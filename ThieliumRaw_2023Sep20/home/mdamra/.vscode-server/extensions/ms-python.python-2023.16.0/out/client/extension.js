/*! For license information please see extension.js.LICENSE.txt */
(()=>{var __webpack_modules__={69145:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionActivationManager=void 0;const o=n(86700),s=n(77651),a=n(17585),c=n(77570),l=n(84974),u=n(61684),p=n(87282),d=n(19735),h=n(98634),f=n(90819);let g=class{constructor(e,t,n,r,i,o,s,a,c){this.activationServices=e,this.singleActivationServices=t,this.documentManager=n,this.autoSelection=r,this.appDiagnostics=i,this.workspaceService=o,this.fileSystem=s,this.activeResourceService=a,this.interpreterPathService=c,this.activatedWorkspaces=new Set,this.isInterpreterSetForWorkspacePromises=new Map,this.disposables=[]}filterServices(){this.workspaceService.isTrusted||(this.activationServices=this.activationServices.filter((e=>e.supportedWorkspaceTypes.untrustedWorkspace)),this.singleActivationServices=this.singleActivationServices.filter((e=>e.supportedWorkspaceTypes.untrustedWorkspace))),this.workspaceService.isVirtualWorkspace&&(this.activationServices=this.activationServices.filter((e=>e.supportedWorkspaceTypes.virtualWorkspace)),this.singleActivationServices=this.singleActivationServices.filter((e=>e.supportedWorkspaceTypes.virtualWorkspace)))}dispose(){for(;this.disposables.length>0;)this.disposables.shift().dispose();this.docOpenedHandler&&(this.docOpenedHandler.dispose(),this.docOpenedHandler=void 0)}async activate(){this.filterServices(),await this.initialize(),await Promise.all([...this.singleActivationServices.map((e=>e.activate())),this.activateWorkspace(this.activeResourceService.getActiveResource())])}async activateWorkspace(e){const t=this.getWorkspaceKey(e);this.activatedWorkspaces.has(t)||(this.activatedWorkspaces.add(t),this.workspaceService.isTrusted&&(await this.autoSelection.autoSelectInterpreter(e),await this.interpreterPathService.copyOldInterpreterStorageValuesToNew(e)),await(0,h.sendActivationTelemetry)(this.fileSystem,this.workspaceService,e),await Promise.all(this.activationServices.map((t=>t.activate(e)))),await this.appDiagnostics.performPreStartupHealthCheck(e))}async initialize(){this.addHandlers(),this.addRemoveDocOpenedHandlers()}onDocOpened(e){var t;if(e.languageId!==c.PYTHON_LANGUAGE)return;const n=this.getWorkspaceKey(e.uri),r=((null===(t=this.workspaceService.workspaceFolders)||void 0===t?void 0:t.length)||0)>0;if(""===n&&r)return;if(this.activatedWorkspaces.has(n))return;const i=this.workspaceService.getWorkspaceFolder(e.uri);this.activateWorkspace(i?i.uri:void 0).ignoreErrors()}addHandlers(){this.disposables.push(this.workspaceService.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this))}addRemoveDocOpenedHandlers(){this.hasMultipleWorkspaces()?this.docOpenedHandler||(this.docOpenedHandler=this.documentManager.onDidOpenTextDocument(this.onDocOpened,this)):this.docOpenedHandler&&(this.docOpenedHandler.dispose(),this.docOpenedHandler=void 0)}onWorkspaceFoldersChanged(){const e=this.workspaceService.workspaceFolders.map((e=>this.getWorkspaceKey(e.uri))),t=Array.from(this.activatedWorkspaces.keys()).filter((t=>e.indexOf(t)<0));if(t.length>0)for(const e of t)this.activatedWorkspaces.delete(e);this.addRemoveDocOpenedHandlers()}hasMultipleWorkspaces(){var e;return((null===(e=this.workspaceService.workspaceFolders)||void 0===e?void 0:e.length)||0)>1}getWorkspaceKey(e){return this.workspaceService.getWorkspaceFolderIdentifier(e,"")}};r([(0,d.traceDecoratorError)("Failed to activate a workspace")],g.prototype,"activateWorkspace",null),g=r([(0,o.injectable)(),i(0,(0,o.multiInject)(f.IExtensionActivationService)),i(1,(0,o.multiInject)(f.IExtensionSingleActivationService)),i(2,(0,o.inject)(a.IDocumentManager)),i(3,(0,o.inject)(p.IInterpreterAutoSelectionService)),i(4,(0,o.inject)(s.IApplicationDiagnostics)),i(5,(0,o.inject)(a.IWorkspaceService)),i(6,(0,o.inject)(l.IFileSystem)),i(7,(0,o.inject)(a.IActiveResourceService)),i(8,(0,o.inject)(u.IInterpreterPathService))],g),t.ExtensionActivationManager=g},23826:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Commands=void 0,(t.Commands||(t.Commands={})).RestartLS="python.analysis.restartLanguageServer"},10464:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerAnalysisOptionsWithEnv=t.LanguageServerAnalysisOptionsBase=void 0;const i=n(66828),o=n(52847),s=n(77570),a=n(36952),c=n(19735);class l{constructor(e,t){this.workspace=t,this.didChange=new i.EventEmitter,this.output=e.channel}async initialize(e,t){}get onDidChange(){return this.didChange.event}dispose(){this.didChange.dispose()}async getAnalysisOptions(){const e=this.getWorkspaceFolder();return{documentSelector:this.getDocumentFilters(e),workspaceFolder:e,synchronize:{configurationSection:this.getConfigSectionsToSynchronize()},outputChannel:this.output,revealOutputChannelOn:o.RevealOutputChannelOn.Never,initializationOptions:await this.getInitializationOptions()}}getWorkspaceFolder(){}getDocumentFilters(e){return this.workspace.isVirtualWorkspace?[{language:s.PYTHON_LANGUAGE}]:s.PYTHON}getConfigSectionsToSynchronize(){return[s.PYTHON_LANGUAGE]}async getInitializationOptions(){}}r([(0,c.traceDecoratorError)("Failed to get analysis options")],l.prototype,"getAnalysisOptions",null),t.LanguageServerAnalysisOptionsBase=l;class u extends l{constructor(e,t,n){super(t,n),this.envVarsProvider=e,this.disposables=[],this.envPythonPath=""}async initialize(e,t){const n=this.envVarsProvider.onDidEnvironmentVariablesChange(this.onEnvVarChange,this);this.disposables.push(n)}dispose(){super.dispose(),this.disposables.forEach((e=>e.dispose()))}async getEnvPythonPath(){const e=await this.envVarsProvider.getEnvironmentVariables();return this.envPythonPath=e.PYTHONPATH||"",this.envPythonPath}onEnvVarChange(){this.notifyifEnvPythonPathChanged().ignoreErrors()}async notifyifEnvPythonPathChanged(){const e=(await this.envVarsProvider.getEnvironmentVariables()).PYTHONPATH||"";this.envPythonPath!==e&&this.didChange.fire()}}r([(0,a.debounceSync)(1e3)],u.prototype,"onEnvVarChange",null),t.LanguageServerAnalysisOptionsWithEnv=u},17347:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileBasedCancellationStrategy=void 0;const r=n(6113),i=n(57147),o=n(22037),s=n(71017),a=n(52847);function c(e){return s.join(o.tmpdir(),"python-languageserver-cancellation",e)}function l(e,t){return s.join(c(e),`cancellation-${String(t)}.tmp`)}function u(e){try{e()}catch(e){}}class p{constructor(e){this.folderName=e;const t=c(e);u((()=>i.mkdirSync(t,{recursive:!0})))}async sendCancellation(e,t){const n=l(this.folderName,t);u((()=>i.writeFileSync(n,"",{flag:"w"})))}cleanup(e){u((()=>i.unlinkSync(l(this.folderName,e))))}dispose(){const e=c(this.folderName);function t(e){const n=i.lstatSync(e);if(n)if(n.isDirectory()&&!n.isSymbolicLink()){for(const n of i.readdirSync(e))t(s.join(e,n));i.rmdirSync(e)}else i.unlinkSync(e)}u((()=>t(e)))}}t.FileBasedCancellationStrategy=class{constructor(){const e=(0,r.randomBytes)(21).toString("hex");this._sender=new p(e)}get receiver(){return a.CancellationReceiverStrategy.Message}get sender(){return this._sender}getCommandLineArguments(){return[`--cancellationReceive=file:${this._sender.folderName}`]}dispose(){this._sender.dispose()}}},14306:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultLanguageServer=void 0;const i=n(86700),o=n(77570),s=n(61684),a=n(90819);let c=class{constructor(e){this.defaultLSType=e}};c=r([(0,i.injectable)()],c),t.setDefaultLanguageServer=async function(e,t){const n=await async function(e){return e.getExtension(o.PYLANCE_EXTENSION_ID)?a.LanguageServerType.Node:a.LanguageServerType.Jedi}(e);t.addSingletonInstance(s.IDefaultLanguageServer,new c(n))}},65188:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerChangeHandler=t.promptForPylanceInstall=void 0;const r=n(66828),i=n(77570),o=n(59314),s=n(67098),a=n(90819);async function c(e,t,n,o){const c=await e.showWarningMessage(s.Pylance.pylanceRevertToJediPrompt,s.Pylance.pylanceInstallPylance,s.Pylance.pylanceRevertToJedi,s.Pylance.remindMeLater);if(c===s.Pylance.pylanceInstallPylance)t.executeCommand("extension.open",i.PYLANCE_EXTENSION_ID);else if(c===s.Pylance.pylanceRevertToJedi){const e=n.getConfiguration("python").inspect("languageServer");let t;(null==e?void 0:e.workspaceValue)?t=r.ConfigurationTarget.Workspace:(null==e?void 0:e.globalValue)&&(t=r.ConfigurationTarget.Global),t&&await o.updateSetting("languageServer",a.LanguageServerType.Jedi,void 0,t)}}t.promptForPylanceInstall=c,t.LanguageServerChangeHandler=class{constructor(e,t,n,r,i,s){this.currentLsType=e,this.extensions=t,this.appShell=n,this.commands=r,this.workspace=i,this.configService=s,this.pylanceInstallCompletedDeferred=(0,o.createDeferred)(),this.disposables=[],this.pylanceInstalled=!1,this.pylanceInstalled=this.isPylanceInstalled(),this.disposables.push(t.onDidChange((async()=>{await this.extensionsChangeHandler()})))}dispose(){for(var e;this.disposables.length;)null===(e=this.disposables.pop())||void 0===e||e.dispose()}get pylanceInstallCompleted(){return this.pylanceInstallCompletedDeferred.promise}async handleLanguageServerChange(e){this.currentLsType!==e&&e!==a.LanguageServerType.Microsoft&&(e!==a.LanguageServerType.Node||this.isPylanceInstalled()||await c(this.appShell,this.commands,this.workspace,this.configService),this.currentLsType=e)}async extensionsChangeHandler(){const e=this.pylanceInstalled;this.pylanceInstalled=this.isPylanceInstalled(),e===this.pylanceInstalled&&this.pylanceInstallCompletedDeferred.resolve()}isPylanceInstalled(){return!!this.extensions.getExtension(i.PYLANCE_EXTENSION_ID)}}},52228:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LoadLanguageServerExtension=void 0;const o=n(86700),s=n(17585),a=n(61684);let c=class{constructor(e,t){this.commandManager=e,this.disposables=t,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!0}}activate(){const e=this.commandManager.registerCommand("python._loadLanguageServerExtension",(()=>{}));return this.disposables.push(e),Promise.resolve()}};c=r([(0,o.injectable)(),i(0,(0,o.inject)(s.ICommandManager)),i(1,(0,o.inject)(a.IDisposableRegistry))],c),t.LoadLanguageServerExtension=c},63265:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerOutputChannel=void 0;const o=n(86700),s=n(17585);n(32727);const a=n(61684),c=n(67098);let l=class{constructor(e,t,n){this.appShell=e,this.commandManager=t,this.disposable=n,this.registered=!1}get channel(){return this.output||(this.output=this.appShell.createOutputChannel(c.OutputChannelNames.languageServer),this.disposable.push(this.output),this.registerCommand().ignoreErrors()),this.output}async registerCommand(){this.registered||(this.registered=!0,await this.commandManager.executeCommand("setContext","python.hasLanguageServerOutputChannel",!0),this.disposable.push(this.commandManager.registerCommand("python.viewLanguageServerOutput",(()=>{var e;return null===(e=this.output)||void 0===e?void 0:e.show(!0)}))),this.disposable.push({dispose:()=>{this.registered=!1}}))}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IApplicationShell)),i(1,(0,o.inject)(s.ICommandManager)),i(2,(0,o.inject)(a.IDisposableRegistry))],l),t.LanguageServerOutputChannel=l},61702:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionSurveyPrompt=t.extensionSurveyStateKeys=void 0;const o=n(86700),s=n(63477),a=n(66828),c=n(17585),l=n(60717);n(32727);const u=n(84974),p=n(61684),d=n(67098),h=n(19735),f=n(54813),g=n(61522);var m;!function(e){e.doNotShowAgain="doNotShowExtensionSurveyAgain",e.disableSurveyForTime="doNotShowExtensionSurveyUntilTime"}(m=t.extensionSurveyStateKeys||(t.extensionSurveyStateKeys={}));const v=72576e5;let y=class{constructor(e,t,n,r,i,o,s,a=10,c=108e5){this.appShell=e,this.browserService=t,this.persistentState=n,this.random=r,this.experiments=i,this.appEnvironment=o,this.platformService=s,this.sampleSizePerOneHundredUsers=a,this.waitTimeToShowSurvey=c,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(){await this.experiments.inExperiment(l.ShowExtensionSurveyPrompt.experiment)&&this.shouldShowBanner()&&setTimeout((()=>this.showSurvey().ignoreErrors()),this.waitTimeToShowSurvey)}shouldShowBanner(){return a.env.uiKind!==(null===a.UIKind||void 0===a.UIKind?void 0:a.UIKind.Web)&&(!this.persistentState.createGlobalPersistentState(m.doNotShowAgain,!1).value&&(!this.persistentState.createGlobalPersistentState(m.disableSurveyForTime,!1,v).value&&!(this.random.getRandomInt(0,100)>=this.sampleSizePerOneHundredUsers)))}async showSurvey(){const e=[d.ExtensionSurveyBanner.bannerLabelYes,d.ExtensionSurveyBanner.maybeLater,d.Common.doNotShowAgain],t=await this.appShell.showInformationMessage(d.ExtensionSurveyBanner.bannerMessage,...e);(0,f.sendTelemetryEvent)(g.EventName.EXTENSION_SURVEY_PROMPT,void 0,{selection:t?["Yes","Maybe later","Don't show again"][e.indexOf(t)]:void 0}),t&&(t===d.ExtensionSurveyBanner.bannerLabelYes?(this.launchSurvey(),await this.persistentState.createGlobalPersistentState(m.disableSurveyForTime,!1,v).updateValue(!0)):t===d.Common.doNotShowAgain&&await this.persistentState.createGlobalPersistentState(m.doNotShowAgain,!1).updateValue(!0))}launchSurvey(){const e=`https://aka.ms/AA5rjx5?${s.stringify({o:encodeURIComponent(this.platformService.osType),v:encodeURIComponent(this.appEnvironment.vscodeVersion),e:encodeURIComponent(this.appEnvironment.packageJson.version),m:encodeURIComponent(this.appEnvironment.sessionId)})}`;this.browserService.launch(e)}};r([(0,h.traceDecoratorError)("Failed to check whether to display prompt for extension survey")],y.prototype,"shouldShowBanner",null),r([(0,h.traceDecoratorError)("Failed to display prompt for extension survey")],y.prototype,"showSurvey",null),y=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IApplicationShell)),i(1,(0,o.inject)(p.IBrowserService)),i(2,(0,o.inject)(p.IPersistentStateFactory)),i(3,(0,o.inject)(p.IRandom)),i(4,(0,o.inject)(p.IExperimentService)),i(5,(0,o.inject)(c.IApplicationEnvironment)),i(6,(0,o.inject)(u.IPlatformService)),i(7,(0,o.optional)()),i(8,(0,o.optional)())],y),t.ExtensionSurveyPrompt=y},67220:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JediLanguageServerAnalysisOptions=void 0;const r=n(71017),i=n(10464);class o extends i.LanguageServerAnalysisOptionsWithEnv{constructor(e,t,n,r){super(e,t,r),this.configurationService=n,this.resource=void 0}async initialize(e,t){return this.resource=e,super.initialize(e,t)}getWorkspaceFolder(){return this.workspace.getWorkspaceFolder(this.resource)}async getInitializationOptions(){var e;const t=this.configurationService.getSettings(this.resource),n=null===(e=this.getWorkspaceFolder())||void 0===e?void 0:e.uri.fsPath,i=t.autoComplete?t.autoComplete.extraPaths.map((e=>r.isAbsolute(e)?e:n?r.join(n,e):"")):[];return n&&i.unshift(n),{markupKindPreferred:"markdown",completion:{resolveEagerly:!1,disableSnippets:!0},diagnostics:{enable:!0,didOpen:!0,didSave:!0,didChange:!0},hover:{disable:{keyword:{all:!0}}},workspace:{extraPaths:i.filter((e=>e.length>0)).filter(((e,t,n)=>n.indexOf(e)===t)),symbols:{maxSymbols:0}}}}}t.JediLanguageServerAnalysisOptions=o},49532:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JediLanguageClientFactory=void 0;const r=n(71017),i=n(52847),o=n(77570);t.JediLanguageClientFactory=class{constructor(e){this.interpreterService=e}async createLanguageClient(e,t,n){const s=r.join(o.EXTENSION_ROOT_DIR,"pythonFiles","run-jedi-language-server.py"),a=await this.interpreterService.getActiveInterpreter(e),c={command:a?a.path:"python",args:[s]};return new i.LanguageClient(o.PYTHON_LANGUAGE,"Python Jedi",c,n)}}},74381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JediLanguageClientMiddleware=void 0;const r=n(1158),i=n(90819);class o extends r.LanguageClientMiddleware{constructor(e,t){super(e,i.LanguageServerType.Jedi,t),this.setupHidingMiddleware(e)}}t.JediLanguageClientMiddleware=o},17192:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.JediLanguageServerProxy=void 0,n(32727);const i=n(54813),o=n(61522),s=n(12133),a=n(18699),c=n(19735);class l{constructor(e){this.factory=e,this.disposables=[]}static versionTelemetryProps(e){return{lsVersion:e.lsVersion}}dispose(){this.stop().ignoreErrors()}async start(e,t,n){var r;this.lsVersion=null!==(r=n.middleware?n.middleware.serverVersion:void 0)&&void 0!==r?r:"0.19.3";try{const r=await this.factory.createLanguageClient(e,t,n);this.registerHandlers(r),await r.start(),this.languageClient=r}catch(e){throw(0,c.traceError)("Failed to start language server:",e),new Error("Launching Jedi language server using python failed, see output.")}}async stop(){for(var e;this.disposables.length>0;)this.disposables.shift().dispose();if(this.languageClient){const t=this.languageClient;this.languageClient=void 0;const n=null===(e=t._serverProcess)||void 0===e?void 0:e.pid,r=()=>{n&&(0,a.killPid)(n)};try{await t.stop(),await t.dispose(),r()}catch(e){(0,c.traceError)("Stopping language client failed",e),r()}}}loadExtension(){}registerHandlers(e){const t=new s.ProgressReporting(e);this.disposables.push(t)}}r([(0,c.traceDecoratorVerbose)("Disposing language server")],l.prototype,"dispose",null),r([(0,c.traceDecoratorError)("Failed to start language server"),(0,i.captureTelemetry)(o.EventName.JEDI_LANGUAGE_SERVER_ENABLED,void 0,!0,void 0,l.versionTelemetryProps)],l.prototype,"start",null),r([(0,c.traceDecoratorVerbose)("Stopping language server")],l.prototype,"stop",null),r([(0,i.captureTelemetry)(o.EventName.JEDI_LANGUAGE_SERVER_READY,void 0,!0,void 0,l.versionTelemetryProps)],l.prototype,"registerHandlers",null),t.JediLanguageServerProxy=l},73461:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.JediLanguageServerManager=void 0;const i=n(55674),o=n(71017);n(32727);const s=n(36952),a=n(63281),c=n(54813),l=n(61522),u=n(23826),p=n(74381),d=n(19735);class h{constructor(e,t,n,r){this.serviceContainer=e,this.analysisOptions=t,this.languageServerProxy=n,this.disposables=[],this.connected=!1,h.commandDispose&&h.commandDispose.dispose(),h.commandDispose=r.registerCommand(u.Commands.RestartLS,(()=>{this.restartLanguageServer().ignoreErrors()}))}static versionTelemetryProps(e){return{lsVersion:e.lsVersion}}dispose(){this.stopLanguageServer().ignoreErrors(),h.commandDispose.dispose(),this.disposables.forEach((e=>e.dispose()))}async start(e,t){this.resource=e,this.interpreter=t,this.analysisOptions.onDidChange(this.restartLanguageServerDebounced,this,this.disposables);try{const e=await i.readFile(o.join(a.EXTENSION_ROOT_DIR,"pythonFiles","jedilsp_requirements","requirements.txt"),"utf-8"),t=/jedi-language-server==([0-9\.]*)/.exec(e);t&&2===t.length&&([,this.lsVersion]=t)}catch(e){(0,d.traceVerbose)("Failed to get jedi-language-server version: ",e)}await this.analysisOptions.initialize(e,t),await this.startLanguageServer()}connect(){var e;this.connected||(this.connected=!0,null===(e=this.middleware)||void 0===e||e.connect())}disconnect(){var e;this.connected&&(this.connected=!1,null===(e=this.middleware)||void 0===e||e.disconnect())}restartLanguageServerDebounced(){this.restartLanguageServer().ignoreErrors()}async restartLanguageServer(){await this.stopLanguageServer(),await this.startLanguageServer()}async startLanguageServer(){const e=await this.analysisOptions.getAnalysisOptions();this.middleware=new p.JediLanguageClientMiddleware(this.serviceContainer,this.lsVersion),e.middleware=this.middleware,this.connected&&this.middleware.connect(),await this.languageServerProxy.start(this.resource,this.interpreter,e)}async stopLanguageServer(){this.languageServerProxy&&await this.languageServerProxy.stop()}}r([(0,d.traceDecoratorError)("Failed to start language server")],h.prototype,"start",null),r([(0,s.debounceSync)(1e3)],h.prototype,"restartLanguageServerDebounced",null),r([(0,d.traceDecoratorError)("Failed to restart language server"),(0,d.traceDecoratorVerbose)("Restarting language server")],h.prototype,"restartLanguageServer",null),r([(0,c.captureTelemetry)(l.EventName.JEDI_LANGUAGE_SERVER_STARTUP,void 0,!0,void 0,h.versionTelemetryProps),(0,d.traceDecoratorVerbose)("Starting language server")],h.prototype,"startLanguageServer",null),r([(0,d.traceDecoratorVerbose)("Stopping language server")],h.prototype,"stopLanguageServer",null),t.JediLanguageServerManager=h},1158:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageClientMiddleware=void 0;const r=n(17585),i=n(61684),o=n(54813),s=n(42857),a=n(1730);class c extends s.LanguageClientMiddlewareBase{constructor(e,t,n){super(e,t,o.sendTelemetryEvent,n)}setupHidingMiddleware(e){const t=e.get(r.IJupyterExtensionDependencyManager),n=e.get(i.IDisposableRegistry)||[],o=e.get(i.IExtensions);this.shouldCreateHidingMiddleware(t)&&(this.notebookAddon=(0,a.createHidingMiddleware)()),n.push(null==o?void 0:o.onDidChange((async()=>{await this.onExtensionChange(t)})))}shouldCreateHidingMiddleware(e){return e&&e.isJupyterExtensionInstalled}async onExtensionChange(e){e&&(this.notebookAddon&&!this.shouldCreateHidingMiddleware(e)?this.notebookAddon=void 0:!this.notebookAddon&&this.shouldCreateHidingMiddleware(e)&&(this.notebookAddon=(0,a.createHidingMiddleware)()))}}t.LanguageClientMiddleware=c},42857:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageClientMiddlewareBase=void 0;const r=n(71017),i=n(66828),o=n(92850),s=n(77570),a=n(59314),c=n(70057),l=n(19909),u=n(18639),p=n(61522),d=n(90819),h=3e5,f=6e4;t.LanguageClientMiddlewareBase=class{constructor(e,t,n,r){this.serviceContainer=e,this.sendTelemetryEventFunc=n,this.serverVersion=r,this.lastCaptured=new Map,this.nextWindow=0,this.eventCount=0,this.workspace={configuration:async(e,t,n)=>{var r,s,c;if(!this.serviceContainer)return n(e,t);const p=this.serviceContainer.get(u.IInterpreterService),d=this.serviceContainer.get(l.IEnvironmentVariablesProvider);let h=n(e,t);if((0,a.isThenable)(h)&&(h=await h),h instanceof o.ResponseError)return h;for(const[t,n]of e.items.entries()){if("python"===n.section){const e=n.scopeUri?i.Uri.parse(n.scopeUri):void 0,o=h[t];o.pythonPath=null!==(c=null!==(r=await this.getPythonPathOverride(e))&&void 0!==r?r:null===(s=await p.getActiveInterpreter(e))||void 0===s?void 0:s.path)&&void 0!==c?c:"python";const a=(await d.getEnvironmentVariables(e)).PYTHONPATH;a&&(o._envPYTHONPATH=a)}this.configurationHook(n,h[t])}return h}},this.connectedPromise=(0,a.createDeferred)(),this.notebooks={didOpen:this.didOpenNotebook.bind(this),didSave:this.didSaveNotebook.bind(this),didChange:this.didChangeNotebook.bind(this),didClose:this.didCloseNotebook.bind(this)},this.handleDiagnostics=this.handleDiagnostics.bind(this),this.didOpen=this.didOpen.bind(this),this.didSave=this.didSave.bind(this),this.didChange=this.didChange.bind(this),this.didClose=this.didClose.bind(this),this.willSave=this.willSave.bind(this),this.willSaveWaitUntil=this.willSaveWaitUntil.bind(this),t===d.LanguageServerType.Node?this.eventName=p.EventName.LANGUAGE_SERVER_REQUEST:t===d.LanguageServerType.Jedi&&(this.eventName=p.EventName.JEDI_LANGUAGE_SERVER_REQUEST)}async getPythonPathOverride(e){}configurationHook(e,t){}get connected(){return this.connectedPromise.promise}connect(){this.connectedPromise.resolve(!0)}disconnect(){this.connectedPromise=(0,a.createDeferred)(),this.connectedPromise.resolve(!1)}didChange(){return this.callNext("didChange",arguments)}didOpen(){return this.callNext("didOpen",arguments)}didClose(){return this.callNext("didClose",arguments)}didSave(){return this.callNext("didSave",arguments)}willSave(){return this.callNext("willSave",arguments)}willSaveWaitUntil(){return this.callNext("willSaveWaitUntil",arguments)}async didOpenNotebook(){return this.callNotebooksNext("didOpen",arguments)}async didSaveNotebook(){return this.callNotebooksNext("didSave",arguments)}async didChangeNotebook(){return this.callNotebooksNext("didChange",arguments)}async didCloseNotebook(){return this.callNotebooksNext("didClose",arguments)}async provideCompletionItem(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/completion",h,"provideCompletionItem",arguments,((e,t)=>t?{resultLength:Array.isArray(t)?t.length:t.items.length}:{resultLength:0}))}async provideHover(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/hover",h,"provideHover",arguments)}async handleDiagnostics(e,t,n){if(await this.connected){const t=e.fsPath,n=t?r.basename(t):void 0;if(!n||!n.startsWith(s.HiddenFilePrefix))return this.callNext("handleDiagnostics",arguments)}}async resolveCompletionItem(){if(await this.connected)return this.callNextAndSendTelemetry("completionItem/resolve",h,"resolveCompletionItem",arguments)}async provideSignatureHelp(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/signatureHelp",h,"provideSignatureHelp",arguments)}async provideDefinition(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/definition",f,"provideDefinition",arguments)}async provideReferences(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/references",f,"provideReferences",arguments)}async provideDocumentHighlights(){if(await this.connected)return this.callNext("provideDocumentHighlights",arguments)}async provideDocumentSymbols(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/documentSymbol",h,"provideDocumentSymbols",arguments)}async provideWorkspaceSymbols(){if(await this.connected)return this.callNextAndSendTelemetry("workspace/symbol",f,"provideWorkspaceSymbols",arguments)}async provideCodeActions(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/codeAction",h,"provideCodeActions",arguments)}async provideCodeLenses(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/codeLens",h,"provideCodeLenses",arguments)}async resolveCodeLens(){if(await this.connected)return this.callNextAndSendTelemetry("codeLens/resolve",h,"resolveCodeLens",arguments)}async provideDocumentFormattingEdits(){if(await this.connected)return this.callNext("provideDocumentFormattingEdits",arguments)}async provideDocumentRangeFormattingEdits(){if(await this.connected)return this.callNext("provideDocumentRangeFormattingEdits",arguments)}async provideOnTypeFormattingEdits(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/onTypeFormatting",h,"provideOnTypeFormattingEdits",arguments)}async provideRenameEdits(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/rename",f,"provideRenameEdits",arguments)}async prepareRename(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/prepareRename",f,"prepareRename",arguments)}async provideDocumentLinks(){if(await this.connected)return this.callNext("provideDocumentLinks",arguments)}async resolveDocumentLink(){if(await this.connected)return this.callNext("resolveDocumentLink",arguments)}async provideDeclaration(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/declaration",f,"provideDeclaration",arguments)}async provideTypeDefinition(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/typeDefinition",f,"provideTypeDefinition",arguments)}async provideImplementation(){if(await this.connected)return this.callNext("provideImplementation",arguments)}async provideDocumentColors(){if(await this.connected)return this.callNext("provideDocumentColors",arguments)}async provideColorPresentations(){if(await this.connected)return this.callNext("provideColorPresentations",arguments)}async provideFoldingRanges(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/foldingRange",h,"provideFoldingRanges",arguments)}async provideSelectionRanges(){if(await this.connected)return this.callNextAndSendTelemetry("textDocument/selectionRange",f,"provideSelectionRanges",arguments)}async prepareCallHierarchy(){if(await this.connected)return this.callNext("prepareCallHierarchy",arguments)}async provideCallHierarchyIncomingCalls(){if(await this.connected)return this.callNext("provideCallHierarchyIncomingCalls",arguments)}async provideCallHierarchyOutgoingCalls(){if(await this.connected)return this.callNext("provideCallHierarchyOutgoingCalls",arguments)}async provideDocumentSemanticTokens(){if(await this.connected)return this.callNext("provideDocumentSemanticTokens",arguments)}async provideDocumentSemanticTokensEdits(){if(await this.connected)return this.callNext("provideDocumentSemanticTokensEdits",arguments)}async provideDocumentRangeSemanticTokens(){if(await this.connected)return this.callNext("provideDocumentRangeSemanticTokens",arguments)}async provideLinkedEditingRange(){if(await this.connected)return this.callNext("provideLinkedEditingRange",arguments)}callNext(e,t){return this.notebookAddon&&this.notebookAddon[e]?this.notebookAddon[e](...t):t[t.length-1](...t)}callNotebooksNext(e,t){var n;return(null===(n=this.notebookAddon)||void 0===n?void 0:n.notebooks)&&this.notebookAddon.notebooks[e]?this.notebookAddon.notebooks[e](...t):t[t.length-1](...t)}callNextAndSendTelemetry(e,t,n,r,i){const o=Date.now(),s=new c.StopWatch;let l=!1;const u=[...r];u[u.length-1]=(...e)=>(l=!0,r[r.length-1](...e)),o>this.nextWindow&&(this.nextWindow=o+36e5,this.eventCount=0);const p=this.lastCaptured.get(e),d=n=>{if(this.eventName&&l&&this.eventCount<100&&(!p||o-p>t)){this.lastCaptured.set(e,o),this.eventCount+=1;const t=e.replace(/\//g,"."),r={lsVersion:this.serverVersion||"unknown",method:t};let a=s.elapsedTime;i&&(a={duration:a,...i(this,n)}),this.sendTelemetryEventFunc(this.eventName,a,r)}return n},h=this.callNext(n,u);return(0,a.isThenable)(h)?h.then(d):d(h)}}},22473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLanguageServerAnalysisOptions=void 0;const r=n(10464);class i extends r.LanguageServerAnalysisOptionsBase{constructor(e,t){super(e,t)}getConfigSectionsToSynchronize(){return[...super.getConfigSectionsToSynchronize(),"jupyter.runStartupCommands"]}async getInitializationOptions(){return{experimentationSupport:!0,trustedWorkspaceSupport:!0}}}t.NodeLanguageServerAnalysisOptions=i},46888:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLanguageClientFactory=t.PYLANCE_NAME=void 0;const r=n(71017),i=n(52847),o=n(77570);t.PYLANCE_NAME="Pylance",t.NodeLanguageClientFactory=class{constructor(e,t){this.fs=e,this.extensions=t}async createLanguageClient(e,n,s){var a;const c=(null===(a=s.connectionOptions)||void 0===a?void 0:a.cancellationStrategy).getCommandLineArguments(),l=this.extensions.getExtension(o.PYLANCE_EXTENSION_ID),u=l?l.extensionPath:"",p=r.join(u,"dist","server.bundle.js"),d=r.join(u,"dist","server.js"),h=await this.fs.fileExists(d)?d:p,f={run:{module:p,transport:i.TransportKind.ipc,args:c},debug:{module:h,transport:i.TransportKind.ipc,options:{execArgv:["--nolazy","--inspect=6600"]},args:c}};return new i.LanguageClient(o.PYTHON_LANGUAGE,t.PYLANCE_NAME,f,s)}}},95479:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLanguageClientMiddleware=void 0;const r=n(17585),i=n(66259),o=n(19735),s=n(1158),a=n(95266),c=n(90819),l=n(32342);class u extends s.LanguageClientMiddleware{constructor(e,t,n){super(e,c.LanguageServerType.Node,n),this.getClient=t,this.workspaceService=e.get(r.IWorkspaceService),this.lspNotebooksExperiment=e.get(l.LspNotebooksExperiment),this.setupHidingMiddleware(e),this.jupyterExtensionIntegration=e.get(i.JupyterExtensionIntegration),this.notebookAddon||(this.notebookAddon=new a.LspInteractiveWindowMiddlewareAddon(this.getClient,this.jupyterExtensionIntegration))}shouldCreateHidingMiddleware(e){return!1}async onExtensionChange(e){e&&e.isJupyterExtensionInstalled&&await this.lspNotebooksExperiment.onJupyterInstalled(),this.notebookAddon||(this.notebookAddon=new a.LspInteractiveWindowMiddlewareAddon(this.getClient,this.jupyterExtensionIntegration))}async getPythonPathOverride(e){if(!e)return;const t=this.jupyterExtensionIntegration.getJupyterPythonPathFunction();if(!t)return;const n=await t(e);return n&&(0,o.traceLog)(`Jupyter provided interpreter path override: ${n}`),n}configurationHook(e,t){if("editor"===e.section&&this.workspaceService){const n=this.workspaceService.getConfiguration(e.section,void 0,!0);t.formatOnType=n.get("formatOnType")}}}t.NodeLanguageClientMiddleware=u},82602:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLanguageServerProxy=void 0,n(32727);const i=n(52847),o=n(54813),s=n(61522),a=n(17347),c=n(12133),l=n(19735),u=n(77570);var p,d;!function(e){e.Method="python/inExperiment"}(p||(p={})),function(e){e.Method="python/getExperimentValue"}(d||(d={}));class h{constructor(e,t,n,r,i,o){this.factory=e,this.experimentService=t,this.interpreterPathService=n,this.environmentService=r,this.workspace=i,this.extensions=o,this.disposables=[]}static versionTelemetryProps(e){return{lsVersion:e.lsVersion}}dispose(){this.stop().ignoreErrors()}async start(e,t,n){const r=await this.getPylanceExtension();this.lsVersion=(null==r?void 0:r.packageJSON.version)||"0";const i=null==r?void 0:r.exports;if(i&&i.client&&i.client.isEnabled())return this.pylanceApi=i,void await i.client.start();this.cancellationStrategy=new a.FileBasedCancellationStrategy,n.connectionOptions={cancellationStrategy:this.cancellationStrategy};const o=await this.factory.createLanguageClient(e,t,n);this.registerHandlers(o,e),this.disposables.push(this.workspace.onDidGrantWorkspaceTrust((()=>{o.sendNotification("python/workspaceTrusted",{isTrusted:!0})}))),await o.start(),this.languageClient=o}async stop(){if(this.pylanceApi){const e=this.pylanceApi;this.pylanceApi=void 0,await e.client.stop()}for(;this.disposables.length>0;)this.disposables.shift().dispose();if(this.languageClient){const e=this.languageClient;this.languageClient=void 0;try{await e.stop(),await e.dispose()}catch(e){(0,l.traceError)("Stopping language client failed",e)}}this.cancellationStrategy&&(this.cancellationStrategy.dispose(),this.cancellationStrategy=void 0)}loadExtension(){}registerHandlers(e,t){const n=new c.ProgressReporting(e);this.disposables.push(n),this.disposables.push(this.interpreterPathService.onDidChange((()=>{e.sendNotification(i.DidChangeConfigurationNotification.type,{settings:null})}))),this.disposables.push(this.environmentService.onDidEnvironmentVariablesChange((()=>{e.sendNotification(i.DidChangeConfigurationNotification.type,{settings:null})}))),e.onTelemetry((e=>{var t;const n=e.EventName||s.EventName.LANGUAGE_SERVER_TELEMETRY,r={...e.Properties,method:null===(t=e.Properties.method)||void 0===t?void 0:t.replace(/\//g,".")};(0,o.sendTelemetryEvent)(n,e.Measurements,r,e.Exception)})),e.onRequest(p.Method,(async e=>({inExperiment:await this.experimentService.inExperiment(e.experimentName)}))),e.onRequest(d.Method,(async e=>({value:await this.experimentService.getExperimentValue(e.experimentName)}))),this.disposables.push(e.onRequest("python/isTrustedWorkspace",(async()=>({isTrusted:this.workspace.isTrusted}))))}async getPylanceExtension(){const e=this.extensions.getExtension(u.PYLANCE_EXTENSION_ID);if(e)return e.isActive||await e.activate(),e}}r([(0,l.traceDecoratorVerbose)("Disposing language server")],h.prototype,"dispose",null),r([(0,l.traceDecoratorError)("Failed to start language server"),(0,o.captureTelemetry)(s.EventName.LANGUAGE_SERVER_ENABLED,void 0,!0,void 0,h.versionTelemetryProps)],h.prototype,"start",null),r([(0,l.traceDecoratorVerbose)("Disposing language server")],h.prototype,"stop",null),r([(0,o.captureTelemetry)(s.EventName.LANGUAGE_SERVER_READY,void 0,!0,void 0,h.versionTelemetryProps)],h.prototype,"registerHandlers",null),t.NodeLanguageServerProxy=h},95266:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LspInteractiveWindowMiddlewareAddon=void 0;const r=n(52847),i=n(40273);class o{constructor(e,t){this.getClient=e,this.jupyterExtensionIntegration=t,this.notebookDocumentMap=new Map,this.unlinkedTextDocumentMap=new Map,this.notebooks={didOpen:this.didOpenNotebook.bind(this),didClose:this.didCloseNotebook.bind(this)},this.didOpen=this.didOpen.bind(this),this.didChange=this.didChange.bind(this),this.didClose=this.didClose.bind(this)}dispose(){}async didOpen(e,t){var n,i;const o=this.getNotebookUriForTextDocumentUri(e.uri);if(!o)return void await t(e);const s=this.notebookDocumentMap.get(o.toString());if(s)try{const t={cells:{structure:{array:{start:s.cellCount,deleteCount:0,cells:[{kind:r.NotebookCellKind.Code,document:e.uri.toString()}]},didOpen:[{uri:e.uri.toString(),languageId:e.languageId,version:e.version,text:e.getText()}],didClose:void 0}}};await(null===(n=this.getClient())||void 0===n?void 0:n.sendNotification(r.DidChangeNotebookDocumentNotification.type,{notebookDocument:{version:s.version,uri:o.toString()},change:t}))}catch(e){throw null===(i=this.getClient())||void 0===i||i.error("Sending DidChangeNotebookDocumentNotification failed",e),e}else this.unlinkedTextDocumentMap.set(o.toString(),e)}async didChange(e,t){const n=this.getNotebookUriForTextDocumentUri(e.document.uri);if(!n)return void await t(e);const r=this.notebookDocumentMap.get(n.toString());if(r){const t=this.getClient();t&&t.sendNotification(i.DidChangeNotebookDocumentNotification.type,{notebookDocument:{uri:n.toString(),version:r.version},change:{cells:{textContent:[o._asTextContentChange(e,t.code2ProtocolConverter)]}}})}}static _asTextContentChange(e,t){const n=t.asChangeTextDocumentParams(e,e.document.uri,e.document.version);return{document:n.textDocument,changes:n.contentChanges}}async didClose(e,t){const n=this.getNotebookUriForTextDocumentUri(e.uri);n?this.unlinkedTextDocumentMap.delete(n.toString()):await t(e)}async didOpenNotebook(e,t,n){this.notebookDocumentMap.set(e.uri.toString(),e);const i=this.unlinkedTextDocumentMap.get(e.uri.toString());if(i){const o=[...t,{index:e.cellCount,notebook:e,kind:r.NotebookCellKind.Code,document:i,metadata:{},outputs:[],executionSummary:void 0}];this.unlinkedTextDocumentMap.delete(e.uri.toString()),await n(e,o)}else await n(e,t)}async didCloseNotebook(e,t,n){this.notebookDocumentMap.delete(e.uri.toString()),await n(e,t)}getNotebookUriForTextDocumentUri(e){const t=this.jupyterExtensionIntegration.getGetNotebookUriForTextDocumentUriFunction();if(t)return t(e)}}t.LspInteractiveWindowMiddlewareAddon=o},32342:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LspNotebooksExperiment=void 0;const o=n(86700),s=n(19735),a=n(17585),c=n(77498),l=n(59314),u=n(66259);let p=class{constructor(e,t){this.serviceContainer=e,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!0},this.isJupyterInstalled=!1,this.isJupyterInstalled=t.isJupyterExtensionInstalled}activate(){return Promise.resolve()}async onJupyterInstalled(){this.isJupyterInstalled||(await this.waitForJupyterToRegisterPythonPathFunction(),this.isJupyterInstalled=!0)}async waitForJupyterToRegisterPythonPathFunction(){const e=this.serviceContainer.get(u.JupyterExtensionIntegration);let t=!1;for(let n=0;n<20;n+=1){if(e.getJupyterPythonPathFunction()){(0,s.traceVerbose)("Jupyter called registerJupyterPythonPathFunction"),t=!0;break}await(0,l.sleep)(500)}t||(0,s.traceVerbose)("Timed out waiting for Jupyter to call registerJupyterPythonPathFunction")}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer)),i(1,(0,o.inject)(a.IJupyterExtensionDependencyManager))],p),t.LspNotebooksExperiment=p},57582:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeLanguageServerManager=void 0,n(32727);const i=n(36952),o=n(54813),s=n(61522),a=n(23826),c=n(95479),l=n(19735),u=n(77570);class p{constructor(e,t,n,r,i){this.serviceContainer=e,this.analysisOptions=t,this.languageServerProxy=n,this.extensions=i,this.disposables=[],this.connected=!1,this.started=!1,p.commandDispose&&p.commandDispose.dispose(),p.commandDispose=r.registerCommand(a.Commands.RestartLS,(()=>{(0,o.sendTelemetryEvent)(s.EventName.LANGUAGE_SERVER_RESTART,void 0,{reason:"command"}),this.restartLanguageServer().ignoreErrors()}))}static versionTelemetryProps(e){return{lsVersion:e.lsVersion}}dispose(){this.stopLanguageServer().ignoreErrors(),p.commandDispose.dispose(),this.disposables.forEach((e=>e.dispose()))}async start(e,t){if(this.started)throw new Error("Language server already started");this.resource=e,this.interpreter=t,this.analysisOptions.onDidChange(this.restartLanguageServerDebounced,this,this.disposables);const n=this.extensions.getExtension(u.PYLANCE_EXTENSION_ID);this.lsVersion=(null==n?void 0:n.packageJSON.version)||"0",await this.analysisOptions.initialize(e,t),await this.startLanguageServer(),this.started=!0}connect(){var e;this.connected||(this.connected=!0,null===(e=this.middleware)||void 0===e||e.connect())}disconnect(){var e;this.connected&&(this.connected=!1,null===(e=this.middleware)||void 0===e||e.disconnect())}restartLanguageServerDebounced(){(0,o.sendTelemetryEvent)(s.EventName.LANGUAGE_SERVER_RESTART,void 0,{reason:"settings"}),this.restartLanguageServer().ignoreErrors()}async restartLanguageServer(){await this.stopLanguageServer(),await this.startLanguageServer()}async startLanguageServer(){const e=await this.analysisOptions.getAnalysisOptions();this.middleware=new c.NodeLanguageClientMiddleware(this.serviceContainer,(()=>this.languageServerProxy.languageClient),this.lsVersion),e.middleware=this.middleware,this.connected&&this.middleware.connect(),await this.languageServerProxy.start(this.resource,this.interpreter,e)}async stopLanguageServer(){this.languageServerProxy&&await this.languageServerProxy.stop()}}r([(0,l.traceDecoratorError)("Failed to start language server")],p.prototype,"start",null),r([(0,i.debounceSync)(1e3)],p.prototype,"restartLanguageServerDebounced",null),r([(0,l.traceDecoratorError)("Failed to restart language server"),(0,l.traceDecoratorVerbose)("Restarting language server")],p.prototype,"restartLanguageServer",null),r([(0,o.captureTelemetry)(s.EventName.LANGUAGE_SERVER_STARTUP,void 0,!0,void 0,p.versionTelemetryProps),(0,l.traceDecoratorVerbose)("Starting language server")],p.prototype,"startLanguageServer",null),r([(0,l.traceDecoratorVerbose)("Stopping language server")],p.prototype,"stopLanguageServer",null),t.NodeLanguageServerManager=p},22430:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PartialModeStatusItem=void 0;const o=n(86700),s=n(17585),a=n(61684),c=n(67098);let l=class{constructor(e,t){this.workspace=e,this.disposables=t,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!0}}async activate(){const{isTrusted:e,isVirtualWorkspace:t}=this.workspace;if(e&&!t)return;const n=this.createStatusItem();n&&this.disposables.push(n)}createStatusItem(){const e=n(66828);if("createLanguageStatusItem"in e.languages){const t=e.languages.createLanguageStatusItem("python.projectStatus",{language:"python"});return t.name=c.LanguageService.statusItem.name,t.severity=e.LanguageStatusSeverity.Warning,t.text=c.LanguageService.statusItem.text,t.detail=this.workspace.isTrusted?c.LanguageService.virtualWorkspaceStatusItem.detail:c.LanguageService.statusItem.detail,t.command={title:c.Common.learnMore,command:"vscode.open",arguments:[e.Uri.parse("https://aka.ms/AAdzyh4")]},t}}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IWorkspaceService)),i(1,(0,o.inject)(a.IDisposableRegistry))],l),t.PartialModeStatusItem=l},12133:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressReporting=void 0;const r=n(66828),i=n(59314);t.ProgressReporting=class{constructor(e){this.languageClient=e,this.languageClient.onNotification("python/setStatusBarMessage",(e=>{this.statusBarMessage&&this.statusBarMessage.dispose(),this.statusBarMessage=r.window.setStatusBarMessage(e)})),this.languageClient.onNotification("python/beginProgress",(e=>{this.progressDeferred||this.beginProgress()})),this.languageClient.onNotification("python/reportProgress",(e=>{this.progress||this.beginProgress(),this.progress.report({message:e})})),this.languageClient.onNotification("python/endProgress",(e=>{this.progressDeferred&&(this.progressDeferred.resolve(),this.progressDeferred=void 0,this.progress=void 0)}))}dispose(){this.statusBarMessage&&this.statusBarMessage.dispose()}beginProgress(){this.progressDeferred=(0,i.createDeferred)(),r.window.withProgress({location:r.ProgressLocation.Window,title:""},(e=>(this.progress=e,this.progressDeferred.promise)))}}},76546:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(69145),i=n(61702),o=n(63265),s=n(90819),a=n(52228),c=n(22430),l=n(72391),u=n(8335),p=n(32342);t.registerTypes=function(e){e.addSingleton(s.IExtensionActivationService,c.PartialModeStatusItem),e.add(s.IExtensionActivationManager,r.ExtensionActivationManager),e.addSingleton(s.ILanguageServerOutputChannel,o.LanguageServerOutputChannel),e.addSingleton(s.IExtensionSingleActivationService,i.ExtensionSurveyPrompt),e.addSingleton(s.IExtensionSingleActivationService,a.LoadLanguageServerExtension),e.addSingleton(l.ILanguageServerWatcher,u.LanguageServerWatcher),e.addBinding(l.ILanguageServerWatcher,s.IExtensionActivationService),e.addSingleton(p.LspNotebooksExperiment,p.LspNotebooksExperiment),e.addBinding(p.LspNotebooksExperiment,s.IExtensionSingleActivationService)}},90819:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.IExtensionSingleActivationService=t.ILanguageServerOutputChannel=t.ILanguageServerProxy=t.ILanguageServerManager=t.ILanguageServerAnalysisOptions=t.ILanguageClientFactory=t.ILanguageServerActivator=t.LanguageServerType=t.IExtensionActivationService=t.IExtensionActivationManager=void 0,t.IExtensionActivationManager=Symbol("IExtensionActivationManager"),t.IExtensionActivationService=Symbol("IExtensionActivationService"),(n=t.LanguageServerType||(t.LanguageServerType={})).Jedi="Jedi",n.JediLSP="JediLSP",n.Microsoft="Microsoft",n.Node="Pylance",n.None="None",t.ILanguageServerActivator=Symbol("ILanguageServerActivator"),t.ILanguageClientFactory=Symbol("ILanguageClientFactory"),t.ILanguageServerAnalysisOptions=Symbol("ILanguageServerAnalysisOptions"),t.ILanguageServerManager=Symbol("ILanguageServerManager"),t.ILanguageServerProxy=Symbol("ILanguageServerProxy"),t.ILanguageServerOutputChannel=Symbol("ILanguageServerOutputChannel"),t.IExtensionSingleActivationService=Symbol("IExtensionSingleActivationService")},10063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildApi=void 0;const r=n(52847),i=n(46888),o=n(90819),s=n(77570),a=n(61684),c=n(12187),l=n(18639),u=n(66259),p=n(19735),d=n(12304),h=n(54813);t.buildApi=function(e,t,n,f){const g=n.get(a.IConfigurationService),m=n.get(l.IInterpreterService);t.addSingleton(u.JupyterExtensionIntegration,u.JupyterExtensionIntegration);const v=n.get(u.JupyterExtensionIntegration),y=n.get(o.ILanguageServerOutputChannel),b={ready:e.catch((e=>((0,p.traceError)("Failure during activation.",e),Promise.reject(e)))),jupyter:{registerHooks:()=>v.integrateWithJupyterExtension()},debug:{getRemoteLauncherCommand:async(e,t,n=!0)=>(0,c.getDebugpyLauncherArgs)({host:e,port:t,waitUntilDebuggerAttaches:n}),getDebuggerPackagePath:async()=>(0,c.getDebugpyPackagePath)()},settings:{onDidChangeExecutionDetails:m.onDidChangeInterpreterConfiguration,getExecutionDetails(e){const{pythonPath:t}=g.getSettings(e);return{execCommand:""===t?void 0:[t]}}},pylance:{createClient:(...e)=>{var t;const n=e[1];return n.outputChannel=null!==(t=n.outputChannel)&&void 0!==t?t:y.channel,new r.LanguageClient(s.PYTHON_LANGUAGE,i.PYLANCE_NAME,e[0],n)},start:e=>e.start(),stop:e=>e.stop(),getTelemetryReporter:()=>(0,h.getTelemetryReporter)()},environments:(0,d.buildEnvironmentApi)(f,n)};return(0,s.isTestExecution)()&&(b.serviceContainer=n,b.serviceManager=t),b}},5899:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonExtension=t.PVSC_EXTENSION_ID=void 0;const r=n(66828);t.PVSC_EXTENSION_ID="ms-python.python",(t.PythonExtension||(t.PythonExtension={})).api=async function(){const e=r.extensions.getExtension(t.PVSC_EXTENSION_ID);if(void 0===e)throw new Error("Python extension is not installed or is disabled");return e.isActive||await e.activate(),e.exports}},19897:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationDiagnostics=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570),l=n(77498),u=n(19735),p=n(93971);async function d(e,t){await Promise.all(e.map((async e=>{const n=await e.diagnose(t);n.length>0&&(function(e){e.forEach((e=>{const t=`Diagnostic Code: ${e.code}, Message: ${e.message}`;switch(e.severity){case s.DiagnosticSeverity.Error:case s.DiagnosticSeverity.Warning:(0,u.traceLog)(t);break;default:(0,u.traceVerbose)(t)}}))}(n),await e.handle(n))})))}let h=class{constructor(e){this.serviceContainer=e}register(){this.serviceContainer.get(p.ISourceMapSupportService).register()}async performPreStartupHealthCheck(e){if((0,c.isTestExecution)())return;let t=this.serviceContainer.getAll(p.IDiagnosticsService);this.serviceContainer.get(a.IWorkspaceService).isTrusted||(t=t.filter((e=>e.runInUntrustedWorkspace))),await d(t.filter((e=>!e.runInBackground)),e),d(t.filter((e=>e.runInBackground)),e).ignoreErrors()}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IServiceContainer))],h),t.ApplicationDiagnostics=h},66674:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDiagnosticsService=t.BaseDiagnostic=void 0;const s=n(86700),a=n(17585),c=n(99910),l=n(54813),u=n(61522),p=n(93971);let d=class{constructor(e,t,n,r,i,o=!0,s="default"){this.code=e,this.message=t,this.severity=n,this.scope=r,this.resource=i,this.shouldShowPrompt=o,this.invokeHandler=s}};d=i([(0,s.injectable)()],d),t.BaseDiagnostic=d;let h=r=class{constructor(e,t,n,r=!1,i=!1){this.supportedDiagnosticCodes=e,this.serviceContainer=t,this.disposableRegistry=n,this.runInBackground=r,this.runInUntrustedWorkspace=i,this.filterService=t.get(p.IDiagnosticFilterService),n.push(this)}dispose(){}async handle(e){if(0===e.length)return;const t=await(0,c.asyncFilter)(e,(async e=>{if(!await this.canHandle(e))return!1;if(e.invokeHandler&&"always"===e.invokeHandler)return!0;const t=this.getDiagnosticsKey(e);return-1===r.handledDiagnosticCodeKeys.indexOf(t)&&(r.handledDiagnosticCodeKeys.push(t),!0)}));await this.onHandle(t)}async canHandle(e){return(0,l.sendTelemetryEvent)(u.EventName.DIAGNOSTICS_MESSAGE,void 0,{code:e.code}),this.supportedDiagnosticCodes.filter((t=>t===e.code)).length>0}getDiagnosticsKey(e){if(e.scope===p.DiagnosticScope.Global)return e.code;const t=this.serviceContainer.get(a.IWorkspaceService),n=e.resource?t.getWorkspaceFolder(e.resource):void 0;return`${e.code}dbe75733-0407-4124-a1b2-ca769dc30523${n?n.uri.fsPath:""}`}};h.handledDiagnosticCodeKeys=[],h=r=i([(0,s.injectable)(),o(0,(0,s.unmanaged)()),o(1,(0,s.unmanaged)()),o(2,(0,s.unmanaged)()),o(3,(0,s.unmanaged)()),o(4,(0,s.unmanaged)())],h),t.BaseDiagnosticsService=h},60474:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentPathVariableDiagnosticsService=t.EnvironmentPathVariableDiagnosticsServiceId=void 0;const o=n(86700),s=n(66828),a=n(17585);n(32727);const c=n(84974),l=n(61684),u=n(67098),p=n(77498),d=n(66674),h=n(16356),f=n(7587),g=n(51475),m=n(93971);class v extends d.BaseDiagnostic{constructor(e,t){super(f.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic,e,s.DiagnosticSeverity.Warning,m.DiagnosticScope.Global,t)}}t.EnvironmentPathVariableDiagnosticsServiceId="EnvironmentPathVariableDiagnosticsServiceId";let y=class extends d.BaseDiagnosticsService{constructor(e,t){super([f.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic],e,t,!0,!0),this.platform=this.serviceContainer.get(c.IPlatformService),this.messageService=e.get(m.IDiagnosticHandlerService,g.DiagnosticCommandPromptHandlerServiceId)}async diagnose(e){if(this.platform.isWindows&&this.doesPathVariableHaveInvalidEntries()){const t=this.serviceContainer.get(a.IApplicationEnvironment),n="The environment variable '{0}' seems to have some paths containing the '\"' character. The existence of such a character is known to have caused the {1} extension to not load. If the extension fails to load please modify your paths to remove this '\"' character.".format(this.platform.pathVariableName,t.extensionName);return[new v(n,e)]}return[]}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0];if(await this.filterService.shouldIgnoreDiagnostic(t.code))return;const n=this.serviceContainer.get(h.IDiagnosticsCommandFactory),r=[{prompt:u.Common.ignore},{prompt:u.Common.alwaysIgnore,command:n.createCommand(t,{type:"ignore",options:m.DiagnosticScope.Global})},{prompt:u.Common.moreInfo,command:n.createCommand(t,{type:"launch",options:"https://aka.ms/Niq35h"})}];await this.messageService.handle(t,{commandPrompts:r})}doesPathVariableHaveInvalidEntries(){const e=this.serviceContainer.get(l.ICurrentProcess).env[this.platform.pathVariableName],t=this.serviceContainer.get(l.IPathUtils).delimiter;return(e||"").split(t).filter((e=>e.indexOf('"')>=0)).length>0}};y=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer)),i(1,(0,o.inject)(l.IDisposableRegistry))],y),t.EnvironmentPathVariableDiagnosticsService=y},27351:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidLaunchJsonDebuggerService=t.InvalidLaunchJsonDebuggerServiceId=t.InvalidLaunchJsonDebuggerDiagnostic=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(17585);n(32727);const l=n(84974),u=n(61684),p=n(67098),d=n(77498),h=n(66674),f=n(7587),g=n(51475),m=n(93971),v={[f.DiagnosticCodes.InvalidDebuggerTypeDiagnostic]:p.Diagnostics.invalidDebuggerTypeDiagnostic,[f.DiagnosticCodes.JustMyCodeDiagnostic]:p.Diagnostics.justMyCodeDiagnostic,[f.DiagnosticCodes.ConsoleTypeDiagnostic]:p.Diagnostics.consoleTypeDiagnostic,[f.DiagnosticCodes.ConfigPythonPathDiagnostic]:""};class y extends h.BaseDiagnostic{constructor(e,t,n=!0){super(e,v[e],a.DiagnosticSeverity.Error,m.DiagnosticScope.WorkspaceFolder,t,n)}}t.InvalidLaunchJsonDebuggerDiagnostic=y,t.InvalidLaunchJsonDebuggerServiceId="InvalidLaunchJsonDebuggerServiceId";let b=class extends h.BaseDiagnosticsService{constructor(e,t,n,r,i){super([f.DiagnosticCodes.InvalidDebuggerTypeDiagnostic,f.DiagnosticCodes.JustMyCodeDiagnostic,f.DiagnosticCodes.ConsoleTypeDiagnostic,f.DiagnosticCodes.ConfigPythonPathDiagnostic],e,n,!0),this.fs=t,this.workspaceService=r,this.messageService=i}async diagnose(e){var t;if(!(((null===(t=this.workspaceService.workspaceFolders)||void 0===t?void 0:t.length)||0)>0))return[];const n=e?this.workspaceService.getWorkspaceFolder(e):this.workspaceService.workspaceFolders[0];return this.diagnoseWorkspace(n,e)}async onHandle(e){e.forEach((e=>this.handleDiagnostic(e)))}async fixLaunchJson(e){var t,n;((null===(t=this.workspaceService.workspaceFolders)||void 0===t?void 0:t.length)||0)>0&&await Promise.all((null!==(n=this.workspaceService.workspaceFolders)&&void 0!==n?n:[]).map((t=>this.fixLaunchJsonInWorkspace(e,t))))}async diagnoseWorkspace(e,t){const n=E(e);if(!await this.fs.fileExists(n))return[];const r=await this.fs.readFile(n),i=[];return r.indexOf('"pythonExperimental"')>0&&i.push(new y(f.DiagnosticCodes.InvalidDebuggerTypeDiagnostic,t)),r.indexOf('"debugStdLib"')>0&&i.push(new y(f.DiagnosticCodes.JustMyCodeDiagnostic,t)),r.indexOf('"console": "none"')>0&&i.push(new y(f.DiagnosticCodes.ConsoleTypeDiagnostic,t)),(r.indexOf('"pythonPath":')>0||r.indexOf("{config:python.pythonPath}")>0||r.indexOf("{config:python.interpreterPath}")>0)&&i.push(new y(f.DiagnosticCodes.ConfigPythonPathDiagnostic,t,!1)),i}async handleDiagnostic(e){if(!e.shouldShowPrompt)return void await this.fixLaunchJson(e.code);const t=[{prompt:p.Diagnostics.yesUpdateLaunch,command:{diagnostic:e,invoke:async()=>{await this.fixLaunchJson(e.code)}}},{prompt:p.Common.noIWillDoItLater}];await this.messageService.handle(e,{commandPrompts:t})}async fixLaunchJsonInWorkspace(e,t){if(0===(await this.diagnoseWorkspace(t,void 0)).length)return;const n=E(t);let r=await this.fs.readFile(n);switch(e){case f.DiagnosticCodes.InvalidDebuggerTypeDiagnostic:r=S(r,'"pythonExperimental"','"python"'),r=S(r,'"Python Experimental:','"Python:');break;case f.DiagnosticCodes.JustMyCodeDiagnostic:r=S(r,'"debugStdLib": false','"justMyCode": true'),r=S(r,'"debugStdLib": true','"justMyCode": false');break;case f.DiagnosticCodes.ConsoleTypeDiagnostic:r=S(r,'"console": "none"','"console": "internalConsole"');break;case f.DiagnosticCodes.ConfigPythonPathDiagnostic:r=S(r,'"pythonPath":','"python":'),r=S(r,"{config:python.pythonPath}","{command:python.interpreterPath}"),r=S(r,"{config:python.interpreterPath}","{command:python.interpreterPath}");break;default:return}await this.fs.writeFile(n,r)}};function S(e,t,n){const r=new RegExp(t,"g");return e.replace(r,n)}function E(e){return s.join(e.uri.fsPath,".vscode","launch.json")}b=r([(0,o.injectable)(),i(0,(0,o.inject)(d.IServiceContainer)),i(1,(0,o.inject)(l.IFileSystem)),i(2,(0,o.inject)(u.IDisposableRegistry)),i(3,(0,o.inject)(c.IWorkspaceService)),i(4,(0,o.inject)(m.IDiagnosticHandlerService)),i(4,(0,o.named)(g.DiagnosticCommandPromptHandlerServiceId))],b),t.InvalidLaunchJsonDebuggerService=b},42655:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidPythonPathInDebuggerService=t.InvalidPythonPathInDebuggerServiceId=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(17585);n(32727);const l=n(61684),u=n(67098),p=n(48683),d=n(41691),h=n(18639),f=n(77498),g=n(19735),m=n(66674),v=n(16356),y=n(7587),b=n(51475),S=n(93971),E={[y.DiagnosticCodes.InvalidPythonPathInDebuggerSettingsDiagnostic]:u.Diagnostics.invalidPythonPathInDebuggerSettings,[y.DiagnosticCodes.InvalidPythonPathInDebuggerLaunchDiagnostic]:u.Diagnostics.invalidPythonPathInDebuggerLaunch};class _ extends m.BaseDiagnostic{constructor(e,t){super(e,E[e],a.DiagnosticSeverity.Error,S.DiagnosticScope.WorkspaceFolder,t,void 0,"always")}}t.InvalidPythonPathInDebuggerServiceId="InvalidPythonPathInDebuggerServiceId";let w=class extends m.BaseDiagnosticsService{constructor(e,t,n,r,i,o,s,a){super([y.DiagnosticCodes.InvalidPythonPathInDebuggerSettingsDiagnostic,y.DiagnosticCodes.InvalidPythonPathInDebuggerLaunchDiagnostic],e,s,!0),this.workspace=t,this.commandFactory=n,this.interpreterHelper=r,this.documentManager=i,this.configService=o,this.messageService=a}async diagnose(){return[]}async validatePythonPath(e,t,n){return"${command:python.interpreterPath}"!==(e=e?this.resolveVariables(e,n):void 0)&&e||(e=this.configService.getSettings(n).pythonPath),!!await this.interpreterHelper.getInterpreterInformation(e).catch((()=>{}))||((0,g.traceError)(`Invalid Python Path '${e}'`),t===d.PythonPathSource.launchJson?this.handle([new _(y.DiagnosticCodes.InvalidPythonPathInDebuggerLaunchDiagnostic,n)]).catch((e=>(0,g.traceError)("Failed to handle invalid python path in launch.json debugger",e))).ignoreErrors():this.handle([new _(y.DiagnosticCodes.InvalidPythonPathInDebuggerSettingsDiagnostic,n)]).catch((e=>(0,g.traceError)("Failed to handle invalid python path in settings.json debugger",e))).ignoreErrors(),!1)}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0],n=this.getCommandPrompts(t);await this.messageService.handle(t,{commandPrompts:n})}resolveVariables(e,t){return new p.SystemVariables(t,void 0,this.workspace).resolveAny(e)}getCommandPrompts(e){switch(e.code){case y.DiagnosticCodes.InvalidPythonPathInDebuggerSettingsDiagnostic:return[{prompt:u.Common.selectPythonInterpreter,command:this.commandFactory.createCommand(e,{type:"executeVSCCommand",options:"python.setInterpreter"})}];case y.DiagnosticCodes.InvalidPythonPathInDebuggerLaunchDiagnostic:return[{prompt:u.Common.openLaunch,command:{diagnostic:e,invoke:async()=>{const e=(t=a.workspace.workspaceFolders[0],s.join(t.uri.fsPath,".vscode","launch.json"));var t;const n=await this.documentManager.openTextDocument(e);await this.documentManager.showTextDocument(n)}}}];default:throw new Error("Invalid diagnostic for 'InvalidPythonPathInDebuggerService'")}}};w=r([(0,o.injectable)(),i(0,(0,o.inject)(f.IServiceContainer)),i(1,(0,o.inject)(c.IWorkspaceService)),i(2,(0,o.inject)(v.IDiagnosticsCommandFactory)),i(3,(0,o.inject)(h.IInterpreterHelper)),i(4,(0,o.inject)(c.IDocumentManager)),i(5,(0,o.inject)(l.IConfigurationService)),i(6,(0,o.inject)(l.IDisposableRegistry)),i(7,(0,o.inject)(S.IDiagnosticHandlerService)),i(7,(0,o.named)(b.DiagnosticCommandPromptHandlerServiceId))],w),t.InvalidPythonPathInDebuggerService=w},94117:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.JediPython27NotSupportedDiagnosticService=t.JediPython27NotSupportedDiagnosticServiceId=t.JediPython27NotSupportedDiagnostic=void 0;const o=n(86700),s=n(66828),a=n(90819),c=n(17585),l=n(61684),u=n(67098),p=n(18639),d=n(77498),h=n(66674),f=n(16356),g=n(7587),m=n(51475),v=n(93971);class y extends h.BaseDiagnostic{constructor(e,t){super(g.DiagnosticCodes.JediPython27NotSupportedDiagnostic,e,s.DiagnosticSeverity.Warning,v.DiagnosticScope.Global,t)}}t.JediPython27NotSupportedDiagnostic=y,t.JediPython27NotSupportedDiagnosticServiceId="JediPython27NotSupportedDiagnosticServiceId";let b=class extends h.BaseDiagnosticsService{constructor(e,t,n,r,i,o){super([g.DiagnosticCodes.JediPython27NotSupportedDiagnostic],e,o,!0),this.interpreterService=t,this.workspaceService=n,this.configurationService=r,this.messageService=i}async diagnose(e){var t,n;const r=await this.interpreterService.getActiveInterpreter(e),{languageServer:i}=this.configurationService.getSettings(e);return await this.updateLanguageServerSetting(e),r&&(null!==(n=null===(t=r.version)||void 0===t?void 0:t.major)&&void 0!==n?n:0)<3&&i===a.LanguageServerType.Jedi?[new y(u.Python27Support.jediMessage,e)]:[]}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0];if(await this.filterService.shouldIgnoreDiagnostic(t.code))return;const n=this.serviceContainer.get(f.IDiagnosticsCommandFactory),r=[{prompt:u.Common.gotIt},{prompt:u.Common.doNotShowAgain,command:n.createCommand(t,{type:"ignore",options:v.DiagnosticScope.Global})}];await this.messageService.handle(t,{commandPrompts:r})}async updateLanguageServerSetting(e){const t=this.workspaceService.getConfiguration("python",e).inspect("languageServer");let n;if((null==t?void 0:t.workspaceValue)===a.LanguageServerType.JediLSP)n=s.ConfigurationTarget.Workspace;else{if((null==t?void 0:t.globalValue)!==a.LanguageServerType.JediLSP)return;n=s.ConfigurationTarget.Global}await this.configurationService.updateSetting("languageServer",a.LanguageServerType.Jedi,e,n)}};b=r([i(0,(0,o.inject)(d.IServiceContainer)),i(1,(0,o.inject)(p.IInterpreterService)),i(2,(0,o.inject)(c.IWorkspaceService)),i(3,(0,o.inject)(l.IConfigurationService)),i(4,(0,o.inject)(v.IDiagnosticHandlerService)),i(4,(0,o.named)(m.DiagnosticCommandPromptHandlerServiceId)),i(5,(0,o.inject)(l.IDisposableRegistry))],b),t.JediPython27NotSupportedDiagnosticService=b},21513:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidMacPythonInterpreterService=t.InvalidMacPythonInterpreterServiceId=t.InvalidMacPythonInterpreterDiagnostic=void 0;const o=n(86700),s=n(66828);n(32727);const a=n(84974),c=n(61684),l=n(18639),u=n(77498),p=n(66674),d=n(16356),h=n(7587),f=n(51475),g=n(93971),m=n(67098),v={[h.DiagnosticCodes.MacInterpreterSelected]:s.l10n.t("The selected macOS system install of Python is not recommended, some functionality in the extension will be limited. [Install another version of Python](https://www.python.org/downloads) or select a different interpreter for the best experience. [Learn more](https://aka.ms/AA7jfor).")};class y extends p.BaseDiagnostic{constructor(e,t){super(e,v[e],s.DiagnosticSeverity.Error,g.DiagnosticScope.WorkspaceFolder,t)}}t.InvalidMacPythonInterpreterDiagnostic=y,t.InvalidMacPythonInterpreterServiceId="InvalidMacPythonInterpreterServiceId";let b=class extends p.BaseDiagnosticsService{constructor(e,t,n,r){super([h.DiagnosticCodes.MacInterpreterSelected],e,t,!0),this.platform=n,this.helper=r,this.changeThrottleTimeout=1e3,this.addPythonPathChangedHandler()}dispose(){this.timeOut&&"number"!=typeof this.timeOut&&(clearTimeout(this.timeOut),this.timeOut=void 0)}async diagnose(e){if(!this.platform.isMac)return[];const t=this.serviceContainer.get(c.IConfigurationService).getSettings(e);return await this.helper.isMacDefaultPythonPath(t.pythonPath)?[new y(h.DiagnosticCodes.MacInterpreterSelected,e)]:[]}async onHandle(e){if(0===e.length)return;const t=this.serviceContainer.get(g.IDiagnosticHandlerService,f.DiagnosticCommandPromptHandlerServiceId);await Promise.all(e.map((async e=>{const n=await this.canHandle(e),r=await this.filterService.shouldIgnoreDiagnostic(e.code);if(!n||r)return;const i=this.getCommandPrompts(e);await t.handle(e,{commandPrompts:i,message:e.message})})))}addPythonPathChangedHandler(){const e=this.serviceContainer.get(c.IDisposableRegistry),t=this.serviceContainer.get(c.IInterpreterPathService);e.push(t.onDidChange((e=>this.onDidChangeConfiguration(e))))}async onDidChangeConfiguration(e){const t=e.uri;this.timeOut&&"number"!=typeof this.timeOut&&(clearTimeout(this.timeOut),this.timeOut=void 0),this.timeOut=setTimeout((()=>{this.timeOut=void 0,this.diagnose(t).then((e=>this.handle(e))).ignoreErrors()}),this.changeThrottleTimeout)}getCommandPrompts(e){const t=this.serviceContainer.get(d.IDiagnosticsCommandFactory);if(e.code===h.DiagnosticCodes.MacInterpreterSelected)return[{prompt:m.Common.selectPythonInterpreter,command:t.createCommand(e,{type:"executeVSCCommand",options:"python.setInterpreter"})},{prompt:m.Common.doNotShowAgain,command:t.createCommand(e,{type:"ignore",options:g.DiagnosticScope.Global})}];throw new Error("Invalid diagnostic for 'InvalidMacPythonInterpreterService'")}};b=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IServiceContainer)),i(1,(0,o.inject)(c.IDisposableRegistry)),i(2,(0,o.inject)(a.IPlatformService)),i(3,(0,o.inject)(l.IInterpreterHelper))],b),t.InvalidMacPythonInterpreterService=b},54205:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PowerShellActivationHackDiagnosticsService=t.PowerShellActivationHackDiagnosticsServiceId=t.PowershellActivationNotAvailableDiagnostic=void 0;const o=n(86700),s=n(66828);n(32727);const a=n(87688),c=n(61684),l=n(67098),u=n(77498),p=n(19735),d=n(54813),h=n(61522),f=n(66674),g=n(16356),m=n(7587),v=n(51475),y=n(93971),b=s.l10n.t("Activation of the selected Python environment is not supported in PowerShell. Consider changing your shell to Command Prompt.");class S extends f.BaseDiagnostic{constructor(e){super(m.DiagnosticCodes.EnvironmentActivationInPowerShellWithBatchFilesNotSupportedDiagnostic,b,s.DiagnosticSeverity.Warning,y.DiagnosticScope.Global,e,void 0,"always")}}t.PowershellActivationNotAvailableDiagnostic=S,t.PowerShellActivationHackDiagnosticsServiceId="EnvironmentActivationInPowerShellWithBatchFilesNotSupportedDiagnostic";let E=class extends f.BaseDiagnosticsService{constructor(e,t){super([m.DiagnosticCodes.EnvironmentActivationInPowerShellWithBatchFilesNotSupportedDiagnostic],e,t,!0),this.messageService=e.get(y.IDiagnosticHandlerService,v.DiagnosticCommandPromptHandlerServiceId)}async diagnose(){return[]}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0];if(await this.filterService.shouldIgnoreDiagnostic(t.code))return;const n=this.serviceContainer.get(g.IDiagnosticsCommandFactory),r=this.serviceContainer.get(c.ICurrentProcess),i=this.serviceContainer.get(c.IConfigurationService),o=[{prompt:l.Common.useCommandPrompt,command:{diagnostic:t,invoke:async()=>{(0,d.sendTelemetryEvent)(h.EventName.DIAGNOSTICS_ACTION,void 0,{action:"switchToCommandPrompt"}),(0,a.useCommandPromptAsDefaultShell)(r,i).catch((e=>(0,p.traceError)("Use Command Prompt as default shell",e)))}}},{prompt:l.Common.ignore},{prompt:l.Common.alwaysIgnore,command:n.createCommand(t,{type:"ignore",options:y.DiagnosticScope.Global})},{prompt:l.Common.moreInfo,command:n.createCommand(t,{type:"launch",options:"https://aka.ms/CondaPwsh"})}];await this.messageService.handle(t,{commandPrompts:o})}};E=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IServiceContainer)),i(1,(0,o.inject)(c.IDisposableRegistry))],E),t.PowerShellActivationHackDiagnosticsService=E},9798:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PylanceDefaultDiagnosticService=t.PylanceDefaultDiagnosticServiceId=t.PylanceDefaultDiagnostic=t.PYLANCE_PROMPT_MEMENTO=void 0;const o=n(86700),s=n(66828),a=n(61684),c=n(67098),l=n(77498),u=n(66674),p=n(7587),d=n(51475),h=n(93971);t.PYLANCE_PROMPT_MEMENTO="pylanceDefaultPromptMemento";class f extends u.BaseDiagnostic{constructor(e,t){super(p.DiagnosticCodes.PylanceDefaultDiagnostic,e,s.DiagnosticSeverity.Information,h.DiagnosticScope.Global,t)}}t.PylanceDefaultDiagnostic=f,t.PylanceDefaultDiagnosticServiceId="PylanceDefaultDiagnosticServiceId";let g=class extends u.BaseDiagnosticsService{constructor(e,t,n,r){super([p.DiagnosticCodes.PylanceDefaultDiagnostic],e,r,!0,!0),this.context=t,this.messageService=n,this.initialMementoValue=void 0,this.initialMementoValue=this.context.globalState.get("extensionVersion")}async diagnose(e){return await this.shouldShowPrompt()?[new f(c.Diagnostics.pylanceDefaultMessage,e)]:[]}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0];if(await this.filterService.shouldIgnoreDiagnostic(t.code))return;const n=[{prompt:c.Common.ok}];await this.messageService.handle(t,{commandPrompts:n,onClose:this.updateMemento.bind(this)})}async updateMemento(){await this.context.globalState.update(t.PYLANCE_PROMPT_MEMENTO,!0)}async shouldShowPrompt(){const e=this.initialMementoValue,n=this.context.globalState.get(t.PYLANCE_PROMPT_MEMENTO);return void 0===e?(await this.updateMemento(),!1):void 0===n}};g=r([i(0,(0,o.inject)(l.IServiceContainer)),i(1,(0,o.inject)(a.IExtensionContext)),i(2,(0,o.inject)(h.IDiagnosticHandlerService)),i(2,(0,o.named)(d.DiagnosticCommandPromptHandlerServiceId)),i(3,(0,o.inject)(a.IDisposableRegistry))],g),t.PylanceDefaultDiagnosticService=g},81613:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidPythonInterpreterService=t.InvalidPythonInterpreterServiceId=t.DefaultShellDiagnostic=t.InvalidPythonInterpreterDiagnostic=void 0;const o=n(86700),s=n(66828);n(32727);const a=n(71017),c=n(61684),l=n(18639),u=n(77498),p=n(66674),d=n(16356),h=n(7587),f=n(51475),g=n(93971),m=n(67098),v=n(77570),y=n(17585),b=n(54813),S=n(61522),E=n(36952),_=n(3481),w=n(87450),T=n(84974),C=n(19735),P=n(31776),I=n(47237),x=n(29983),O=n(48431),R={[h.DiagnosticCodes.NoPythonInterpretersDiagnostic]:s.l10n.t("No Python interpreter is selected. Please select a Python interpreter to enable features such as IntelliSense, linting, and debugging."),[h.DiagnosticCodes.InvalidPythonInterpreterDiagnostic]:s.l10n.t("An Invalid Python interpreter is selected{0}, please try changing it to enable features such as IntelliSense, linting, and debugging. See output for more details regarding why the interpreter is invalid."),[h.DiagnosticCodes.InvalidComspecDiagnostic]:s.l10n.t('We detected an issue with one of your environment variables that breaks features such as IntelliSense, linting and debugging. Try setting the "ComSpec" variable to a valid Command Prompt path in your system to fix it.'),[h.DiagnosticCodes.IncompletePathVarDiagnostic]:s.l10n.t('We detected an issue with "Path" environment variable that breaks features such as IntelliSense, linting and debugging. Please edit it to make sure it contains the "System32" subdirectories.'),[h.DiagnosticCodes.DefaultShellErrorDiagnostic]:s.l10n.t('We detected an issue with your default shell that breaks features such as IntelliSense, linting and debugging. Try resetting "ComSpec" and "Path" environment variables to fix it.')};class D extends p.BaseDiagnostic{constructor(e,t,n,r=g.DiagnosticScope.WorkspaceFolder){var i;let o="";if(n.workspaceFile&&n.workspaceFolders&&(null===(i=n.workspaceFolders)||void 0===i?void 0:i.length)>1){const e=n.getWorkspaceFolder(t);e&&(o=` ${s.l10n.t("for workspace")} ${a.basename(e.uri.fsPath)}`)}super(e,R[e].format(o),s.DiagnosticSeverity.Error,r,t,void 0,"always")}}t.InvalidPythonInterpreterDiagnostic=D;class A extends p.BaseDiagnostic{constructor(e,t,n=g.DiagnosticScope.Global){super(e,R[e],s.DiagnosticSeverity.Error,n,t,void 0,"always")}}t.DefaultShellDiagnostic=A,t.InvalidPythonInterpreterServiceId="InvalidPythonInterpreterServiceId";let k=class extends p.BaseDiagnosticsService{constructor(e,t){super([h.DiagnosticCodes.NoPythonInterpretersDiagnostic,h.DiagnosticCodes.InvalidPythonInterpreterDiagnostic,h.DiagnosticCodes.InvalidComspecDiagnostic,h.DiagnosticCodes.IncompletePathVarDiagnostic,h.DiagnosticCodes.DefaultShellErrorDiagnostic],e,t,!1),this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(){const e=this.serviceContainer.get(y.ICommandManager);this.disposableRegistry.push(e.registerCommand(v.Commands.TriggerEnvironmentSelection,(e=>this.triggerEnvSelectionIfNecessary(e))));const t=this.serviceContainer.get(l.IInterpreterService);this.disposableRegistry.push(t.onDidChangeInterpreterConfiguration((t=>e.executeCommand(v.Commands.TriggerEnvironmentSelection,t).then(_.noop,_.noop))))}async diagnose(e){return this.diagnoseDefaultShell(e)}async _manualDiagnose(e){const t=this.serviceContainer.get(y.IWorkspaceService),n=this.serviceContainer.get(l.IInterpreterService),r=await this.diagnoseDefaultShell(e);if(r.length>0)return r;const i=await n.hasInterpreters(),o="python"===this.serviceContainer.get(c.IInterpreterPathService).get(e);return!i&&o?[new D(h.DiagnosticCodes.NoPythonInterpretersDiagnostic,e,t,g.DiagnosticScope.Global)]:await n.getActiveInterpreter(e)?[]:[new D(h.DiagnosticCodes.InvalidPythonInterpreterDiagnostic,e,t)]}async triggerEnvSelectionIfNecessary(e){const t=await this._manualDiagnose(e);return!t.length||(this.handle(t).ignoreErrors(),!1)}async diagnoseDefaultShell(e){if((0,w.getOSType)()!==w.OSType.Windows)return[];const t=this.serviceContainer.get(l.IInterpreterService);if(await t.getActiveInterpreter(e))return[];try{await this.shellExecPython()}catch(t){if(-4058===t.errno)return(0,C.traceError)("ComSpec is likely set to an invalid value",(0,w.getEnvironmentVariable)("ComSpec")),await this.isComspecInvalid()?[new A(h.DiagnosticCodes.InvalidComspecDiagnostic,e)]:this.isPathVarIncomplete()?((0,C.traceError)("PATH env var appears to be incomplete",process.env.Path,process.env.PATH),[new A(h.DiagnosticCodes.IncompletePathVarDiagnostic,e)]):[new A(h.DiagnosticCodes.DefaultShellErrorDiagnostic,e)]}return[]}async isComspecInvalid(){var e;const t=null!==(e=(0,w.getEnvironmentVariable)("ComSpec"))&&void 0!==e?e:"";return this.serviceContainer.get(T.IFileSystem).fileExists(t).then((e=>!e))}isPathVarIncomplete(){var e;const t=(0,I.getSearchPathEnvVarNames)(),n=null!==(e=(0,w.getEnvironmentVariable)("SystemRoot"))&&void 0!==e?e:"C:\\WINDOWS",r=a.join(n,"system32");for(const e of t){const t=(0,w.getEnvironmentVariable)(e);if(t&&(0,O.normCasePath)(t).includes((0,O.normCasePath)(r)))return!1}return!0}async shellExecPython(){const e=this.serviceContainer.get(c.IConfigurationService),{pythonPath:t}=e.getSettings(),[n]=(0,P.getExecutable)(),r=[t,...n].reduce(((e,t)=>e?`${e} ${t.toCommandArgumentForPythonExt()}`:`${t.toCommandArgumentForPythonExt()}`),""),i=this.serviceContainer.get(x.IProcessServiceFactory);return(await i.create()).shellExec(r,{timeout:15e3})}async onHandle(e){if(0===e.length)return;const t=this.serviceContainer.get(g.IDiagnosticHandlerService,f.DiagnosticCommandPromptHandlerServiceId);await Promise.all(e.map((async e=>{if(!this.canHandle(e))return;const n=this.getCommandPrompts(e),r=function(e){if(e.code===h.DiagnosticCodes.NoPythonInterpretersDiagnostic)return e=>{(0,b.sendTelemetryEvent)(S.EventName.PYTHON_NOT_INSTALLED_PROMPT,void 0,{selection:e?"Download":"Ignore"})}}(e);await t.handle(e,{commandPrompts:n,message:e.message,onClose:r})})))}getCommandPrompts(e){const t=this.serviceContainer.get(d.IDiagnosticsCommandFactory);if(e.code===h.DiagnosticCodes.InvalidComspecDiagnostic||e.code===h.DiagnosticCodes.IncompletePathVarDiagnostic||e.code===h.DiagnosticCodes.DefaultShellErrorDiagnostic){const n={InvalidComspecDiagnostic:"https://aka.ms/AAk3djo",IncompletePathVarDiagnostic:"https://aka.ms/AAk744c",DefaultShellErrorDiagnostic:"https://aka.ms/AAk7qix"};return[{prompt:m.Common.seeInstructions,command:t.createCommand(e,{type:"launch",options:n[e.code]})}]}const n=[{prompt:m.Common.selectPythonInterpreter,command:t.createCommand(e,{type:"executeVSCCommand",options:v.Commands.Set_Interpreter})}];return e.code===h.DiagnosticCodes.InvalidPythonInterpreterDiagnostic&&n.push({prompt:m.Common.openOutputPanel,command:t.createCommand(e,{type:"executeVSCCommand",options:v.Commands.ViewOutput})}),n}};r([(0,E.cache)(-1,!0)],k.prototype,"shellExecPython",null),r([(0,E.cache)(1e3,!0)],k.prototype,"onHandle",null),k=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IServiceContainer)),i(1,(0,o.inject)(c.IDisposableRegistry))],k),t.InvalidPythonInterpreterService=k},49264:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchToDefaultLanguageServerDiagnosticService=t.SwitchToDefaultLanguageServerDiagnosticServiceId=t.SwitchToDefaultLanguageServerDiagnostic=void 0;const o=n(86700),s=n(66828),a=n(90819),c=n(17585),l=n(61684),u=n(67098),p=n(77498),d=n(66674),h=n(7587),f=n(51475),g=n(93971);class m extends d.BaseDiagnostic{constructor(e,t){super(h.DiagnosticCodes.SwitchToDefaultLanguageServerDiagnostic,e,s.DiagnosticSeverity.Warning,g.DiagnosticScope.Global,t)}}t.SwitchToDefaultLanguageServerDiagnostic=m,t.SwitchToDefaultLanguageServerDiagnosticServiceId="SwitchToDefaultLanguageServerDiagnosticServiceId";let v=class extends d.BaseDiagnosticsService{constructor(e,t,n,r){super([h.DiagnosticCodes.JediPython27NotSupportedDiagnostic],e,r,!0,!0),this.workspaceService=t,this.messageService=n}diagnose(e){let t=!1;const n=this.workspaceService.getConfiguration("python"),r=n.inspect("languageServer");return(null==r?void 0:r.workspaceValue)===a.LanguageServerType.Microsoft&&(n.update("languageServer","Default",s.ConfigurationTarget.Workspace),t=!0),(null==r?void 0:r.globalValue)===a.LanguageServerType.Microsoft&&(n.update("languageServer","Default",s.ConfigurationTarget.Global),t=!0),Promise.resolve(t?[new m(u.SwitchToDefaultLS.bannerMessage,e)]:[])}async onHandle(e){if(0===e.length||!this.canHandle(e[0]))return;const t=e[0];await this.filterService.shouldIgnoreDiagnostic(t.code)||await this.messageService.handle(t,{commandPrompts:[{prompt:u.Common.gotIt}]})}};v=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer)),i(1,(0,o.inject)(c.IWorkspaceService)),i(2,(0,o.inject)(g.IDiagnosticHandlerService)),i(2,(0,o.named)(f.DiagnosticCommandPromptHandlerServiceId)),i(3,(0,o.inject)(l.IDisposableRegistry))],v),t.SwitchToDefaultLanguageServerDiagnosticService=v},69686:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDiagnosticCommand=void 0,t.BaseDiagnosticCommand=class{constructor(e){this.diagnostic=e}}},2852:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteVSCCommand=void 0;const r=n(17585),i=n(54813),o=n(61522),s=n(69686);class a extends s.BaseDiagnosticCommand{constructor(e,t,n){super(e),this.serviceContainer=t,this.commandName=n}async invoke(){return(0,i.sendTelemetryEvent)(o.EventName.DIAGNOSTICS_ACTION,void 0,{commandName:this.commandName}),this.serviceContainer.get(r.ICommandManager).executeCommand(this.commandName).then((()=>{}))}}t.ExecuteVSCCommand=a},23185:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticsCommandFactory=void 0;const o=n(86700),s=n(77498),a=n(2852),c=n(28634),l=n(33690);let u=class{constructor(e){this.serviceContainer=e}createCommand(e,t){const n=t.type;switch(t.type){case"ignore":return new c.IgnoreDiagnosticCommand(e,this.serviceContainer,t.options);case"launch":return new l.LaunchBrowserCommand(e,this.serviceContainer,t.options);case"executeVSCCommand":return new a.ExecuteVSCCommand(e,this.serviceContainer,t.options);default:throw new Error(`Unknown Diagnostic command commandType '${n}'`)}}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IServiceContainer))],u),t.DiagnosticsCommandFactory=u},28634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IgnoreDiagnosticCommand=void 0;const r=n(54813),i=n(61522),o=n(93971),s=n(69686);class a extends s.BaseDiagnosticCommand{constructor(e,t,n){super(e),this.serviceContainer=t,this.scope=n}invoke(){return(0,r.sendTelemetryEvent)(i.EventName.DIAGNOSTICS_ACTION,void 0,{ignoreCode:this.diagnostic.code}),this.serviceContainer.get(o.IDiagnosticFilterService).ignoreDiagnostic(this.diagnostic.code,this.scope)}}t.IgnoreDiagnosticCommand=a},33690:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchBrowserCommand=void 0;const r=n(61684),i=n(54813),o=n(61522),s=n(69686);class a extends s.BaseDiagnosticCommand{constructor(e,t,n){super(e),this.serviceContainer=t,this.url=n}async invoke(){return(0,i.sendTelemetryEvent)(o.EventName.DIAGNOSTICS_ACTION,void 0,{url:this.url}),this.serviceContainer.get(r.IBrowserService).launch(this.url)}}t.LaunchBrowserCommand=a},16356:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDiagnosticsCommandFactory=void 0,t.IDiagnosticsCommandFactory=Symbol("IDiagnosticsCommandFactory")},7587:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticCodes=void 0,(n=t.DiagnosticCodes||(t.DiagnosticCodes={})).InvalidEnvironmentPathVariableDiagnostic="InvalidEnvironmentPathVariableDiagnostic",n.InvalidDebuggerTypeDiagnostic="InvalidDebuggerTypeDiagnostic",n.NoPythonInterpretersDiagnostic="NoPythonInterpretersDiagnostic",n.MacInterpreterSelected="MacInterpreterSelected",n.InvalidPythonPathInDebuggerSettingsDiagnostic="InvalidPythonPathInDebuggerSettingsDiagnostic",n.InvalidPythonPathInDebuggerLaunchDiagnostic="InvalidPythonPathInDebuggerLaunchDiagnostic",n.EnvironmentActivationInPowerShellWithBatchFilesNotSupportedDiagnostic="EnvironmentActivationInPowerShellWithBatchFilesNotSupportedDiagnostic",n.InvalidPythonInterpreterDiagnostic="InvalidPythonInterpreterDiagnostic",n.InvalidComspecDiagnostic="InvalidComspecDiagnostic",n.IncompletePathVarDiagnostic="IncompletePathVarDiagnostic",n.DefaultShellErrorDiagnostic="DefaultShellErrorDiagnostic",n.LSNotSupportedDiagnostic="LSNotSupportedDiagnostic",n.PythonPathDeprecatedDiagnostic="PythonPathDeprecatedDiagnostic",n.JustMyCodeDiagnostic="JustMyCodeDiagnostic",n.ConsoleTypeDiagnostic="ConsoleTypeDiagnostic",n.ConfigPythonPathDiagnostic="ConfigPythonPathDiagnostic",n.PylanceDefaultDiagnostic="PylanceDefaultDiagnostic",n.JediPython27NotSupportedDiagnostic="JediPython27NotSupportedDiagnostic",n.SwitchToDefaultLanguageServerDiagnostic="SwitchToDefaultLanguageServerDiagnostic",n.SwitchToPreReleaseExtensionDiagnostic="SwitchToPreReleaseExtensionDiagnostic"},70263:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticFilterService=t.FilterKeys=void 0;const o=n(86700),s=n(61684),a=n(77498),c=n(93971);var l;!function(e){e.GlobalDiagnosticFilter="GLOBAL_DIAGNOSTICS_FILTER",e.WorkspaceDiagnosticFilter="WORKSPACE_DIAGNOSTICS_FILTER"}(l=t.FilterKeys||(t.FilterKeys={}));let u=class{constructor(e){this.serviceContainer=e}async shouldIgnoreDiagnostic(e){const t=this.serviceContainer.get(s.IPersistentStateFactory),n=t.createGlobalPersistentState(l.GlobalDiagnosticFilter,[]),r=t.createWorkspacePersistentState(l.WorkspaceDiagnosticFilter,[]);return n.value.indexOf(e)>=0||r.value.indexOf(e)>=0}async ignoreDiagnostic(e,t){const n=this.serviceContainer.get(s.IPersistentStateFactory),r=t===c.DiagnosticScope.Global?n.createGlobalPersistentState(l.GlobalDiagnosticFilter,[]):n.createWorkspacePersistentState(l.WorkspaceDiagnosticFilter,[]),i=r.value.slice();await r.updateValue(i.concat(e))}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],u),t.DiagnosticFilterService=u},51475:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticCommandPromptHandlerService=t.DiagnosticCommandPromptHandlerServiceId=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77498);t.DiagnosticCommandPromptHandlerServiceId="DiagnosticCommandPromptHandlerServiceId";let l=class{constructor(e){this.appShell=e.get(a.IApplicationShell)}async handle(e,t={commandPrompts:[]}){const n=t.commandPrompts.map((e=>e.prompt)),r=await this.displayMessage(t.message?t.message:e.message,e.severity,n);if(t.onClose&&t.onClose(r),!r)return;const i=t.commandPrompts.find((e=>e.prompt===r));i&&i.command&&await i.command.invoke()}async displayMessage(e,t,n){switch(t){case s.DiagnosticSeverity.Error:return this.appShell.showErrorMessage(e,...n);case s.DiagnosticSeverity.Warning:return this.appShell.showWarningMessage(e,...n);default:return this.appShell.showInformationMessage(e,...n)}}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],l),t.DiagnosticCommandPromptHandlerService=l},47066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(77651),o=n(19897),s=n(60474),a=n(27351),c=n(42655),l=n(94117),u=n(21513),p=n(54205),d=n(9798),h=n(81613),f=n(49264),g=n(23185),m=n(16356),v=n(70263),y=n(51475),b=n(93971);t.registerTypes=function(e){e.addSingleton(b.IDiagnosticFilterService,v.DiagnosticFilterService),e.addSingleton(b.IDiagnosticHandlerService,y.DiagnosticCommandPromptHandlerService,y.DiagnosticCommandPromptHandlerServiceId),e.addSingleton(b.IDiagnosticsService,s.EnvironmentPathVariableDiagnosticsService,s.EnvironmentPathVariableDiagnosticsServiceId),e.addSingleton(b.IDiagnosticsService,a.InvalidLaunchJsonDebuggerService,a.InvalidLaunchJsonDebuggerServiceId),e.addSingleton(b.IDiagnosticsService,h.InvalidPythonInterpreterService,h.InvalidPythonInterpreterServiceId),e.addSingleton(r.IExtensionSingleActivationService,h.InvalidPythonInterpreterService),e.addSingleton(b.IDiagnosticsService,c.InvalidPythonPathInDebuggerService,c.InvalidPythonPathInDebuggerServiceId),e.addSingleton(b.IDiagnosticsService,p.PowerShellActivationHackDiagnosticsService,p.PowerShellActivationHackDiagnosticsServiceId),e.addSingleton(b.IDiagnosticsService,u.InvalidMacPythonInterpreterService,u.InvalidMacPythonInterpreterServiceId),e.addSingleton(b.IDiagnosticsService,d.PylanceDefaultDiagnosticService,d.PylanceDefaultDiagnosticServiceId),e.addSingleton(b.IDiagnosticsService,l.JediPython27NotSupportedDiagnosticService,l.JediPython27NotSupportedDiagnosticServiceId),e.addSingleton(b.IDiagnosticsService,f.SwitchToDefaultLanguageServerDiagnosticService,f.SwitchToDefaultLanguageServerDiagnosticServiceId),e.addSingleton(m.IDiagnosticsCommandFactory,g.DiagnosticsCommandFactory),e.addSingleton(i.IApplicationDiagnostics,o.ApplicationDiagnostics)}},62867:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceMapSupportService=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570),l=n(61684),u=n(67098);let p=class{constructor(e,t,n,r){this.commandManager=e,this.disposables=t,this.configurationService=n,this.shell=r}register(){this.disposables.push(this.commandManager.registerCommand(c.Commands.Enable_SourceMap_Support,this.onEnable,this))}async enable(){await this.configurationService.updateSetting("diagnostics.sourceMapsEnabled",!0,void 0,s.ConfigurationTarget.Global),await this.commandManager.executeCommand("workbench.action.reloadWindow")}async onEnable(){const e=u.Diagnostics.enableSourceMapsAndReloadVSC;await this.shell.showWarningMessage(u.Diagnostics.warnBeforeEnablingSourceMaps,e)===e&&await this.enable()}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ICommandManager)),i(1,(0,o.inject)(l.IDisposableRegistry)),i(2,(0,o.inject)(l.IConfigurationService)),i(3,(0,o.inject)(a.IApplicationShell))],p),t.SourceMapSupportService=p},93971:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ISourceMapSupportService=t.IInvalidPythonPathInDebuggerService=t.IInvalidPythonPathInSettings=t.IDiagnosticHandlerService=t.IDiagnosticFilterService=t.IDiagnosticsService=t.DiagnosticScope=void 0,(n=t.DiagnosticScope||(t.DiagnosticScope={})).Global="Global",n.WorkspaceFolder="WorkspaceFolder",t.IDiagnosticsService=Symbol("IDiagnosticsService"),t.IDiagnosticFilterService=Symbol("IDiagnosticFilterService"),t.IDiagnosticHandlerService=Symbol("IDiagnosticHandlerService"),t.IInvalidPythonPathInSettings=Symbol("IInvalidPythonPathInSettings"),t.IInvalidPythonPathInDebuggerService=Symbol("IInvalidPythonPathInDebuggerService"),t.ISourceMapSupportService=Symbol("ISourceMapSupportService")},30086:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(47066),i=n(62867),o=n(93971);t.registerTypes=function(e){e.addSingleton(o.ISourceMapSupportService,i.SourceMapSupportService),(0,r.registerTypes)(e)}},77651:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IApplicationDiagnostics=void 0,t.IApplicationDiagnostics=Symbol("IApplicationDiagnostics")},41659:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Common=t.LanguageService=void 0;const r=n(66828);(t.LanguageService||(t.LanguageService={})).statusItem={name:r.l10n.t("Python IntelliSense Status"),text:r.l10n.t("Partial Mode"),detail:r.l10n.t("Limited IntelliSense provided by Pylance")},(t.Common||(t.Common={})).learnMore=r.l10n.t("Learn more")},17792:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveResourceService=void 0;const o=n(86700),s=n(17585);let a=class{constructor(e,t){this.documentManager=e,this.workspaceService=t}getActiveResource(){const e=this.documentManager.activeTextEditor;return e&&!e.document.isUntitled?e.document.uri:Array.isArray(this.workspaceService.workspaceFolders)&&this.workspaceService.workspaceFolders.length>0?this.workspaceService.workspaceFolders[0].uri:void 0}};a=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IDocumentManager)),i(1,(0,o.inject)(s.IWorkspaceService))],a),t.ActiveResourceService=a},18718:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationEnvironment=void 0;const o=n(86700),s=n(71017),a=n(81249),c=n(66828),l=n(19735),u=n(84974),p=n(61684),d=n(87450);let h=class{constructor(e,t,n){this.platform=e,this.pathUtils=t,this.process=n}get userSettingsFile(){const e="insiders"===this.channel?"Code - Insiders":"Code";switch(this.platform.osType){case d.OSType.OSX:return s.join(this.pathUtils.home,"Library","Application Support",e,"User","settings.json");case d.OSType.Linux:return s.join(this.pathUtils.home,".config",e,"User","settings.json");case d.OSType.Windows:return this.process.env.APPDATA?s.join(this.process.env.APPDATA,e,"User","settings.json"):void 0;default:return}}get appName(){return c.env.appName}get vscodeVersion(){return c.version}get appRoot(){return c.env.appRoot}get uiKind(){return c.env.uiKind}get language(){return c.env.language}get sessionId(){return c.env.sessionId}get machineId(){return c.env.machineId}get remoteName(){return c.env.remoteName}get extensionName(){return this.packageJson.displayName}get shell(){return c.env.shell}get onDidChangeShell(){try{return c.env.onDidChangeShell}catch(e){return(0,l.traceError)("Failed to get onDidChangeShell API",e),(new c.EventEmitter).event}}get packageJson(){return n(4147)}get channel(){return this.appName.indexOf("Insider")>0?"insiders":"stable"}get extensionChannel(){const e=(0,a.parse)(this.packageJson.version);return!e||e.prerelease.length>0||e.minor%2==1?"insiders":"stable"}get uriScheme(){return c.env.uriScheme}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IPlatformService)),i(1,(0,o.inject)(p.IPathUtils)),i(2,(0,o.inject)(p.ICurrentProcess))],h),t.ApplicationEnvironment=h},13706:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationShell=void 0;const i=n(86700),o=n(66828);let s=class{get onDidChangeWindowState(){return o.window.onDidChangeWindowState}showInformationMessage(e,t,...n){return o.window.showInformationMessage(e,t,...n)}showWarningMessage(e,t,...n){return o.window.showWarningMessage(e,t,...n)}showErrorMessage(e,t,...n){return o.window.showErrorMessage(e,t,...n)}showQuickPick(e,t,n){return o.window.showQuickPick(e,t,n)}showOpenDialog(e){return o.window.showOpenDialog(e)}showSaveDialog(e){return o.window.showSaveDialog(e)}showInputBox(e,t){return o.window.showInputBox(e,t)}showTextDocument(e,t,n){return o.window.showTextDocument(e,t,n)}openUrl(e){o.env.openExternal(o.Uri.parse(e))}setStatusBarMessage(e,t){return o.window.setStatusBarMessage(e,t)}createStatusBarItem(e,t,n){return n?o.window.createStatusBarItem(n,e,t):o.window.createStatusBarItem(e,t)}showWorkspaceFolderPick(e){return o.window.showWorkspaceFolderPick(e)}withProgress(e,t){return o.window.withProgress(e,t)}withProgressCustomIcon(e,t){const n=(new o.CancellationTokenSource).token,r=this.createStatusBarItem(o.StatusBarAlignment.Left),i={report:t=>{r.text=`${e} ${t.message}`}};return r.show(),t(i,n).then((e=>(r.dispose(),e)))}createQuickPick(){return o.window.createQuickPick()}createInputBox(){return o.window.createInputBox()}createTreeView(e,t){return o.window.createTreeView(e,t)}createOutputChannel(e){return o.window.createOutputChannel(e,{log:!0})}createLanguageStatusItem(e,t){return o.languages.createLanguageStatusItem(e,t)}};s=r([(0,i.injectable)()],s),t.ApplicationShell=s},77633:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ClipboardService=void 0;const i=n(86700),o=n(66828);let s=class{async readText(){return o.env.clipboard.readText()}async writeText(e){await o.env.clipboard.writeText(e)}};s=r([(0,i.injectable)()],s),t.ClipboardService=s},17381:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandManager=void 0;const i=n(86700),o=n(66828);let s=class{registerCommand(e,t,n){return o.commands.registerCommand(e,t,n)}registerTextEditorCommand(e,t,n){return o.commands.registerTextEditorCommand(e,t,n)}executeCommand(e,...t){return o.commands.executeCommand(e,...t)}getCommands(e){return o.commands.getCommands(e)}};s=r([(0,i.injectable)()],s),t.CommandManager=s},32907:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePythonFileCommandHandler=void 0;const o=n(86700),s=n(77570),a=n(17585),c=n(54813),l=n(61522),u=n(61684);let p=class{constructor(e,t,n,r){this.commandManager=e,this.workspaceService=t,this.appShell=n,this.disposables=r,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!0}}async activate(){this.disposables.push(this.commandManager.registerCommand(s.Commands.CreateNewFile,this.createPythonFile,this))}async createPythonFile(){const e=await this.workspaceService.openTextDocument({language:"python"});this.appShell.showTextDocument(e),(0,c.sendTelemetryEvent)(l.EventName.CREATE_NEW_FILE_COMMAND)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ICommandManager)),i(1,(0,o.inject)(a.IWorkspaceService)),i(2,(0,o.inject)(a.IApplicationShell)),i(3,(0,o.inject)(u.IDisposableRegistry))],p),t.CreatePythonFileCommandHandler=p},30651:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReloadVSCodeCommandHandler=void 0;const o=n(86700),s=n(67098),a=n(3481),c=n(17585);let l=class{constructor(e,t){this.commandManager=e,this.appShell=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(){this.commandManager.registerCommand("python.reloadVSCode",this.onReloadVSCode,this)}async onReloadVSCode(e){await this.appShell.showInformationMessage(e,s.Common.reload)===s.Common.reload&&this.commandManager.executeCommand("workbench.action.reloadWindow").then(a.noop,a.noop)}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(c.ICommandManager)),i(1,(0,o.inject)(c.IApplicationShell))],l),t.ReloadVSCodeCommandHandler=l},5869:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReportIssueCommandHandler=void 0;const o=n(55674),s=n(22037),a=n(71017),c=n(86700),l=n(96486),u=n(17585),p=n(63281),d=n(18639),h=n(77570),f=n(61684),g=n(54813),m=n(61522),v=n(81387),y=n(89515),b=n(48683);let S=class{constructor(e,t,n,r,i){var o,s,c;this.commandManager=e,this.workspaceService=t,this.interpreterService=n,this.configurationService=r,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this.argSettingsPath=a.join(p.EXTENSION_ROOT_DIR,"resources","report_issue_user_settings.json"),this.templatePath=a.join(p.EXTENSION_ROOT_DIR,"resources","report_issue_template.md"),this.packageJSONSettings=null===(c=null===(s=null===(o=i.packageJson)||void 0===o?void 0:o.contributes)||void 0===s?void 0:s.configuration)||void 0===c?void 0:c.properties}async activate(){this.commandManager.registerCommand(h.Commands.ReportIssue,this.openReportIssue,this)}async openReportIssue(){var e,t,n,r;const i=this.configurationService.getSettings(),a=JSON.parse(await o.readFile(this.argSettingsPath,"utf8"));let c="";Object.keys(i).forEach((e=>{const t=a[e];if(t)if("object"==typeof t){let n=!1;const r=i[e];"object"==typeof r&&Object.keys(t).forEach((i=>{const o=t[i];if(o){const t=this.getDefaultValue(`${e}.${i}`);if(void 0===t||!(0,l.isEqual)(t,r[i])){n||(c=c.concat(s.EOL,e,s.EOL),n=!0);const t=!0===o?JSON.stringify(r[i]):'"<placeholder>"';c=c.concat(" ",i,": ",t,s.EOL)}}}))}else{const n=this.getDefaultValue(e);if(void 0===n||!(0,l.isEqual)(n,i[e])){const n=!0===t?JSON.stringify(i[e]):'"<placeholder>"';c=c.concat(s.EOL,e,": ",n,s.EOL)}}}));const u=await o.readFile(this.templatePath,"utf8"),p=await this.interpreterService.getActiveInterpreter(),d=null!==(t=null===(e=null==p?void 0:p.version)||void 0===e?void 0:e.raw)&&void 0!==t?t:"",h=this.workspaceService.getConfiguration("python").get("languageServer")||"Not Found",f=(null==p?void 0:p.envType)||v.EnvironmentType.Unknown,y=(null!==(r=null===(n=this.workspaceService.workspaceFolders)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>1&&""!==c?`Multiroot scenario, following user settings may not apply:${s.EOL}`:"";await this.commandManager.executeCommand("workbench.action.openIssueReporter",{extensionId:"ms-python.python",issueBody:u.format(d,f,h,y,c)}),(0,g.sendTelemetryEvent)(m.EventName.USE_REPORT_ISSUE_COMMAND,void 0,{})}getDefaultValue(e){var t;if(!this.packageJSONSettings)return;const n=y.PythonSettings.getSettingsUriAndTarget(void 0,this.workspaceService).uri;return new b.SystemVariables(n,void 0,this.workspaceService).resolveAny(null===(t=this.packageJSONSettings[`python.${e}`])||void 0===t?void 0:t.default)}};S=r([(0,c.injectable)(),i(0,(0,c.inject)(u.ICommandManager)),i(1,(0,c.inject)(u.IWorkspaceService)),i(2,(0,c.inject)(d.IInterpreterService)),i(3,(0,c.inject)(f.IConfigurationService)),i(4,(0,c.inject)(u.IApplicationEnvironment))],S),t.ReportIssueCommandHandler=S},54094:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ContextKeyManager=void 0;const o=n(86700),s=n(17585);let a=class{constructor(e){this.commandManager=e,this.values=new Map}async setContext(e,t){return this.values.get(e)===t?Promise.resolve():(this.values.set(e,t),this.commandManager.executeCommand("setContext",e,t))}};a=r([(0,o.injectable)(),i(0,(0,o.inject)(s.ICommandManager))],a),t.ContextKeyManager=a},56994:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionContextKey=void 0,(n=t.ExtensionContextKey||(t.ExtensionContextKey={})).showInstallPythonTile="showInstallPythonTile",n.HasFailedTests="hasFailedTests",n.RefreshingTests="refreshingTests",n.IsJupyterInstalled="isJupyterInstalled"},54144:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugService=void 0;const o=n(86700),s=n(66828);let a=r=class{get activeDebugConsole(){return s.debug.activeDebugConsole}get activeDebugSession(){return s.debug.activeDebugSession}get breakpoints(){return s.debug.breakpoints}get onDidChangeActiveDebugSession(){return s.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return s.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return s.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return s.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return s.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return s.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return s.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return s.debug.startDebugging(e,t,n)}addBreakpoints(e){s.debug.addBreakpoints(e)}removeBreakpoints(e){s.debug.removeBreakpoints(e)}registerDebugAdapterDescriptorFactory(e,t){return s.debug.registerDebugAdapterDescriptorFactory(e,t)}};a.instance=new r,a=r=i([(0,o.injectable)()],a),t.DebugService=a},67808:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugSessionTelemetry=void 0;const o=n(86700),s=n(54813),a=n(61522),c=n(61684),l=n(70057),u=n(17585);class p{constructor(e){this.timer=new l.StopWatch,this.trigger="launch",this.trigger=e.configuration.request;const t=e.configuration;this.console=t.console}onWillStartSession(){this.sendTelemetry(a.EventName.DEBUG_SESSION_START)}onDidSendMessage(e){"response"===e.type&&"configurationDone"===e.command&&this.sendTelemetry(a.EventName.DEBUG_SESSION_USER_CODE_RUNNING)}onWillStopSession(){this.sendTelemetry(a.EventName.DEBUG_SESSION_STOP)}onError(e){this.sendTelemetry(a.EventName.DEBUG_SESSION_ERROR)}sendTelemetry(e){e===a.EventName.DEBUG_SESSION_START&&this.timer.reset();const t={trigger:this.trigger,console:this.console};(0,s.sendTelemetryEvent)(e,this.timer.elapsedTime,t)}}let d=class{constructor(e,t){this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},e.push(t.registerDebugAdapterTrackerFactory("python",this))}async activate(){}createDebugAdapterTracker(e){return new p(e)}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IDisposableRegistry)),i(1,(0,o.inject)(u.IDebugService))],d),t.DebugSessionTelemetry=d},72874:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentManager=void 0;const i=n(86700),o=n(66828);let s=class{get textDocuments(){return o.workspace.textDocuments}get activeTextEditor(){return o.window.activeTextEditor}get visibleTextEditors(){return o.window.visibleTextEditors}get onDidChangeActiveTextEditor(){return o.window.onDidChangeActiveTextEditor}get onDidChangeTextDocument(){return o.workspace.onDidChangeTextDocument}get onDidChangeVisibleTextEditors(){return o.window.onDidChangeVisibleTextEditors}get onDidChangeTextEditorSelection(){return o.window.onDidChangeTextEditorSelection}get onDidChangeTextEditorOptions(){return o.window.onDidChangeTextEditorOptions}get onDidChangeTextEditorViewColumn(){return o.window.onDidChangeTextEditorViewColumn}get onDidOpenTextDocument(){return o.workspace.onDidOpenTextDocument}get onDidCloseTextDocument(){return o.workspace.onDidCloseTextDocument}get onDidSaveTextDocument(){return o.workspace.onDidSaveTextDocument}showTextDocument(e,t,n){return o.window.showTextDocument(e,t,n)}openTextDocument(e){return o.workspace.openTextDocument(e)}applyEdit(e){return o.workspace.applyEdit(e)}createTextEditorDecorationType(e){return o.window.createTextEditorDecorationType(e)}};s=r([(0,i.injectable)()],s),t.DocumentManager=s},13578:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=void 0;const o=n(86700),s=n(66828),a=n(77911),c=n(71017),l=n(84974),u=n(77570);let p=class{constructor(e){this.fs=e}get all(){return s.extensions.all}get onDidChange(){return s.extensions.onDidChange}getExtension(e){return s.extensions.getExtension(e)}get cachedExtensions(){return this._cachedExtensions||(this._cachedExtensions=s.extensions.all,s.extensions.onDidChange((()=>{this._cachedExtensions=s.extensions.all}))),this._cachedExtensions}async determineExtensionFromCallStack(){const{stack:e}=new Error;if(e){const t=c.join(u.EXTENSION_ROOT_DIR.toLowerCase(),c.sep),n=e.split("\n").map((e=>{const t=/\((.*)\)/.exec(e);if(t)return t[1]})).filter((e=>e&&!e.toLowerCase().startsWith(t))).filter((e=>this.cachedExtensions.some((t=>e.includes(t.extensionUri.path)||e.includes(t.extensionUri.fsPath)))));a.parse(new Error("Ex")).forEach((e=>{const r=e.getFileName();r&&!r.toLowerCase().startsWith(t)&&n.push(r)}));for(const e of n){let t=c.dirname(e),n=e;for(;t&&t.length<n.length;){const e=c.join(t,"package.json");if(await this.fs.pathExists(e)){const t=await this.fs.readFile(e);try{const e=JSON.parse(t);return{extensionId:`${e.publisher}.${e.name}`,displayName:e.displayName}}catch(e){}}n=t,t=c.dirname(t)}}}return{extensionId:"unknown",displayName:"unknown"}}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IFileSystem))],p),t.Extensions=p},64991:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageService=void 0;const i=n(86700),o=n(66828);let s=class{registerCompletionItemProvider(e,t,...n){return o.languages.registerCompletionItemProvider(e,t,...n)}};s=r([(0,i.injectable)()],s),t.LanguageService=s},53314:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalManager=void 0;const i=n(86700),o=n(66828),s=n(19735);let a=class{constructor(){this.didOpenTerminal=new o.EventEmitter,o.window.onDidOpenTerminal((e=>{this.didOpenTerminal.fire(c(e))}))}get onDidCloseTerminal(){return o.window.onDidCloseTerminal}get onDidOpenTerminal(){return this.didOpenTerminal.event}createTerminal(e){return c(o.window.createTerminal(e))}};function c(e){if(!e.isPatched){const t=e.sendText.bind(e);e.sendText=(e,n=!0)=>((0,s.traceLog)(`Send text to terminal: ${e}`),t(e,n)),e.isPatched=!0}return e}a=r([(0,i.injectable)()],a),t.TerminalManager=a},17585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IClipboard=t.IActiveResourceService=t.ILanguageService=t.IApplicationEnvironment=t.IDebugService=t.ITerminalManager=t.IWorkspaceService=t.IDocumentManager=t.IJupyterExtensionDependencyManager=t.IContextKeyManager=t.ICommandManager=t.IApplicationShell=void 0,t.IApplicationShell=Symbol("IApplicationShell"),t.ICommandManager=Symbol("ICommandManager"),t.IContextKeyManager=Symbol("IContextKeyManager"),t.IJupyterExtensionDependencyManager=Symbol("IJupyterExtensionDependencyManager"),t.IDocumentManager=Symbol("IDocumentManager"),t.IWorkspaceService=Symbol("IWorkspaceService"),t.ITerminalManager=Symbol("ITerminalManager"),t.IDebugService=Symbol("IDebugManager"),t.IApplicationEnvironment=Symbol("IApplicationEnvironment"),t.ILanguageService=Symbol("ILanguageService"),t.IActiveResourceService=Symbol("IActiveResourceService"),t.IClipboard=Symbol("IClipboard")},91932:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PythonWelcome=void 0,(n=t.PythonWelcome||(t.PythonWelcome={})).name="pythonWelcome",n.windowsInstallId="python.installPythonWin8",n.linuxInstallId="python.installPythonLinux",n.macOSInstallId="python.installPythonMac"},56792:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceService=void 0;const i=n(86700),o=n(71017),s=n(66828),a=n(87450);let c=class{get onDidChangeConfiguration(){return s.workspace.onDidChangeConfiguration}get rootPath(){return Array.isArray(s.workspace.workspaceFolders)&&s.workspace.workspaceFolders.length>0?s.workspace.workspaceFolders[0].uri.fsPath:void 0}get workspaceFolders(){return s.workspace.workspaceFolders}get onDidChangeWorkspaceFolders(){return s.workspace.onDidChangeWorkspaceFolders}get workspaceFile(){return s.workspace.workspaceFile}getConfiguration(e,t,n=!1){return n?s.workspace.getConfiguration(e,{uri:t,languageId:"python"}):s.workspace.getConfiguration(e,t)}getWorkspaceFolder(e){return e?s.workspace.getWorkspaceFolder(e):void 0}asRelativePath(e,t){return s.workspace.asRelativePath(e,t)}createFileSystemWatcher(e,t,n,r){return s.workspace.createFileSystemWatcher(e,t,n,r)}findFiles(e,t,n,r){const i=void 0===t?this.searchExcludes:t;return s.workspace.findFiles(e,i,n,r)}getWorkspaceFolderIdentifier(e,t=""){const n=e?s.workspace.getWorkspaceFolder(e):void 0;return n?o.normalize((0,a.getOSType)()===a.OSType.Windows?n.uri.fsPath.toUpperCase():n.uri.fsPath):t}get isVirtualWorkspace(){return!(!s.workspace.workspaceFolders||!s.workspace.workspaceFolders.every((e=>"file"!==e.uri.scheme)))}get isTrusted(){return s.workspace.isTrusted}get onDidGrantWorkspaceTrust(){return s.workspace.onDidGrantWorkspaceTrust}openTextDocument(e){return s.workspace.openTextDocument(e)}get searchExcludes(){const e=this.getConfiguration("search.exclude");return`{${Object.keys(e).filter((t=>!0===e.get(t))).join(",")}}`}async save(e){try{return await s.workspace.save(e)}catch(e){return}}};c=r([(0,i.injectable)()],c),t.WorkspaceService=c},29979:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cancellation=t.wrapCancellationTokens=t.createPromiseFromCancellation=t.CancellationError=void 0;const r=n(66828),i=n(59314),o=n(67098);class s extends Error{constructor(){super(o.Common.canceled)}}t.CancellationError=s,t.createPromiseFromCancellation=function(e){return new Promise(((t,n)=>{e.token&&e.token.onCancellationRequested((()=>{if(e.token.isCancellationRequested){if("resolve"===e.cancelAction)return t(e.defaultValue);if("reject"===e.cancelAction)return n(new s)}}))}))},t.wrapCancellationTokens=function(...e){const t=new r.CancellationTokenSource;for(const n of e)if(n){if(n.isCancellationRequested)return n;n.onCancellationRequested((()=>t.cancel()))}return t.token},function(e){function t(e){return!!e&&e.isCancellationRequested}e.race=function(e,t){if(t){const n=(0,i.createDeferred)();return t.onCancellationRequested((()=>{n.completed||n.reject(new s)})),t.isCancellationRequested?n.reject(new s):e(t).then((e=>{n.completed||n.resolve(e)})).catch((e=>{n.completed||n.reject(e)})),n.promise}return e()},e.isCanceled=t,e.throwIfCanceled=function(e){if(t(e))throw new s}}(t.Cancellation||(t.Cancellation={}))},89515:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonSettings=void 0;const i=n(71017),o=n(57147),s=n(66828),a=n(90819);n(32727);const c=n(54813),l=n(61522),u=n(98634),p=n(56792),d=n(77570),h=n(36952),f=n(48683),g=n(87450),m=n(65243),v=n(58967);class y{constructor(e,t,n,r,i){this.interpreterAutoSelectionService=t,this.interpreterPathService=r,this.defaultLS=i,this.envFile="",this.venvPath="",this.venvFolders=[],this.activeStateToolPath="",this.condaPath="",this.pipenvPath="",this.poetryPath="",this.devOptions=[],this.globalModuleInstallation=!1,this.languageServer=a.LanguageServerType.Node,this.languageServerIsDefault=!0,this.changed=new s.EventEmitter,this.disposables=[],this._pythonPath="python",this._defaultInterpreterPath="",this.workspace=n||new p.WorkspaceService,this.workspaceRoot=e,this.initialize()}get onDidChange(){return this.changed.event}static onConfigChange(){return y.configChanged.event}get pythonPath(){return this._pythonPath}set pythonPath(e){if(this._pythonPath!==e)try{this._pythonPath=this.getPythonExecutable(e)}catch(t){this._pythonPath=e}}get defaultInterpreterPath(){return this._defaultInterpreterPath}set defaultInterpreterPath(e){if(this._defaultInterpreterPath!==e)try{this._defaultInterpreterPath=this.getPythonExecutable(e)}catch(t){this._defaultInterpreterPath=e}}static getInstance(e,t,n,r,i){n=n||new p.WorkspaceService;const o=y.getSettingsUriAndTarget(e,n).uri,s=o?o.fsPath:"";if(!y.pythonSettings.has(s)){const a=new y(o,t,n,r,i);y.pythonSettings.set(s,a),a.onDidChange((e=>y.debounceConfigChangeNotification(e)));const u=n.getConfiguration("editor",e||null),p=!!u&&u.get("formatOnType",!1);(0,c.sendTelemetryEvent)(l.EventName.FORMAT_ON_TYPE,void 0,{enabled:p})}return y.pythonSettings.get(s)}static debounceConfigChangeNotification(e){y.configChanged.fire(e)}static getSettingsUriAndTarget(e,t){t=t||new p.WorkspaceService;const n=e?t.getWorkspaceFolder(e):void 0;let r=n?n.uri:void 0;return!r&&Array.isArray(t.workspaceFolders)&&t.workspaceFolders.length>0&&(r=t.workspaceFolders[0].uri),{uri:r,target:r?s.ConfigurationTarget.WorkspaceFolder:s.ConfigurationTarget.Global}}static dispose(){if(!(0,d.isTestExecution)())throw new Error("Dispose can only be called from unit tests");y.pythonSettings.forEach((e=>e&&e.dispose())),y.pythonSettings.clear()}static toSerializable(e){const t={};return Object.entries(e).forEach((e=>{const[n,r]=e;n.includes("Manager")||n.includes("Service")||n.includes("onDid")||(t[n]=r)})),t}dispose(){this.disposables.forEach((e=>e&&e.dispose())),this.disposables=[]}update(e){var t,n,r,i,o;const c=null===(t=this.workspaceRoot)||void 0===t?void 0:t.fsPath,l=new f.SystemVariables(void 0,c,this.workspace);this.pythonPath=this.getPythonPath(l,c);const p=l.resolveAny(e.get("defaultInterpreterPath"));if(this.defaultInterpreterPath=p||d.DEFAULT_INTERPRETER_SETTING,this.defaultInterpreterPath===d.DEFAULT_INTERPRETER_SETTING){const e=this.interpreterAutoSelectionService.getAutoSelectedInterpreter(this.workspaceRoot);this.defaultInterpreterPath=null!==(n=null==e?void 0:e.path)&&void 0!==n?n:this.defaultInterpreterPath}this.defaultInterpreterPath=b(this.defaultInterpreterPath,c),this.venvPath=l.resolveAny(e.get("venvPath")),this.venvFolders=l.resolveAny(e.get("venvFolders"));const h=l.resolveAny(e.get("activeStateToolPath"));this.activeStateToolPath=h&&h.length>0?b(h,c):h;const g=l.resolveAny(e.get("condaPath"));this.condaPath=g&&g.length>0?b(g,c):g;const m=l.resolveAny(e.get("pipenvPath"));this.pipenvPath=m&&m.length>0?b(m,c):m;const v=l.resolveAny(e.get("poetryPath"));this.poetryPath=v&&v.length>0?b(v,c):v,this.interpreter=null!==(r=e.get("interpreter"))&&void 0!==r?r:{infoVisibility:"onPythonRelated"};let y=e.get("languageServer");y=l.resolveAny(y),y&&"Default"!==y&&"Microsoft"!==y&&Object.values(a.LanguageServerType).includes(y)?"JediLSP"===y?(this.languageServer=a.LanguageServerType.Jedi,this.languageServerIsDefault=!1):(this.languageServer=y,this.languageServerIsDefault=!1):(this.languageServer=null!==(o=null===(i=this.defaultLS)||void 0===i?void 0:i.defaultLSType)&&void 0!==o?o:a.LanguageServerType.None,this.languageServerIsDefault=!0);const S=l.resolveAny(e.get("autoComplete"));this.autoComplete?Object.assign(this.autoComplete,S):this.autoComplete=S;const E=e.get("envFile");this.envFile=l.resolveAny(E),(0,u.sendSettingTelemetry)(this.workspace,E),this.devOptions=l.resolveAny(e.get("devOptions")),this.devOptions=Array.isArray(this.devOptions)?this.devOptions:[];const _=l.resolveAny(e.get("linting"));this.linting?Object.assign(this.linting,_):this.linting=_,this.globalModuleInstallation=!0===e.get("globalModuleInstallation");const w=l.resolveAny(e.get("sortImports"));this.sortImports?Object.assign(this.sortImports,w):this.sortImports=w,this.sortImports=this.sortImports?this.sortImports:{path:"",args:[]},this.linting=this.linting?this.linting:{enabled:!1,cwd:void 0,ignorePatterns:[],flake8Args:[],flake8Enabled:!1,flake8Path:"flake8",lintOnSave:!1,maxNumberOfProblems:100,mypyArgs:[],mypyEnabled:!1,mypyPath:"mypy",banditArgs:[],banditEnabled:!1,banditPath:"bandit",pycodestyleArgs:[],pycodestyleEnabled:!1,pycodestylePath:"pycodestyle",pylamaArgs:[],pylamaEnabled:!1,pylamaPath:"pylama",prospectorArgs:[],prospectorEnabled:!1,prospectorPath:"prospector",pydocstyleArgs:[],pydocstyleEnabled:!1,pydocstylePath:"pydocstyle",pylintArgs:[],pylintEnabled:!1,pylintPath:"pylint",pylintCategorySeverity:{convention:s.DiagnosticSeverity.Hint,error:s.DiagnosticSeverity.Error,fatal:s.DiagnosticSeverity.Error,refactor:s.DiagnosticSeverity.Hint,warning:s.DiagnosticSeverity.Warning},pycodestyleCategorySeverity:{E:s.DiagnosticSeverity.Error,W:s.DiagnosticSeverity.Warning},flake8CategorySeverity:{E:s.DiagnosticSeverity.Error,W:s.DiagnosticSeverity.Warning,F:s.DiagnosticSeverity.Warning},mypyCategorySeverity:{error:s.DiagnosticSeverity.Error,note:s.DiagnosticSeverity.Hint}},this.linting.pylintPath=b(l.resolveAny(this.linting.pylintPath),c),this.linting.flake8Path=b(l.resolveAny(this.linting.flake8Path),c),this.linting.pycodestylePath=b(l.resolveAny(this.linting.pycodestylePath),c),this.linting.pylamaPath=b(l.resolveAny(this.linting.pylamaPath),c),this.linting.prospectorPath=b(l.resolveAny(this.linting.prospectorPath),c),this.linting.pydocstylePath=b(l.resolveAny(this.linting.pydocstylePath),c),this.linting.mypyPath=b(l.resolveAny(this.linting.mypyPath),c),this.linting.banditPath=b(l.resolveAny(this.linting.banditPath),c),this.linting.cwd&&(this.linting.cwd=b(l.resolveAny(this.linting.cwd),c));const T=l.resolveAny(e.get("formatting"));this.formatting?Object.assign(this.formatting,T):this.formatting=T,this.formatting=this.formatting?this.formatting:{autopep8Args:[],autopep8Path:"autopep8",provider:"autopep8",blackArgs:[],blackPath:"black",yapfArgs:[],yapfPath:"yapf"},this.formatting.autopep8Path=b(l.resolveAny(this.formatting.autopep8Path),c),this.formatting.yapfPath=b(l.resolveAny(this.formatting.yapfPath),c),this.formatting.blackPath=b(l.resolveAny(this.formatting.blackPath),c);const C=l.resolveAny(e.get("testing"));this.testing?Object.assign(this.testing,C):(this.testing=C,(0,d.isTestExecution)()&&!this.testing&&(this.testing={pytestArgs:[],unittestArgs:[],promptToConfigure:!0,debugPort:3e3,pytestEnabled:!1,unittestEnabled:!1,pytestPath:"pytest",autoTestDiscoverOnSaveEnabled:!0})),this.testing=this.testing?this.testing:{promptToConfigure:!0,debugPort:3e3,pytestArgs:[],pytestEnabled:!1,pytestPath:"pytest",unittestArgs:[],unittestEnabled:!1,autoTestDiscoverOnSaveEnabled:!0},this.testing.pytestPath=b(l.resolveAny(this.testing.pytestPath),c),this.testing.cwd&&(this.testing.cwd=b(l.resolveAny(this.testing.cwd),c)),this.testing.pytestArgs=this.testing.pytestArgs.map((e=>l.resolveAny(e))),this.testing.unittestArgs=this.testing.unittestArgs.map((e=>l.resolveAny(e)));const P=l.resolveAny(e.get("terminal"));this.terminal?Object.assign(this.terminal,P):(this.terminal=P,(0,d.isTestExecution)()&&!this.terminal&&(this.terminal={})),this.terminal=this.terminal?this.terminal:{executeInFileDir:!0,focusAfterLaunch:!1,launchArgs:[],activateEnvironment:!0,activateEnvInCurrentTerminal:!1};const I=l.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,I):this.experiments=I,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};const x=l.resolveAny(e.get("tensorBoard"));this.tensorBoard=x||{logDirectory:""},this.tensorBoard.logDirectory&&(this.tensorBoard.logDirectory=b(this.tensorBoard.logDirectory,c))}getPythonExecutable(e){return function(e){if("python"===(e=v(e))||-1===e.indexOf(i.sep)||i.basename(e)===i.dirname(e))return e;if(S(e))return e;const t=["python","python4","python3.6","python3.5","python3","python2.7","python2","python3.7","python3.8","python3.9"];for(let n of t)if((0,m.isWindows)()){if(n=`${n}.exe`,S(i.join(e,n)))return i.join(e,n);if(S(i.join(e,"Scripts",n)))return i.join(e,"Scripts",n)}else{if(S(i.join(e,n)))return i.join(e,n);if(S(i.join(e,"bin",n)))return i.join(e,"bin",n)}return e}(e)}onWorkspaceFoldersChanged(){const e=this.workspace.workspaceFolders.map((e=>e.uri.fsPath)),t=Array.from(y.pythonSettings.keys()).filter((t=>e.indexOf(t)<0));if(t.length>0)for(const e of t)y.pythonSettings.delete(e)}register(){y.pythonSettings=new Map,this.initialize()}onDidChanged(e){const t=this.workspace.getConfiguration("python",this.workspaceRoot);this.update(t),this.debounceChangeNotification(e)}initialize(){this.disposables.push(this.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this.disposables.push(this.interpreterAutoSelectionService.onDidChangeAutoSelectedInterpreter((()=>{this.onDidChanged()}))),this.disposables.push(this.workspace.onDidChangeConfiguration((e=>{e.affectsConfiguration("python")&&this.onDidChanged(e)}))),this.interpreterPathService&&this.disposables.push(this.interpreterPathService.onDidChange((()=>{this.onDidChanged()})));const e=this.workspace.getConfiguration("python",this.workspaceRoot);e&&this.update(e)}debounceChangeNotification(e){this.changed.fire(e)}getPythonPath(e,t){if(this.pythonPath=e.resolveAny(this.interpreterPathService.get(this.workspaceRoot)),!process.env.CI_DISABLE_AUTO_SELECTION&&(0===this.pythonPath.length||"python"===this.pythonPath)&&this.interpreterAutoSelectionService){const e=this.interpreterAutoSelectionService.getAutoSelectedInterpreter(this.workspaceRoot);e&&(this.pythonPath=e.path,this.workspaceRoot&&this.interpreterAutoSelectionService.setWorkspaceInterpreter(this.workspaceRoot,e).ignoreErrors())}return b(this.pythonPath,t)}}function b(e,t){return t||(t=__dirname),e=v(e),(0,d.isTestExecution)()&&!e?t:-1===e.indexOf(i.sep)||i.isAbsolute(e)?e:i.resolve(t,e)}function S(e){return o.existsSync(e)&&i.basename((0,g.getOSType)()===g.OSType.Windows?e.toLowerCase():e).startsWith("python")}y.pythonSettings=new Map,y.configChanged=new s.EventEmitter,r([(0,h.debounceSync)(1)],y.prototype,"debounceChangeNotification",null),r([(0,h.debounceSync)(1)],y,"debounceConfigChangeNotification",null),t.PythonSettings=y},15797:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PipEnvExecutionPath=void 0;const o=n(86700),s=n(61684);let a=class{constructor(e){this.configService=e}get executable(){return this.configService.getSettings().pipenvPath}};a=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IConfigurationService))],a),t.PipEnvExecutionPath=a},30751:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationService=void 0;const o=n(86700),s=n(66828),a=n(87282),c=n(77498),l=n(17585),u=n(89515),p=n(77570),d=n(61684);let h=class{constructor(e){this.serviceContainer=e,this.workspaceService=this.serviceContainer.get(l.IWorkspaceService)}get onDidChange(){return u.PythonSettings.onConfigChange()}getSettings(e){const t=this.serviceContainer.get(a.IInterpreterAutoSelectionService),n=this.serviceContainer.get(d.IInterpreterPathService),r=this.serviceContainer.tryGet(d.IDefaultLanguageServer);return u.PythonSettings.getInstance(e,t,this.workspaceService,n,r)}async updateSectionSetting(e,t,n,r,i){let o={uri:r,target:i||s.ConfigurationTarget.WorkspaceFolder};"python"===e&&i!==s.ConfigurationTarget.Global&&(o=u.PythonSettings.getSettingsUriAndTarget(r,this.workspaceService)),i=i||o.target;const a=this.workspaceService.getConfiguration(e,o.uri),c=a.inspect(t);void 0!==c&&(i===s.ConfigurationTarget.Global&&c.globalValue===n||i===s.ConfigurationTarget.Workspace&&c.workspaceValue===n||i===s.ConfigurationTarget.WorkspaceFolder&&c.workspaceFolderValue===n)||(await a.update(t,n,i),await this.verifySetting(a,i,t,n))}async updateSetting(e,t,n,r){return this.updateSectionSetting("python",e,t,n,r)}isTestExecution(){return"1"===process.env.VSC_PYTHON_CI_TEST}async verifySetting(e,t,n,r){if(this.isTestExecution()&&!(0,p.isUnitTestExecution)()){let i=0;do{const o=e.inspect(n);if(!o&&void 0===r)break;if(o&&void 0!==r){let e;if(e=t===s.ConfigurationTarget.Global?o.globalValue:t===s.ConfigurationTarget.Workspace?o.workspaceValue:o.workspaceFolderValue,e===r)break}await new Promise((e=>setTimeout(e,250))),i+=1}while(i<20)}}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],h),t.ConfigurationService=h},77570:function(e,t,n){"use strict";var r,i,o,s,a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),c=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};function l(){return"1"===process.env.VSC_PYTHON_UNIT_TEST}Object.defineProperty(t,"__esModule",{value:!0}),t.UseProposedApi=t.isUnitTestExecution=t.isTestExecution=t.isCI=t.DEFAULT_INTERPRETER_SETTING=t.ThemeIcons=t.Octicons=t.Commands=t.CommandSource=t.AppinsightsKey=t.JUPYTER_EXTENSION_ID=t.PYLANCE_EXTENSION_ID=t.PVSC_EXTENSION_ID=t.PYTHON_NOTEBOOKS=t.PYTHON=t.InteractiveScheme=t.InteractiveInputScheme=t.NotebookCellScheme=t.PYTHON_WARNINGS=t.PYTHON_LANGUAGE=void 0,t.PYTHON_LANGUAGE="python",t.PYTHON_WARNINGS="PYTHONWARNINGS",t.NotebookCellScheme="vscode-notebook-cell",t.InteractiveInputScheme="vscode-interactive-input",t.InteractiveScheme="vscode-interactive",t.PYTHON=[{scheme:"file",language:t.PYTHON_LANGUAGE},{scheme:"untitled",language:t.PYTHON_LANGUAGE},{scheme:"vscode-notebook",language:t.PYTHON_LANGUAGE},{scheme:t.NotebookCellScheme,language:t.PYTHON_LANGUAGE},{scheme:t.InteractiveInputScheme,language:t.PYTHON_LANGUAGE}],t.PYTHON_NOTEBOOKS=[{scheme:"vscode-notebook",language:t.PYTHON_LANGUAGE},{scheme:t.NotebookCellScheme,language:t.PYTHON_LANGUAGE},{scheme:t.InteractiveInputScheme,language:t.PYTHON_LANGUAGE}],t.PVSC_EXTENSION_ID="ms-python.python",t.PYLANCE_EXTENSION_ID="ms-python.vscode-pylance",t.JUPYTER_EXTENSION_ID="ms-toolsai.jupyter",t.AppinsightsKey="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",(s=t.CommandSource||(t.CommandSource={})).ui="ui",s.commandPalette="commandpalette",(o=t.Commands||(t.Commands={})).ClearStorage="python.clearCacheAndReload",o.CreateNewFile="python.createNewFile",o.ClearWorkspaceInterpreter="python.clearWorkspaceInterpreter",o.Create_Environment="python.createEnvironment",o.Create_Environment_Button="python.createEnvironment-button",o.Create_Terminal="python.createTerminal",o.Debug_In_Terminal="python.debugInTerminal",o.Enable_Linter="python.enableLinting",o.Enable_SourceMap_Support="python.enableSourceMapSupport",o.Exec_In_Terminal="python.execInTerminal",o.Exec_In_Terminal_Icon="python.execInTerminal-icon",o.Exec_In_Separate_Terminal="python.execInDedicatedTerminal",o.Exec_Selection_In_Django_Shell="python.execSelectionInDjangoShell",o.Exec_Selection_In_Terminal="python.execSelectionInTerminal",o.GetSelectedInterpreterPath="python.interpreterPath",o.InstallJupyter="python.installJupyter",o.InstallPython="python.installPython",o.InstallPythonOnLinux="python.installPythonOnLinux",o.InstallPythonOnMac="python.installPythonOnMac",o.LaunchTensorBoard="python.launchTensorBoard",o.PickLocalProcess="python.pickLocalProcess",o.RefreshTensorBoard="python.refreshTensorBoard",o.ReportIssue="python.reportIssue",o.Run_Linter="python.runLinting",o.Set_Interpreter="python.setInterpreter",o.Set_Linter="python.setLinter",o.Set_ShebangInterpreter="python.setShebangInterpreter",o.Sort_Imports="python.sortImports",o.Start_REPL="python.startREPL",o.Tests_Configure="python.configureTests",o.TriggerEnvironmentSelection="python.triggerEnvSelection",o.ViewOutput="python.viewOutput",(i=t.Octicons||(t.Octicons={})).Add="$(add)",i.Test_Pass="$(check)",i.Test_Fail="$(alert)",i.Test_Error="$(x)",i.Test_Skip="$(circle-slash)",i.Downloading="$(cloud-download)",i.Installing="$(desktop-download)",i.Search_Stop="$(search-stop)",i.Star="$(star-full)",i.Gear="$(gear)",i.Warning="$(warning)",i.Error="$(error)",i.Lightbulb="$(lightbulb)",(r=t.ThemeIcons||(t.ThemeIcons={})).Refresh="refresh",r.SpinningLoader="loading~spin",t.DEFAULT_INTERPRETER_SETTING="python",t.isCI="true"===process.env.TRAVIS||void 0!==process.env.TF_BUILD,t.isTestExecution=function(){return"1"===process.env.VSC_PYTHON_CI_TEST||l()},t.isUnitTestExecution=l,t.UseProposedApi=Symbol("USE_VSC_PROPOSED_API"),c(n(63281),t)},94316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextKey=void 0,t.ContextKey=class{constructor(e,t){this.name=e,this.commandManager=t}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await this.commandManager.executeCommand("setContext",this.name,this.lastValue))}}},84911:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorUtils=t.getTempFileWithDocumentContents=t.getWorkspaceEditsFromPatch=t.getTextEditsFromPatch=void 0;const i=n(65176),o=n(86700),s=n(2568),a=n(22037),c=n(71017),l=n(66828),u=n(19735),p=n(26804),d=n(3481);var h;!function(e){e[e.Delete=0]="Delete",e[e.Insert=1]="Insert",e[e.Replace=2]="Replace"}(h||(h={}));const f=a.EOL.length;class g{constructor(e,t){this.action=e,this.start=t,this.text=""}apply(){switch(this.action){case h.Insert:return l.TextEdit.insert(this.start,this.text);case h.Delete:return l.TextEdit.delete(new l.Range(this.start,this.end));case h.Replace:return l.TextEdit.replace(new l.Range(this.start,this.end),this.text);default:return new l.TextEdit(new l.Range(new l.Position(0,0),new l.Position(0,0)),"")}}}function m(e,t,r=0){let i=r,o=0;const s=e.split(/\r?\n/g);i>0&&s.filter(((e,t)=>t<i)).forEach((e=>o+=e.length+f));const a=[];let c,u=null;for(let e=0;e<t.length;e+=1){let r=new l.Position(i,o);for(let n=0;n<t[e][1].length;n+=1)"\n"!==t[e][1][n]?o+=1:(o=0,i+=1);const p=n(65176);switch(t[e][0]){case p.DIFF_DELETE:if(0===s[i-1].length&&s[r.line-1]&&0===s[r.line-1].length?(r=new l.Position(r.line-1,0),c=new l.Position(i-1,0)):c=new l.Position(i,o),null===u)u=new g(h.Delete,r);else if(u.action!==h.Delete)throw new Error("cannot format due to an internal error.");u.end=c;break;case p.DIFF_INSERT:null===u?u=new g(h.Insert,r):u.action===h.Delete&&(u.action=h.Replace),i=r.line,o=r.character,u.text+=t[e][1];break;case p.DIFF_EQUAL:null!==u&&(a.push(u),u=null)}}return null!==u&&a.push(u),a}function v(e){const t=[];if(!e)return t;const r=e.split(/[\r\n]/);let o=0;const s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;for(;o<r.length;){const e=r[o].match(s);if(!e)throw new Error(`Invalid patch string: ${r[o]}`);const a=new i.diff_match_patch.patch_obj;t.push(a),a.start1=parseInt(e[1],10),""===e[2]?(a.start1-=1,a.length1=1):"0"===e[2]?a.length1=0:(a.start1-=1,a.length1=parseInt(e[2],10)),a.start2=parseInt(e[3],10),""===e[4]?(a.start2-=1,a.length2=1):"0"===e[4]?a.length2=0:(a.start2-=1,a.length2=parseInt(e[4],10)),o+=1;const c=n(65176);for(;o<r.length;){const e=r[o].charAt(0);let t;try{t=r[o].substring(1)}catch(e){throw new Error("Illegal escape in patch_fromText")}if("-"===e)a.diffs.push([c.DIFF_DELETE,t]);else if("+"===e)a.diffs.push([c.DIFF_INSERT,t]);else if(" "===e)a.diffs.push([c.DIFF_EQUAL,t]);else{if("@"===e)break;if(""!==e)throw new Error(`Invalid patch mode '${e}' in: ${t}`)}o+=1}}return t}t.getTextEditsFromPatch=function(e,t){if(t.startsWith("---")&&(t=t.substring(t.indexOf("@@"))),0===t.length)return[];t=t.replace(/\\ No newline at end of file[\r\n]/,"");const r=new(n(65176).diff_match_patch),i=v.call(r,t);if(!Array.isArray(i)||0===i.length)throw new Error("Unable to parse Patch string");const o=[];return i.forEach((t=>{t.diffs.forEach((e=>{e[1]+=a.EOL})),m(e,t.diffs,t.start1).forEach((e=>o.push(e.apply())))})),o},t.getWorkspaceEditsFromPatch=function(e,t,r){const i=new l.WorkspaceEdit;return e.forEach((e=>{const o=e.indexOf("@@");if(-1===o)return;const s=e.substring(0,o).split(/\r?\n/g).map((e=>e.trim())).filter((e=>e.length>0&&e.toLowerCase().endsWith(".py")&&e.indexOf(" a")>0));if(e.startsWith("---")&&(e=e.substring(o)),0===e.length)return;if(0===s.length)return;let u=s[0].substring(s[0].indexOf(" a")+3).trim();if(u=t&&!c.isAbsolute(u)?c.resolve(t,u):u,!r.fileExistsSync(u))return;e=e.replace(/\\ No newline at end of file[\r\n]/,"");const p=new(n(65176).diff_match_patch),d=v.call(p,e);if(!Array.isArray(d)||0===d.length)throw new Error("Unable to parse Patch string");const f=r.readFileSync(u),g=l.Uri.file(u);d.forEach((e=>{e.diffs.forEach((e=>{e[1]+=a.EOL})),m(f,e.diffs,e.start1).forEach((e=>{switch(e.action){case h.Delete:i.delete(g,new l.Range(e.start,e.end));break;case h.Insert:i.insert(g,e.start,e.text);break;case h.Replace:i.replace(g,new l.Range(e.start,e.end),e.text)}}))}))})),i},t.getTempFileWithDocumentContents=async function(e,t){let n=`${e.uri.fsPath}.${s(e.uri.fsPath+e.uri.fragment)}.tmp`;try{(0,d.isNotebookCell)(e.uri)&&!await t.fileExists(e.uri.fsPath)&&(n=(await t.createTemporaryFile(`${c.basename(e.uri.fsPath)}-${e.uri.fragment}.tmp`)).filePath),await t.writeFile(n,e.getText())}catch(e){(0,u.traceError)("Failed to create a temporary file",e);const t=e;throw new p.WrappedError(`Failed to create a temporary file, ${t.message}`,t)}return n};let y=class{getWorkspaceEditsFromPatch(e,t,r){const i=new l.WorkspaceEdit;if(t.startsWith("---")&&(t=t.substring(t.indexOf("@@"))),0===t.length)return i;t=t.replace(/\\ No newline at end of file[\r\n]/,"");const o=new(n(65176).diff_match_patch),s=v.call(o,t);if(!Array.isArray(s)||0===s.length)throw new Error("Unable to parse Patch string");return s.forEach((t=>{t.diffs.forEach((e=>{e[1]+=a.EOL})),m(e,t.diffs,t.start1).forEach((e=>{switch(e.action){case h.Delete:i.delete(r,new l.Range(e.start,e.end));break;case h.Insert:i.insert(r,e.start,e.text);break;case h.Replace:i.replace(r,new l.Range(e.start,e.end),e.text)}}))})),i}};y=r([(0,o.injectable)()],y),t.EditorUtils=y},26804:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WrappedError=t.ErrorUtils=void 0;const r=n(22037);t.ErrorUtils=class{static outputHasModuleNotInstalledError(e,t){return!(!t||!(t.indexOf(`No module named ${e}`)>0||t.indexOf(`No module named '${e}'`)>0))}};class i extends Error{constructor(e,t){super(e),this.stack=`${new Error("").stack}${r.EOL}${r.EOL}${t.stack}`}}t.WrappedError=i},97300:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleNotInstalledError=void 0;class n extends Error{constructor(e){super(`Module '${e}' not installed.`)}}t.ModuleNotInstalledError=n},60717:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnableTestAdapterRewrite=t.ShowFormatterExtensionPrompt=t.TerminalEnvVarActivation=t.ShowToolsExtensionPrompt=t.ShowExtensionSurveyPrompt=void 0,(t.ShowExtensionSurveyPrompt||(t.ShowExtensionSurveyPrompt={})).experiment="pythonSurveyNotification",(t.ShowToolsExtensionPrompt||(t.ShowToolsExtensionPrompt={})).experiment="pythonPromptNewToolsExt",(t.TerminalEnvVarActivation||(t.TerminalEnvVarActivation={})).experiment="pythonTerminalEnvVarActivation",(t.ShowFormatterExtensionPrompt||(t.ShowFormatterExtensionPrompt={})).experiment="pythonPromptNewFormatterExt",(t.EnableTestAdapterRewrite||(t.EnableTestAdapterRewrite={})).experiment="pythonTestAdapter"},46747:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inTerminalEnvVarExperiment=void 0;const r=n(66828),i=n(60717),o=n(77570);t.inTerminalEnvVarExperiment=function(e){return!(!(0,o.isTestExecution)()&&r.workspace.workspaceFile&&r.env.remoteName||!e.inExperimentSync(i.TerminalEnvVarActivation.experiment))}},12474:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentService=t.TargetPopulation=void 0;const o=n(86700),s=n(66828),a=n(59035),c=n(19735),l=n(54813),u=n(61522),p=n(17585),d=n(77570),h=n(61684),f=n(31373),g="vscode";var m;!function(e){e.Insiders="python-insider",e.Public="python-public"}(m=t.TargetPopulation||(t.TargetPopulation={}));let v=class{constructor(e,t,n){this.workspaceService=e,this.appEnvironment=t,this.persistentState=n,this._optInto=[],this._optOutFrom=[],this.experiments=this.persistentState.createGlobalPersistentState("VSCode.ABExp.FeatureData",{features:[]});const r=this.workspaceService.getConfiguration("python"),i=r.get("experiments.optInto")||[],o=r.get("experiments.optOutFrom")||[];if(this._optInto=i.filter((e=>!e.endsWith("control"))),this._optOutFrom=o.filter((e=>!e.endsWith("control"))),this._optOutFrom.includes("All")||!1===r.get("experiments.enabled")?this.enabled=!1:this.enabled=!0,!this.enabled)return;let s;s="insiders"===this.appEnvironment.extensionChannel?m.Insiders:m.Public;const c=new f.ExperimentationTelemetry;this.experimentationService=(0,a.getExperimentationService)(d.PVSC_EXTENSION_ID,this.appEnvironment.packageJson.version,s,c,this.experiments.storage)}async activate(){if(this.experimentationService){const e=Date.now();await this.experimentationService.initializePromise,0===this.experiments.value.features.length&&(await this.experimentationService.initialFetch,(0,l.sendTelemetryEvent)(u.EventName.PYTHON_EXPERIMENTS_INIT_PERFORMANCE,Date.now()-e)),this.logExperiments()}!function(e,t,n){const r=y("python.experiments.optInto",n),i=y("python.experiments.optOutFrom",n),o=e.filter((e=>r.includes(e))),s=t.filter((e=>i.includes(e)));(0,l.sendTelemetryEvent)(u.EventName.PYTHON_EXPERIMENTS_OPT_IN_OPT_OUT_SETTINGS,void 0,{optedInto:o,optedOutFrom:s})}(this._optInto,this._optOutFrom,this.appEnvironment.packageJson)}async inExperiment(e){return this.inExperimentSync(e)}inExperimentSync(e){return!!this.experimentationService&&(!this._optOutFrom.includes("All")&&!this._optOutFrom.includes(e)&&(this._optInto.includes("All")||this._optInto.includes(e)?(this.experimentationService.getTreatmentVariable(g,e),!0):!0===this.experimentationService.getTreatmentVariable(g,e)))}async getExperimentValue(e){if(this.experimentationService&&!this._optOutFrom.includes("All")&&!this._optOutFrom.includes(e))return this.experimentationService.getTreatmentVariable(g,e)}logExperiments(){const e=this.workspaceService.getConfiguration("telemetry");let t=!1;e&&!1===e.get("enableTelemetry")&&((0,c.traceLog)("Telemetry is disabled"),t=!0),e&&"off"===e.get("telemetryLevel")&&((0,c.traceLog)("Telemetry level is off"),t=!0),t&&(0,c.traceLog)("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All")?(0,c.traceLog)(s.l10n.t("Experiment '{0}' is inactive","All")):this._optInto.includes("All")?(0,c.traceLog)(s.l10n.t("Experiment '{0}' is active","All")):(this._optOutFrom.filter((e=>"All"!==e&&e.toLowerCase().startsWith("python"))).forEach((e=>{(0,c.traceLog)(s.l10n.t("Experiment '{0}' is inactive",e))})),this._optInto.filter((e=>"All"!==e&&e.toLowerCase().startsWith("python"))).forEach((e=>{(0,c.traceLog)(s.l10n.t("Experiment '{0}' is active",e))})),t||this.experiments.value.features.forEach((e=>{!e.toLowerCase().startsWith("python")||this._optOutFrom.includes(e)||this._optInto.includes(e)||(0,c.traceLog)(s.l10n.t("Experiment '{0}' is active",e))})))}};function y(e,t){var n;const r=t.contributes.configuration.properties[e];return r&&null!==(n=r.items.enum)&&void 0!==n?n:[]}v=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IWorkspaceService)),i(1,(0,o.inject)(p.IApplicationEnvironment)),i(2,(0,o.inject)(h.IPersistentStateFactory))],v),t.ExperimentService=v},31373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentationTelemetry=void 0;const r=n(54813);t.ExperimentationTelemetry=class{setSharedProperty(e,t){(0,r.setSharedProperty)(e,t)}postEvent(e,t){const n={};t.forEach(((e,t)=>{n[t]=e})),(0,r.sendTelemetryEvent)(e,void 0,n)}}},32727:()=>{"use strict";String.prototype.toCommandArgumentForPythonExt=function(){return this?!(this.indexOf(" ")>=0||this.indexOf("&")>=0||this.indexOf("(")>=0||this.indexOf(")")>=0)||this.startsWith('"')||this.endsWith('"')?this.toString():`"${this}"`:this},String.prototype.fileToCommandArgumentForPythonExt=function(){return this?this.toCommandArgumentForPythonExt().replace(/\\/g,"/"):this},String.prototype.trimQuotes=function(){return this?this.replace(/(^['"])|(['"]$)/g,""):this},Promise.prototype.ignoreErrors=function(){return this.catch((()=>{}))},String.prototype.format||(String.prototype.format=function(){const e=arguments;return this.replace(/{(\d+)}/g,((t,n)=>void 0===e[n]?t:e[n]))})},40071:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNotInstalledError=void 0;const r=n(97300);t.isNotInstalledError=function(e){const t=e;if("object"!=typeof e||null===e)return!1;if(e instanceof r.ModuleNotInstalledError)return!0;const n=e.message.indexOf("No module named")>=0;return"ENOENT"===t.code||127===t.code||n}},95939:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstallationChannelManager=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(81387),l=n(17585),u=n(84974),p=n(67098),d=n(3481),h=n(92674),f=n(59747);let g=class{constructor(e){this.serviceContainer=e}async getInstallationChannel(e,t){const n=await this.getInstallationChannels(t);if(1===n.length)return n[0];const r=h.ProductNames.get(e),i=this.serviceContainer.get(l.IApplicationShell);if(0===n.length)return void await this.showNoInstallersMessage((0,d.isResource)(t)?t:void 0);const o=`Select an option to install ${r}`,s=n.map((e=>({label:`Install using ${e.displayName}`,description:"",installer:e}))),a=await i.showQuickPick(s,{matchOnDescription:!0,matchOnDetail:!0,placeHolder:o});return a?a.installer:void 0}async getInstallationChannels(e){const t=this.serviceContainer.getAll(f.IModuleInstaller),n=[];if(0===t.length)return[];t.sort(((e,t)=>t.priority-e.priority));let r=t[0].priority;for(const i of t){if(i.priority!==r){if(n.length>0)break;r=i.priority}await i.isSupported(e)&&n.push(i)}return n}async showNoInstallersMessage(e){const t=this.serviceContainer.get(s.IInterpreterService),n=await t.getActiveInterpreter(e);if(!n)return;const r=this.serviceContainer.get(l.IApplicationShell);let i;if(i=n.envType===c.EnvironmentType.Conda?await r.showErrorMessage(p.Installer.noCondaOrPipInstaller,p.Installer.searchForHelp):await r.showErrorMessage(p.Installer.noPipInstaller,p.Installer.searchForHelp),"Search for help"===i){const e=this.serviceContainer.get(u.IPlatformService),t=e.isWindows?"Windows":e.isMac?"MacOS":"Linux";r.openUrl(`https://www.bing.com/search?q=Install Pip ${t} ${n.envType===c.EnvironmentType.Conda?"Conda":""}`)}}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],g),t.InstallationChannelManager=g},5181:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CondaInstaller=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(44773),l=n(81387),u=n(61684),p=n(3481),d=n(30135),h=n(59747);let f=class extends d.ModuleInstaller{constructor(e){super(e)}get name(){return"Conda"}get displayName(){return"Conda"}get type(){return l.ModuleInstallerType.Conda}get priority(){return 10}async isSupported(e){if(!1===this._isCondaAvailable)return!1;const t=this.serviceContainer.get(s.ICondaService);return this._isCondaAvailable=await t.isCondaAvailable(),!!this._isCondaAvailable&&this.isCurrentEnvironmentACondaEnvironment(e)}async getExecutionInfo(e,t,n=0){var r;const i=this.serviceContainer.get(s.ICondaService),o=await i.getCondaFile(!0),a=(0,p.isResource)(t)?this.serviceContainer.get(u.IConfigurationService).getSettings(t).pythonPath:null!==(r=(0,c.getEnvPath)(t.path,t.envPath).path)&&void 0!==r?r:"",l=this.serviceContainer.get(s.IComponentAdapter),f=await l.getCondaEnvironment(a),g=[n&h.ModuleInstallFlags.upgrade?"update":"install"];return[u.Product.tensorboard].map(d.translateProductToModule).includes(e)&&g.push("-c","conda-forge"),f&&f.name?(g.push("--name"),g.push(f.name.toCommandArgumentForPythonExt())):f&&f.path&&(g.push("--prefix"),g.push(f.path.fileToCommandArgumentForPythonExt())),n&h.ModuleInstallFlags.updateDependencies&&g.push("--update-deps"),n&h.ModuleInstallFlags.reInstall&&g.push("--force-reinstall"),g.push(e),g.push("-y"),{args:g,execPath:o,useShell:!0}}async isCurrentEnvironmentACondaEnvironment(e){var t;const n=this.serviceContainer.get(s.IComponentAdapter),r=(0,p.isResource)(e)?this.serviceContainer.get(u.IConfigurationService).getSettings(e).pythonPath:null!==(t=(0,c.getEnvPath)(e.path,e.envPath).path)&&void 0!==t?t:"";return n.isCondaEnvironment(r)}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],f),t.CondaInstaller=f},30135:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.translateProductToModule=t.ModuleInstaller=void 0;const i=n(86700),o=n(71017),s=n(66828),a=n(18639),c=n(19735),l=n(81387),u=n(54813),p=n(61522),d=n(17585),h=n(29979),f=n(84974),g=n(31776),m=n(29983),v=n(58400),y=n(61684),b=n(3481),S=n(92674);let E=class{constructor(e){this.serviceContainer=e}async installModule(e,t,n,r,i){const c=!(null==i?void 0:i.installAsProcess),m="string"==typeof e?e:_(e),v="string"==typeof e?m:S.ProductNames.get(e);(0,u.sendTelemetryEvent)(p.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:this.displayName,productName:v});const E=(0,b.isResource)(t)?t:void 0,w=await this.getExecutionInfo(m,t,r),T=async e=>{var n;const r=await this.processInstallArgs(w.args,t);if(w.moduleName){const i=this.serviceContainer.get(y.IConfigurationService).getSettings(E),s=this.serviceContainer.get(a.IInterpreterService),u=(0,b.isResource)(t)?await s.getActiveInterpreter(t):t,p=null!==(n=null==u?void 0:u.path)&&void 0!==n?n:i.pythonPath,d=(0,b.isResource)(t)?p:t.path,h=g.execModule(w.moduleName,r);if(u&&u.envType===l.EnvironmentType.Unknown)if(i.globalModuleInstallation){const n=this.serviceContainer.get(f.IFileSystem);await n.isDirReadonly(o.dirname(d)).catch((e=>!0))?this.elevatedInstall(d,h):await this.executeCommand(c,t,d,h,e,w.useShell)}else m===_(y.Product.pip)||l.virtualEnvTypes.includes(u.envType)?await this.executeCommand(c,t,d,h,e,w.useShell):await this.executeCommand(c,t,d,h.concat(["--user"]),e,w.useShell);else await this.executeCommand(c,t,d,h,e,w.useShell)}else await this.executeCommand(c,t,w.execPath,r,e,w.useShell)};if(n){const e=this.serviceContainer.get(d.IApplicationShell),t={location:s.ProgressLocation.Notification,cancellable:!0,title:s.l10n.t("Installing {0}",m)};await e.withProgress(t,(async(e,t)=>T((0,h.wrapCancellationTokens)(t,n))))}else await T(n)}elevatedInstall(e,t){const r=this.serviceContainer.get(y.ILogOutputChannel),i=`"${e.replace(/\\/g,"/")}" ${t.join(" ")}`;(0,c.traceLog)(`[Elevated] ${i}`),n(65425).exec(i,{name:"VS Code Python"},(async(e,t,n)=>{if(e){const t=this.serviceContainer.get(d.IApplicationShell);await t.showErrorMessage(e)}else r.show(),t&&(0,c.traceLog)(t),n&&(0,c.traceError)(`Warning: ${n}`)}))}async processInstallArgs(e,t){const n=e.findIndex((e=>"PYLINT"===e.toUpperCase()));if(-1===n)return e;const r=this.serviceContainer.get(a.IInterpreterService),i=(0,b.isResource)(t)?await r.getActiveInterpreter(t):t;if(i&&i.version&&2===i.version.major){const t=[...e];return t[n]='"pylint<2.0.0"',t}return e}async executeCommand(e,t,n,r,i,o){const s={};if((0,b.isResource)(t)?s.resource=t:s.interpreter=t,e)this.serviceContainer.get(v.ITerminalServiceFactory).getTerminalService(s).sendCommand(n,r,i);else{const e=this.serviceContainer.get(m.IProcessServiceFactory),t=await e.create(s.resource);if(o){const e=[n,...r].reduce(((e,t)=>e?`${e} ${t.toCommandArgumentForPythonExt()}`:`${t.toCommandArgumentForPythonExt()}`),"");await t.shellExec(e)}else await t.exec(n,r)}}};function _(e){switch(e){case y.Product.mypy:return"mypy";case y.Product.pylama:return"pylama";case y.Product.prospector:return"prospector";case y.Product.pylint:return"pylint";case y.Product.pytest:return"pytest";case y.Product.autopep8:return"autopep8";case y.Product.black:return"black";case y.Product.pycodestyle:return"pycodestyle";case y.Product.pydocstyle:return"pydocstyle";case y.Product.yapf:return"yapf";case y.Product.flake8:return"flake8";case y.Product.unittest:return"unittest";case y.Product.bandit:return"bandit";case y.Product.tensorboard:return"tensorboard";case y.Product.torchProfilerInstallName:return"torch-tb-profiler";case y.Product.torchProfilerImportName:return"torch_tb_profiler";case y.Product.pip:return"pip";case y.Product.ensurepip:return"ensurepip";case y.Product.python:return"python";default:throw new Error(`Product ${e} cannot be installed as a Python Module.`)}}E=r([(0,i.injectable)()],E),t.ModuleInstaller=E,t.translateProductToModule=_},22577:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PipEnvInstaller=t.pipenvName=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(37924),l=n(81387),u=n(17585),p=n(3481),d=n(30135),h=n(59747);t.pipenvName="pipenv";let f=class extends d.ModuleInstaller{get name(){return"pipenv"}get type(){return l.ModuleInstallerType.Pipenv}get displayName(){return t.pipenvName}get priority(){return 10}constructor(e){super(e)}async isSupported(e){if((0,p.isResource)(e)){const t=await this.serviceContainer.get(s.IInterpreterService).getActiveInterpreter(e),n=e?this.serviceContainer.get(u.IWorkspaceService).getWorkspaceFolder(e):void 0;return!(!t||!n||t.envType!==l.EnvironmentType.Pipenv)&&(0,c.isPipenvEnvironmentRelatedToFolder)(t.path,n.uri.fsPath)}return e.envType===l.EnvironmentType.Pipenv}async getExecutionInfo(e,n,r=0){return{args:[r&h.ModuleInstallFlags.reInstall||r&h.ModuleInstallFlags.updateDependencies||r&h.ModuleInstallFlags.upgrade?"update":"install",e,"--dev"],execPath:t.pipenvName}}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],f),t.PipEnvInstaller=f},36352:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PipInstaller=void 0;const o=n(86700),s=n(77498),a=n(81387),c=n(17585),l=n(29983),u=n(61684),p=n(3481),d=n(30135),h=n(59747),f=n(71017),g=n(48266),m=n(92674),v=n(54813),y=n(61522),b=n(18639),S=n(48431);let E=class extends d.ModuleInstaller{get name(){return"Pip"}get type(){return a.ModuleInstallerType.Pip}get displayName(){return"Pip"}get priority(){return 0}constructor(e){super(e)}async isSupported(e){return!1!==await async function(e,t){var n;const r=e.get(b.IInterpreterService),i=(0,p.isResource)(t)?await r.getActiveInterpreter(t):t;if(i)return!((null===(n=i.envPath)||void 0===n?void 0:n.length)&&i.envType===a.EnvironmentType.Conda&&!(0,S.isParentPath)(null==i?void 0:i.path,i.envPath))}(this.serviceContainer,e)&&this.isPipAvailable(e)}async getExecutionInfo(e,t,n=0){var r,i,o;if(e===(0,d.translateProductToModule)(u.Product.pip)){const e=(0,p.isResource)(t)?"":`${(null===(r=t.version)||void 0===r?void 0:r.major)||""}.${(null===(i=t.version)||void 0===i?void 0:i.minor)||""}.${(null===(o=t.version)||void 0===o?void 0:o.patch)||""}`,n=(0,p.isResource)(t)?void 0:t.envType;(0,v.sendTelemetryEvent)(y.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:"unavailable",requiredInstaller:a.ModuleInstallerType.Pip,productName:m.ProductNames.get(u.Product.pip),version:e,envType:n});const s=this.serviceContainer.get(u.IInstaller);if(await s.isInstalled(u.Product.ensurepip,t))return{args:[],moduleName:"ensurepip"};(0,v.sendTelemetryEvent)(y.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:"unavailable",requiredInstaller:a.ModuleInstallerType.Pip,productName:m.ProductNames.get(u.Product.ensurepip),version:e,envType:n});const c=this.serviceContainer.get(b.IInterpreterService),l=(0,p.isResource)(t)?await c.getActiveInterpreter(t):t;return{execPath:l?l.path:"python",args:[f.join(g._SCRIPTS_DIR,"get-pip.py")]}}const s=[],l=this.serviceContainer.get(c.IWorkspaceService).getConfiguration("http").get("proxy","");return l.length>0&&(s.push("--proxy"),s.push(l)),s.push("install","-U"),n&h.ModuleInstallFlags.reInstall&&s.push("--force-reinstall"),{args:[...s,e],moduleName:"pip"}}isPipAvailable(e){const t=this.serviceContainer.get(l.IPythonExecutionFactory),n=(0,p.isResource)(e)?e:void 0,r=(0,p.isResource)(e)?void 0:e.path;return t.create({resource:n,pythonPath:r}).then((e=>e.isModuleInstalled("pip"))).catch((()=>!1))}};E=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IServiceContainer))],E),t.PipInstaller=E},73300:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PoetryInstaller=t.poetryName=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(13298),l=n(81387),u=n(17585),p=n(61684),d=n(3481),h=n(30135);t.poetryName="poetry";let f=class extends h.ModuleInstaller{constructor(e,t,n){super(e),this.workspaceService=t,this.configurationService=n}get name(){return"poetry"}get type(){return l.ModuleInstallerType.Poetry}get displayName(){return t.poetryName}get priority(){return 10}async isSupported(e){if(!e)return!1;if(!(0,d.isResource)(e))return!1;const t=await this.serviceContainer.get(s.IInterpreterService).getActiveInterpreter(e),n=e?this.workspaceService.getWorkspaceFolder(e):void 0;return!(!t||!n||t.envType!==l.EnvironmentType.Poetry)&&(0,c.isPoetryEnvironmentRelatedToFolder)(t.path,n.uri.fsPath,this.configurationService.getSettings(e).poetryPath)}async getExecutionInfo(e,t){return{args:["add","--group","dev",e],execPath:this.configurationService.getSettings((0,d.isResource)(t)?t:void 0).poetryPath}}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer)),i(1,(0,o.inject)(u.IWorkspaceService)),i(2,(0,o.inject)(p.IConfigurationService))],f),t.PoetryInstaller=f},80819:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProductInstaller=t.PythonInstaller=t.DataScienceInstaller=t.TestFrameworkInstaller=t.LinterInstaller=t.FormatterInstaller=t.Product=void 0;const o=n(86700),s=n(81249),a=n(66828);n(32727);const c=n(18639),l=n(77498),u=n(81387),p=n(54813),d=n(61522),h=n(17585),f=n(77570),g=n(29983),m=n(61684),v=n(67098),y=n(3481),b=n(30135),S=n(92674),E=n(59747),_=n(19735),w=n(48431);var T=n(61684);Object.defineProperty(t,"Product",{enumerable:!0,get:function(){return T.Product}});const C=new Map([[m.Product.torchProfilerInstallName,new Set([u.EnvironmentType.Conda])]]);class P{constructor(e){this.serviceContainer=e,this.appShell=e.get(h.IApplicationShell),this.configService=e.get(m.IConfigurationService),this.workspaceService=e.get(h.IWorkspaceService),this.productService=e.get(E.IProductService),this.persistentStateFactory=e.get(m.IPersistentStateFactory)}promptToInstall(e,t,n,r){const i=t&&(0,y.isResource)(t)?this.workspaceService.getWorkspaceFolder(t):void 0,o=`${e}${i?i.uri.fsPath:""}`;if(P.PromptPromises.has(o))return P.PromptPromises.get(o);const s=this.promptToInstallImplementation(e,t,n,r);return P.PromptPromises.set(o,s),s.then((()=>P.PromptPromises.delete(o))).ignoreErrors(),s.catch((()=>P.PromptPromises.delete(o))).ignoreErrors(),s}async install(e,t,n,r,i){if(e===m.Product.unittest)return m.InstallerResponse.Installed;const o=this.serviceContainer.get(E.IInstallationChannelManager),s=await o.getInstallationChannel(e,t);return s?(await s.installModule(e,t,n,r,i).catch((t=>(0,_.traceError)(`Error in installing the product '${S.ProductNames.get(e)}', ${t}`))),this.isInstalled(e,t).then((t=>((0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:s.displayName,productName:S.ProductNames.get(e),isInstalled:t}),t?m.InstallerResponse.Installed:m.InstallerResponse.Ignore)))):((0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:"unavailable",productName:S.ProductNames.get(e)}),m.InstallerResponse.Ignore)}async isProductVersionCompatible(e,t,n){const r=await this.getProductSemVer(e,n);return r?s.satisfies(r,t)?m.ProductInstallStatus.Installed:m.ProductInstallStatus.NeedsUpgrade:m.ProductInstallStatus.NotInstalled}async getProductSemVer(e,t){const n=(0,y.isResource)(t)?void 0:t,r=(0,y.isResource)(t)?t:void 0,i=this.getExecutableNameFromSettings(e,r);let o;if(this.isExecutableAModule(e,r)){const e=await this.serviceContainer.get(g.IPythonExecutionFactory).createActivatedEnvironment({resource:r,interpreter:n,allowEnvironmentFetchExceptions:!0});o=await e.getModuleVersion(i)}else{const e=await this.serviceContainer.get(g.IProcessServiceFactory).create(r);o=(await e.exec(i,["--version"],{mergeStdOutErr:!0})).stdout.trim()}if(!o)return null;try{return s.coerce(o)}catch(t){return(0,_.traceError)(`Unable to parse version ${o} for product ${e}: `,t),null}}async isInstalled(e,t){if(e===m.Product.unittest)return!0;const n=(0,y.isResource)(t)?void 0:t,r=(0,y.isResource)(t)?t:void 0,i=this.getExecutableNameFromSettings(e,r);return this.isExecutableAModule(e,r)?(await this.serviceContainer.get(g.IPythonExecutionFactory).createActivatedEnvironment({resource:r,interpreter:n,allowEnvironmentFetchExceptions:!0})).isModuleInstalled(i):(await this.serviceContainer.get(g.IProcessServiceFactory).create(r)).exec(i,["--version"],{mergeStdOutErr:!0}).then((()=>!0)).catch((()=>!1))}getExecutableNameFromSettings(e,t){const n=this.productService.getProductType(e);return this.serviceContainer.get(E.IProductPathService,n).getExecutableNameFromSettings(e,t)}isExecutableAModule(e,t){const n=this.productService.getProductType(e);return this.serviceContainer.get(E.IProductPathService,n).isExecutableAModule(e,t)}}P.PromptPromises=new Map;class I extends P{async promptToInstallImplementation(e,t,n,r){const i=this.persistentStateFactory.createGlobalPersistentState("FORMATTER_NOT_INSTALLED_KEY",!1);if(i.value)return m.InstallerResponse.Ignore;const o=[m.Product.autopep8,m.Product.black,m.Product.yapf],s=o.map((e=>S.ProductNames.get(e))),c=S.ProductNames.get(e);s.splice(s.indexOf(c),1);const l=s.map((e=>a.l10n.t("Use {0}",e))),u=v.Common.bannerLabelYes,p=[...l,v.Common.doNotShowAgain];let d=a.l10n.t("Formatter {0} is not installed. Install?",c);if(this.isExecutableAModule(e,t))p.splice(0,0,u);else{const n=this.getExecutableNameFromSettings(e,t);d=a.l10n.t("Path to the {0} formatter is invalid ({1})",c,n)}const h=await this.appShell.showErrorMessage(d,...p);if(h===u)return this.install(e,t,n);if(h===v.Common.doNotShowAgain)return i.updateValue(!0),m.InstallerResponse.Ignore;if("string"==typeof h)for(const e of o){const r=S.ProductNames.get(e);if(h.endsWith(r))return await this.configService.updateSetting("formatting.provider",r,t),this.install(e,t,n)}return m.InstallerResponse.Ignore}}t.FormatterInstaller=I;class x extends P{constructor(e){super(e),this.serviceContainer=e}async promptToInstallImplementation(e,t,n,r){return this.oldPromptForInstallation(e,t,n)}getStoredResponse(e){return!0===this.serviceContainer.get(m.IPersistentStateFactory).createGlobalPersistentState(e,void 0).value}async oldPromptForInstallation(e,t,n){const r=S.ProductNames.get(e),{install:i}=v.Common,{doNotShowAgain:o}=v.Common,s=`${r}_DisableLinterInstallPrompt`,{selectLinter:c}=v.Linters;if(!0===this.getStoredResponse(s))return m.InstallerResponse.Ignore;const l=[c,o];let u=a.l10n.t("Linter {0} is not installed.",r);if(this.isExecutableAModule(e,t))l.splice(0,0,i);else{const n=this.getExecutableNameFromSettings(e,t);u=a.l10n.t("Path to the {0} linter is invalid ({1})",r,n)}const g=await this.appShell.showErrorMessage(u,...l);if(g===i)return(0,p.sendTelemetryEvent)(d.EventName.LINTER_NOT_INSTALLED_PROMPT,void 0,{tool:r,action:"install"}),this.install(e,t,n);if(g===o)return await this.setStoredResponse(s,!0),(0,p.sendTelemetryEvent)(d.EventName.LINTER_NOT_INSTALLED_PROMPT,void 0,{tool:r,action:"disablePrompt"}),m.InstallerResponse.Ignore;if(g===c){(0,p.sendTelemetryEvent)(d.EventName.LINTER_NOT_INSTALLED_PROMPT,void 0,{action:"select"});const e=this.serviceContainer.get(h.ICommandManager);await e.executeCommand(f.Commands.Set_Linter)}return m.InstallerResponse.Ignore}async setStoredResponse(e,t){const n=this.serviceContainer.get(m.IPersistentStateFactory).createGlobalPersistentState(e,void 0);n&&n.value!==t&&await n.updateValue(t)}}t.LinterInstaller=x;class O extends P{async promptToInstallImplementation(e,t,n,r){const i=S.ProductNames.get(e),o=[];let s=a.l10n.t("Test framework {0} is not installed. Install?",i);if(this.isExecutableAModule(e,t))o.push(v.Common.bannerLabelYes,v.Common.bannerLabelNo);else{const n=this.getExecutableNameFromSettings(e,t);s=a.l10n.t("Path to the {0} test framework is invalid ({1})",i,n)}return await this.appShell.showErrorMessage(s,...o)===v.Common.bannerLabelYes?this.install(e,t,n):m.InstallerResponse.Ignore}}t.TestFrameworkInstaller=O;class R extends P{async install(e,t,n,r){var i,o,s,c;if((0,y.isResource)(t))throw new Error("All data science packages require an interpreter be passed in");const l=t;let h=await this.serviceContainer.get(E.IInstallationChannelManager).getInstallationChannels(l);const f=(0,b.translateProductToModule)(e),g=`${(null===(i=l.version)||void 0===i?void 0:i.major)||""}.${(null===(o=l.version)||void 0===o?void 0:o.minor)||""}.${(null===(s=l.version)||void 0===s?void 0:s.patch)||""}`;if(r&&r&E.ModuleInstallFlags.installPipIfRequired&&l.envType!==u.EnvironmentType.Conda&&!h.some((e=>e.type===u.ModuleInstallerType.Pip))){const e=this.serviceContainer.getAll(E.IModuleInstaller).find((e=>e.type===u.ModuleInstallerType.Pip));e?((0,_.traceInfo)(`Installing pip as its not available to install ${f}.`),await e.installModule(m.Product.pip,l,n).catch((e=>(0,_.traceError)(`Error in installing the module '${f} as Pip could not be installed', ${e}`))),await this.isInstalled(m.Product.pip,l).then((t=>{(0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:e.displayName,requiredInstaller:u.ModuleInstallerType.Pip,version:g,envType:l.envType,isInstalled:t,productName:S.ProductNames.get(m.Product.pip)})})).catch(y.noop),h=await this.serviceContainer.get(E.IInstallationChannelManager).getInstallationChannels(l)):((0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:"unavailable",requiredInstaller:u.ModuleInstallerType.Pip,productName:S.ProductNames.get(m.Product.pip),version:g,envType:l.envType}),(0,_.traceError)("Unable to install pip when its required."))}const v=!(null===(c=C.get(e))||void 0===c?void 0:c.has(u.EnvironmentType.Conda));let w=u.ModuleInstallerType.Unknown;if(l.envType===u.EnvironmentType.Conda&&v)w=u.ModuleInstallerType.Conda;else if(l.envType!==u.EnvironmentType.Conda||v)switch(l.envType){case u.EnvironmentType.Pipenv:w=u.ModuleInstallerType.Pipenv;break;case u.EnvironmentType.Poetry:w=u.ModuleInstallerType.Poetry;break;default:w=u.ModuleInstallerType.Pip}else(0,_.traceInfo)(`Interpreter type is conda but package ${f} is not available through conda, using pip instead.`),w=u.ModuleInstallerType.Pip;const T=h.find((e=>e.type===w));return T?(await T.installModule(e,l,n,r).catch((e=>(0,_.traceError)(`Error in installing the module '${f}', ${e}`))),this.isInstalled(e,l).then((t=>((0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:T.displayName||"",requiredInstaller:w,version:g,envType:l.envType,isInstalled:t,productName:S.ProductNames.get(e)}),t?m.InstallerResponse.Installed:m.InstallerResponse.Ignore)))):(this.appShell.showErrorMessage(a.l10n.t("Could not install {0}. If pip is not available, please use the package manager of your choice to manually install this library into your Python environment.",f)).then(y.noop,y.noop),(0,p.sendTelemetryEvent)(d.EventName.PYTHON_INSTALL_PACKAGE,void 0,{installer:"unavailable",requiredInstaller:w,productName:S.ProductNames.get(e),version:g,envType:l.envType}),m.InstallerResponse.Ignore)}async promptToInstallImplementation(e,t,n,r){const i=S.ProductNames.get(e);return await this.appShell.showErrorMessage(a.l10n.t("Data Science library {0} is not installed. Install?",i),v.Common.bannerLabelYes,v.Common.bannerLabelNo)===v.Common.bannerLabelYes?this.install(e,t,n):m.InstallerResponse.Ignore}}t.DataScienceInstaller=R;let D=class{constructor(e){this.serviceContainer=e}async isInstalled(e,t){var n;if(e!==m.Product.python)throw new Error(`${e} cannot be installed via conda python installer`);const r=this.serviceContainer.get(c.IInterpreterService),i=(0,y.isResource)(t)?await r.getActiveInterpreter(t):t;return!i||!((null===(n=i.envPath)||void 0===n?void 0:n.length)&&i.envType===u.EnvironmentType.Conda&&!(0,w.isParentPath)(null==i?void 0:i.path,i.envPath))}async install(e,t,n,r){if(e!==m.Product.python)throw new Error(`${e} cannot be installed via python installer`);const i=this.serviceContainer.getAll(E.IModuleInstaller).find((e=>e.type===u.ModuleInstallerType.Conda));if(!i||!await i.isSupported(t))return(0,_.traceError)("Conda installer not available for installing python in the given environment"),m.InstallerResponse.Ignore;const o=(0,b.translateProductToModule)(e);return await i.installModule(m.Product.python,t,void 0,void 0,{installAsProcess:!0}).catch((e=>(0,_.traceError)(`Error in installing the module '${o}', ${e}`))),this.isInstalled(e,t).then((e=>e?m.InstallerResponse.Installed:m.InstallerResponse.Ignore))}async promptToInstall(e,t,n,r){return m.InstallerResponse.Ignore}async isProductVersionCompatible(e,t,n){return m.ProductInstallStatus.Installed}};D=r([i(0,(0,o.inject)(l.IServiceContainer))],D),t.PythonInstaller=D;let A=class{constructor(e){this.serviceContainer=e,this.productService=e.get(E.IProductService),this.interpreterService=this.serviceContainer.get(c.IInterpreterService)}dispose(){}async promptToInstall(e,t,n,r){return((0,y.isResource)(t)?await this.interpreterService.getActiveInterpreter(t):t)?this.createInstaller(e).promptToInstall(e,t,n,r):m.InstallerResponse.Ignore}async isProductVersionCompatible(e,t,n){return this.createInstaller(e).isProductVersionCompatible(e,t,n)}async install(e,t,n,r,i){return this.createInstaller(e).install(e,t,n,r,i)}async isInstalled(e,t){return this.createInstaller(e).isInstalled(e,t)}translateProductToModuleName(e){return(0,b.translateProductToModule)(e)}createInstaller(e){switch(this.productService.getProductType(e)){case m.ProductType.Formatter:return new I(this.serviceContainer);case m.ProductType.Linter:return new x(this.serviceContainer);case m.ProductType.TestFramework:return new O(this.serviceContainer);case m.ProductType.DataScience:return new R(this.serviceContainer);case m.ProductType.Python:return new D(this.serviceContainer)}throw new Error(`Unknown product ${e}`)}};A=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IServiceContainer))],A),t.ProductInstaller=A},92674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductNames=void 0;const r=n(61684);t.ProductNames=new Map,t.ProductNames.set(r.Product.autopep8,"autopep8"),t.ProductNames.set(r.Product.bandit,"bandit"),t.ProductNames.set(r.Product.black,"black"),t.ProductNames.set(r.Product.flake8,"flake8"),t.ProductNames.set(r.Product.mypy,"mypy"),t.ProductNames.set(r.Product.pycodestyle,"pycodestyle"),t.ProductNames.set(r.Product.pylama,"pylama"),t.ProductNames.set(r.Product.prospector,"prospector"),t.ProductNames.set(r.Product.pydocstyle,"pydocstyle"),t.ProductNames.set(r.Product.pylint,"pylint"),t.ProductNames.set(r.Product.pytest,"pytest"),t.ProductNames.set(r.Product.yapf,"yapf"),t.ProductNames.set(r.Product.tensorboard,"tensorboard"),t.ProductNames.set(r.Product.torchProfilerInstallName,"torch-tb-profiler"),t.ProductNames.set(r.Product.torchProfilerImportName,"torch_tb_profiler"),t.ProductNames.set(r.Product.pip,"pip"),t.ProductNames.set(r.Product.ensurepip,"ensurepip")},43942:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataScienceProductPathService=t.TestFrameworkProductPathService=t.LinterProductPathService=t.FormatterProductPathService=t.BaseProductPathsService=void 0;const o=n(86700),s=n(71017),a=n(44263),c=n(77498),l=n(62964),u=n(40704),p=n(61684);let d=class{constructor(e){this.serviceContainer=e,this.configService=e.get(p.IConfigurationService),this.productInstaller=e.get(p.IInstaller)}isExecutableAModule(e,t){let n;try{n=this.productInstaller.translateProductToModuleName(e)}catch(e){}const r=this.getExecutableNameFromSettings(e,t);return"string"==typeof n&&n.length>0&&s.basename(r)===r}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],d),t.BaseProductPathsService=d;let h=class extends d{constructor(e){super(e)}getExecutableNameFromSettings(e,t){const n=this.configService.getSettings(t),r=this.serviceContainer.get(a.IFormatterHelper).getSettingsPropertyNames(e);return n.formatting[r.pathName]}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],h),t.FormatterProductPathService=h;let f=class extends d{constructor(e){super(e)}getExecutableNameFromSettings(e,t){return this.serviceContainer.get(l.ILinterManager).getLinterInfo(e).pathName(t)}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],f),t.LinterProductPathService=f;let g=class extends d{constructor(e){super(e)}getExecutableNameFromSettings(e,t){const n=this.serviceContainer.get(u.ITestingService).getSettingsPropertyNames(e);return n.pathName?this.configService.getSettings(t).testing[n.pathName]:this.productInstaller.translateProductToModuleName(e)}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],g),t.TestFrameworkProductPathService=g;let m=class extends d{constructor(e){super(e)}getExecutableNameFromSettings(e,t){return this.productInstaller.translateProductToModuleName(e)}};m=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],m),t.DataScienceProductPathService=m},23202:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ProductService=void 0;const i=n(86700),o=n(61684);let s=class{constructor(){this.ProductTypes=new Map,this.ProductTypes.set(o.Product.bandit,o.ProductType.Linter),this.ProductTypes.set(o.Product.flake8,o.ProductType.Linter),this.ProductTypes.set(o.Product.mypy,o.ProductType.Linter),this.ProductTypes.set(o.Product.pycodestyle,o.ProductType.Linter),this.ProductTypes.set(o.Product.prospector,o.ProductType.Linter),this.ProductTypes.set(o.Product.pydocstyle,o.ProductType.Linter),this.ProductTypes.set(o.Product.pylama,o.ProductType.Linter),this.ProductTypes.set(o.Product.pylint,o.ProductType.Linter),this.ProductTypes.set(o.Product.pytest,o.ProductType.TestFramework),this.ProductTypes.set(o.Product.unittest,o.ProductType.TestFramework),this.ProductTypes.set(o.Product.autopep8,o.ProductType.Formatter),this.ProductTypes.set(o.Product.black,o.ProductType.Formatter),this.ProductTypes.set(o.Product.yapf,o.ProductType.Formatter),this.ProductTypes.set(o.Product.tensorboard,o.ProductType.DataScience),this.ProductTypes.set(o.Product.torchProfilerInstallName,o.ProductType.DataScience),this.ProductTypes.set(o.Product.torchProfilerImportName,o.ProductType.DataScience),this.ProductTypes.set(o.Product.pip,o.ProductType.DataScience),this.ProductTypes.set(o.Product.ensurepip,o.ProductType.DataScience),this.ProductTypes.set(o.Product.python,o.ProductType.Python)}getProductType(e){return this.ProductTypes.get(e)}};s=r([(0,i.injectable)()],s),t.ProductService=s},34061:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(61684),i=n(95939),o=n(5181),s=n(22577),a=n(36352),c=n(73300),l=n(43942),u=n(23202),p=n(59747);t.registerTypes=function(e){e.addSingleton(p.IModuleInstaller,o.CondaInstaller),e.addSingleton(p.IModuleInstaller,a.PipInstaller),e.addSingleton(p.IModuleInstaller,s.PipEnvInstaller),e.addSingleton(p.IModuleInstaller,c.PoetryInstaller),e.addSingleton(p.IInstallationChannelManager,i.InstallationChannelManager),e.addSingleton(p.IProductService,u.ProductService),e.addSingleton(p.IProductPathService,l.FormatterProductPathService,r.ProductType.Formatter),e.addSingleton(p.IProductPathService,l.LinterProductPathService,r.ProductType.Linter),e.addSingleton(p.IProductPathService,l.TestFrameworkProductPathService,r.ProductType.TestFramework),e.addSingleton(p.IProductPathService,l.DataScienceProductPathService,r.ProductType.DataScience)}},59747:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleInstallFlags=t.IProductPathService=t.IProductService=t.IInstallationChannelManager=t.IPythonInstallation=t.IBaseInstaller=t.IModuleInstaller=void 0,t.IModuleInstaller=Symbol("IModuleInstaller"),t.IBaseInstaller=Symbol("IBaseInstaller"),t.IPythonInstallation=Symbol("IPythonInstallation"),t.IInstallationChannelManager=Symbol("IInstallationChannelManager"),t.IProductService=Symbol("IProductService"),t.IProductPathService=Symbol("IProductPathService"),(n=t.ModuleInstallFlags||(t.ModuleInstallFlags={}))[n.upgrade=1]="upgrade",n[n.updateDependencies=2]="updateDependencies",n[n.reInstall=4]="reInstall",n[n.installPipIfRequired=8]="installPipIfRequired"},97469:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterPathService=t.getCIPythonPath=t.defaultInterpreterPathSetting=t.isRemoteGlobalSettingCopiedKey=t.remoteWorkspaceFolderKeysForWhichTheCopyIsDone_Key=t.remoteWorkspaceKeysForWhichTheCopyIsDone_Key=void 0;const o=n(55674),s=n(86700),a=n(66828),c=n(19735),l=n(17585),u=n(89515),p=n(77570),d=n(48431),h=n(61684),f=n(48683);t.remoteWorkspaceKeysForWhichTheCopyIsDone_Key="remoteWorkspaceKeysForWhichTheCopyIsDone_Key",t.remoteWorkspaceFolderKeysForWhichTheCopyIsDone_Key="remoteWorkspaceFolderKeysForWhichTheCopyIsDone_Key",t.isRemoteGlobalSettingCopiedKey="isRemoteGlobalSettingCopiedKey",t.defaultInterpreterPathSetting="defaultInterpreterPath";const g=m();function m(){return process.env.CI_PYTHON_PATH&&o.existsSync(process.env.CI_PYTHON_PATH)?process.env.CI_PYTHON_PATH:"python"}t.getCIPythonPath=m;let v=class{constructor(e,t,n,r){this.persistentStateFactory=e,this.workspaceService=t,this.appEnvironment=r,this._didChangeInterpreterEmitter=new a.EventEmitter,n.push(this.workspaceService.onDidChangeConfiguration(this.onDidChangeConfiguration.bind(this))),this.fileSystemPaths=d.FileSystemPaths.withDefaults()}get onDidChange(){return this._didChangeInterpreterEmitter.event}async onDidChangeConfiguration(e){e.affectsConfiguration(`python.${t.defaultInterpreterPathSetting}`)&&(this._didChangeInterpreterEmitter.fire({uri:void 0,configTarget:a.ConfigurationTarget.Global}),(0,c.traceVerbose)("Interpreter Path updated",`python.${t.defaultInterpreterPathSetting}`))}inspect(e,t=!1){var n,r;let i,o;(e=u.PythonSettings.getSettingsUriAndTarget(e,this.workspaceService).uri)&&(i=this.persistentStateFactory.createGlobalPersistentState(this.getSettingKey(e,a.ConfigurationTarget.WorkspaceFolder,t),void 0),o=this.persistentStateFactory.createGlobalPersistentState(this.getSettingKey(e,a.ConfigurationTarget.Workspace,t),void 0));const s=null!==(r=null===(n=this.workspaceService.getConfiguration("python",e))||void 0===n?void 0:n.inspect("defaultInterpreterPath"))&&void 0!==r?r:{};return{globalValue:s.globalValue,workspaceFolderValue:(null==i?void 0:i.value)&&"python"!==(null==i?void 0:i.value)?i.value:s.workspaceFolderValue,workspaceValue:(null==o?void 0:o.value)&&"python"!==(null==o?void 0:o.value)?o.value:s.workspaceValue}}get(e){var t;const n=this.inspect(e),r=n.workspaceFolderValue||n.workspaceValue||n.globalValue||((0,p.isTestExecution)()?g:"python");return new f.SystemVariables(void 0,null===(t=this.workspaceService.getWorkspaceFolder(e))||void 0===t?void 0:t.uri.fsPath,this.workspaceService).resolveAny(r)}async update(e,t,n){if(e=u.PythonSettings.getSettingsUriAndTarget(e,this.workspaceService).uri,t===a.ConfigurationTarget.Global){const e=this.workspaceService.getConfiguration("python");return void(e.inspect("defaultInterpreterPath").globalValue!==n&&await e.update("defaultInterpreterPath",n,!0))}if(!e)return void(0,c.traceError)("Cannot update workspace settings as no workspace is opened");const r=this.getSettingKey(e,t),i=this.persistentStateFactory.createGlobalPersistentState(r,void 0);i.value!==n&&(await i.updateValue(n),this._didChangeInterpreterEmitter.fire({uri:e,configTarget:t}),(0,c.traceVerbose)("Interpreter Path updated",r,n))}getSettingKey(e,t,n=!1){let r;const i=this.workspaceService.getWorkspaceFolderIdentifier(e);return r=t===a.ConfigurationTarget.WorkspaceFolder?`WORKSPACE_FOLDER_INTERPRETER_PATH_${i}`:this.workspaceService.workspaceFile?`WORKSPACE_INTERPRETER_PATH_${this.fileSystemPaths.normCase(this.workspaceService.workspaceFile.fsPath)}`:`WORKSPACE_FOLDER_INTERPRETER_PATH_${i}`,!n&&this.appEnvironment.remoteName?`${this.appEnvironment.remoteName}_${r}`:r}async copyOldInterpreterStorageValuesToNew(e){e=u.PythonSettings.getSettingsUriAndTarget(e,this.workspaceService).uri;const t=this.inspect(e,!0);await Promise.all([this._copyWorkspaceFolderValueToNewStorage(e,t.workspaceFolderValue),this._copyWorkspaceValueToNewStorage(e,t.workspaceValue),this._moveGlobalSettingValueToNewStorage(t.globalValue)])}async _copyWorkspaceFolderValueToNewStorage(e,n){const r=this.workspaceService.getWorkspaceFolderIdentifier(e,"");if(""===r)return;const i=this.persistentStateFactory.createGlobalPersistentState(t.remoteWorkspaceFolderKeysForWhichTheCopyIsDone_Key,[]),o=i.value;!o.includes(r)&&(await this.update(e,a.ConfigurationTarget.WorkspaceFolder,n),await i.updateValue([r,...o]))}async _copyWorkspaceValueToNewStorage(e,n){const r=this.workspaceService.workspaceFile?this.fileSystemPaths.normCase(this.workspaceService.workspaceFile.fsPath):void 0;if(!r)return;const i=this.persistentStateFactory.createGlobalPersistentState(t.remoteWorkspaceKeysForWhichTheCopyIsDone_Key,[]),o=i.value;!o.includes(r)&&(await this.update(e,a.ConfigurationTarget.Workspace,n),await i.updateValue([r,...o]))}async _moveGlobalSettingValueToNewStorage(e){const n=this.persistentStateFactory.createGlobalPersistentState(t.isRemoteGlobalSettingCopiedKey,!1);!n.value&&(await this.update(void 0,a.ConfigurationTarget.Global,e),await n.updateValue(!0))}};v=r([(0,s.injectable)(),i(0,(0,s.inject)(h.IPersistentStateFactory)),i(1,(0,s.inject)(l.IWorkspaceService)),i(2,(0,s.inject)(h.IDisposableRegistry)),i(3,(0,s.inject)(l.IApplicationEnvironment))],v),t.InterpreterPathService=v},21621:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserService=t.launch=void 0;const i=n(86700),o=n(66828);function s(e){o.env.openExternal(o.Uri.parse(e))}t.launch=s;let a=class{launch(e){s(e)}};a=r([(0,i.injectable)()],a),t.BrowserService=a},73766:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalStorage=t.PersistentStateFactory=t.WORKSPACE_PERSISTENT_KEYS_DEPRECATED=t.GLOBAL_PERSISTENT_KEYS_DEPRECATED=t.PersistentState=void 0;const o=n(86700),s=n(19735),a=n(17585),c=n(77570),l=n(61684),u=n(36952),p=n(3481);class d{constructor(e,t,n,r){this.storage=e,this.key=t,this.defaultValue=n,this.expiryDurationMs=r}get value(){if(this.expiryDurationMs){const e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}return this.storage.get(this.key,this.defaultValue)}async updateValue(e,t=!0){try{this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e),t&&JSON.stringify(this.value)!=JSON.stringify(e)&&((0,s.traceVerbose)("Storage update failed for key",this.key," retrying by resetting first"),await this.updateValue(void 0,!1),await this.updateValue(e,!1),JSON.stringify(this.value)!=JSON.stringify(e)&&(0,s.traceWarn)("Retry failed, storage update failed for key",this.key))}catch(e){(0,s.traceError)("Error while updating storage for key:",this.key,e)}}}t.PersistentState=d,t.GLOBAL_PERSISTENT_KEYS_DEPRECATED="PYTHON_EXTENSION_GLOBAL_STORAGE_KEYS",t.WORKSPACE_PERSISTENT_KEYS_DEPRECATED="PYTHON_EXTENSION_WORKSPACE_STORAGE_KEYS";const h="PYTHON_GLOBAL_STORAGE_KEYS";let f=class{constructor(e,t,n){this.globalState=e,this.workspaceState=t,this.cmdManager=n,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this._globalKeysStorage=new d(this.globalState,h,[]),this._workspaceKeysStorage=new d(this.workspaceState,"PYTHON_WORKSPACE_STORAGE_KEYS",[])}async activate(){var e;null===(e=this.cmdManager)||void 0===e||e.registerCommand(c.Commands.ClearStorage,this.cleanAllPersistentStates.bind(this));const n=this.createGlobalPersistentState(t.GLOBAL_PERSISTENT_KEYS_DEPRECATED,[]),r=this.createWorkspacePersistentState(t.WORKSPACE_PERSISTENT_KEYS_DEPRECATED,[]);n.value.length>0&&n.updateValue([]).ignoreErrors(),r.value.length>0&&r.updateValue([]).ignoreErrors()}createGlobalPersistentState(e,t,n){return this.addKeyToStorage("global",e,t).ignoreErrors(),new d(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return this.addKeyToStorage("workspace",e,t).ignoreErrors(),new d(this.workspaceState,e,t,n)}async addKeyToStorage(e,t,n){const r="global"===e?this._globalKeysStorage:this._workspaceKeysStorage;r.value.find((e=>e.key===t))||await r.updateValue([{key:t,defaultValue:n},...r.value])}async cleanAllPersistentStates(){var e;await Promise.all(this._globalKeysStorage.value.map((async e=>{const t=this.createGlobalPersistentState(e.key);await t.updateValue(e.defaultValue)}))),await Promise.all(this._workspaceKeysStorage.value.map((async e=>{const t=this.createWorkspacePersistentState(e.key);await t.updateValue(e.defaultValue)}))),await this._globalKeysStorage.updateValue([]),await this._workspaceKeysStorage.updateValue([]),null===(e=this.cmdManager)||void 0===e||e.executeCommand("workbench.action.reloadWindow").then(p.noop)}};r([(0,u.cache)(-1,!0)],f.prototype,"addKeyToStorage",null),f=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IMemento)),i(0,(0,o.named)(l.GLOBAL_MEMENTO)),i(1,(0,o.inject)(l.IMemento)),i(1,(0,o.named)(l.WORKSPACE_MEMENTO)),i(2,(0,o.inject)(a.ICommandManager))],f),t.PersistentStateFactory=f,t.getGlobalStorage=function(e,t,n){const r=new d(e.globalState,h,[]);if(!r.value.find((e=>e.key===t))){const e=[{key:t,defaultValue:n},...r.value];r.updateValue(e).ignoreErrors()}const i=new d(e.globalState,t,n);return{get:()=>i.value,set:e=>i.updateValue(e)}}},95311:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNoPermissionsError=t.isNotDirError=t.isFileIsDirError=t.isFileExistsError=t.isFileNotFoundError=t.createDirNotEmptyError=void 0;const r=n(66828);var i;function o(e,t){const n=e.code;if(n)return n===t}!function(e){const t=r.FileSystemError.FileNotFound().name,n=r.FileSystemError.FileExists().name,i=r.FileSystemError.FileIsADirectory().name,o=r.FileSystemError.FileNotADirectory().name,s=r.FileSystemError.NoPermissions().name,a=[t,n,i,o,s];function c(e,t){if(a.includes(e.name))return e.name===t}e.isFileNotFound=function(e){return c(e,t)},e.isFileExists=function(e){return c(e,n)},e.isFileIsDir=function(e){return c(e,i)},e.isNotDir=function(e){return c(e,o)},e.isNoPermissions=function(e){return c(e,s)}}(i||(i={})),t.createDirNotEmptyError=function(e){const t=new Error(`directory "${e}" not empty`);return t.name="SystemError",t.code="ENOTEMPTY",t.path=e,t.syscall="rmdir",t},t.isFileNotFoundError=function(e){const t=e,n=i.isFileNotFound(t);return void 0!==n?n:o(t,"ENOENT")},t.isFileExistsError=function(e){const t=e,n=i.isFileExists(t);return void 0!==n?n:o(t,"EEXIST")},t.isFileIsDirError=function(e){const t=i.isFileIsDir(e);return void 0!==t?t:o(e,"EISDIR")},t.isNotDirError=function(e){const t=i.isNotDir(e);return void 0!==t?t:o(e,"ENOTDIR")},t.isNoPermissionsError=function(e){const t=e,n=i.isNoPermissions(t);return void 0!==n?n:o(t,"EACCES")}},90209:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystem=t.getHashString=t.FileSystemUtils=t.RawFileSystem=t.convertStat=void 0;const i=n(6113),o=n(55674),s=n(12884),a=n(86700),c=n(73837),l=n(66828),u=n(19735);n(32727);const p=n(56091),d=n(95311),h=n(48431),f=n(22512),g=n(84974),m="utf8";function v(e,t){return{type:t,size:e.size,ctime:Math.round(e.ctimeMs),mtime:Math.round(e.mtimeMs)}}function y(e,t){return t===g.FileType.Unknown?e.filter((([e,t])=>t===g.FileType.Unknown||t===(g.FileType.SymbolicLink&g.FileType.Unknown))):e.filter((([e,n])=>(n&t)>0))}t.convertStat=v;class b{constructor(e,t,n){this.paths=e,this.vscfs=t,this.fsExtra=n}static withDefaults(e,t,n){return new b(e||h.FileSystemPaths.withDefaults(),t||l.workspace.fs,n||o)}async pathExists(e){return this.fsExtra.pathExists(e)}async stat(e){const t=l.Uri.file(e);return this.vscfs.stat(t)}async lstat(e){const t=await this.fsExtra.lstat(e);return v(t,(0,p.convertFileType)(t))}async chmod(e,t){return this.fsExtra.chmod(e,t)}async move(e,t){const n=l.Uri.file(e),r=l.Uri.file(t);await this.vscfs.stat(l.Uri.file(this.paths.dirname(t)));const i={overwrite:!1};try{await this.vscfs.rename(n,r,i)}catch(e){if(!(0,d.isFileExistsError)(e))throw e;if((await this.vscfs.stat(r)).type===g.FileType.Directory)throw e;i.overwrite=!0,await this.vscfs.rename(n,r,i)}}async readData(e){const t=l.Uri.file(e),n=await this.vscfs.readFile(t);return Buffer.from(n)}async readText(e){const t=l.Uri.file(e),n=await this.vscfs.readFile(t);return Buffer.from(n).toString(m)}async writeText(e,t){const n=l.Uri.file(e),r=Buffer.from(t);await this.vscfs.writeFile(n,r)}async appendText(e,t){return this.fsExtra.appendFile(e,t)}async copyFile(e,t){const n=l.Uri.file(e),r=l.Uri.file(t);await this.vscfs.stat(l.Uri.file(this.paths.dirname(t))),await this.vscfs.copy(n,r,{overwrite:!0})}async rmfile(e){const t=l.Uri.file(e);return this.vscfs.delete(t,{recursive:!1,useTrash:!1})}async rmdir(e){const t=l.Uri.file(e),n=await this.vscfs.readDirectory(t);if(n&&n.length>0)throw(0,d.createDirNotEmptyError)(e);return this.vscfs.delete(t,{recursive:!0,useTrash:!1})}async rmtree(e){const t=l.Uri.file(e);return await this.vscfs.stat(t),this.vscfs.delete(t,{recursive:!0,useTrash:!1})}async mkdirp(e){const t=l.Uri.file(e);await this.vscfs.createDirectory(t)}async listdir(e){const t=l.Uri.file(e);return(await this.vscfs.readDirectory(t)).map((([t,n])=>[this.paths.join(e,t),n]))}statSync(e){let t=this.fsExtra.lstatSync(e),n=g.FileType.Unknown;return t.isSymbolicLink()&&(n=g.FileType.SymbolicLink,t=this.fsExtra.statSync(e)),n|=(0,p.convertFileType)(t),v(t,n)}readTextSync(e){return this.fsExtra.readFileSync(e,m)}createReadStream(e){return this.fsExtra.createReadStream(e)}createWriteStream(e){return this.fsExtra.createWriteStream(e)}}t.RawFileSystem=b;class S{constructor(e,t,n,r,i,o){this.raw=e,this.pathUtils=t,this.paths=n,this.tmp=r,this.getHash=i,this.globFiles=o}static withDefaults(e,t,n,r,i){return t=t||h.FileSystemPathUtils.withDefaults(),new S(e||b.withDefaults(t.paths),t,t.paths,n||f.TemporaryFileSystem.withDefaults(),r||E,i||(0,c.promisify)(s))}async createDirectory(e){return this.raw.mkdirp(e)}async deleteDirectory(e){return this.raw.rmdir(e)}async deleteFile(e){return this.raw.rmfile(e)}async pathExists(e,t){if(void 0===t)return this.raw.pathExists(e);let n;try{n=await this.raw.stat(e)}catch(t){return(0,d.isFileNotFoundError)(t)||(0,u.traceError)(`stat() failed for "${e}"`,t),!1}return t===g.FileType.Unknown?n.type===g.FileType.Unknown:(n.type&t)===t}async fileExists(e){return this.pathExists(e,g.FileType.File)}async directoryExists(e){return this.pathExists(e,g.FileType.Directory)}async listdir(e){try{return await this.raw.listdir(e)}catch(t){if(!await this.pathExists(e))return[];throw t}}async getSubDirectories(e){return y(await this.listdir(e),g.FileType.Directory).map((([e,t])=>e))}async getFiles(e){return y(await this.listdir(e),g.FileType.File).map((([e,t])=>e))}async isDirReadonly(e){const t=`${e}${this.paths.sep}___vscpTest___`;try{await this.raw.stat(e),await this.raw.writeText(t,"")}catch(e){if((0,d.isNoPermissionsError)(e))return!0;throw e}return this.raw.rmfile(t).ignoreErrors(),!1}async getFileHash(e){const t=await this.raw.lstat(e),n=`${t.ctime}-${t.mtime}`;return this.getHash(n)}async search(e,t,n){let r;t&&(r={...r,cwd:t}),n&&(r={...r,dot:n});const i=await this.globFiles(e,r);return Array.isArray(i)?i:[]}fileExistsSync(e){try{this.raw.statSync(e)}catch(e){if((0,d.isFileNotFoundError)(e))return!1;throw e}return!0}}function E(e){const t=(0,i.createHash)("sha512");return t.update(e),t.digest("hex")}t.FileSystemUtils=S,t.getHashString=E;let _=class{constructor(){this.utils=S.withDefaults()}get directorySeparatorChar(){return this.utils.paths.sep}arePathsSame(e,t){return this.utils.pathUtils.arePathsSame(e,t)}getDisplayName(e){return this.utils.pathUtils.getDisplayName(e)}async stat(e){return this.utils.raw.stat(e)}async createDirectory(e){return this.utils.createDirectory(e)}async deleteDirectory(e){return this.utils.deleteDirectory(e)}async listdir(e){return this.utils.listdir(e)}async readFile(e){return this.utils.raw.readText(e)}async readData(e){return this.utils.raw.readData(e)}async writeFile(e,t){return this.utils.raw.writeText(e,t)}async appendFile(e,t){return this.utils.raw.appendText(e,t)}async copyFile(e,t){return this.utils.raw.copyFile(e,t)}async deleteFile(e){return this.utils.deleteFile(e)}async chmod(e,t){return this.utils.raw.chmod(e,t)}async move(e,t){await this.utils.raw.move(e,t)}readFileSync(e){return this.utils.raw.readTextSync(e)}createReadStream(e){return this.utils.raw.createReadStream(e)}createWriteStream(e){return this.utils.raw.createWriteStream(e)}async fileExists(e){return this.utils.fileExists(e)}pathExists(e){return this.utils.pathExists(e)}fileExistsSync(e){return this.utils.fileExistsSync(e)}async directoryExists(e){return this.utils.directoryExists(e)}async getSubDirectories(e){return this.utils.getSubDirectories(e)}async getFiles(e){return this.utils.getFiles(e)}async getFileHash(e){return this.utils.getFileHash(e)}async search(e,t,n){return this.utils.search(e,t,n)}async createTemporaryFile(e,t){return this.utils.tmp.createFile(e,t)}async isDirReadonly(e){return this.utils.isDirReadonly(e)}};_=r([(0,a.injectable)()],_),t.FileSystem=_},88409:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchLocationForPattern=t.FileChangeType=void 0;const r=n(66828),i=n(19735),o=n(81837);var s;!function(e){e.Changed="changed",e.Created="created",e.Deleted="deleted"}(s=t.FileChangeType||(t.FileChangeType={})),t.watchLocationForPattern=function(e,t,n){const a=new r.RelativePattern(e,t),c=new o.Disposables;(0,i.traceVerbose)(`Start watching: ${e} with pattern ${t} using VSCode API`);const l=r.workspace.createFileSystemWatcher(a);return c.push(l.onDidCreate((e=>n(s.Created,e.fsPath)))),c.push(l.onDidChange((e=>n(s.Changed,e.fsPath)))),c.push(l.onDidDelete((e=>n(s.Deleted,e.fsPath)))),c}},48431:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arePathsSame=t.isParentPath=t.normCase=t.normCasePath=t.FileSystemPathUtils=t.Executables=t.FileSystemPaths=void 0;const r=n(71017),i=n(47237),o=n(87450),s=n(58967);class a{constructor(e,t){this.isCaseInsensitive=e,this.raw=t}static withDefaults(e){return void 0===e&&(e=(0,o.getOSType)()===o.OSType.Windows),new a(e,r)}get sep(){return this.raw.sep}join(...e){return this.raw.join(...e)}dirname(e){return this.raw.dirname(e)}basename(e,t){return this.raw.basename(e,t)}normalize(e){return this.raw.normalize(e)}normCase(e){return e=this.raw.normalize(e),this.isCaseInsensitive?e.toUpperCase():e}}t.FileSystemPaths=a;class c{constructor(e,t){this.delimiter=e,this.osType=t}static withDefaults(){return new c(r.delimiter,(0,o.getOSType)())}get envVar(){return(0,i.getSearchPathEnvVarNames)(this.osType)[0]}}t.Executables=c;class l{constructor(e,t,n,r){this.home=e,this.paths=t,this.executables=n,this.raw=r}static withDefaults(e){return void 0===e&&(e=a.withDefaults()),new l(s("~"),e,c.withDefaults(),r)}arePathsSame(e,t){return(e=this.paths.normCase(e))===this.paths.normCase(t)}getDisplayName(e,t){return t&&d(e,t)?`.${this.paths.sep}${this.raw.relative(t,e)}`:d(e,this.home)?`~${this.paths.sep}${this.raw.relative(this.home,e)}`:e}}function u(e){return p(r.normalize(e))}function p(e){return(0,o.getOSType)()===o.OSType.Windows?e.toUpperCase():e}function d(e,t){return t.endsWith(r.sep)||(t+=r.sep),e.endsWith(r.sep)||(e+=r.sep),u(e).startsWith(u(t))}t.FileSystemPathUtils=l,t.normCasePath=u,t.normCase=p,t.isParentPath=d,t.arePathsSame=function(e,t){return u(e)===u(t)}},22512:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TemporaryFileSystem=void 0;const r=n(36276);class i{constructor(e){this.raw=e}static withDefaults(){return new i(r)}createFile(e,t){const n={postfix:e,mode:t};return new Promise(((e,t)=>{this.raw.file(n,((n,r,i,o)=>{if(n)return t(n);e({filePath:r,dispose:o})}))}))}}t.TemporaryFileSystem=i},79434:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PathUtils=void 0;const o=n(86700),s=n(71017),a=n(61684),c=n(87450),l=n(48431),u=n(58967);let p=class{constructor(e){const t=e?c.OSType.Windows:c.OSType.Unknown;this.utils=new l.FileSystemPathUtils(u("~"),l.FileSystemPaths.withDefaults(),new l.Executables(s.delimiter,t),s)}get home(){return this.utils.home}get delimiter(){return this.utils.executables.delimiter}get separator(){return this.utils.paths.sep}getPathVariableName(){return this.utils.executables.envVar}getDisplayName(e,t){return this.utils.getDisplayName(e,t)}basename(e,t){return this.utils.paths.basename(e,t)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IsWindows))],p),t.PathUtils=p},65243:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.isWindows=t.PlatformService=void 0;const i=n(86700),o=n(22037),s=n(81249),a=n(47237),c=n(87450),l=n(52439);let u=class{constructor(){this.osType=(0,c.getOSType)()}get pathVariableName(){return(0,a.getSearchPathEnvVarNames)(this.osType)[0]}get virtualEnvBinName(){return this.isWindows?"Scripts":"bin"}async getVersion(){if(this.version)return this.version;switch(this.osType){case c.OSType.Windows:case c.OSType.OSX:try{const e=(0,s.coerce)(o.release());if(e)return this.version=e,this.version;throw new Error("Unable to parse version")}catch(e){return(0,l.parseSemVerSafe)(o.release())}default:throw new Error("Not Supported")}}get isWindows(){return p()}get isMac(){return this.osType===c.OSType.OSX}get isLinux(){return this.osType===c.OSType.Linux}get osRelease(){return o.release()}get is64bit(){return(0,c.getArchitecture)()===c.Architecture.x64}};function p(){return(0,c.getOSType)()===c.OSType.Windows}u=r([(0,i.injectable)()],u),t.PlatformService=u,t.isWindows=p},3522:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.getArchitectureDisplayName=t.RegistryImplementation=void 0;const i=n(86700),o=n(19735),s=n(87450),a=n(84974);var c;!function(e){e.x86="x86",e.x64="x64"}(c||(c={}));let l=class{async getKeys(e,t,r){return async function(e){const t=n(1283);return new Promise((n=>{new t(e).keys(((e,t)=>{if(e||!Array.isArray(t))return n([]);n(t.filter((e=>"string"==typeof e.key)).map((e=>e.key)))}))}))}({hive:p(t),arch:u(r),key:e}).catch((e=>((0,o.traceError)("Fetching keys from windows registry resulted in an error",e),[])))}async getValue(e,t,r,i=""){return async function(e,t=""){const r=n(1283);return new Promise((n=>{new r(e).get(t,((e,t)=>{if(e||!t||"string"!=typeof t.value)return n(void 0);n(t.value)}))}))}({hive:p(t),arch:u(r),key:e},i).catch((e=>{(0,o.traceError)("Fetching key value from windows registry resulted in an error",e)}))}};function u(e){switch(e){case s.Architecture.x86:return c.x86;case s.Architecture.x64:return c.x64;default:return}}function p(e){const t=n(1283);switch(e){case a.RegistryHive.HKCU:return t.HKCU;case a.RegistryHive.HKLM:return t.HKLM;default:return}}l=r([(0,i.injectable)()],l),t.RegistryImplementation=l,t.getArchitectureDisplayName=function(e){switch(e){case s.Architecture.x64:return"64-bit";case s.Architecture.x86:return"32-bit";default:return""}}},29992:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90209),i=n(65243),o=n(3522),s=n(84974);t.registerTypes=function(e){e.addSingleton(s.IPlatformService,i.PlatformService),e.addSingleton(s.IFileSystem,r.FileSystem),e.addSingleton(s.IRegistry,o.RegistryImplementation)}},84974:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFileSystem=t.IFileSystemPathUtils=t.IPlatformService=t.IRegistry=t.RegistryHive=t.FileType=void 0;const r=n(66828);var i;t.FileType=r.FileType,(i=t.RegistryHive||(t.RegistryHive={}))[i.HKCU=0]="HKCU",i[i.HKLM=1]="HKLM",t.IRegistry=Symbol("IRegistry"),t.IPlatformService=Symbol("IPlatformService"),t.IFileSystemPathUtils=Symbol("IFileSystemPathUtils"),t.IFileSystem=Symbol("IFileSystem")},93289:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ENCODING=void 0,t.DEFAULT_ENCODING="utf8"},20900:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentProcess=void 0;const i=n(86700);let o=class{constructor(){this.on=(e,t)=>(process.on(e,t),process)}get env(){return process.env}get argv(){return process.argv}get stdout(){return process.stdout}get stdin(){return process.stdin}get execPath(){return process.execPath}};o=r([(0,i.injectable)()],o),t.CurrentProcess=o},73153:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeBuffer=void 0;const r=n(4914),i=n(93289);t.decodeBuffer=function(e,t=i.DEFAULT_ENCODING){return t=r.encodingExists(t)?t:i.DEFAULT_ENCODING,r.decode(Buffer.concat(e),t)}},31776:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getModuleVersion=t.isModuleInstalled=t.isValid=t.getUserSitePackages=t.getSitePackages=t.getExecutable=t.execModule=t.execCode=void 0,t.execCode=function(e){return["-c",e]},t.execModule=function(e,t){return["-m",e,...t]},t.getExecutable=function(){return[["-c","import sys;print(sys.executable)"],function(e){return e.trim()}]},t.getSitePackages=function(){return[["-c","from distutils.sysconfig import get_python_lib; print(get_python_lib())"],function(e){return e.trim()}]},t.getUserSitePackages=function(){return[["site","--user-site"],function(e){return e.trim()}]},t.isValid=function(){return[["-c","print(1234)"],function(e){return e.startsWith("1234")}]},t.isModuleInstalled=function(e){return[["-c",`import ${e}`],function(e){return!0}]},t.getModuleVersion=function(e){return[["-c",`import ${e}; print(${e}.__version__)`],function(e){return e.trim()}]}},48266:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._SCRIPTS_DIR=void 0;const r=n(71017),i=n(77570);t._SCRIPTS_DIR=r.join(i.EXTENSION_ROOT_DIR,"pythonFiles")},4057:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.installedCheckScript=t.createCondaScript=t.createVenvScript=t.linterScript=t.tensorboardLauncher=t.execution_py_testlauncher=t.visualstudio_py_testlauncher=t.pytestlauncher=t.testlauncher=t.shell_exec=t.printEnvVariables=t.normalizeSelection=t.interpreterInfo=t.OUTPUT_MARKER_SCRIPT=t.testingTools=void 0;const r=n(71017),i=n(48266),o=i._SCRIPTS_DIR;t.testingTools=n(81036),t.OUTPUT_MARKER_SCRIPT=r.join(i._SCRIPTS_DIR,"get_output_via_markers.py"),t.interpreterInfo=function(){const e=[r.join(o,"interpreterInfo.py")];return[e,function(t){try{return JSON.parse(t)}catch(n){throw Error(`python ${e} returned bad JSON (${t}) (${n})`)}}]},t.normalizeSelection=function(){return[[r.join(o,"normalizeSelection.py")],function(e){return e}]},t.printEnvVariables=function(){return[[r.join(o,"printEnvVariables.py").fileToCommandArgumentForPythonExt()],function(e){return JSON.parse(e)}]},t.shell_exec=function(e,t,n){return[r.join(o,"shell_exec.py"),e.fileToCommandArgumentForPythonExt(),...n,t.fileToCommandArgumentForPythonExt()]},t.testlauncher=function(e){return[r.join(o,"testlauncher.py"),...e]},t.pytestlauncher=function(e){return[r.join(o,"vscode_pytest","run_pytest_script.py"),...e]},t.visualstudio_py_testlauncher=function(e){return[r.join(o,"visualstudio_py_testlauncher.py"),...e]},t.execution_py_testlauncher=function(e){return[r.join(o,"unittestadapter","execution.py"),...e]},t.tensorboardLauncher=function(e){return[r.join(o,"tensorboard_launcher.py"),...e]},t.linterScript=function(){return r.join(o,"linter.py")},t.createVenvScript=function(){return r.join(o,"create_venv.py")},t.createCondaScript=function(){return r.join(o,"create_conda.py")},t.installedCheckScript=function(){return r.join(o,"installed_check.py")}},81036:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unittestDiscovery=t.runAdapter=void 0;const r=n(71017),i=n(48266),o=r.join(i._SCRIPTS_DIR,"testing_tools");t.runAdapter=function(e){return[r.join(o,"run_adapter.py"),...e]},t.unittestDiscovery=function(e){return[r.join(o,"unittest_discovery.py"),...e]}},34581:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessLogger=void 0;const o=n(86700),s=n(19735),a=n(17585),c=n(77570),l=n(87450),u=n(96486),p=n(94146),d=n(89465);let h=class{constructor(e){this.workspaceService=e}logProcess(e,t,n){var r;if(!(0,c.isTestExecution)()&&c.isCI&&process.env.UITEST_DISABLE_PROCESS_LOGGING)return;let i=t?[e,...t].map((e=>e.trimQuotes().toCommandArgumentForPythonExt())).join(" "):e;const o=[`> ${this.getDisplayCommands(i)}`];if(null==n?void 0:n.cwd){const e="string"==typeof(null==n?void 0:n.cwd)?null==n?void 0:n.cwd:null===(r=null==n?void 0:n.cwd)||void 0===r?void 0:r.toString();o.push(`cwd: ${this.getDisplayCommands(e)}`)}"string"==typeof(null==n?void 0:n.shell)&&o.push(`shell: ${(0,d.identifyShellFromShellPath)(null==n?void 0:n.shell)}`),o.forEach((e=>{(0,s.traceLog)(e)}))}getDisplayCommands(e){this.workspaceService.workspaceFolders&&1===this.workspaceService.workspaceFolders.length&&(e=f(e,this.workspaceService.workspaceFolders[0].uri.fsPath,"."));const t=(0,l.getUserHomeDir)();return t&&(e=f(e,t,"~")),e}};function f(e,t,n){function r(e){let t=(0,u.escapeRegExp)(e);return(0,l.getOSType)()===l.OSType.Windows&&(t=(0,p.replaceAll)(t,"\\\\","(\\\\|/)")),new RegExp(t,"ig")}let i=e.split(" ");for(let e=0;e<i.length;e++){let o=r(t);const s=o.exec(i[e]);if(s){const a=s.index;a>0&&i[e][a-1].match(/[a-z]/)&&(o=r(t.substring(1))),i[e]=i[e].replace(o,n)}}return i.join(" ")}h=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IWorkspaceService))],h),t.ProcessLogger=h},66462:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessService=void 0;const r=n(82361),i=n(19735),o=n(18699);class s extends r.EventEmitter{constructor(e){super(),this.env=e,this.processesToKill=new Set}static isAlive(e){try{return process.kill(e,0),!0}catch(e){return!1}}static kill(e){(0,o.killPid)(e)}dispose(){this.removeAllListeners(),this.processesToKill.forEach((e=>{try{e.dispose()}catch(e){}}))}execObservable(e,t,n={}){const r=(0,o.execObservable)(e,t,n,this.env,this.processesToKill);return this.emit("exec",e,t,n),r}exec(e,t,n={}){const r=(0,o.plainExec)(e,t,n,this.env,this.processesToKill);return this.emit("exec",e,t,n),r}shellExec(e,t={}){this.emit("exec",e,void 0,t);const n=new Set;return(0,o.shellExec)(e,t,this.env,n).finally((()=>{n.forEach((t=>{try{t.dispose()}catch(t){(0,i.traceError)(`Unable to kill process for ${e}`)}}))}))}}t.ProcessService=s},98065:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessServiceFactory=void 0;const o=n(86700),s=n(61684),a=n(19909),c=n(66462),l=n(29983);let u=class{constructor(e,t,n){this.envVarsService=e,this.processLogger=t,this.disposableRegistry=n}async create(e,t){const n=(null==t?void 0:t.doNotUseCustomEnvs)?void 0:await this.envVarsService.getEnvironmentVariables(e),r=new c.ProcessService(n);return this.disposableRegistry.push(r),r.on("exec",this.processLogger.logProcess.bind(this.processLogger))}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IEnvironmentVariablesProvider)),i(1,(0,o.inject)(l.IProcessLogger)),i(2,(0,o.inject)(s.IDisposableRegistry))],u),t.ProcessServiceFactory=u},3672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMicrosoftStoreEnv=t.createCondaEnv=t.createPythonEnv=void 0;const r=n(71017),i=n(19735),o=n(75470),s=n(24708),a=n(93400),c=n(69554),l=n(77570),u=n(31776),p=new Map;class d{constructor(e,t){this.pythonPath=e,this.deps=t,this.cachedInterpreterInformation=null}getExecutionInfo(e=[],t){const n=this.deps.getPythonArgv(this.pythonPath);return(0,s.buildPythonExecInfo)(n,e,t)}getExecutionObservableInfo(e=[],t){const n=this.deps.getObservablePythonArgv(this.pythonPath);return(0,s.buildPythonExecInfo)(n,e,t)}async getInterpreterInformation(){return null===this.cachedInterpreterInformation&&(this.cachedInterpreterInformation=await this.getInterpreterInformationImpl()),this.cachedInterpreterInformation}async getExecutablePath(){if(await this.deps.isValidExecutable(this.pythonPath))return this.pythonPath;const e=p.get(this.pythonPath);if(void 0!==e&&!(0,l.isTestExecution)())return e;const t=this.getExecutionInfo(),n=(0,a.getExecutablePath)(t,this.deps.shellExec);return p.set(this.pythonPath,n),n}async getModuleVersion(e){const[t,n]=u.getModuleVersion(e),r=this.getExecutionInfo(t);let o;try{o=await this.deps.exec(r.command,r.args)}catch(t){return void(0,i.traceVerbose)(`Error when getting version of module ${e}`,t)}return n(o.stdout)}async isModuleInstalled(e){const[t]=u.isModuleInstalled(e),n=this.getExecutionInfo(t);try{await this.deps.exec(n.command,n.args)}catch(t){return(0,i.traceVerbose)(`Error when checking if module is installed ${e}`,t),!1}return!0}async getInterpreterInformationImpl(){try{const e=this.getExecutionInfo();return await(0,c.getInterpreterInfo)(e,this.deps.shellExec,{verbose:i.traceVerbose,error:i.traceError})}catch(e){(0,i.traceError)(`Failed to get interpreter information for '${this.pythonPath}'`,e)}}}function h(e,t,n,i,o){return{getPythonArgv:e=>(r.basename(e)===e&&(t=e.split(" ")),t||[e]),getObservablePythonArgv:e=>(r.basename(e)===e&&(n=e.split(" ")),n||[e]),isValidExecutable:e,exec:async(e,t)=>i(e,t,{throwOnStdErr:!0}),shellExec:o}}t.createPythonEnv=function(e,t,n){const r=h((async e=>n.pathExists(e)),void 0,void 0,((e,n,r)=>t.exec(e,n,r)),((e,n)=>t.shellExec(e,n)));return new d(e,r)},t.createCondaEnv=async function(e,t,n){const r=await o.Conda.getConda(),i=await(null==r?void 0:r.getRunPythonArgs({name:e.name,prefix:e.path}));if(!i)return;const s=h((async e=>n.pathExists(e)),i,i,((e,n,r)=>t.exec(e,n,r)),((e,n)=>t.shellExec(e,n))),a=await(null==r?void 0:r.getInterpreterPathForEnvironment({name:e.name,prefix:e.path}));return a?new d(a,s):void 0},t.createMicrosoftStoreEnv=function(e,t){const n=h((async e=>!0),void 0,void 0,((e,n,r)=>t.exec(e,n,r)),((e,n)=>t.shellExec(e,n)));return new d(e,n)}},51625:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonExecutionFactory=void 0;const o=n(86700),s=n(80351),a=n(18639),c=n(77498),l=n(54813),u=n(61522),p=n(84974),d=n(61684),h=n(66462),f=n(3672),g=n(29672),m=n(29983),v=n(87282),y=n(59314),b=n(19735);let S=class{constructor(e,t,n,r,i,o,s){this.serviceContainer=e,this.activationHelper=t,this.processServiceFactory=n,this.configService=r,this.pyenvs=i,this.autoSelection=o,this.interpreterPathExpHelper=s,this.disposables=this.serviceContainer.get(d.IDisposableRegistry),this.logger=this.serviceContainer.get(m.IProcessLogger),this.fileSystem=this.serviceContainer.get(p.IFileSystem)}async create(e){let{pythonPath:t}=e;if(!t||"python"===t){const n=this.serviceContainer.get(a.IActivatedEnvironmentLaunch);await n.selectIfLaunchedViaActivatedEnv();const r=this.interpreterPathExpHelper.get(e.resource);r&&"python"!==r||await Promise.race([this.autoSelection.autoSelectInterpreter(e.resource).then((()=>!0)),(0,y.sleep)(5e4).then((()=>!1))])||(0,b.traceError)("Autoselection timeout out, this is likely a issue with how consumer called execution factory API. Using default python to execute."),t=this.configService.getSettings(e.resource).pythonPath}const n=await this.processServiceFactory.create(e.resource),r=await this.createCondaExecutionService(t,n);if(r)return r;const i=this.pyenvs.isMicrosoftStoreInterpreter.bind(this.pyenvs);return E(n,await i(t)?(0,f.createMicrosoftStoreEnv)(t,n):(0,f.createPythonEnv)(t,n,this.fileSystem))}async createActivatedEnvironment(e){const t=await this.activationHelper.getActivatedEnvironmentVariables(e.resource,e.interpreter,e.allowEnvironmentFetchExceptions),n=t&&Object.keys(t).length>0;if((0,l.sendTelemetryEvent)(u.EventName.PYTHON_INTERPRETER_ACTIVATION_ENVIRONMENT_VARIABLES,void 0,{hasEnvVars:n}),!n)return this.create({resource:e.resource,pythonPath:e.interpreter?e.interpreter.path:void 0});const r=e.interpreter?e.interpreter.path:this.configService.getSettings(e.resource).pythonPath,i=new h.ProcessService({...t});i.on("exec",this.logger.logProcess.bind(this.logger)),this.disposables.push(i);const o=await this.createCondaExecutionService(r,i);return o||E(i,(0,f.createPythonEnv)(r,i,this.fileSystem))}async createCondaExecutionService(e,t){const n=this.serviceContainer.get(a.IComponentAdapter),[r]=await Promise.all([n.getCondaEnvironment(e)]);if(!r)return;const i=await(0,f.createCondaEnv)(r,t,this.fileSystem);return i?E(t,i):void 0}};function E(e,t){const n=(0,g.createPythonProcessService)(e,t);return{getInterpreterInformation:()=>t.getInterpreterInformation(),getExecutablePath:()=>t.getExecutablePath(),isModuleInstalled:e=>t.isModuleInstalled(e),getModuleVersion:e=>t.getModuleVersion(e),getExecutionInfo:e=>t.getExecutionInfo(e),execObservable:(e,t)=>n.execObservable(e,t),execModuleObservable:(e,t,r)=>n.execModuleObservable(e,t,r),exec:(e,t)=>n.exec(e,t),execModule:(e,t,r)=>n.execModule(e,t,r),execForLinter:(e,t,r)=>n.execForLinter(e,t,r)}}S=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer)),i(1,(0,o.inject)(s.IEnvironmentActivationService)),i(2,(0,o.inject)(m.IProcessServiceFactory)),i(3,(0,o.inject)(d.IConfigurationService)),i(4,(0,o.inject)(a.IComponentAdapter)),i(5,(0,o.inject)(v.IInterpreterAutoSelectionService)),i(6,(0,o.inject)(d.IInterpreterPathService))],S),t.PythonExecutionFactory=S},29672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPythonProcessService=void 0;const r=n(26804),i=n(97300),o=n(31776);class s{constructor(e){this.deps=e}execObservable(e,t){const n={...t},r=this.deps.getExecutionObservableInfo(e);return this.deps.execObservable(r.command,r.args,n)}execModuleObservable(e,t,n){const r=o.execModule(e,t),i={...n},s=this.deps.getExecutionObservableInfo(r);return this.deps.execObservable(s.command,s.args,i)}async exec(e,t){const n={...t},r=this.deps.getExecutionInfo(e);return this.deps.exec(r.command,r.args,n)}async execModule(e,t,n){const s=o.execModule(e,t),a={...n},c=this.deps.getExecutionInfo(s),l=await this.deps.exec(c.command,c.args,a);if(e&&r.ErrorUtils.outputHasModuleNotInstalledError(e,l.stderr)&&!await this.deps.isModuleInstalled(e))throw new i.ModuleNotInstalledError(e);return l}async execForLinter(e,t,n){const o={...n},s=this.deps.getExecutionInfo(t),a=await this.deps.exec(s.command,s.args,o);if(e&&r.ErrorUtils.outputHasModuleNotInstalledError(e,a.stderr)&&!await this.deps.isModuleInstalled(e))throw new i.ModuleNotInstalledError(e);return a}}t.createPythonProcessService=function(e,t){return new s({isModuleInstalled:async e=>t.isModuleInstalled(e),getExecutionInfo:e=>t.getExecutionInfo(e),getExecutionObservableInfo:e=>t.getExecutionObservableInfo(e),exec:async(t,n,r)=>e.exec(t,n,r),execObservable:(t,n,r)=>e.execObservable(t,n,r)})}},91950:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonToolExecutionService=void 0;const o=n(86700),s=n(77498),a=n(29983);let c=class{constructor(e){this.serviceContainer=e}async execObservable(e,t,n){if(t.env)throw new Error("Environment variables are not supported");return e.moduleName&&e.moduleName.length>0?(await this.serviceContainer.get(a.IPythonExecutionFactory).create({resource:n})).execModuleObservable(e.moduleName,e.args,t):(await this.serviceContainer.get(a.IProcessServiceFactory).create(n)).execObservable(e.execPath,e.args,{...t})}async exec(e,t,n){if(t.env)throw new Error("Environment variables are not supported");return e.moduleName&&e.moduleName.length>0?(await this.serviceContainer.get(a.IPythonExecutionFactory).create({resource:n})).execModule(e.moduleName,e.args,t):(await this.serviceContainer.get(a.IProcessServiceFactory).create(n)).exec(e.execPath,e.args,{...t})}async execForLinter(e,t,n){if(t.env)throw new Error("Environment variables are not supported");const r=await this.serviceContainer.get(a.IPythonExecutionFactory).create({resource:n});return e.execPath?r.exec(e.args,t):r.execForLinter(e.moduleName,e.args,t)}};c=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IServiceContainer))],c),t.PythonToolExecutionService=c},18699:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.killPid=t.execObservable=t.plainExec=t.shellExec=void 0;const r=n(32081),i=n(95100),o=n(59314),s=n(93289),a=n(29983),c=n(3481),l=n(73153),u=n(19735),p=/your [0-9]+x[0-9]+ screen size is bogus\. expect trouble/;function d(e,t){const n={...e},r=n;if(r){r.encoding="string"==typeof r.encoding&&r.encoding.length>0?r.encoding:s.DEFAULT_ENCODING;const{encoding:e}=r;delete r.encoding,r.encoding=e}if(n.env&&0!==Object.keys(n.env).length)n.env={...n.env};else{const e=t||process.env;n.env={...e}}return r&&r.extraVariables&&(n.env={...n.env,...r.extraVariables}),n.env.PYTHONUNBUFFERED="1",n.env.PYTHONIOENCODING||(n.env.PYTHONIOENCODING="utf-8"),n}function h(e){const t=e.match(/>>>PYTHON-EXEC-OUTPUT([\s\S]*)<<<PYTHON-EXEC-OUTPUT/),n=null!==t&&t.length>=2?t[1].trim():void 0;return void 0!==n?n:e}function f(e){try{"win32"===process.platform?(0,r.execSync)(`taskkill /pid ${e} /T /F`):process.kill(e)}catch(e){}}t.shellExec=function(e,t={},n,i){const o=d(t,n);return(0,u.traceVerbose)(`Shell Exec: ${e} with options: ${JSON.stringify(o,null,4)}`),new Promise(((t,n)=>{const s=(0,r.exec)(e,o,((e,r,i)=>{e&&null!==e?n(e):o.throwOnStdErr&&i&&i.length?n(new Error(i)):(r=h(r),t({stderr:i&&i.length>0?i:void 0,stdout:r}))})),a={dispose:()=>{s.killed||s.kill()}};i&&i.add(a)}))},t.plainExec=function(e,t,n={},i,s){var u,f;const g=d(n,i),m=g.encoding?g.encoding:"utf8",v=(0,r.spawn)(e,t,g);null===(u=v.stdout)||void 0===u||u.on("error",c.noop),null===(f=v.stderr)||void 0===f||f.on("error",c.noop);const y=(0,o.createDeferred)(),b={dispose:()=>{v.killed||v.kill()}};null==s||s.add(b);const S=[],E=(e,t,n)=>{null==e||e.on(t,n),S.push({dispose:()=>null==e?void 0:e.removeListener(t,n)})};n.token&&S.push(n.token.onCancellationRequested(b.dispose));const _=[];E(v.stdout,"data",(e=>{var t;_.push(e),null===(t=n.outputChannel)||void 0===t||t.append(e.toString())}));const w=[];return E(v.stderr,"data",(e=>{var t;n.mergeStdOutErr?(_.push(e),w.push(e)):w.push(e),null===(t=n.outputChannel)||void 0===t||t.append(e.toString())})),v.once("close",(()=>{if(y.completed)return;const e=0===w.length?void 0:(0,l.decodeBuffer)(w,m);if(e&&e.length>0&&n.throwOnStdErr&&(!p.test(e)||0!==e.replace(p,"").trim().length))y.reject(new a.StdErrError(e));else{let t=(0,l.decodeBuffer)(_,m);t=h(t),y.resolve({stdout:t,stderr:e})}S.forEach((e=>e.dispose())),b.dispose()})),v.once("error",(e=>{y.reject(e),S.forEach((e=>e.dispose())),b.dispose()})),y.promise},t.execObservable=function(e,t,n={},o,s){const c=d(n,o),u=c.encoding?c.encoding:"utf8",p=(0,r.spawn)(e,t,c);let h=!1;const g={dispose(){p&&p.pid&&!p.killed&&!h&&f(p.pid),p&&p.unref()}};null==s||s.add(g);const m=new i.Observable((e=>{const t=[],r=(e,n,r)=>{null==e||e.on(n,r),t.push({dispose:()=>null==e?void 0:e.removeListener(n,r)})};n.token&&t.push(n.token.onCancellationRequested((()=>{h||p.killed||(p.kill(),h=!0)})));const i=(t,r)=>{let i=(0,l.decodeBuffer)([r],u);"stderr"===t&&n.throwOnStdErr?e.error(new a.StdErrError(i)):(i=function(e){return(e=e.replace(">>>PYTHON-EXEC-OUTPUT\r\n","").replace(">>>PYTHON-EXEC-OUTPUT\n","")).replace("<<<PYTHON-EXEC-OUTPUT\r\n","").replace("<<<PYTHON-EXEC-OUTPUT\n","")}(i),e.next({source:t,out:i}))};r(p.stdout,"data",(e=>i("stdout",e))),r(p.stderr,"data",(e=>i("stderr",e))),p.once("close",(()=>{h=!0,e.complete(),t.forEach((e=>e.dispose()))})),p.once("exit",(()=>{h=!0,e.complete(),t.forEach((e=>e.dispose()))})),p.once("error",(n=>{h=!0,e.error(n),t.forEach((e=>e.dispose()))}))}));return{proc:p,out:m,dispose:g.dispose}},t.killPid=f},52615:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(98065),i=n(51625),o=n(91950),s=n(29983);t.registerTypes=function(e){e.addSingleton(s.IProcessServiceFactory,r.ProcessServiceFactory),e.addSingleton(s.IPythonExecutionFactory,i.PythonExecutionFactory),e.addSingleton(s.IPythonToolExecutionService,o.PythonToolExecutionService)}},29983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPythonToolExecutionService=t.StdErrError=t.IPythonExecutionService=t.IPythonExecutionFactory=t.IProcessServiceFactory=t.IProcessLogger=void 0,t.IProcessLogger=Symbol("IProcessLogger"),t.IProcessServiceFactory=Symbol("IProcessServiceFactory"),t.IPythonExecutionFactory=Symbol("IPythonExecutionFactory"),t.IPythonExecutionService=Symbol("IPythonExecutionService");class n extends Error{constructor(e){super(e)}}t.StdErrError=n,t.IPythonToolExecutionService=Symbol("IPythonToolRunnerService")},39702:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(61684),o=n(11272),s=n(15036),a=n(78838),c=n(17792),l=n(18718),u=n(13706),p=n(77633),d=n(17381),h=n(30651),f=n(5869),g=n(54144),m=n(67808),v=n(72874),y=n(13578),b=n(64991),S=n(53314),E=n(17585),_=n(56792),w=n(30751),T=n(15797),C=n(84911),P=n(12474),I=n(80819),x=n(97469),O=n(21621),R=n(73766),D=n(79434),A=n(20900),k=n(34581),N=n(29983),M=n(32237),L=n(80484),j=n(14744),F=n(92298),U=n(8572),V=n(78625),H=n(79152),B=n(78558),W=n(546),q=n(86678),$=n(55928),G=n(81731),K=n(67482),z=n(80656),Y=n(58400),J=n(22207),X=n(10195),Q=n(54094),Z=n(32907),ee=n(35657),te=n(65243);t.registerTypes=function(e){e.addSingletonInstance(i.IsWindows,(0,te.isWindows)()),e.addSingleton(E.IActiveResourceService,c.ActiveResourceService),e.addSingleton(i.IInterpreterPathService,x.InterpreterPathService),e.addSingleton(i.IExtensions,y.Extensions),e.addSingleton(i.IRandom,X.Random),e.addSingleton(i.IPersistentStateFactory,R.PersistentStateFactory),e.addBinding(i.IPersistentStateFactory,r.IExtensionSingleActivationService),e.addSingleton(Y.ITerminalServiceFactory,W.TerminalServiceFactory),e.addSingleton(i.IPathUtils,D.PathUtils),e.addSingleton(E.IApplicationShell,u.ApplicationShell),e.addSingleton(E.IClipboard,p.ClipboardService),e.addSingleton(i.ICurrentProcess,A.CurrentProcess),e.addSingleton(i.IInstaller,I.ProductInstaller),e.addSingleton(E.IJupyterExtensionDependencyManager,o.JupyterExtensionDependencyManager),e.addSingleton(r.IExtensionSingleActivationService,ee.RequireJupyterPrompt),e.addSingleton(r.IExtensionSingleActivationService,Z.CreatePythonFileCommandHandler),e.addSingleton(E.ICommandManager,d.CommandManager),e.addSingleton(E.IContextKeyManager,Q.ContextKeyManager),e.addSingleton(i.IConfigurationService,w.ConfigurationService),e.addSingleton(E.IWorkspaceService,_.WorkspaceService),e.addSingleton(N.IProcessLogger,k.ProcessLogger),e.addSingleton(E.IDocumentManager,v.DocumentManager),e.addSingleton(E.ITerminalManager,S.TerminalManager),e.addSingleton(E.IDebugService,g.DebugService),e.addSingleton(E.IApplicationEnvironment,l.ApplicationEnvironment),e.addSingleton(E.ILanguageService,b.LanguageService),e.addSingleton(i.IBrowserService,O.BrowserService),e.addSingleton(i.IEditorUtils,C.EditorUtils),e.addSingleton(Y.ITerminalActivator,M.TerminalActivator),e.addSingleton(Y.ITerminalActivationHandler,L.PowershellTerminalActivationFailedHandler),e.addSingleton(i.IExperimentService,P.ExperimentService),e.addSingleton(Y.ITerminalHelper,q.TerminalHelper),e.addSingleton(Y.ITerminalActivationCommandProvider,j.Bash,Y.TerminalActivationProviders.bashCShellFish),e.addSingleton(Y.ITerminalActivationCommandProvider,U.CommandPromptAndPowerShell,Y.TerminalActivationProviders.commandPromptAndPowerShell),e.addSingleton(Y.ITerminalActivationCommandProvider,F.Nushell,Y.TerminalActivationProviders.nushell),e.addSingleton(Y.ITerminalActivationCommandProvider,B.PyEnvActivationCommandProvider,Y.TerminalActivationProviders.pyenv),e.addSingleton(Y.ITerminalActivationCommandProvider,V.CondaActivationCommandProvider,Y.TerminalActivationProviders.conda),e.addSingleton(Y.ITerminalActivationCommandProvider,H.PipEnvActivationCommandProvider,Y.TerminalActivationProviders.pipenv),e.addSingleton(i.IToolExecutionPath,T.PipEnvExecutionPath,i.ToolExecutionPath.pipenv),e.addSingleton(J.IMultiStepInputFactory,J.MultiStepInputFactory),e.addSingleton(a.IImportTracker,s.ImportTracker),e.addBinding(a.IImportTracker,r.IExtensionSingleActivationService),e.addSingleton(Y.IShellDetector,G.TerminalNameShellDetector),e.addSingleton(Y.IShellDetector,$.SettingsShellDetector),e.addSingleton(Y.IShellDetector,K.UserEnvironmentShellDetector),e.addSingleton(Y.IShellDetector,z.VSCEnvironmentShellDetector),e.addSingleton(r.IExtensionSingleActivationService,h.ReloadVSCodeCommandHandler),e.addSingleton(r.IExtensionSingleActivationService,f.ReportIssueCommandHandler),e.addSingleton(r.IExtensionSingleActivationService,m.DebugSessionTelemetry)}},94146:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceAll=t.splitLines=void 0,t.splitLines=function(e,t={removeEmptyEntries:!0,trim:!0}){let n=e.split(/\r?\n/g);return(null==t?void 0:t.trim)&&(n=n.map((e=>e.trim()))),(null==t?void 0:t.removeEmptyEntries)&&(n=n.filter((e=>e.length>0))),n},t.replaceAll=function(e,t,n){return e?e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n):e}},57563:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTerminalActivator=void 0;const r=n(19735),i=n(59314);t.BaseTerminalActivator=class{constructor(e){this.helper=e,this.activatedTerminals=new Map}async activateEnvironmentInTerminal(e,t){if(this.activatedTerminals.has(e))return this.activatedTerminals.get(e);const n=(0,i.createDeferred)();this.activatedTerminals.set(e,n.promise);const o=this.helper.identifyTerminalShell(e),s=await this.helper.getEnvironmentActivationCommands(o,null==t?void 0:t.resource,null==t?void 0:t.interpreter);let a=!1;if(s)for(const n of s)e.show(null==t?void 0:t.preserveFocus),(0,r.traceVerbose)(`Command sent to terminal: ${n}`),e.sendText(n),await this.waitForCommandToProcess(o),a=!0;return n.resolve(a),a}async waitForCommandToProcess(e){await(0,i.sleep)(500)}}},32237:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalActivator=void 0;const o=n(86700),s=n(61684),a=n(58400),c=n(57563),l=n(46747);let u=class{constructor(e,t,n,r){this.helper=e,this.handlers=t,this.configurationService=n,this.experimentService=r,this.pendingActivations=new WeakMap,this.initialize()}async activateEnvironmentInTerminal(e,t){let n=this.pendingActivations.get(e);return n||(n=this.activateEnvironmentInTerminalImpl(e,t),this.pendingActivations.set(e,n),n)}async activateEnvironmentInTerminalImpl(e,t){if(!this.configurationService.getSettings(null==t?void 0:t.resource).terminal.activateEnvironment||(0,l.inTerminalEnvVarExperiment)(this.experimentService)||(null==t?void 0:t.hideFromUser))return!1;const n=await this.baseActivator.activateEnvironmentInTerminal(e,t);return this.handlers.forEach((r=>r.handleActivation(e,null==t?void 0:t.resource,!0===(null==t?void 0:t.preserveFocus),n).ignoreErrors())),n}initialize(){this.baseActivator=new c.BaseTerminalActivator(this.helper)}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ITerminalHelper)),i(1,(0,o.multiInject)(a.ITerminalActivationHandler)),i(2,(0,o.inject)(s.IConfigurationService)),i(3,(0,o.inject)(s.IExperimentService))],u),t.TerminalActivator=u},80484:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PowershellTerminalActivationFailedHandler=void 0;const o=n(86700),s=n(54205),a=n(93971),c=n(84974),l=n(58400);let u=class{constructor(e,t,n){this.helper=e,this.platformService=t,this.diagnosticService=n}async handleActivation(e,t,n,r){if(r||!this.platformService.isWindows)return;const i=this.helper.identifyTerminalShell(e);if(i!==l.TerminalShellType.powershell&&i!==l.TerminalShellType.powershellCore)return;const o=await this.helper.getEnvironmentActivationCommands(l.TerminalShellType.commandPrompt,t);o&&Array.isArray(o)&&0!==o.length&&this.diagnosticService.handle([new s.PowershellActivationNotAvailableDiagnostic(t)]).ignoreErrors()}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(l.ITerminalHelper)),i(1,(0,o.inject)(c.IPlatformService)),i(2,(0,o.inject)(a.IDiagnosticsService)),i(2,(0,o.named)(s.PowerShellActivationHackDiagnosticsServiceId))],u),t.PowershellTerminalActivationFailedHandler=u},87688:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useCommandPromptAsDefaultShell=t.getCommandPromptLocation=void 0;const r=n(71017),i=n(66828);function o(e){const t=e.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),n=r.join(e.env.windir,t?"Sysnative":"System32");return r.join(n,"cmd.exe")}t.getCommandPromptLocation=o,t.useCommandPromptAsDefaultShell=async function(e,t){const n=o(e);await t.updateSectionSetting("terminal","integrated.shell.windows",n,void 0,i.ConfigurationTarget.Global)}},86575:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.VenvBaseActivationCommandProvider=void 0;const o=n(86700),s=n(71017),a=n(18639),c=n(77498),l=n(84974);let u=class{constructor(e){this.serviceContainer=e}async getActivationCommands(e,t){const n=await this.serviceContainer.get(a.IInterpreterService).getActiveInterpreter(e);if(n)return this.getActivationCommandsForInterpreter(n.path,t)}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],u),t.VenvBaseActivationCommandProvider=class extends u{isShellSupported(e){return void 0!==this.scripts[e]}async findScriptFile(e,t){const n=this.serviceContainer.get(l.IFileSystem),r=this.scripts[t];if(r)return function(e,t,r,i){const o="string"==typeof e?[e]:e;return async e=>{const i=t(e);for(const e of o){const t=r(i,e);if(await(s=t,n.fileExists(s)))return t}var s}}(r,s.dirname,s.join)(e)}}},14744:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.Bash=t.getAllScripts=void 0;const i=n(86700);n(32727);const o=n(58400),s=n(86575),a={[o.TerminalShellType.wsl]:["activate.sh","activate"],[o.TerminalShellType.ksh]:["activate.sh","activate"],[o.TerminalShellType.zsh]:["activate.sh","activate"],[o.TerminalShellType.gitbash]:["activate.sh","activate"],[o.TerminalShellType.bash]:["activate.sh","activate"],[o.TerminalShellType.tcshell]:["activate.csh"],[o.TerminalShellType.cshell]:["activate.csh"],[o.TerminalShellType.fish]:["activate.fish"]};t.getAllScripts=function(){const e=[];for(const t of Object.values(a))for(const n of t)e.includes(n)||e.push(n);return e};let c=class extends s.VenvBaseActivationCommandProvider{constructor(){super(...arguments),this.scripts=a}async getActivationCommandsForInterpreter(e,t){const n=await this.findScriptFile(e,t);if(n)return[`source ${n.fileToCommandArgumentForPythonExt()}`]}};c=r([(0,i.injectable)()],c),t.Bash=c},8572:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandPromptAndPowerShell=t.getAllScripts=void 0;const o=n(86700),s=n(71017),a=n(77498);n(32727);const c=n(58400),l=n(86575),u={[c.TerminalShellType.commandPrompt]:["activate.bat","Activate.ps1"],[c.TerminalShellType.powershell]:["Activate.ps1","activate.bat"],[c.TerminalShellType.powershellCore]:["Activate.ps1","activate.bat"]};t.getAllScripts=function(e){const t=[];for(const n of Object.values(u))for(const r of n)t.includes(r)||t.push(r,e("Scripts",r),e("scripts",r));return t};let p=class extends l.VenvBaseActivationCommandProvider{constructor(e){super(e),this.scripts={};for(const[e,t]of Object.entries(u)){const n=e,r=[];for(const e of t)r.push(e,s.join("Scripts",e),s.join("scripts",e));this.scripts[n]=r}}async getActivationCommandsForInterpreter(e,t){const n=await this.findScriptFile(e,t);if(n)return t===c.TerminalShellType.commandPrompt&&n.endsWith("activate.bat")?[n.fileToCommandArgumentForPythonExt()]:t!==c.TerminalShellType.powershell&&t!==c.TerminalShellType.powershellCore||!n.endsWith("Activate.ps1")?t===c.TerminalShellType.commandPrompt&&n.endsWith("Activate.ps1")?[]:void 0:[`& ${n.fileToCommandArgumentForPythonExt()}`]}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],p),t.CommandPromptAndPowerShell=p},78625:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t._getPowershellCommands=t.CondaActivationCommandProvider=void 0,n(32727);const o=n(86700),s=n(71017),a=n(18639),c=n(84974),l=n(61684),u=n(58400);let p=class{constructor(e,t,n,r){this.condaService=e,this.platform=t,this.configService=n,this.pyenvs=r}isShellSupported(){return!0}getActivationCommands(e,t){const{pythonPath:n}=this.configService.getSettings(e);return this.getActivationCommandsForInterpreter(n,t)}async getActivationCommandsForInterpreter(e,t){const n=await this.pyenvs.getCondaEnvironment(e);if(!n)return;const r=n.name.length>0?n.name:n.path,i=await this.condaService.getInterpreterPathForEnvironment(n),o=await this.condaService.getActivationScriptFromInterpreter(i,n.name);if(null==o?void 0:o.path){if(this.platform.isWindows&&t!==u.TerminalShellType.bash&&t!==u.TerminalShellType.gitbash)return[o.path,`conda activate ${r.toCommandArgumentForPythonExt()}`];const e=await this.condaService.getCondaInfo();return"global"!==o.type||void 0===(null==e?void 0:e.conda_shlvl)||-1===e.conda_shlvl?"activate"===o.path?[`source ${o.path}`,`conda activate ${r.toCommandArgumentForPythonExt()}`]:[`source ${o.path} ${r.toCommandArgumentForPythonExt()}`]:[`conda activate ${r.toCommandArgumentForPythonExt()}`]}switch(t){case u.TerminalShellType.powershell:case u.TerminalShellType.powershellCore:return d(r);case u.TerminalShellType.fish:return async function(e,t){return[`${t.fileToCommandArgumentForPythonExt()} activate ${e.toCommandArgumentForPythonExt()}`]}(r,await this.condaService.getCondaFile());default:return this.platform.isWindows?this.getWindowsCommands(r):async function(e,t){const n=s.dirname(t);return[`source ${s.join(n,"activate").fileToCommandArgumentForPythonExt()} ${e.toCommandArgumentForPythonExt()}`]}(r,await this.condaService.getCondaFile())}}async getWindowsActivateCommand(){let e="activate";const t=await this.condaService.getCondaFile();if(t&&s.basename(t)!==t){const n=s.dirname(t);e=s.join(n,e),e=e.toCommandArgumentForPythonExt()}return e}async getWindowsCommands(e){return[`${await this.getWindowsActivateCommand()} ${e.toCommandArgumentForPythonExt()}`]}};async function d(e){return[`conda activate ${e.toCommandArgumentForPythonExt()}`]}p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ICondaService)),i(1,(0,o.inject)(c.IPlatformService)),i(2,(0,o.inject)(l.IConfigurationService)),i(3,(0,o.inject)(a.IComponentAdapter))],p),t.CondaActivationCommandProvider=p,t._getPowershellCommands=d},92298:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.Nushell=t.getAllScripts=void 0;const i=n(86700);n(32727);const o=n(58400),s=n(86575),a={[o.TerminalShellType.nushell]:["activate.nu"]};t.getAllScripts=function(){const e=[];for(const t of Object.values(a))for(const n of t)e.includes(n)||e.push(n);return e};let c=class extends s.VenvBaseActivationCommandProvider{constructor(){super(...arguments),this.scripts=a}async getActivationCommandsForInterpreter(e,t){const n=await this.findScriptFile(e,t);if(n)return[`overlay use ${n.fileToCommandArgumentForPythonExt()}`]}};c=r([(0,i.injectable)()],c),t.Nushell=c},79152:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PipEnvActivationCommandProvider=void 0;const o=n(86700);n(32727);const s=n(18639),a=n(37924),c=n(81387),l=n(17585),u=n(61684);let p=class{constructor(e,t,n){this.interpreterService=e,this.pipEnvExecution=t,this.workspaceService=n}isShellSupported(){return!1}async getActivationCommands(e){const t=await this.interpreterService.getActiveInterpreter(e);if(!t||t.envType!==c.EnvironmentType.Pipenv)return;const n=e?this.workspaceService.getWorkspaceFolder(e):void 0;return!n||await(0,a.isPipenvEnvironmentRelatedToFolder)(t.path,null==n?void 0:n.uri.fsPath)?[`${this.pipEnvExecution.executable.fileToCommandArgumentForPythonExt()} shell`]:void 0}async getActivationCommandsForInterpreter(e){const t=await this.interpreterService.getInterpreterDetails(e);if(t&&t.envType===c.EnvironmentType.Pipenv)return[`${this.pipEnvExecution.executable.fileToCommandArgumentForPythonExt()} shell`]}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IInterpreterService)),i(1,(0,o.inject)(u.IToolExecutionPath)),i(1,(0,o.named)(u.ToolExecutionPath.pipenv)),i(2,(0,o.inject)(l.IWorkspaceService))],p),t.PipEnvActivationCommandProvider=p},78558:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PyEnvActivationCommandProvider=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(81387);let l=class{constructor(e){this.serviceContainer=e}isShellSupported(e){return!0}async getActivationCommands(e,t){const n=await this.serviceContainer.get(s.IInterpreterService).getActiveInterpreter(e);if(n&&n.envType===c.EnvironmentType.Pyenv&&n.envName)return[`pyenv shell ${n.envName.toCommandArgumentForPythonExt()}`]}async getActivationCommandsForInterpreter(e,t){const n=await this.serviceContainer.get(s.IInterpreterService).getInterpreterDetails(e);if(n&&n.envType===c.EnvironmentType.Pyenv&&n.envName)return[`pyenv shell ${n.envName.toCommandArgumentForPythonExt()}`]}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],l),t.PyEnvActivationCommandProvider=l},546:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalServiceFactory=void 0;const o=n(86700),s=n(71017),a=n(18639),c=n(77498),l=n(17585),u=n(84974),p=n(97207),d=n(88624);let h=class{constructor(e,t,n){this.serviceContainer=e,this.fs=t,this.interpreterService=n,this.terminalServices=new Map}getTerminalService(e){const t=null==e?void 0:e.resource,n=null==e?void 0:e.title;let r="string"==typeof n&&n.trim().length>0?n.trim():"Python";const i=null==e?void 0:e.interpreter,o=this.getTerminalId(r,t,i,e.newTerminalPerFile);if(!this.terminalServices.has(o)){t&&e.newTerminalPerFile&&(r=`${r}: ${s.basename(t.fsPath).replace(".py","")}`),e.title=r;const n=new p.TerminalService(this.serviceContainer,e);this.terminalServices.set(o,n)}return new d.SynchronousTerminalService(this.fs,this.interpreterService,this.terminalServices.get(o),i)}createTerminalService(e,t){return t="string"==typeof t&&t.trim().length>0?t.trim():"Python",new p.TerminalService(this.serviceContainer,{resource:e,title:t})}getTerminalId(e,t,n,r){if(!t&&!n)return e;const i=this.serviceContainer.get(l.IWorkspaceService).getWorkspaceFolder(t||void 0),o=t&&r?t.fsPath:"";return`${e}:${(null==i?void 0:i.uri.fsPath)||""}:${null==n?void 0:n.path}:${o}`}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer)),i(1,(0,o.inject)(u.IFileSystem)),i(2,(0,o.inject)(a.IInterpreterService))],h),t.TerminalServiceFactory=h},86678:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalHelper=void 0;const o=n(86700),s=n(18639),a=n(77498),c=n(19735),l=n(81387),u=n(54813),p=n(61522),d=n(17585);n(32727);const h=n(84974),f=n(61684),g=n(87450),m=n(71791),v=n(58400);let y=class{constructor(e,t,n,r,i,o,s,a,c,l,u,p){this.platform=e,this.terminalManager=t,this.serviceContainer=n,this.interpreterService=r,this.configurationService=i,this.conda=o,this.bashCShellFish=s,this.commandPromptAndPowerShell=a,this.nushell=c,this.pyenv=l,this.pipenv=u,this.shellDetector=new m.ShellDetector(this.platform,p)}createTerminal(e){return this.terminalManager.createTerminal({name:e})}identifyTerminalShell(e){return this.shellDetector.identifyTerminalShell(e)}buildCommandForTerminal(e,t,n){const r=e===v.TerminalShellType.powershell||e===v.TerminalShellType.powershellCore?"& ":"",i=n.map((e=>e.toCommandArgumentForPythonExt()));return`${r}${t.fileToCommandArgumentForPythonExt()} ${i.join(" ")}`.trim()}async getEnvironmentActivationCommands(e,t,n){const r=[this.pipenv,this.pyenv,this.bashCShellFish,this.commandPromptAndPowerShell,this.nushell],i=this.getActivationCommands(t||void 0,n,e,r);return this.sendTelemetry(e,p.EventName.PYTHON_INTERPRETER_ACTIVATION_FOR_TERMINAL,n,i).ignoreErrors(),i}async getEnvironmentActivationShellCommands(e,t,n){if(this.platform.osType===g.OSType.Unknown)return;const r=[this.bashCShellFish,this.commandPromptAndPowerShell,this.nushell],i=this.getActivationCommands(e,n,t,r);return this.sendTelemetry(t,p.EventName.PYTHON_INTERPRETER_ACTIVATION_FOR_RUNNING_CODE,n,i).ignoreErrors(),i}async sendTelemetry(e,t,n,r){let i=!1,o=!1;try{const e=await r;i=Array.isArray(e)&&e.length>0}catch(e){o=!0,(0,c.traceError)("Failed to get activation commands",e)}const s=n&&n.version?n.version.raw:void 0,a={failed:o,hasCommands:i,interpreterType:n?n.envType:l.EnvironmentType.Unknown,terminal:e,pythonVersion:s};(0,u.sendTelemetryEvent)(t,void 0,a)}async getActivationCommands(e,t,n,r){const i=this.configurationService.getSettings(e),o=this.serviceContainer.get(s.IComponentAdapter);if(t?t.envType===l.EnvironmentType.Conda:await o.isCondaEnvironment(i.pythonPath)){const r=t?await this.conda.getActivationCommandsForInterpreter(t.path,n):await this.conda.getActivationCommands(e,n);if(Array.isArray(r))return r}const a=r.filter((e=>e.isShellSupported(n)));for(const r of a){const i=t?await r.getActivationCommandsForInterpreter(t.path,n):await r.getActivationCommands(e,n);if(Array.isArray(i)&&i.length>0)return i}}};r([(0,c.traceDecoratorError)("Failed to capture telemetry")],y.prototype,"sendTelemetry",null),y=r([(0,o.injectable)(),i(0,(0,o.inject)(h.IPlatformService)),i(1,(0,o.inject)(d.ITerminalManager)),i(2,(0,o.inject)(a.IServiceContainer)),i(3,(0,o.inject)(s.IInterpreterService)),i(4,(0,o.inject)(f.IConfigurationService)),i(5,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(5,(0,o.named)(v.TerminalActivationProviders.conda)),i(6,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(6,(0,o.named)(v.TerminalActivationProviders.bashCShellFish)),i(7,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(7,(0,o.named)(v.TerminalActivationProviders.commandPromptAndPowerShell)),i(8,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(8,(0,o.named)(v.TerminalActivationProviders.nushell)),i(9,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(9,(0,o.named)(v.TerminalActivationProviders.pyenv)),i(10,(0,o.inject)(v.ITerminalActivationCommandProvider)),i(10,(0,o.named)(v.TerminalActivationProviders.pipenv)),i(11,(0,o.multiInject)(v.IShellDetector))],y),t.TerminalHelper=y},97207:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalService=void 0;const o=n(86700),s=n(66828);n(32727);const a=n(18639),c=n(77498),l=n(54813),u=n(61522),p=n(43200),d=n(17585),h=n(61684),f=n(58400);let g=class{constructor(e,t){this.serviceContainer=e,this.options=t,this.terminalClosed=new s.EventEmitter;const n=this.serviceContainer.get(h.IDisposableRegistry);n.push(this),this.terminalHelper=this.serviceContainer.get(f.ITerminalHelper),this.terminalManager=this.serviceContainer.get(d.ITerminalManager),this.terminalAutoActivator=this.serviceContainer.get(p.ITerminalAutoActivation),this.terminalManager.onDidCloseTerminal(this.terminalCloseHandler,this,n),this.terminalActivator=this.serviceContainer.get(f.ITerminalActivator)}get onDidCloseTerminal(){return this.terminalClosed.event.bind(this.terminalClosed)}dispose(){this.terminal&&this.terminal.dispose()}async sendCommand(e,t,n){var r;await this.ensureTerminal();const i=this.terminalHelper.buildCommandForTerminal(this.terminalShellType,e,t);(null===(r=this.options)||void 0===r?void 0:r.hideFromUser)||this.terminal.show(!0),this.terminal.sendText(i,!0)}async sendText(e){var t;await this.ensureTerminal(),(null===(t=this.options)||void 0===t?void 0:t.hideFromUser)||this.terminal.show(!0),this.terminal.sendText(e)}async show(e=!0){var t;await this.ensureTerminal(e),(null===(t=this.options)||void 0===t?void 0:t.hideFromUser)||this.terminal.show(e)}async ensureTerminal(e=!0){var t,n,r,i,o,s,a;this.terminal||(this.terminalShellType=this.terminalHelper.identifyTerminalShell(this.terminal),this.terminal=this.terminalManager.createTerminal({name:(null===(t=this.options)||void 0===t?void 0:t.title)||"Python",env:null===(n=this.options)||void 0===n?void 0:n.env,hideFromUser:null===(r=this.options)||void 0===r?void 0:r.hideFromUser}),this.terminalAutoActivator.disableAutoActivation(this.terminal),await new Promise((e=>setTimeout(e,100))),await this.terminalActivator.activateEnvironmentInTerminal(this.terminal,{resource:null===(i=this.options)||void 0===i?void 0:i.resource,preserveFocus:e,interpreter:null===(o=this.options)||void 0===o?void 0:o.interpreter,hideFromUser:null===(s=this.options)||void 0===s?void 0:s.hideFromUser}),(null===(a=this.options)||void 0===a?void 0:a.hideFromUser)||this.terminal.show(e),this.sendTelemetry().ignoreErrors())}terminalCloseHandler(e){e===this.terminal&&(this.terminalClosed.fire(),this.terminal=void 0)}async sendTelemetry(){var e,t;const n=this.serviceContainer.get(h.IConfigurationService).getSettings(null===(e=this.options)||void 0===e?void 0:e.resource).pythonPath,r=(null===(t=this.options)||void 0===t?void 0:t.interpreter)||await this.serviceContainer.get(a.IInterpreterService).getInterpreterDetails(n),i=r&&r.version?r.version.raw:void 0,o=r?r.envType:void 0;(0,l.captureTelemetry)(u.EventName.TERMINAL_CREATE,{terminal:this.terminalShellType,pythonVersion:i,interpreterType:o})}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],g),t.TerminalService=g},71791:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ShellDetector=void 0;const o=n(86700),s=n(66828),a=n(19735),c=n(54813),l=n(61522);n(32727);const u=n(84974),p=n(87450),d=n(58400),h={[p.OSType.Linux]:d.TerminalShellType.bash,[p.OSType.OSX]:d.TerminalShellType.bash,[p.OSType.Windows]:d.TerminalShellType.commandPrompt,[p.OSType.Unknown]:d.TerminalShellType.other};let f=class{constructor(e,t){this.platform=e,this.shellDetectors=t}identifyTerminalShell(e){let t;const n={failed:!0,shellIdentificationSource:"default",terminalProvided:!!e,hasCustomShell:void 0,hasShellInEnv:void 0},r=this.shellDetectors.slice().sort(((e,t)=>t.priority-e.priority));for(const i of r)if(t=i.identify(n,e),(0,a.traceVerbose)(`${i}. Shell identified as ${t} ${e?`(Terminal name is ${e.name})`:""}`),t&&t!==d.TerminalShellType.other){n.failed=!1;break}return(0,c.sendTelemetryEvent)(l.EventName.TERMINAL_SHELL_IDENTIFICATION,void 0,n),(0,a.traceVerbose)(`Shell identified as '${t}'`),void 0!==t&&t!==d.TerminalShellType.other||((0,a.traceError)("Unable to identify shell",s.env.shell," for OS ",this.platform.osType),(0,a.traceVerbose)("Using default OS shell"),t=h[this.platform.osType]),t}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IPlatformService)),i(1,(0,o.multiInject)(d.IShellDetector))],f),t.ShellDetector=f},89465:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.identifyShellFromShellPath=t.BaseShellDetector=void 0;const o=n(86700),s=n(19735),a=n(58400),c=new Map;c.set(a.TerminalShellType.powershell,/(powershell$)/i),c.set(a.TerminalShellType.gitbash,/(gitbash$)/i),c.set(a.TerminalShellType.bash,/(bash$)/i),c.set(a.TerminalShellType.wsl,/(wsl$)/i),c.set(a.TerminalShellType.zsh,/(zsh$)/i),c.set(a.TerminalShellType.ksh,/(ksh$)/i),c.set(a.TerminalShellType.commandPrompt,/(cmd$)/i),c.set(a.TerminalShellType.fish,/(fish$)/i),c.set(a.TerminalShellType.tcshell,/(tcsh$)/i),c.set(a.TerminalShellType.cshell,/(csh$)/i),c.set(a.TerminalShellType.nushell,/(nu$)/i),c.set(a.TerminalShellType.powershellCore,/(pwsh$)/i),c.set(a.TerminalShellType.xonsh,/(xonsh$)/i);let l=class{constructor(e){this.priority=e}identifyShellFromShellPath(e){return u(e)}};function u(e){const t=e.replace(/\.exe$/,""),n=Array.from(c.keys()).reduce(((e,n)=>{if(e===a.TerminalShellType.other){const e=c.get(n);if(e&&e.test(t))return n}return e}),a.TerminalShellType.other);return(0,s.traceVerbose)(`Shell path '${e}', base path '${t}'`),(0,s.traceVerbose)(`Shell path identified as shell '${n}'`),n}l=r([(0,o.injectable)(),i(0,(0,o.unmanaged)())],l),t.BaseShellDetector=l,t.identifyShellFromShellPath=u},55928:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsShellDetector=void 0;const o=n(86700),s=n(19735),a=n(17585),c=n(84974),l=n(87450),u=n(58400),p=n(89465);let d=class extends p.BaseShellDetector{constructor(e,t){super(2),this.workspace=e,this.platform=t}getTerminalShellPath(){const e=this.workspace.getConfiguration("terminal.integrated.shell");let t="";switch(this.platform.osType){case l.OSType.Windows:t="windows";break;case l.OSType.OSX:t="osx";break;case l.OSType.Linux:t="linux";break;default:return""}return e.get(t)}identify(e,t){const n=this.getTerminalShellPath();e.hasCustomShell=!!n;const r=n?this.identifyShellFromShellPath(n):u.TerminalShellType.other;return r!==u.TerminalShellType.other?e.shellIdentificationSource="environment":e.shellIdentificationSource="settings",(0,s.traceVerbose)(`Shell path from user settings '${n}'`),r}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IWorkspaceService)),i(1,(0,o.inject)(c.IPlatformService))],d),t.SettingsShellDetector=d},81731:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalNameShellDetector=void 0;const i=n(86700),o=n(19735),s=n(58400),a=n(89465);let c=class extends a.BaseShellDetector{constructor(){super(4)}identify(e,t){if(!t)return;const n=this.identifyShellFromShellPath(t.name);return(0,o.traceVerbose)(`Terminal name '${t.name}' identified as shell '${n}'`),e.shellIdentificationSource=n===s.TerminalShellType.other?e.shellIdentificationSource:"terminalName",n}};c=r([(0,i.injectable)()],c),t.TerminalNameShellDetector=c},67482:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserEnvironmentShellDetector=void 0;const o=n(86700),s=n(19735),a=n(84974),c=n(61684),l=n(87450),u=n(58400),p=n(89465);let d=class extends p.BaseShellDetector{constructor(e,t){super(1),this.currentProcess=e,this.platform=t}getDefaultPlatformShell(){return e=this.platform,t=this.currentProcess,e.osType===l.OSType.Windows?function(e,t){const n=parseFloat(e.osRelease)>=10,r=t.env.hasOwnProperty("PROCESSOR_ARCHITEW6432"),i=`${t.env.windir}\\${r?"Sysnative":"System32"}\\WindowsPowerShell\\v1.0\\powershell.exe`;return n?i:function(e){return e.env.comspec||"cmd.exe"}(t)}(e,t):t.env.SHELL&&"/bin/false"!==t.env.SHELL?t.env.SHELL:"/bin/bash";var e,t}identify(e,t){const n=this.getDefaultPlatformShell();e.hasShellInEnv=!!n;const r=this.identifyShellFromShellPath(n);return r!==u.TerminalShellType.other&&(e.shellIdentificationSource="environment"),(0,s.traceVerbose)(`Shell path from user env '${n}'`),r}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(c.ICurrentProcess)),i(1,(0,o.inject)(a.IPlatformService))],d),t.UserEnvironmentShellDetector=d},80656:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSCEnvironmentShellDetector=void 0;const o=n(86700),s=n(19735),a=n(17585),c=n(58400),l=n(89465);let u=class extends l.BaseShellDetector{constructor(e){super(3),this.appEnv=e}identify(e,t){const n=(null==t?void 0:t.creationOptions)&&"shellPath"in t.creationOptions&&t.creationOptions.shellPath?t.creationOptions.shellPath:this.appEnv.shell;if(!n)return;const r=this.identifyShellFromShellPath(n);return(0,s.traceVerbose)(`Terminal shell path '${n}' identified as shell '${r}'`),e.shellIdentificationSource=r===c.TerminalShellType.other?e.shellIdentificationSource:"vscode",e.failed=r!==c.TerminalShellType.other,r}};u=r([i(0,(0,o.inject)(a.IApplicationEnvironment))],u),t.VSCEnvironmentShellDetector=u},88624:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronousTerminalService=void 0;const o=n(86700),s=n(18639),a=n(19735),c=n(29979),l=n(84974),u=n(4057),p=n(59314),d=n(3481);var h;!function(e){e[e.notStarted=0]="notStarted",e[e.started=1]="started",e[e.completed=2]="completed",e[e.errored=4]="errored"}(h||(h={}));class f{constructor(e,t,n){this.lockFile=e,this.fs=t,this.command=n,this.state=h.notStarted,this._completed=(0,p.createDeferred)(),this.registerStateUpdate(),this._completed.promise.finally((()=>this.dispose())).ignoreErrors()}get completed(){return this._completed.promise}dispose(){this.disposable&&(this.disposable.dispose(),this.disposable=void 0)}registerStateUpdate(){const e=setInterval((async()=>{const e=await this.getLockFileState(this.lockFile);if(e!==this.state&&(0,a.traceVerbose)(`Command state changed to ${e}. ${this.command.join(" ")}`),this.state=e,e&h.errored){const e=await this.fs.readFile(`${this.lockFile}.error`).catch((()=>""));this._completed.reject(new Error(`Command failed with errors, check the terminal for details. Command: ${this.command.join(" ")}\n${e}`))}else e&h.completed&&this._completed.resolve()}),100);this.disposable={dispose:()=>clearInterval(e)}}async getLockFileState(e){const t=await this.fs.readFile(e);let n=h.notStarted;return t.includes("START")&&(n|=h.started),t.includes("END")&&(n|=h.completed),t.includes("FAIL")&&(n|=h.completed|h.errored),n}}let g=class{constructor(e,t,n,r){this.fs=e,this.interpreter=t,this.terminalService=n,this.pythonInterpreter=r,this.disposables=[]}get onDidCloseTerminal(){return this.terminalService.onDidCloseTerminal}dispose(){for(this.terminalService.dispose();this.disposables.length;){const e=this.disposables.shift();if(!e)break;try{e.dispose()}catch(e){(0,d.noop)()}}}async sendCommand(e,t,n,r=!0){if(!n)return this.terminalService.sendCommand(e,t);const i=await this.createLockFile(),o=new f(i.filePath,this.fs,[e,...t]);try{const s=this.pythonInterpreter||await this.interpreter.getActiveInterpreter(void 0),a=u.shell_exec(e,i.filePath,t);await this.terminalService.sendCommand((null==s?void 0:s.path)||"python",a);const l=r?o.completed:o.completed.catch(d.noop);await c.Cancellation.race((()=>l),n)}finally{o.dispose(),i.dispose()}}sendText(e){return this.terminalService.sendText(e)}show(e){return this.terminalService.show(e)}createLockFile(){return this.fs.createTemporaryFile(".log").then((e=>(this.disposables.push(e),e)))}};g=r([i(0,(0,o.inject)(l.IFileSystem)),i(1,(0,o.inject)(s.IInterpreterService))],g),t.SynchronousTerminalService=g},58400:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.IShellDetector=t.ITerminalActivationHandler=t.ITerminalActivationCommandProvider=t.ITerminalActivator=t.ITerminalHelper=t.ITerminalServiceFactory=t.TerminalShellType=t.TerminalActivationProviders=void 0,(r=t.TerminalActivationProviders||(t.TerminalActivationProviders={})).bashCShellFish="bashCShellFish",r.commandPromptAndPowerShell="commandPromptAndPowerShell",r.nushell="nushell",r.pyenv="pyenv",r.conda="conda",r.pipenv="pipenv",(n=t.TerminalShellType||(t.TerminalShellType={})).powershell="powershell",n.powershellCore="powershellCore",n.commandPrompt="commandPrompt",n.gitbash="gitbash",n.bash="bash",n.zsh="zsh",n.ksh="ksh",n.fish="fish",n.cshell="cshell",n.tcshell="tshell",n.nushell="nushell",n.wsl="wsl",n.xonsh="xonsh",n.other="other",t.ITerminalServiceFactory=Symbol("ITerminalServiceFactory"),t.ITerminalHelper=Symbol("ITerminalHelper"),t.ITerminalActivator=Symbol("ITerminalActivator"),t.ITerminalActivationCommandProvider=Symbol("ITerminalActivationCommandProvider"),t.ITerminalActivationHandler=Symbol("ITerminalActivationHandler"),t.IShellDetector=Symbol("IShellDetector")},61684:(e,t)=>{"use strict";var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.IDefaultLanguageServer=t.IInterpreterPathService=t.IExperimentService=t.IEditorUtils=t.IBrowserService=t.IExtensions=t.IExtensionContext=t.ISocketServer=t.ToolExecutionPath=t.IToolExecutionPath=t.IConfigurationService=t.ICurrentProcess=t.IRandom=t.IPathUtils=t.IInstaller=t.Product=t.ProductType=t.ProductInstallStatus=t.InstallerResponse=t.IPersistentStateFactory=t.WORKSPACE_MEMENTO=t.GLOBAL_MEMENTO=t.IMemento=t.IDisposableRegistry=t.IsWindows=t.IDocumentSymbolProvider=t.ITestOutputChannel=t.ILogOutputChannel=void 0,t.ILogOutputChannel=Symbol("ILogOutputChannel"),t.ITestOutputChannel=Symbol("ITestOutputChannel"),t.IDocumentSymbolProvider=Symbol("IDocumentSymbolProvider"),t.IsWindows=Symbol("IS_WINDOWS"),t.IDisposableRegistry=Symbol("IDisposableRegistry"),t.IMemento=Symbol("IGlobalMemento"),t.GLOBAL_MEMENTO=Symbol("IGlobalMemento"),t.WORKSPACE_MEMENTO=Symbol("IWorkspaceMemento"),t.IPersistentStateFactory=Symbol("IPersistentStateFactory"),(o=t.InstallerResponse||(t.InstallerResponse={}))[o.Installed=0]="Installed",o[o.Disabled=1]="Disabled",o[o.Ignore=2]="Ignore",(i=t.ProductInstallStatus||(t.ProductInstallStatus={}))[i.Installed=0]="Installed",i[i.NotInstalled=1]="NotInstalled",i[i.NeedsUpgrade=2]="NeedsUpgrade",(r=t.ProductType||(t.ProductType={})).Linter="Linter",r.Formatter="Formatter",r.TestFramework="TestFramework",r.RefactoringLibrary="RefactoringLibrary",r.DataScience="DataScience",r.Python="Python",(n=t.Product||(t.Product={}))[n.pytest=1]="pytest",n[n.pylint=3]="pylint",n[n.flake8=4]="flake8",n[n.pycodestyle=5]="pycodestyle",n[n.pylama=6]="pylama",n[n.prospector=7]="prospector",n[n.pydocstyle=8]="pydocstyle",n[n.yapf=9]="yapf",n[n.autopep8=10]="autopep8",n[n.mypy=11]="mypy",n[n.unittest=12]="unittest",n[n.isort=15]="isort",n[n.black=16]="black",n[n.bandit=17]="bandit",n[n.tensorboard=24]="tensorboard",n[n.torchProfilerInstallName=25]="torchProfilerInstallName",n[n.torchProfilerImportName=26]="torchProfilerImportName",n[n.pip=27]="pip",n[n.ensurepip=28]="ensurepip",n[n.python=29]="python",t.IInstaller=Symbol("IInstaller"),t.IPathUtils=Symbol("IPathUtils"),t.IRandom=Symbol("IRandom"),t.ICurrentProcess=Symbol("ICurrentProcess"),t.IConfigurationService=Symbol("IConfigurationService"),t.IToolExecutionPath=Symbol("IToolExecutionPath"),(t.ToolExecutionPath||(t.ToolExecutionPath={})).pipenv="pipenv",t.ISocketServer=Symbol("ISocketServer"),t.IExtensionContext=Symbol("ExtensionContext"),t.IExtensions=Symbol("IExtensions"),t.IBrowserService=Symbol("IBrowserService"),t.IEditorUtils=Symbol("IEditorUtils"),t.IExperimentService=Symbol("IExperimentService"),t.IInterpreterPathService=Symbol("IInterpreterPathService"),t.IDefaultLanguageServer=Symbol("IDefaultLanguageServer")},99910:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncForEach=t.asyncFilter=void 0,t.asyncFilter=async function(e,t){const n=await Promise.all(e.map(t));return e.filter(((e,t)=>n[t]))},t.asyncForEach=async function(e,t){await Promise.all(e.map(t))}},59314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenIterator=t.iterable=t.mapToIterator=t.chain=t.iterEmpty=t.createDeferredFromPromise=t.createDeferredFrom=t.createDeferred=t.isPromise=t.isThenable=t.sleep=void 0,t.sleep=async function(e){return new Promise((t=>{setTimeout((()=>t(e)),e)}))},t.isThenable=function(e){return"function"==typeof(null==e?void 0:e.then)},t.isPromise=function(e){return"function"==typeof(null==e?void 0:e.then)&&"function"==typeof(null==e?void 0:e.catch)};class n{constructor(e=null){this.scope=e,this._resolved=!1,this._rejected=!1,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}resolve(e){this.completed||(this._resolve.apply(this.scope?this.scope:this,[e]),this._resolved=!0)}reject(e){this.completed||(this._reject.apply(this.scope?this.scope:this,[e]),this._rejected=!0)}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}}function r(e=null){return new n(e)}async function i(e,t){const n=void 0===t?-1:t;try{return{index:n,result:await e.next(),err:null}}catch(e){return{index:n,err:e,result:null}}}t.createDeferred=r,t.createDeferredFrom=function(...e){const t=r();return Promise.all(e).then(t.resolve.bind(t)).catch(t.reject.bind(t)),t},t.createDeferredFromPromise=function(e){const t=r();return e.then(t.resolve.bind(t)).catch(t.reject.bind(t)),t},t.iterEmpty=function(){return async function*(){}()};const o=new Promise((()=>{}));async function*s(e,t){const n=e.map(i);let r=e.length;for(;r>0;){const{index:s,result:a,err:c}=await Promise.race(n);null!==c?(n[s]=o,r-=1,void 0!==t&&await t(c,s)):a.done?(n[s]=o,r-=1,void 0!==a.value&&(yield a.value)):(n[s]=i(e[s],s),yield a.value)}}function a(e){const t=e;return void 0===t[Symbol.asyncIterator]&&(t[Symbol.asyncIterator]=()=>t),t}t.chain=s,t.mapToIterator=async function*(e,t,n=!0){if(n){const n=e.map((e=>async function*(){yield t(e)}()));yield*a(s(n))}else yield*e.map(t)},t.iterable=a,t.flattenIterator=async function(e){const t=[];for await(const n of a(e))t.push(n);return t}},35144:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryCache=t.clearCache=t.getCacheKeyFromFunctionArgs=t.getGlobalCacheStore=void 0;const n=new Map;t.getGlobalCacheStore=function(){return n},t.getCacheKeyFromFunctionArgs=function(e,t){return`KeyPrefix=${e}-Args=${t.map((e=>`${JSON.stringify(e)}`)).join("-Arg-Separator-")}`},t.clearCache=function(){n.clear()},t.InMemoryCache=class{constructor(e){this.expiryDurationMs=e}get hasData(){return!(!this.cacheData||this.hasExpired(this.cacheData.expiry))||(this.cacheData=void 0,!1)}get data(){var e;if(this.hasData)return null===(e=this.cacheData)||void 0===e?void 0:e.value}set data(e){this.cacheData=void 0!==e?{expiry:this.calculateExpiry(),value:e}:void 0}clear(){this.cacheData=void 0}hasExpired(e){return e<=Date.now()}calculateExpiry(){return Date.now()+this.expiryDurationMs}}},36952:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swallowExceptions=t.cache=t.makeDebounceAsyncDecorator=t.makeDebounceDecorator=t.debounceAsync=t.debounceSync=void 0,n(32727);const r=n(19735),i=n(77570),o=n(59314),s=n(35144),a=n(70057),c=n(23279);function l(e){return function(t,n,r){const i=r.value,o=c((function(){return i.apply(this,arguments)}),e,{});r.value=o}}function u(e){return function(t,n,r){const i=r.value,s={started:!1,deferred:void 0,timer:void 0};r.value=function(){const t=s.deferred;if(t&&s.started)return t.promise;const n=t&&t.completed,r=s.deferred=!t||n?(0,o.createDeferred)():t;return s.timer&&clearTimeout(s.timer),s.timer=setTimeout((async()=>{s.started=!0,i.apply(this).then((e=>{s.started=!1,r.resolve(e)})).catch((e=>{s.started=!1,r.reject(e)}))}),e||0),r.promise}}}t.debounceSync=function(e){return(0,i.isTestExecution)()&&(e=void 0),l(e)},t.debounceAsync=function(e){return(0,i.isTestExecution)()&&(e=void 0),u(e)},t.makeDebounceDecorator=l,t.makeDebounceAsyncDecorator=u;const p=(0,s.getGlobalCacheStore)(),d=new a.StopWatch;t.cache=function(e,t=!1,n){return function(o,a,c){const l=c.value,u=`Cache_Method_Output_${"constructor"in o&&o.constructor.name?o.constructor.name:""}.${a}`;c.value=async function(...o){if((0,i.isTestExecution)())return l.apply(this,o);let a;try{a=(0,s.getCacheKeyFromFunctionArgs)(u,o)}catch(e){return(0,r.traceError)("Error while creating key for keyPrefix:",u,e),l.apply(this,o)}const c=p.get(a);if(c&&(c.expiry>Date.now()||-1===e))return(0,r.traceVerbose)(`Cached data exists ${a}`),Promise.resolve(c.data);const h=n&&d.elapsedTime>2e5?n:e,f=l.apply(this,o);return t?p.set(a,{data:f,expiry:Date.now()+h}):f.then((e=>p.set(a,{data:e,expiry:Date.now()+h}))).ignoreErrors(),f}}},t.swallowExceptions=function(e){return function(t,n,o){const s=o.value,a=`Python Extension (Error in ${e||n}, method:${n}):`;o.value=function(...e){try{const t=s.apply(this,e);if(t&&"function"==typeof t.then&&"function"==typeof t.catch)return t.catch((e=>{(0,i.isTestExecution)()||(0,r.traceError)(a,e)}))}catch(e){if((0,i.isTestExecution)())return;(0,r.traceError)(a,e)}}}}},4100:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DelayedTrigger=void 0;const r=n(39512),i=n(19735);t.DelayedTrigger=class{constructor(e,t,n){this.callback=e,this.ms=t,this.name=n,this.triggeredCounter=0,this.calledCounter=0}trigger(...e){this.triggeredCounter+=1,this.timerId&&(0,r.clearTimeout)(this.timerId),this.timerId=(0,r.setTimeout)((()=>{this.calledCounter+=1,(0,i.traceVerbose)(`Delay Trigger[${this.name}]: triggered=${this.triggeredCounter}, called=${this.calledCounter}`),this.callback(...e)}),this.ms)}dispose(){this.timerId&&(0,r.clearTimeout)(this.timerId)}}},47237:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidAndExecutable=t.getSearchPathEntries=t.getSearchPathEnvVarNames=void 0;const r=n(57147),i=n(71017),o=n(87450);function s(e=(0,o.getOSType)()){return e===o.OSType.Windows?["Path","PATH"]:["PATH"]}t.getSearchPathEnvVarNames=s,t.getSearchPathEntries=function(){const e=s();for(const t of e){const e=(0,o.getEnvironmentVariable)(t);if(void 0!==e)return e.split(i.delimiter).map((e=>e.trim())).filter((e=>e.length>0))}return[]},t.isValidAndExecutable=async function(e){try{await r.promises.access(e,r.constants.X_OK)}catch(e){return!1}if((0,o.getOSType)()!==o.OSType.Windows)return!0}},56091:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileFilter=t.getFileType=t.convertFileType=t.FileType=void 0;const r=n(57147),i=n(66828),o=n(19735);function s(e){return e.isFile()?t.FileType.File:e.isDirectory()?t.FileType.Directory:e.isSymbolicLink()?t.FileType.SymbolicLink:t.FileType.Unknown}async function a(e,n={ignoreErrors:!0}){let i;try{i=await r.promises.lstat(e)}catch(r){if("ENOENT"===r.code)return;if(n.ignoreErrors)return(0,o.traceError)(`lstat() failed for "${e}" (${r})`),t.FileType.Unknown;throw r}return s(i)}t.FileType=i.FileType,t.convertFileType=s,t.getFileType=a,t.getFileFilter=function(e={ignoreMissing:!0}){const n=function(e){if(void 0!==e){if(Array.isArray(e)){if(0===e.length)return;return e}return[e]}}(e.ignoreFileType);if(e.ignoreMissing||n)return async function(r){let i=await async function(e,t={}){let n;if("string"!=typeof e){if(!t.ensure){if(void 0===t.onMissing)return e;if(void 0!==await a(e.filename))return e}n=e.filename}else n=e;const r=await a(n)||t.onMissing;if(void 0!==r)return{filename:n,filetype:r}}(r,{ensure:e.ensureEntry});if(!i){if(e.ignoreMissing)return!1;i={filename:"string"==typeof r?r:r.filename,filetype:t.FileType.Unknown}}return!n||!n.includes(i.filetype)}}},1040:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=void 0;const r=n(71017),i=n(66828),o=n(63281),s=r.join(o.EXTENSION_ROOT_DIR,"resources","dark"),a=r.join(o.EXTENSION_ROOT_DIR,"resources","light");t.getIcon=function(e){return{dark:i.Uri.file(r.join(s,e)),light:i.Uri.file(r.join(a,e))}}},67098:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ToolsExtensions=t.CreateEnv=t.SwitchToDefaultLS=t.Python27Support=t.OutdatedDebugger=t.Testing=t.DebugConfigStrings=t.ExtensionSurveyBanner=t.Installer=t.Linters=t.OutputChannelNames=t.InterpreterQuickPickList=t.Interpreters=t.LanguageService=t.TensorBoard=t.Pylance=t.AttachProcess=t.CommonSurvey=t.Common=t.Diagnostics=void 0;const r=n(66828);var i,o,s,a,c,l,u,p,d,h,f,g,m,v;(v=t.Diagnostics||(t.Diagnostics={})).warnSourceMaps=r.l10n.t("Source map support is enabled in the Python Extension, this will adversely impact performance of the extension."),v.disableSourceMaps=r.l10n.t("Disable Source Map Support"),v.warnBeforeEnablingSourceMaps=r.l10n.t("Enabling source map support in the Python Extension will adversely impact performance of the extension."),v.enableSourceMapsAndReloadVSC=r.l10n.t("Enable and reload Window."),v.lsNotSupported=r.l10n.t("Your operating system does not meet the minimum requirements of the Python Language Server. Reverting to the alternative autocompletion provider, Jedi."),v.invalidPythonPathInDebuggerSettings=r.l10n.t('You need to select a Python interpreter before you start debugging.\n\nTip: click on "Select Interpreter" in the status bar.'),v.invalidPythonPathInDebuggerLaunch=r.l10n.t("The Python path in your debug configuration is invalid."),v.invalidDebuggerTypeDiagnostic=r.l10n.t('Your launch.json file needs to be updated to change the "pythonExperimental" debug configurations to use the "python" debugger type, otherwise Python debugging may not work. Would you like to automatically update your launch.json file now?'),v.consoleTypeDiagnostic=r.l10n.t('Your launch.json file needs to be updated to change the console type string from "none" to "internalConsole", otherwise Python debugging may not work. Would you like to automatically update your launch.json file now?'),v.justMyCodeDiagnostic=r.l10n.t('Configuration "debugStdLib" in launch.json is no longer supported. It\'s recommended to replace it with "justMyCode", which is the exact opposite of using "debugStdLib". Would you like to automatically update your launch.json file to do that?'),v.yesUpdateLaunch=r.l10n.t("Yes, update launch.json"),v.invalidTestSettings=r.l10n.t('Your settings needs to be updated to change the setting "python.unitTest." to "python.testing.", otherwise testing Python code using the extension may not work. Would you like to automatically update your settings now?'),v.updateSettings=r.l10n.t("Yes, update settings"),v.checkIsort5UpgradeGuide=r.l10n.t("We found outdated configuration for sorting imports in this workspace. Check the [isort upgrade guide](https://aka.ms/AA9j5x4) to update your settings."),v.pylanceDefaultMessage=r.l10n.t("The Python extension now includes Pylance to improve completions, code navigation, overall performance and much more! You can learn more about the update and learn how to change your language server [here](https://aka.ms/new-python-bundle).\n\nRead Pylance's license [here](https://marketplace.visualstudio.com/items/ms-python.vscode-pylance/license)."),(m=t.Common||(t.Common={})).allow=r.l10n.t("Allow"),m.seeInstructions=r.l10n.t("See Instructions"),m.close=r.l10n.t("Close"),m.bannerLabelYes=r.l10n.t("Yes"),m.bannerLabelNo=r.l10n.t("No"),m.canceled=r.l10n.t("Canceled"),m.cancel=r.l10n.t("Cancel"),m.ok=r.l10n.t("Ok"),m.error=r.l10n.t("Error"),m.gotIt=r.l10n.t("Got it!"),m.install=r.l10n.t("Install"),m.loadingExtension=r.l10n.t("Python extension loading..."),m.openOutputPanel=r.l10n.t("Show output"),m.noIWillDoItLater=r.l10n.t("No, I will do it later"),m.notNow=r.l10n.t("Not now"),m.doNotShowAgain=r.l10n.t("Don't show again"),m.reload=r.l10n.t("Reload"),m.moreInfo=r.l10n.t("More Info"),m.learnMore=r.l10n.t("Learn more"),m.and=r.l10n.t("and"),m.reportThisIssue=r.l10n.t("Report this issue"),m.recommended=r.l10n.t("Recommended"),m.clearAll=r.l10n.t("Clear all"),m.alwaysIgnore=r.l10n.t("Always Ignore"),m.ignore=r.l10n.t("Ignore"),m.selectPythonInterpreter=r.l10n.t("Select Python Interpreter"),m.openLaunch=r.l10n.t("Open launch.json"),m.useCommandPrompt=r.l10n.t("Use Command Prompt"),m.download=r.l10n.t("Download"),m.showLogs=r.l10n.t("Show logs"),m.openFolder=r.l10n.t("Open Folder..."),(g=t.CommonSurvey||(t.CommonSurvey={})).remindMeLaterLabel=r.l10n.t("Remind me later"),g.yesLabel=r.l10n.t("Yes, take survey now"),g.noLabel=r.l10n.t("No, thanks"),(f=t.AttachProcess||(t.AttachProcess={})).attachTitle=r.l10n.t("Attach to process"),f.selectProcessPlaceholder=r.l10n.t("Select the process to attach to"),f.noProcessSelected=r.l10n.t("No process selected"),f.refreshList=r.l10n.t("Refresh process list"),(h=t.Pylance||(t.Pylance={})).remindMeLater=r.l10n.t("Remind me later"),h.pylanceNotInstalledMessage=r.l10n.t("Pylance extension is not installed."),h.pylanceInstalledReloadPromptMessage=r.l10n.t("Pylance extension is now installed. Reload window to activate?"),h.pylanceRevertToJediPrompt=r.l10n.t('The Pylance extension is not installed but the python.languageServer value is set to "Pylance". Would you like to install the Pylance extension to use Pylance, or revert back to Jedi?'),h.pylanceInstallPylance=r.l10n.t("Install Pylance"),h.pylanceRevertToJedi=r.l10n.t("Revert to Jedi"),(d=t.TensorBoard||(t.TensorBoard={})).enterRemoteUrl=r.l10n.t("Enter remote URL"),d.enterRemoteUrlDetail=r.l10n.t("Enter a URL pointing to a remote directory containing your TensorBoard log files"),d.useCurrentWorkingDirectoryDetail=r.l10n.t("TensorBoard will search for tfevent files in all subdirectories of the current working directory"),d.useCurrentWorkingDirectory=r.l10n.t("Use current working directory"),d.logDirectoryPrompt=r.l10n.t("Select a log directory to start TensorBoard with"),d.progressMessage=r.l10n.t("Starting TensorBoard session..."),d.nativeTensorBoardPrompt=r.l10n.t('VS Code now has integrated TensorBoard support. Would you like to launch TensorBoard?  (Tip: Launch TensorBoard anytime by opening the command palette and searching for "Launch TensorBoard".)'),d.selectAFolder=r.l10n.t("Select a folder"),d.selectAFolderDetail=r.l10n.t("Select a log directory containing tfevent files"),d.selectAnotherFolder=r.l10n.t("Select another folder"),d.selectAnotherFolderDetail=r.l10n.t("Use the file explorer to select another folder"),d.installPrompt=r.l10n.t("The package TensorBoard is required to launch a TensorBoard session. Would you like to install it?"),d.installTensorBoardAndProfilerPluginPrompt=r.l10n.t("TensorBoard >= 2.4.1 and the PyTorch Profiler TensorBoard plugin >= 0.2.0 are required. Would you like to install these packages?"),d.installProfilerPluginPrompt=r.l10n.t("We recommend installing version >= 0.2.0 of the PyTorch Profiler TensorBoard plugin. Would you like to install the package?"),d.upgradePrompt=r.l10n.t("Integrated TensorBoard support is only available for TensorBoard >= 2.4.1. Would you like to upgrade your copy of TensorBoard?"),d.launchNativeTensorBoardSessionCodeLens=r.l10n.t(" Launch TensorBoard Session"),d.launchNativeTensorBoardSessionCodeAction=r.l10n.t("Launch TensorBoard session"),d.missingSourceFile=r.l10n.t("The Python extension could not locate the requested source file on disk. Please manually specify the file."),d.selectMissingSourceFile=r.l10n.t("Choose File"),d.selectMissingSourceFileDescription=r.l10n.t("The source file's contents may not match the original contents in the trace."),(p=t.LanguageService||(t.LanguageService={})).virtualWorkspaceStatusItem={detail:r.l10n.t("Limited IntelliSense supported by Jedi and Pylance")},p.statusItem={name:r.l10n.t("Python IntelliSense Status"),text:r.l10n.t("Partial Mode"),detail:r.l10n.t("Limited IntelliSense provided by Pylance")},p.startingPylance=r.l10n.t("Starting Pylance language server."),p.startingNone=r.l10n.t("Editor support is inactive since language server is set to None."),p.untrustedWorkspaceMessage=r.l10n.t("Only Pylance is supported in untrusted workspaces, setting language server to None."),p.reloadAfterLanguageServerChange=r.l10n.t("Reload the window after switching between language servers."),p.lsFailedToStart=r.l10n.t("We encountered an issue starting the language server. Reverting to Jedi language engine. Check the Python output panel for details."),p.lsFailedToDownload=r.l10n.t("We encountered an issue downloading the language server. Reverting to Jedi language engine. Check the Python output panel for details."),p.lsFailedToExtract=r.l10n.t("We encountered an issue extracting the language server. Reverting to Jedi language engine. Check the Python output panel for details."),p.downloadFailedOutputMessage=r.l10n.t("Language server download failed."),p.extractionFailedOutputMessage=r.l10n.t("Language server extraction failed."),p.extractionCompletedOutputMessage=r.l10n.t("Language server download complete."),p.extractionDoneOutputMessage=r.l10n.t("done."),p.reloadVSCodeIfSeachPathHasChanged=r.l10n.t("Search paths have changed for this Python interpreter. Reload the extension to ensure that the IntelliSense works correctly."),(u=t.Interpreters||(t.Interpreters={})).requireJupyter=r.l10n.t("Running in Interactive window requires Jupyter Extension. Would you like to install it? [Learn more](https://aka.ms/pythonJupyterSupport)."),u.installingPython=r.l10n.t("Installing Python into Environment..."),u.discovering=r.l10n.t("Discovering Python Interpreters"),u.refreshing=r.l10n.t("Refreshing Python Interpreters"),u.condaInheritEnvMessage=r.l10n.t('We noticed you\'re using a conda environment. If you are experiencing issues with this environment in the integrated terminal, we recommend that you let the Python extension change "terminal.integrated.inheritEnv" to false in your user settings. [Learn more](https://aka.ms/AA66i8f).'),u.activatingTerminals=r.l10n.t("Reactivating terminals..."),u.activateTerminalDescription=r.l10n.t("Activated environment for"),u.terminalEnvVarCollectionPrompt=r.l10n.t("The Python extension automatically activates all terminals using the selected environment, even when the name of the environment{0} is not present in the terminal prompt. [Learn more](https://aka.ms/vscodePythonTerminalActivation)."),u.activatedCondaEnvLaunch=r.l10n.t("We noticed VS Code was launched from an activated conda environment, would you like to select it?"),u.environmentPromptMessage=r.l10n.t("We noticed a new environment has been created. Do you want to select it for the workspace folder?"),u.entireWorkspace=r.l10n.t("Select at workspace level"),u.clearAtWorkspace=r.l10n.t("Clear at workspace level"),u.selectInterpreterTip=r.l10n.t("Tip: you can change the Python interpreter used by the Python extension by clicking on the Python version in the status bar"),u.installPythonTerminalMessageLinux=r.l10n.t(" Try installing the Python package using your package manager. Alternatively you can also download it from https://www.python.org/downloads"),u.installPythonTerminalMacMessage=r.l10n.t(" Brew does not seem to be available. You can download Python from https://www.python.org/downloads. Alternatively, you can install the Python package using some other available package manager."),u.changePythonInterpreter=r.l10n.t("Change Python Interpreter"),u.selectedPythonInterpreter=r.l10n.t("Selected Python Interpreter"),(l=t.InterpreterQuickPickList||(t.InterpreterQuickPickList={})).condaEnvWithoutPythonTooltip=r.l10n.t("Python is not available in this environment, it will automatically be installed upon selecting it"),l.noPythonInstalled=r.l10n.t("Python is not installed"),l.clickForInstructions=r.l10n.t("Click for instructions..."),l.globalGroupName=r.l10n.t("Global"),l.workspaceGroupName=r.l10n.t("Workspace"),l.enterPath={label:r.l10n.t("Enter interpreter path..."),placeholder:r.l10n.t("Enter path to a Python interpreter.")},l.defaultInterpreterPath={label:r.l10n.t("Use Python from `python.defaultInterpreterPath` setting")},l.browsePath={label:r.l10n.t("Find..."),detail:r.l10n.t("Browse your file system to find a Python interpreter."),openButtonLabel:r.l10n.t("Select Interpreter"),title:r.l10n.t("Select Python interpreter")},l.refreshInterpreterList=r.l10n.t("Refresh Interpreter list"),l.refreshingInterpreterList=r.l10n.t("Refreshing Interpreter list..."),(c=t.OutputChannelNames||(t.OutputChannelNames={})).languageServer=r.l10n.t("Python Language Server"),c.python=r.l10n.t("Python"),c.pythonTest=r.l10n.t("Python Test Log"),(t.Linters||(t.Linters={})).selectLinter=r.l10n.t("Select Linter"),(a=t.Installer||(t.Installer={})).noCondaOrPipInstaller=r.l10n.t("There is no Conda or Pip installer available in the selected environment."),a.noPipInstaller=r.l10n.t("There is no Pip installer available in the selected environment."),a.searchForHelp=r.l10n.t("Search for help"),(s=t.ExtensionSurveyBanner||(t.ExtensionSurveyBanner={})).bannerMessage=r.l10n.t("Can you take 2 minutes to tell us how the Python extension is working for you?"),s.bannerLabelYes=r.l10n.t("Yes, take survey now"),s.bannerLabelNo=r.l10n.t("No, thanks"),s.maybeLater=r.l10n.t("Maybe later"),function(e){let t,n,i,o,s,a,c,l;e.selectConfiguration={title:r.l10n.t("Select a debug configuration"),placeholder:r.l10n.t("Debug Configuration")},e.launchJsonCompletions={label:r.l10n.t("Python"),description:r.l10n.t("Select a Python debug configuration")},function(e){e.snippet={name:r.l10n.t("Python: Current File")},e.selectConfiguration={label:r.l10n.t("Python File"),description:r.l10n.t("Debug the currently active Python file")}}(t=e.file||(e.file={})),function(e){e.snippet={name:r.l10n.t("Python: Module"),default:r.l10n.t("enter-your-module-name")},e.selectConfiguration={label:r.l10n.t("Module"),description:r.l10n.t("Debug a Python module by invoking it with '-m'")},e.enterModule={title:r.l10n.t("Debug Module"),prompt:r.l10n.t("Enter a Python module/package name"),default:r.l10n.t("enter-your-module-name"),invalid:r.l10n.t("Enter a valid module name")}}(n=e.module||(e.module={})),function(e){e.snippet={name:r.l10n.t("Python: Remote Attach")},e.selectConfiguration={label:r.l10n.t("Remote Attach"),description:r.l10n.t("Attach to a remote debug server")},e.enterRemoteHost={title:r.l10n.t("Remote Debugging"),prompt:r.l10n.t("Enter a valid host name or IP address"),invalid:r.l10n.t("Enter a valid host name or IP address")},e.enterRemotePort={title:r.l10n.t("Remote Debugging"),prompt:r.l10n.t("Enter the port number that the debug server is listening on"),invalid:r.l10n.t("Enter a valid port number")}}(i=e.attach||(e.attach={})),function(e){e.snippet={name:r.l10n.t("Python: Attach using Process Id")},e.selectConfiguration={label:r.l10n.t("Attach using Process ID"),description:r.l10n.t("Attach to a local process")}}(o=e.attachPid||(e.attachPid={})),function(e){e.snippet={name:r.l10n.t("Python: Django")},e.selectConfiguration={label:r.l10n.t("Django"),description:r.l10n.t("Launch and debug a Django web application")},e.enterManagePyPath={title:r.l10n.t("Debug Django"),prompt:r.l10n.t("Enter the path to manage.py ('${workspaceFolder}' points to the root of the current workspace folder)"),invalid:r.l10n.t("Enter a valid Python file path")}}(s=e.django||(e.django={})),function(e){e.snippet={name:r.l10n.t("Python: FastAPI")},e.selectConfiguration={label:r.l10n.t("FastAPI"),description:r.l10n.t("Launch and debug a FastAPI web application")},e.enterAppPathOrNamePath={title:r.l10n.t("Debug FastAPI"),prompt:r.l10n.t("Enter the path to the application, e.g. 'main.py' or 'main'"),invalid:r.l10n.t("Enter a valid name")}}(a=e.fastapi||(e.fastapi={})),function(e){e.snippet={name:r.l10n.t("Python: Flask")},e.selectConfiguration={label:r.l10n.t("Flask"),description:r.l10n.t("Launch and debug a Flask web application")},e.enterAppPathOrNamePath={title:r.l10n.t("Debug Flask"),prompt:r.l10n.t("Python: Flask"),invalid:r.l10n.t("Enter a valid name")}}(c=e.flask||(e.flask={})),function(e){e.snippet={name:r.l10n.t("Python: Pyramid Application")},e.selectConfiguration={label:r.l10n.t("Pyramid"),description:r.l10n.t("Launch and debug a Pyramid web application")},e.enterDevelopmentIniPath={title:r.l10n.t("Debug Pyramid"),invalid:r.l10n.t("Enter a valid file path")}}(l=e.pyramid||(e.pyramid={}))}(t.DebugConfigStrings||(t.DebugConfigStrings={})),(o=t.Testing||(t.Testing={})).configureTests=r.l10n.t("Configure Test Framework"),o.testNotConfigured=r.l10n.t("No test framework configured."),o.cancelUnittestDiscovery=r.l10n.t("Canceled unittest test discovery"),o.errorUnittestDiscovery=r.l10n.t("Unittest test discovery error"),o.cancelPytestDiscovery=r.l10n.t("Canceled pytest test discovery"),o.errorPytestDiscovery=r.l10n.t("pytest test discovery error"),o.seePythonOutput=r.l10n.t("(see Output > Python)"),o.cancelUnittestExecution=r.l10n.t("Canceled unittest test execution"),o.errorUnittestExecution=r.l10n.t("Unittest test execution error"),o.cancelPytestExecution=r.l10n.t("Canceled pytest test execution"),o.errorPytestExecution=r.l10n.t("Pytest test execution error"),(t.OutdatedDebugger||(t.OutdatedDebugger={})).outdatedDebuggerMessage=r.l10n.t("We noticed you are attaching to ptvsd (Python debugger), which was deprecated on May 1st, 2020. Use [debugpy](https://aka.ms/migrateToDebugpy) instead."),(t.Python27Support||(t.Python27Support={})).jediMessage=r.l10n.t("IntelliSense with Jedi for Python 2.7 is no longer supported. [Learn more](https://aka.ms/python-27-support)."),(t.SwitchToDefaultLS||(t.SwitchToDefaultLS={})).bannerMessage=r.l10n.t("The Microsoft Python Language Server has reached end of life. Your language server has been set to the default for Python in VS Code, Pylance.\n\nIf you'd like to change your language server, you can learn about how to do so [here](https://devblogs.microsoft.com/python/python-in-visual-studio-code-may-2021-release/#configuring-your-language-server).\n\nRead Pylance's license [here](https://marketplace.visualstudio.com/items/ms-python.vscode-pylance/license)."),function(e){let t,n;e.informEnvCreation=r.l10n.t("The following environment is selected:"),e.statusTitle=r.l10n.t("Creating environment"),e.statusStarting=r.l10n.t("Starting..."),e.hasVirtualEnv=r.l10n.t("Workspace folder contains a virtual environment"),e.noWorkspace=r.l10n.t("A workspace is required when creating an environment using venv."),e.pickWorkspacePlaceholder=r.l10n.t("Select a workspace to create environment"),e.providersQuickPickPlaceholder=r.l10n.t("Select an environment type"),function(e){e.creating=r.l10n.t("Creating venv..."),e.creatingMicrovenv=r.l10n.t("Creating microvenv..."),e.created=r.l10n.t("Environment created..."),e.existing=r.l10n.t("Using existing environment..."),e.downloadingPip=r.l10n.t("Downloading pip..."),e.installingPip=r.l10n.t("Installing pip..."),e.upgradingPip=r.l10n.t("Upgrading pip..."),e.installingPackages=r.l10n.t("Installing packages..."),e.errorCreatingEnvironment=r.l10n.t("Error while creating virtual environment."),e.selectPythonPlaceHolder=r.l10n.t("Select a Python installation to create the virtual environment"),e.providerDescription=r.l10n.t("Creates a `.venv` virtual environment in the current workspace"),e.error=r.l10n.t("Creating virtual environment failed with error."),e.tomlExtrasQuickPickTitle=r.l10n.t("Select optional dependencies to install from pyproject.toml"),e.requirementsQuickPickTitle=r.l10n.t("Select dependencies to install"),e.recreate=r.l10n.t("Recreate"),e.recreateDescription=r.l10n.t('Delete existing ".venv" environment and create a new one'),e.useExisting=r.l10n.t("Use Existing"),e.useExistingDescription=r.l10n.t('Use existing ".venv" environment with no changes to it'),e.existingVenvQuickPickPlaceholder=r.l10n.t('Choose an option to handle the existing ".venv" environment'),e.deletingEnvironmentProgress=r.l10n.t('Deleting existing ".venv" environment...'),e.errorDeletingEnvironment=r.l10n.t('Error while deleting existing ".venv" environment.')}(t=e.Venv||(e.Venv={})),function(e){e.condaMissing=r.l10n.t("Install `conda` to create conda environments."),e.created=r.l10n.t("Environment created..."),e.installingPackages=r.l10n.t("Installing packages..."),e.errorCreatingEnvironment=r.l10n.t("Error while creating conda environment."),e.selectPythonQuickPickPlaceholder=r.l10n.t("Select the version of Python to install in the environment"),e.creating=r.l10n.t("Creating conda environment..."),e.providerDescription=r.l10n.t("Creates a `.conda` Conda environment in the current workspace")}(n=e.Conda||(e.Conda={}))}(t.CreateEnv||(t.CreateEnv={})),(i=t.ToolsExtensions||(t.ToolsExtensions={})).flake8PromptMessage=r.l10n.t("Use the Flake8 extension to enable easier configuration and new features such as quick fixes."),i.pylintPromptMessage=r.l10n.t("Use the Pylint extension to enable easier configuration and new features such as quick fixes."),i.isortPromptMessage=r.l10n.t("To use sort imports, install the isort extension. It provides easier configuration and new features such as code actions."),i.installPylintExtension=r.l10n.t("Install Pylint extension"),i.installFlake8Extension=r.l10n.t("Install Flake8 extension"),i.installISortExtension=r.l10n.t("Install isort extension"),i.selectBlackFormatterPrompt=r.l10n.t("You have the Black formatter extension installed, would you like to use that as the default formatter?"),i.selectAutopep8FormatterPrompt=r.l10n.t("You have the Autopep8 formatter extension installed, would you like to use that as the default formatter?"),i.selectMultipleFormattersPrompt=r.l10n.t("You have multiple formatters installed, would you like to select one as the default formatter?"),i.installBlackFormatterPrompt=r.l10n.t("You triggered formatting with Black, would you like to install one of our new formatter extensions? This will also set it as the default formatter for Python."),i.installAutopep8FormatterPrompt=r.l10n.t("You triggered formatting with Autopep8, would you like to install one of our new formatter extension? This will also set it as the default formatter for Python.")},3481:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNotebookCell=t.getURIFilter=t.isResource=t.noop=void 0;const r=n(77570),i=n(48431);t.noop=function(){},t.isResource=function(e){if(!e)return!0;const t=e;return"string"==typeof t.path&&"string"==typeof t.scheme},t.getURIFilter=function(e,t={checkParent:!0}){let n=e.path;for(;n.endsWith("/");)n=n.slice(0,-1);const r=`${n}/`;return function(e){let o=e.path;for(;o.endsWith("/");)o=o.slice(0,-1);if(t.checkParent&&(0,i.isParentPath)(o,r))return!0;if(t.checkChild){const e=`${o}/`;if((0,i.isParentPath)(n,e))return!0}return!1}},t.isNotebookCell=function(e){const t=function(e){if(!e)return!1;const t=e;return"string"==typeof t.path&&"string"==typeof t.scheme}(e)?e:e.uri;return t.scheme.includes(r.NotebookCellScheme)||t.scheme.includes(r.InteractiveInputScheme)}},22207:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MultiStepInputFactory=t.IMultiStepInputFactory=t.MultiStepInput=t.InputFlowAction=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(59314);class l{constructor(){}}t.InputFlowAction=l,l.back=new l,l.cancel=new l,l.resume=new l;class u{constructor(e){this.shell=e,this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick({title:e,step:t,totalSteps:n,items:r,activeItem:i,placeholder:o,customButtonSetups:a,matchOnDescription:u,matchOnDetail:p,acceptFilterBoxTextAsSelection:d,onChangeItem:h,keepScrollPosition:f,sortByLabel:g,initialize:m}){const v=[],y=this.shell.createQuickPick();if(y.title=e,y.step=t,y.sortByLabel=g||!1,y.totalSteps=n,y.placeholder=o,y.ignoreFocusOut=!0,y.items=r,y.matchOnDescription=u||!1,y.matchOnDetail=p||!1,y.buttons=this.steps.length>1?[s.QuickInputButtons.Back]:[],a)for(const e of a)y.buttons=[...y.buttons,e.button];this.current&&this.current.dispose(),this.current=y,h&&v.push(h.event((e=>h.callback(e,y)))),m&&m(y),y.activeItems=i?[await i]:[],this.current.show(),y.keepScrollPosition=f;const b=(0,c.createDeferred)();v.push(y.onDidTriggerButton((async e=>{if(e===s.QuickInputButtons.Back&&(b.reject(l.back),y.hide()),a)for(const t of a)JSON.stringify(e)===JSON.stringify(null==t?void 0:t.button)&&await(null==t?void 0:t.callback(y))})),y.onDidChangeSelection((e=>b.resolve(e[0]))),y.onDidHide((()=>{b.completed||b.resolve(void 0)}))),d&&v.push(y.onDidAccept((()=>{b.resolve(y.value)})));try{return await b.promise}finally{v.forEach((e=>e.dispose()))}}async showInputBox({title:e,step:t,totalSteps:n,value:r,prompt:i,validate:o,password:a,buttons:c}){const u=[];try{return await new Promise(((p,d)=>{const h=this.shell.createInputBox();h.title=e,h.step=t,h.totalSteps=n,h.password=!!a,h.value=r||"",h.prompt=i,h.ignoreFocusOut=!0,h.buttons=[...this.steps.length>1?[s.QuickInputButtons.Back]:[],...c||[]];let f=o("");u.push(h.onDidTriggerButton((e=>{e===s.QuickInputButtons.Back?d(l.back):p(e)})),h.onDidAccept((async()=>{const e=h.value;h.enabled=!1,h.busy=!0,await o(e)||p(e),h.enabled=!0,h.busy=!1})),h.onDidChangeValue((async e=>{const t=o(e);f=t;const n=await t;t===f&&(h.validationMessage=n)})),h.onDidHide((()=>{p(void 0)}))),this.current&&this.current.dispose(),this.current=h,this.current.show()}))}finally{u.forEach((e=>e.dispose()))}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(e){if(e===l.back){if(this.steps.pop(),n=this.steps.pop(),void 0===n)throw e}else if(e===l.resume)n=this.steps.pop();else{if(e!==l.cancel)throw e;n=void 0}}}this.current&&this.current.dispose()}}t.MultiStepInput=u,t.IMultiStepInputFactory=Symbol("IMultiStepInputFactory");let p=class{constructor(e){this.shell=e}create(){return new u(this.shell)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IApplicationShell))],p),t.MultiStepInputFactory=p},87450:(e,t,n)=>{"use strict";var r,i;function o(e=process.platform){return/^win/.test(e)?i.Windows:/^darwin/.test(e)?i.OSX:/^linux/.test(e)?i.Linux:i.Unknown}Object.defineProperty(t,"__esModule",{value:!0}),t.getUserHomeDir=t.getEnvironmentVariable=t.getArchitecture=t.getOSType=t.OSType=t.Architecture=void 0,function(e){e[e.Unknown=1]="Unknown",e[e.x86=2]="x86",e[e.x64=3]="x64"}(r=t.Architecture||(t.Architecture={})),function(e){e.Unknown="Unknown",e.Windows="Windows",e.OSX="OSX",e.Linux="Linux"}(i=t.OSType||(t.OSType={})),t.getOSType=o;const s={x86:r.x86,x64:r.x64,"":r.Unknown};function a(e){return process.env[e]}t.getArchitecture=function(){const e=s[process.arch];if(void 0!==e)return e;const t=n(3901);return s[t()]||r.Unknown},t.getEnvironmentVariable=a,t.getUserHomeDir=function(){return o()===i.Windows?a("USERPROFILE"):a("HOME")||a("HOMEPATH")}},10195:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.Random=void 0;const i=n(6113),o=n(86700);let s=class{getRandomInt(e=0,t=10){return function(e=0,t=10){return e+function(){let e=0;const t=i.randomBytes(2);return e=(t.readUInt8(0)<<8)+t.readUInt8(1),e/(Math.pow(16,4)-1)}()*(t-e)}(e,t)}};s=r([(0,o.injectable)()],s),t.Random=s},45940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verboseRegExp=void 0,t.verboseRegExp=function(e,t){return e=(e=e.replace(/(^| {2})# .*$/gm,"")).replace(/\s+?/g,""),RegExp(e,t)}},81837:(e,t)=>{"use strict";async function n(e){await Promise.all(e.map((async e=>{try{return Promise.resolve(e.dispose())}catch(e){}return Promise.resolve()})))}Object.defineProperty(t,"__esModule",{value:!0}),t.Disposables=t.disposeAll=void 0,t.disposeAll=n,t.Disposables=class{constructor(...e){this.disposables=[],this.disposables.push(...e)}push(...e){this.disposables.push(...e)}async dispose(){const{disposables:e}=this;this.disposables=[],await n(e)}}},58479:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runAfterActivation=t.addItemsToRunAfterActivation=void 0;const n=[];let r=!1;t.addItemsToRunAfterActivation=function(e){r?e():n.push(e)},t.runAfterActivation=function(){for(r=!0;n.length>0;){const e=n.shift();e&&e()}}},70057:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopWatch=void 0,t.StopWatch=class{constructor(){this.started=(new Date).getTime()}get elapsedTime(){return(new Date).getTime()-this.started}reset(){this.started=(new Date).getTime()}}},7086:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNumber=t.isObject=t.isString=t.isArray=void 0;const n="number";t.isArray=function(e){return Array.isArray?Array.isArray(e):!(!e||typeof e.length!==n||e.constructor!==Array)},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)},t.isNumber=function(e){return(typeof e===n||e instanceof Number)&&!isNaN(e)}},52439:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSemVerSafe=t.areSimilarVersions=t.areIdenticalVersion=t.parseVersionInfo=t.validateVersionInfo=t.normalizeVersionInfo=t.compareVersions=t.isVersionInfoEmpty=t.parseBasicVersionInfo=t.getVersionString=t.EMPTY_VERSION=void 0;const r=n(81249),i=n(45940);function o(e){if("number"==typeof e)return Number.isNaN(e)?[-1,"missing"]:e<0?[-1,""]:[e,""];if("string"==typeof e){const t=parseInt(e,10);return Number.isNaN(t)?[-1,"string not numeric"]:t<0?[-1,""]:[t,""]}return null==e?[-1,"missing"]:[-1,"unsupported type"]}function s(e,t,n){if(!(0===t||t>0)&&n&&""!==n)throw Error(`invalid ${e} version (failed to normalize; ${n})`)}t.EMPTY_VERSION={major:-1,minor:-1,micro:-1},Object.freeze(t.EMPTY_VERSION),t.getVersionString=function(e){return e.major<0?"":e.minor<0?`${e.major}`:e.micro<0?`${e.major}.${e.minor}`:`${e.major}.${e.minor}.${e.micro}`};const a=(0,i.verboseRegExp)("\n    ^\n    (.*?)  # <before>\n    (\\d+)  # <major>\n    (?:\n        [.]\n        (\\d+)  # <minor>\n        (?:\n            [.]\n            (\\d+)  # <micro>\n        )?\n    )?\n    ([^\\d].*)?  # <after>\n    $\n","s");function c(e){const t=e.match(a);if(!t)return;const[,n,r,i,o,s]=t;if(!n||!n.endsWith(".")){if(s&&""!==s){if("."===s)return;if(!(n&&""!==n||o&&""!==o))return}return{version:{major:parseInt(r,10),minor:i?parseInt(i,10):-1,micro:o?parseInt(o,10):-1},before:n||"",after:s||""}}}function l(e,t,n){return e.major<t.major?[1,"major"]:e.major>t.major?[-1,"major"]:-1===e.major?[0,""]:e.minor<t.minor?[1,"minor"]:e.minor>t.minor?[-1,"minor"]:-1===e.minor?[0,""]:e.micro<t.micro?[1,"micro"]:e.micro>t.micro?[-1,"micro"]:void 0!==n?n(e,t):[0,""]}t.parseBasicVersionInfo=c,t.isVersionInfoEmpty=function(e){return!!e&&"number"==typeof e.major&&"number"==typeof e.minor&&"number"==typeof e.micro&&e.major<0&&e.minor<0&&e.micro<0},t.compareVersions=l,t.normalizeVersionInfo=function(e){const n=function(e){if(!e)return t.EMPTY_VERSION;const n=function(e){const t={major:e.major,minor:e.minor,micro:e.micro},{unnormalized:n}=e;return void 0!==n&&(t.unnormalized={major:n.major,minor:n.minor,micro:n.micro}),t}(e);return void 0===n.unnormalized&&(n.unnormalized={},[n.major,n.unnormalized.major]=o(n.major),[n.minor,n.unnormalized.minor]=o(n.minor),[n.micro,n.unnormalized.micro]=o(n.micro)),n}(e);return n.raw=e.raw,n.raw||(n.raw=""),n},t.validateVersionInfo=function(e){!function(e){var t,n,r;const i=e;if(s("major",e.major,null===(t=i.unnormalized)||void 0===t?void 0:t.major),s("minor",e.minor,null===(n=i.unnormalized)||void 0===n?void 0:n.minor),s("micro",e.micro,null===(r=i.unnormalized)||void 0===r?void 0:r.micro),e.major<0)throw Error("missing major version");if(e.minor<0&&(0===e.micro||e.micro>0))throw Error("missing minor version")}(e)},t.parseVersionInfo=function(e){const t=c(e);if(void 0!==t)return t.version.raw=e,t},t.areIdenticalVersion=function(e,t,n){const[r]=l(e,t,n);return 0===r},t.areSimilarVersions=function(e,t,n){const[r,i]=l(e,t,n);return 0===r||"major"!==i&&(r<0?-1===t[i]:-1===e[i])},t.parseSemVerSafe=function(e){e=e.replace(/\.00*(?=[1-9]|0\.)/,".");const t=r.coerce(e);return null!==t&&r.valid(t)?t:new r.SemVer("0.0.0")}},97749:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRunningWorkerPool=t.QueuePosition=void 0;const r=n(19735),i=n(59314);var o;!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(o=t.QueuePosition||(t.QueuePosition={}));class s{constructor(e,t,n,r){this.next=e,this.workFunc=t,this.postResult=n,this.name=r,this.stopProcessing=!1}stop(){this.stopProcessing=!0}async start(){for(;!this.stopProcessing;)try{const e=await this.next();try{const t=await this.workFunc(e);this.postResult(e,t)}catch(t){this.postResult(e,void 0,t)}}catch(e){(0,r.traceError)(`Error while running worker[${this.name}].`,e);continue}}}class a{constructor(){this.items=[],this.results=new Map}add(e,t){const n={item:e};t===o.Front?this.items.unshift(n):this.items.push(n);const r=(0,i.createDeferred)();return this.results.set(n,r),r.promise}completed(e,t,n){const r=this.results.get(e);void 0!==r&&(this.results.delete(e),void 0!==n&&r.reject(n),r.resolve(t))}next(){return this.items.shift()}clear(){this.results.forEach(((e,t,n)=>{e.reject(Error("Queue stopped processing")),n.delete(t)}))}}class c{constructor(e,t=2,n="Worker"){this.workerFunc=e,this.numWorkers=t,this.name=n,this.workers=[],this.waitingWorkersUnblockQueue=[],this.queue=new a,this.stopProcessing=!1}addToQueue(e,t){if(this.stopProcessing)throw Error("Queue is stopped");const n=this.queue.add(e,t),i=this.waitingWorkersUnblockQueue.shift();if(i){const e=this.queue.next();void 0!==e?i.unblock(e):(0,r.traceError)("Work queue was empty immediately after adding item.")}return n}start(){this.stopProcessing=!1;let e=this.numWorkers;for(;e>0;)this.workers.push(new s((()=>this.nextWorkItem()),(e=>this.workerFunc(e.item)),((e,t,n)=>this.queue.completed(e,t,n)),`${this.name} ${e}`)),e-=1;this.workers.forEach((async e=>e.start()))}stop(){this.stopProcessing=!0;let e=this.workers.shift();for(;e;)e.stop(),e=this.workers.shift();this.queue.clear();let t=this.waitingWorkersUnblockQueue.shift();for(;t;)t.stop(),t=this.waitingWorkersUnblockQueue.shift()}nextWorkItem(){const e=this.queue.next();return void 0!==e?Promise.resolve(e):new Promise(((e,t)=>{this.waitingWorkersUnblockQueue.push({unblock:n=>{this.stopProcessing&&t(),e(n)},stop:()=>{t()}})}))}}t.createRunningWorkerPool=function(e,t,n){const r=new c(e,t,n);return r.start(),r}},17197:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.matchTarget=t.restoreKeys=t.normCaseKeys=t.parseEnvFile=t.EnvironmentVariablesService=void 0;const o=n(55674),s=n(86700),a=n(71017),c=n(19735),l=n(54813),u=n(61522),p=n(84974),d=n(61684),h=n(48431);let f=class{constructor(e,t){this.pathUtils=e,this.fs=t}async parseFile(e,t){if(!e||!await this.fs.pathExists(e))return;const n=await this.fs.readFile(e).catch((e=>{(0,c.traceError)("Custom .env is likely not pointing to a valid file",e)}));return n?g(n,t):void 0}parseFileSync(e,t){if(!e||!(0,o.pathExistsSync)(e))return;let n;try{n=(0,o.readFileSync)(e,{encoding:"utf8"})}catch(e){(0,c.traceError)("Custom .env is likely not pointing to a valid file",e)}return n?g(n,t):void 0}mergeVariables(e,t,n){if(!t)return;const r=t;t=v(t),e=v(e);const i=["PYTHONPATH",this.pathVariable];Object.keys(e).forEach((r=>{!(null==n?void 0:n.mergeAll)&&i.indexOf(r)>=0||(void 0===t[r]||(null==n?void 0:n.overwrite))&&(t[r]=e[r])})),y(t),b(r,t)}appendPythonPath(e,...t){return this.appendPaths(e,"PYTHONPATH",...t)}appendPath(e,...t){return this.appendPaths(e,this.pathVariable,...t)}get pathVariable(){return this._pathVariable||(this._pathVariable=this.pathUtils.getPathVariableName()),(0,h.normCase)(this._pathVariable)}appendPaths(e,t,...n){const r=e;return e=v(e),t=(0,h.normCase)(t),y(e=this._appendPaths(e,t,...n)),b(r,e),e}_appendPaths(e,t,...n){const r=n.filter((e=>"string"==typeof e&&e.trim().length>0)).map((e=>e.trim())).join(a.delimiter);if(0===r.length)return e;const i=e?e[t]:void 0;return i&&"string"==typeof i&&i.length>0?e[t]=i+a.delimiter+r:e[t]=r,e}};function g(e,t){const n=t||{},r={};return e.toString().split("\n").forEach(((e,t)=>{const[i,o]=function(e){const t=e.match(/^\s*(_*[a-zA-Z]\w*)\s*=\s*(.*?)?\s*$/);if(!t)return["",""];const n=t[1];let r=t[2];return r&&""!==r?("'"===r[0]&&"'"===r[r.length-1]||'"'===r[0]&&'"'===r[r.length-1])&&(r=r.substring(1,r.length-1),r=r.replace(/\\n/gm,"\n")):r="",[n,r]}(e);""!==i&&(r[i]=function(e,t,n,r=""){let i=!1,o=e;return o=o.replace(m,((e,o,s,a,c)=>a>0&&"\\"===c[a-1]?e:s&&""!==s||!o||""===o?(i=!0,e):t[o]||n[o]||r)),i||o===e||(e=o,(0,l.sendTelemetryEvent)(u.EventName.ENVFILE_VARIABLE_SUBSTITUTION)),e.replace(/\\\$/g,"$")}(o,r,n))})),r}f=r([(0,s.injectable)(),i(0,(0,s.inject)(d.IPathUtils)),i(1,(0,s.inject)(p.IFileSystem))],f),t.EnvironmentVariablesService=f,t.parseEnvFile=g;const m=/\${([a-zA-Z]\w*)?([^}\w].*)?}/g;function v(e){const t={};return Object.keys(e).forEach((n=>{const r=(0,h.normCase)(n);t[r]=e[n]})),t}function y(e){Object.keys(process.env).forEach((t=>{const n=(0,h.normCase)(t);n!==t&&void 0!==e[n]&&(e[t]=e[n],delete e[n])}))}function b(e,t){Object.keys(e).forEach((n=>{t.hasOwnProperty(n)?e[n]=t[n]:delete e[n]})),Object.keys(t).forEach((n=>{e.hasOwnProperty(n)||(e[n]=t[n])}))}t.normCaseKeys=v,t.restoreKeys=y,t.matchTarget=b},88939:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariablesProvider=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(19735),l=n(98634),u=n(17585),p=n(89515),d=n(84974),h=n(61684),f=n(35144),g=n(48683),m=n(19909);let v=class{constructor(e,t,n,r,i,o=36e5){this.envVarsService=e,this.platformService=n,this.workspaceService=r,this.process=i,this.cacheDuration=o,this.trackedWorkspaceFolders=new Set,this.fileWatchers=new Map,this.disposables=[],this.envVarCaches=new Map,t.push(this),this.changeEventEmitter=new a.EventEmitter;const s=this.workspaceService.onDidChangeConfiguration(this.configurationChanged,this);this.disposables.push(s)}get onDidEnvironmentVariablesChange(){return this.changeEventEmitter.event}dispose(){this.changeEventEmitter.dispose(),this.fileWatchers.forEach((e=>{e&&e.dispose()}))}async getEnvironmentVariables(e){const t=this.getCachedEnvironmentVariables(e);if(t)return t;const n=await this._getEnvironmentVariables(e);return this.setCachedEnvironmentVariables(e,n),(0,c.traceVerbose)("Dump environment variables",JSON.stringify(n,null,4)),n}getEnvironmentVariablesSync(e){const t=this.getCachedEnvironmentVariables(e);if(t)return t;const n=this._getEnvironmentVariablesSync(e);return this.setCachedEnvironmentVariables(e,n),n}getCachedEnvironmentVariables(e){var t,n;const r=null!==(n=null===(t=this.getWorkspaceFolderUri(e))||void 0===t?void 0:t.fsPath)&&void 0!==n?n:"",i=this.envVarCaches.get(r);if(i){const e=i.data;if(e)return{...e}}}setCachedEnvironmentVariables(e,t){var n,r;const i=null!==(r=null===(n=this.getWorkspaceFolderUri(e))||void 0===n?void 0:n.fsPath)&&void 0!==r?r:"",o=new f.InMemoryCache(this.cacheDuration);this.envVarCaches.set(i,o),o.data={...t}}async _getEnvironmentVariables(e){const t=await this.getCustomEnvironmentVariables(e);return this.getMergedEnvironmentVariables(t)}_getEnvironmentVariablesSync(e){const t=this.getCustomEnvironmentVariablesSync(e);return this.getMergedEnvironmentVariables(t)}getMergedEnvironmentVariables(e){e||(e={}),this.envVarsService.mergeVariables(this.process.env,e);const t=this.platformService.pathVariableName,n=this.process.env[t];return n&&this.envVarsService.appendPath(e,n),this.process.env.PYTHONPATH&&this.envVarsService.appendPythonPath(e,this.process.env.PYTHONPATH),e}async getCustomEnvironmentVariables(e){return this.envVarsService.parseFile(this.getEnvFile(e),this.process.env)}getCustomEnvironmentVariablesSync(e){return this.envVarsService.parseFileSync(this.getEnvFile(e),this.process.env)}getEnvFile(e){var t;const n=new g.SystemVariables(void 0,null===(t=p.PythonSettings.getSettingsUriAndTarget(e,this.workspaceService).uri)||void 0===t?void 0:t.fsPath,this.workspaceService),r=this.getWorkspaceFolderUri(e),i=this.workspaceService.getConfiguration("python",e).get("envFile"),o=n.resolveAny(i);return void 0===o?((0,c.traceError)("Unable to read `python.envFile` setting for resource",JSON.stringify(e)),(null==r?void 0:r.fsPath)?s.join(null==r?void 0:r.fsPath,".env"):""):(this.trackedWorkspaceFolders.add(r?r.fsPath:""),this.createFileWatcher(o,r),o)}configurationChanged(e){this.trackedWorkspaceFolders.forEach((t=>{const n=t&&t.length>0?a.Uri.file(t):void 0;e.affectsConfiguration("python.envFile",n)&&this.onEnvironmentFileChanged(n)}))}createFileWatcher(e,t){if(this.fileWatchers.has(e))return;const n=this.workspaceService.createFileSystemWatcher(e);this.fileWatchers.set(e,n),n&&(this.disposables.push(n.onDidChange((()=>this.onEnvironmentFileChanged(t)))),this.disposables.push(n.onDidCreate((()=>this.onEnvironmentFileCreated(t)))),this.disposables.push(n.onDidDelete((()=>this.onEnvironmentFileChanged(t)))))}getWorkspaceFolderUri(e){if(!e)return;const t=this.workspaceService.getWorkspaceFolder(e);return t?t.uri:void 0}onEnvironmentFileCreated(e){this.onEnvironmentFileChanged(e),(0,l.sendFileCreationTelemetry)()}onEnvironmentFileChanged(e){this.envVarCaches.clear(),this.changeEventEmitter.fire(e)}};v=r([(0,o.injectable)(),i(0,(0,o.inject)(m.IEnvironmentVariablesService)),i(1,(0,o.inject)(h.IDisposableRegistry)),i(2,(0,o.inject)(d.IPlatformService)),i(3,(0,o.inject)(u.IWorkspaceService)),i(4,(0,o.inject)(h.ICurrentProcess)),i(5,(0,o.optional)())],v),t.EnvironmentVariablesProvider=v},28285:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(17197),i=n(88939),o=n(19909);t.registerTypes=function(e){e.addSingleton(o.IEnvironmentVariablesService,r.EnvironmentVariablesService),e.addSingleton(o.IEnvironmentVariablesProvider,i.EnvironmentVariablesProvider)}},48683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemVariables=void 0;const r=n(71017),i=n(66828),o=n(56792),s=n(7086);t.SystemVariables=class extends class{resolve(e){return s.isString(e)?this.__resolveString(e):s.isArray(e)?this.__resolveArray(e):s.isObject(e)?this.__resolveLiteral(e):e}resolveAny(e){return s.isString(e)?this.__resolveString(e):s.isArray(e)?this.__resolveAnyArray(e):s.isObject(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){return e.replace(/\$\{(.*?)\}/g,((e,t)=>{const n=this[t];return s.isString(n)?n:e&&(e.indexOf("env.")>0||e.indexOf("env:")>0)?"":e}))}__resolveLiteral(e){const t=Object.create(null);return Object.keys(e).forEach((n=>{const r=e[n];t[n]=this.resolve(r)})),t}__resolveAnyLiteral(e){const t=Object.create(null);return Object.keys(e).forEach((n=>{const r=e[n];t[n]=this.resolveAny(r)})),t}__resolveArray(e){return e.map((e=>this.__resolveString(e)))}__resolveAnyArray(e){return e.map((e=>this.resolveAny(e)))}}{constructor(e,t,n,s){var a;super();const c=n&&e?n.getWorkspaceFolder(e):void 0;this._workspaceFolder=c?c.uri.fsPath:t||__dirname,this._workspaceFolderName=r.basename(this._workspaceFolder),this._filePath=e?e.fsPath:void 0,s&&s.activeTextEditor&&(this._lineNumber=s.activeTextEditor.selection.anchor.line+1,this._selectedText=s.activeTextEditor.document.getText(new i.Range(s.activeTextEditor.selection.start,s.activeTextEditor.selection.end))),this._execPath=process.execPath,Object.keys(process.env).forEach((e=>{this[`env:${e}`]=this[`env.${e}`]=process.env[e]})),n=null!=n?n:new o.WorkspaceService;try{null===(a=n.workspaceFolders)||void 0===a||a.forEach((e=>{this[`workspaceFolder:${r.basename(e.uri.fsPath)}`]=e.uri.fsPath}))}catch(e){}}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get workspaceRootFolderName(){return this._workspaceFolderName}get workspaceFolderBasename(){return this._workspaceFolderName}get file(){return this._filePath}get relativeFile(){return this.file?r.relative(this._workspaceFolder,this.file):void 0}get relativeFileDirname(){return this.relativeFile?r.dirname(this.relativeFile):void 0}get fileBasename(){return this.file?r.basename(this.file):void 0}get fileBasenameNoExtension(){return this.file?r.parse(this.file).name:void 0}get fileDirname(){return this.file?r.dirname(this.file):void 0}get fileExtname(){return this.file?r.extname(this.file):void 0}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}get execPath(){return this._execPath}}},19909:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IEnvironmentVariablesProvider=t.IEnvironmentVariablesService=void 0,t.IEnvironmentVariablesService=Symbol("IEnvironmentVariablesService"),t.IEnvironmentVariablesProvider=Symbol("IEnvironmentVariablesProvider")},12524:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.launch=void 0;const r=n(66828);t.launch=function(e){r.env.openExternal(r.Uri.parse(e))}},98638:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeCommand=t.registerCommand=void 0;const r=n(66828);t.registerCommand=function(e,t,n){return r.commands.registerCommand(e,t,n)},t.executeCommand=function(e,...t){return r.commands.executeCommand(e,...t)}},50189:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInsider=t.isExtensionDisabled=t.isExtensionEnabled=t.getExtension=void 0;const r=n(71017),i=n(55674),o=n(66828),s=n(77570);function a(e){return o.extensions.getExtension(e)}t.getExtension=a,t.isExtensionEnabled=function(e){return void 0!==o.extensions.getExtension(e)},t.isExtensionDisabled=function(e){const t=a(s.PVSC_EXTENSION_ID);if(t){let n=!1;return i.readdirSync(r.dirname(t.extensionPath),{withFileTypes:!1}).forEach((t=>{t.toString().startsWith(e)&&(n=!0)})),n}return!1},t.isInsider=function(){return o.env.appName.includes("Insider")}},64061:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onDidChangeDiagnostics=t.createDiagnosticCollection=void 0;const r=n(66828);t.createDiagnosticCollection=function(e){return r.languages.createDiagnosticCollection(e)},t.onDidChangeDiagnostics=function(e){return r.languages.onDidChangeDiagnostics(e)}},56693:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStepForwardEndNode=t.createStepBackEndNode=t.MultiStepNode=t.showQuickPickWithBack=t.MultiStepAction=t.onDidChangeActiveTextEditor=t.getActiveTextEditor=t.withProgress=t.showInformationMessage=t.showErrorMessage=t.createQuickPick=t.showQuickPick=void 0;const r=n(66828),i=n(59314);var o;t.showQuickPick=function(e,t,n){return r.window.showQuickPick(e,t,n)},t.createQuickPick=function(){return r.window.createQuickPick()},t.showErrorMessage=function(e,...t){return r.window.showErrorMessage(e,...t)},t.showInformationMessage=function(e,...t){return r.window.showInformationMessage(e,...t)},t.withProgress=function(e,t){return r.window.withProgress(e,t)},t.getActiveTextEditor=function(){const{activeTextEditor:e}=r.window;return e},t.onDidChangeActiveTextEditor=function(e){return r.window.onDidChangeActiveTextEditor(e)},function(e){e.Back="Back",e.Cancel="Cancel",e.Continue="Continue"}(o=t.MultiStepAction||(t.MultiStepAction={})),t.showQuickPickWithBack=async function(e,t,n){var s,a,c,l;const u=r.window.createQuickPick(),p=[u];u.items=e,u.buttons=[r.QuickInputButtons.Back],u.canSelectMany=null!==(s=null==t?void 0:t.canPickMany)&&void 0!==s&&s,u.ignoreFocusOut=null!==(a=null==t?void 0:t.ignoreFocusOut)&&void 0!==a&&a,u.matchOnDescription=null!==(c=null==t?void 0:t.matchOnDescription)&&void 0!==c&&c,u.matchOnDetail=null!==(l=null==t?void 0:t.matchOnDetail)&&void 0!==l&&l,u.placeholder=null==t?void 0:t.placeHolder,u.title=null==t?void 0:t.title;const d=(0,i.createDeferred)();p.push(u,u.onDidTriggerButton((e=>{e===r.QuickInputButtons.Back&&(d.reject(o.Back),u.hide())})),u.onDidAccept((()=>{d.completed||(u.canSelectMany?d.resolve(u.selectedItems.map((e=>e))):d.resolve(u.selectedItems[0]),u.hide())})),u.onDidHide((()=>{d.completed||d.resolve(void 0)}))),n&&p.push(n.onCancellationRequested((()=>{u.hide()}))),u.show();try{return await d.promise}finally{p.forEach((e=>e.dispose()))}};class s{constructor(e,t,n){this.previous=e,this.current=t,this.next=n}static async run(e,t){let n=e,r=await n.current(t);for(;void 0!==n;){if(r===o.Cancel)return r;r===o.Back&&(n=null==n?void 0:n.previous),r===o.Continue&&(n=null==n?void 0:n.next),n&&(r=await(null==n?void 0:n.current(r)))}return r}}t.MultiStepNode=s,t.createStepBackEndNode=function(e){return new s(void 0,(async()=>(e&&e.reject(o.Back),Promise.resolve(o.Back))),void 0)},t.createStepForwardEndNode=function(e,t){return new s(void 0,(async()=>(e&&e.resolve(t),Promise.resolve(o.Back))),void 0)}},85261:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onDidChangeConfiguration=t.onDidChangeTextDocument=t.onDidOpenTextDocument=t.getOpenTextDocuments=t.onDidSaveTextDocument=t.onDidCloseTextDocument=t.findFiles=t.applyEdit=t.getConfiguration=t.getWorkspaceFolderPaths=t.getWorkspaceFolder=t.getWorkspaceFolders=void 0;const r=n(66828);t.getWorkspaceFolders=function(){return r.workspace.workspaceFolders},t.getWorkspaceFolder=function(e){return e?r.workspace.getWorkspaceFolder(e):void 0},t.getWorkspaceFolderPaths=function(){var e,t;return null!==(t=null===(e=r.workspace.workspaceFolders)||void 0===e?void 0:e.map((e=>e.uri.fsPath)))&&void 0!==t?t:[]},t.getConfiguration=function(e,t){return r.workspace.getConfiguration(e,t)},t.applyEdit=function(e){return r.workspace.applyEdit(e)},t.findFiles=function(e,t,n,i){return r.workspace.findFiles(e,t,n,i)},t.onDidCloseTextDocument=function(e){return r.workspace.onDidCloseTextDocument(e)},t.onDidSaveTextDocument=function(e){return r.workspace.onDidSaveTextDocument(e)},t.getOpenTextDocuments=function(){return r.workspace.textDocuments},t.onDidOpenTextDocument=function(e){return r.workspace.onDidOpenTextDocument(e)},t.onDidChangeTextDocument=function(e){return r.workspace.onDidChangeTextDocument(e)},t.onDidChangeConfiguration=function(e){return r.workspace.onDidChangeConfiguration(e)}},63281:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HiddenFilePrefix=t.EXTENSION_ROOT_DIR=void 0;const r=n(71017),i=r.basename(__dirname);t.EXTENSION_ROOT_DIR="client"===i?r.join(__dirname,"..",".."):r.join(__dirname,"..","..","..",".."),t.HiddenFilePrefix="_HiddenFile_"},51097:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerTypeName=void 0,t.DebuggerTypeName="python"},11393:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugAdapterActivator=void 0;const o=n(86700),s=n(17585),a=n(61684),c=n(17585),l=n(51097),u=n(75791),p=n(41691);let d=class{constructor(e,t,n,r,i,o,s,a){this.debugService=e,this.configSettings=t,this.commandManager=n,this.descriptorFactory=r,this.debugSessionLoggingFactory=i,this.debuggerPromptFactory=o,this.disposables=s,this.attachProcessProviderFactory=a,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){this.attachProcessProviderFactory.registerCommands(),this.disposables.push(this.debugService.registerDebugAdapterTrackerFactory(l.DebuggerTypeName,this.debugSessionLoggingFactory)),this.disposables.push(this.debugService.registerDebugAdapterTrackerFactory(l.DebuggerTypeName,this.debuggerPromptFactory)),this.disposables.push(this.debugService.registerDebugAdapterDescriptorFactory(l.DebuggerTypeName,this.descriptorFactory)),this.disposables.push(this.debugService.onDidStartDebugSession((e=>{var t;this.shouldTerminalFocusOnStart(null===(t=e.workspaceFolder)||void 0===t?void 0:t.uri)&&this.commandManager.executeCommand("workbench.action.terminal.focus")})))}shouldTerminalFocusOnStart(e){var t;return null===(t=this.configSettings.getSettings(e))||void 0===t?void 0:t.terminal.focusAfterLaunch}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IDebugService)),i(1,(0,o.inject)(a.IConfigurationService)),i(2,(0,o.inject)(c.ICommandManager)),i(3,(0,o.inject)(p.IDebugAdapterDescriptorFactory)),i(4,(0,o.inject)(p.IDebugSessionLoggingFactory)),i(5,(0,o.inject)(p.IOutdatedDebuggerPromptFactory)),i(6,(0,o.inject)(a.IDisposableRegistry)),i(7,(0,o.inject)(u.IAttachProcessProviderFactory))],d),t.DebugAdapterActivator=d},44673:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugAdapterDescriptorFactory=t.debugStateKeys=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(63281),l=n(18639),u=n(19735),p=n(54813),d=n(61522),h=n(56693),f=n(67098),g=n(61684),m=n(77570),v=n(17585);var y;!function(e){e.doNotShowAgain="doNotShowPython36DebugDeprecatedAgain"}(y=t.debugStateKeys||(t.debugStateKeys={}));let b=class{constructor(e,t,n){this.commandManager=e,this.interpreterService=t,this.persistentState=n}async createDebugAdapterDescriptor(e,t){var n,r,i,o,l;const h=e.configuration;if("attach"===h.request){if(void 0!==h.connect)return(0,u.traceLog)(`Connecting to DAP Server at:  ${null!==(n=h.connect.host)&&void 0!==n?n:"127.0.0.1"}:${h.connect.port}`),new a.DebugAdapterServer(h.connect.port,null!==(r=h.connect.host)&&void 0!==r?r:"127.0.0.1");if(void 0!==h.port)return(0,u.traceLog)(`Connecting to DAP Server at:  ${null!==(i=h.host)&&void 0!==i?i:"127.0.0.1"}:${h.port}`),new a.DebugAdapterServer(h.port,null!==(o=h.host)&&void 0!==o?o:"127.0.0.1");if(void 0===h.listen&&void 0===h.processId)throw new Error('"request":"attach" requires either "connect", "listen", or "processId"')}const f=await this.getDebugAdapterPython(h,e.workspaceFolder);if(0!==f.length){"attach"===h.request&&void 0!==h.processId&&(0,p.sendTelemetryEvent)(d.EventName.DEBUGGER_ATTACH_TO_LOCAL_PROCESS);const e=null!==(l=f.shift())&&void 0!==l?l:"python",t=h.logToFile?["--log-dir",c.EXTENSION_ROOT_DIR]:[];if(void 0!==h.debugAdapterPath){const n=f.concat([h.debugAdapterPath,...t]);return(0,u.traceLog)(`DAP Server launched with command: ${e} ${n.join(" ")}`),new a.DebugAdapterExecutable(e,n)}const n=s.join(c.EXTENSION_ROOT_DIR,"pythonFiles","lib","python","debugpy","adapter"),r=f.concat([n,...t]);return(0,u.traceLog)(`DAP Server launched with command: ${e} ${r.join(" ")}`),(0,p.sendTelemetryEvent)(d.EventName.DEBUG_ADAPTER_USING_WHEELS_PATH,void 0,{usingWheels:!0}),new a.DebugAdapterExecutable(e,r)}throw new Error("Debug Adapter Executable not provided")}async getDebugAdapterPython(e,t){if(void 0!==e.debugAdapterPython)return this.getExecutableCommand(await this.interpreterService.getInterpreterDetails(e.debugAdapterPython));if(e.pythonPath)return this.getExecutableCommand(await this.interpreterService.getInterpreterDetails(e.pythonPath));const n=t?t.uri:void 0,r=await this.interpreterService.getActiveInterpreter(n);if(r)return(0,u.traceVerbose)(`Selecting active interpreter as Python Executable for DA '${r.path}'`),this.getExecutableCommand(r);await this.interpreterService.hasInterpreters();const i=this.interpreterService.getInterpreters(n);return 0===i.length?(this.notifySelectInterpreter().ignoreErrors(),[]):((0,u.traceVerbose)(`Picking first available interpreter to launch the DA '${i[0].path}'`),this.getExecutableCommand(i[0]))}async showDeprecatedPythonMessage(){if(this.persistentState.createGlobalPersistentState(y.doNotShowAgain,!1).value)return;const e=[f.Interpreters.changePythonInterpreter,f.Common.doNotShowAgain],t=await(0,h.showErrorMessage)(a.l10n.t("The debugger in the python extension no longer supports python versions minor than 3.7."),{modal:!0},...e);t&&(t==f.Interpreters.changePythonInterpreter&&await this.commandManager.executeCommand(m.Commands.Set_Interpreter),t==f.Common.doNotShowAgain&&await this.persistentState.createGlobalPersistentState(y.doNotShowAgain,!1).updateValue(!0))}async getExecutableCommand(e){var t,n,r,i,o,s;return e?(((null!==(n=null===(t=e.version)||void 0===t?void 0:t.major)&&void 0!==n?n:0)<3||(null!==(i=null===(r=e.version)||void 0===r?void 0:r.major)&&void 0!==i?i:0)<=3&&(null!==(s=null===(o=e.version)||void 0===o?void 0:o.minor)&&void 0!==s?s:0)<=6)&&this.showDeprecatedPythonMessage(),e.path.length>0?[e.path]:[]):[]}async notifySelectInterpreter(){await(0,h.showErrorMessage)(a.l10n.t("Install Python or select a Python Interpreter to use the debugger."))}};b=r([(0,o.injectable)(),i(0,(0,o.inject)(v.ICommandManager)),i(1,(0,o.inject)(l.IInterpreterService)),i(2,(0,o.inject)(g.IPersistentStateFactory))],b),t.DebugAdapterDescriptorFactory=b},2493:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugSessionLoggingFactory=void 0;const o=n(86700),s=n(71017),a=n(84974),c=n(70057),l=n(63281);class u{constructor(e,t){if(this.session=e,this.enabled=!1,this.timer=new c.StopWatch,this.enabled=this.session.configuration.logToFile,this.enabled){const e=`debugger.vscode_${this.session.id}.log`;this.stream=t.createWriteStream(s.join(l.EXTENSION_ROOT_DIR,e))}}onWillStartSession(){this.timer.reset(),this.log(`Starting Session:\n${this.stringify(this.session.configuration)}\n`)}onWillReceiveMessage(e){this.log(`Client --\x3e Adapter:\n${this.stringify(e)}\n`)}onDidSendMessage(e){this.log(`Client <-- Adapter:\n${this.stringify(e)}\n`)}onWillStopSession(){this.log("Stopping Session\n")}onError(e){this.log(`Error:\n${this.stringify(e)}\n`)}onExit(e,t){var n;this.log(`Exit:\nExit-Code: ${e||0}\nSignal: ${t||"none"}\n`),null===(n=this.stream)||void 0===n||n.close()}log(e){this.enabled&&this.stream.write(`${this.timer.elapsedTime} ${e}`)}stringify(e){return JSON.stringify(e,null,4)}}let p=class{constructor(e){this.fileSystem=e}createDebugAdapterTracker(e){return new u(e,this.fileSystem)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IFileSystem))],p),t.DebugSessionLoggingFactory=p},93951:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.OutdatedDebuggerPromptFactory=void 0;const i=n(86700),o=n(67098),s=n(12524),a=n(56693);class c{constructor(e){this.promptCheck=e}onDidSendMessage(e){if(this.promptCheck.shouldShowPrompt()&&this.isPtvsd(e)){const e=[o.Common.moreInfo];(0,a.showInformationMessage)(o.OutdatedDebugger.outdatedDebuggerMessage,...e).then((t=>{t===e[0]&&(0,s.launch)("https://aka.ms/migrateToDebugpy")}))}}isPtvsd(e){if("event"===e.type){const t=e;if("output"===t.event){const e=t;if("telemetry"===e.body.category){if("ptvsd"===e.body.output&&!e.body.data.packageVersion.startsWith("1"))return this.promptCheck.setShowPrompt(!1),!0;"debugpy"===e.body.output&&this.promptCheck.setShowPrompt(!1)}}}return!1}}class l{constructor(){this.shouldShow=!0}shouldShowPrompt(){return this.shouldShow}setShowPrompt(e){this.shouldShow=e}}let u=class{constructor(){this.promptCheck=new l}createDebugAdapterTracker(e){return new c(this.promptCheck)}};u=r([(0,i.injectable)()],u),t.OutdatedDebuggerPromptFactory=u},12187:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDebugpyPackagePath=t.getDebugpyLauncherArgs=void 0;const r=n(71017),i=n(77570);n(32727);const o=r.join(i.EXTENSION_ROOT_DIR,"pythonFiles","lib","python"),s=r.join(o,"debugpy");t.getDebugpyLauncherArgs=function(e,t=s){const n=e.waitUntilDebuggerAttaches?["--wait-for-client"]:[];return[t.fileToCommandArgumentForPythonExt(),"--listen",`${e.host}:${e.port}`,...n]},t.getDebugpyPackagePath=function(){return s}},56471:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachProcessProviderFactory=void 0;const o=n(86700),s=n(17585),a=n(77570),c=n(84974),l=n(29983),u=n(61684),p=n(52285),d=n(95868);let h=class{constructor(e,t,n,r,i){this.applicationShell=e,this.commandManager=t,this.platformService=n,this.processServiceFactory=r,this.disposableRegistry=i}registerCommands(){const e=new d.AttachProcessProvider(this.platformService,this.processServiceFactory),t=new p.AttachPicker(this.applicationShell,e),n=this.commandManager.registerCommand(a.Commands.PickLocalProcess,(()=>t.showQuickPick()),this);this.disposableRegistry.push(n)}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IApplicationShell)),i(1,(0,o.inject)(s.ICommandManager)),i(2,(0,o.inject)(c.IPlatformService)),i(3,(0,o.inject)(l.IProcessServiceFactory)),i(4,(0,o.inject)(u.IDisposableRegistry))],h),t.AttachProcessProviderFactory=h},52285:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachPicker=void 0;const o=n(86700),s=n(17585),a=n(1040),c=n(67098),l=n(75791);let u=class{constructor(e,t){this.applicationShell=e,this.attachItemsProvider=t}showQuickPick(){return new Promise((async(e,t)=>{const n=await this.attachItemsProvider.getAttachItems(),r={iconPath:(0,a.getIcon)(l.REFRESH_BUTTON_ICON),tooltip:c.AttachProcess.refreshList},i=this.applicationShell.createQuickPick();i.title=c.AttachProcess.attachTitle,i.placeholder=c.AttachProcess.selectProcessPlaceholder,i.canSelectMany=!1,i.matchOnDescription=!0,i.matchOnDetail=!0,i.items=n,i.buttons=[r];const o=[];i.onDidTriggerButton((async()=>{i.busy=!0;const e=await this.attachItemsProvider.getAttachItems();i.items=e,i.busy=!1}),this,o),i.onDidAccept((()=>{1!==i.selectedItems.length&&t(new Error(c.AttachProcess.noProcessSelected));const n=i.selectedItems[0].id;o.forEach((e=>e.dispose())),i.dispose(),e(n)}),void 0,o),i.onDidHide((()=>{o.forEach((e=>e.dispose())),i.dispose(),t(new Error(c.AttachProcess.noProcessSelected))}),void 0,o),i.show()}))}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IApplicationShell))],u),t.AttachPicker=u},95868:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachProcessProvider=void 0;const o=n(86700),s=n(66828),a=n(84974),c=n(29983),l=n(26942),u=n(20557);let p=class{constructor(e,t){this.platformService=e,this.processServiceFactory=t}getAttachItems(){return this._getInternalProcessEntries().then((e=>(e.sort((({processName:e,commandLine:t},{processName:n,commandLine:r})=>{const i=(e,t)=>{const n=e.toLowerCase(),r=t.toLowerCase();return n===r?0:n<r?-1:1},o=e.startsWith("python"),s=n.startsWith("python");return o||s?o&&!s?-1:s&&!o?1:o?i(t,r):i(r,t):i(e,n)})),e)))}async _getInternalProcessEntries(){let e;if(this.platformService.isMac)e=l.PsProcessParser.psDarwinCommand;else if(this.platformService.isLinux)e=l.PsProcessParser.psLinuxCommand;else{if(!this.platformService.isWindows)throw new Error(s.l10n.t("Operating system '{0}' not supported.",this.platformService.osType));e=u.WmicProcessParser.wmicCommand}const t=await this.processServiceFactory.create(),n=await t.exec(e.command,e.args,{throwOnStdErr:!0});return this.platformService.isWindows?u.WmicProcessParser.parseProcesses(n.stdout):l.PsProcessParser.parseProcesses(n.stdout)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IPlatformService)),i(1,(0,o.inject)(c.IProcessServiceFactory))],p),t.AttachProcessProvider=p},26942:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PsProcessParser=void 0,function(e){const t="".padStart(50,"a");function n(e){const t=new RegExp("^\\s*([0-9]+)\\s+(.{49})\\s+(.*)$").exec(e);if(4===(null==t?void 0:t.length)){const e=t[1].trim(),n=t[2].trim(),r=t[3].trim();return{label:n,description:e,detail:r,id:e,processName:n,commandLine:r}}}e.psLinuxCommand={command:"ps",args:["axww","-o",`pid=,comm=${t},args=`]},e.psDarwinCommand={command:"ps",args:["axww","-o",`pid=,comm=${t},args=`,"-c"]},e.parseProcesses=function(e){return function(e){const t=[];for(let r=1;r<e.length;r+=1){const i=e[r];if(!i)continue;const o=n(i);o&&t.push(o)}return t}(e.split("\n"))}}(t.PsProcessParser||(t.PsProcessParser={}))},75791:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REFRESH_BUTTON_ICON=t.IAttachProcessProviderFactory=void 0,t.IAttachProcessProviderFactory=Symbol("IAttachProcessProviderFactory"),t.REFRESH_BUTTON_ICON="refresh.svg"},20557:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WmicProcessParser=void 0,function(e){const t="ProcessId",n={label:"",description:"",detail:"",id:"",processName:"",commandLine:""};function r(e,n){const r=e.indexOf("="),i=n;if(r>0){const n=e.slice(0,r).trim();let o=e.slice(r+1).trim();if("Name"===n)i.label=o,i.processName=o;else if(n===t)i.description=o,i.id=o;else if("CommandLine"===n){const e="\\??\\";0===o.lastIndexOf(e,0)&&(o=o.slice(e.length)),i.detail=o,i.commandLine=o}}return i}e.wmicCommand={command:"wmic",args:["process","get","Name,ProcessId,CommandLine","/FORMAT:list"]},e.parseProcesses=function(e){const i=e.split("\r\n"),o=[];let s={...n};for(const e of i)e.length&&(r(e,s),0===e.lastIndexOf(t,0)&&(o.push(s),s={...n}));return o}}(t.WmicProcessParser||(t.WmicProcessParser={}))},23728:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonDebugConfigurationService=void 0;const s=n(86700),a=n(96486),c=n(67098),l=n(22207),u=n(41691),p=n(32442),d=n(80),h=n(4846),f=n(74200),g=n(37318),m=n(88372),v=n(32877),y=n(36489),b=n(45093);let S=r=class{constructor(e,t,n){this.attachResolver=e,this.launchResolver=t,this.multiStepFactory=n,this.cacheDebugConfig=void 0}async provideDebugConfigurations(e,t){const n={config:{},folder:e,token:t},i=this.multiStepFactory.create();if(await i.run(((e,t)=>r.pickDebugConfiguration(e,t)),n),0!==Object.keys(n.config).length)return[n.config]}async resolveDebugConfiguration(e,t,n){if("attach"===t.request)return this.attachResolver.resolveDebugConfiguration(e,t,n);if("test"===t.request)throw Error('This configuration can only be used by the test debugging commands. `"request": "test"` is deprecated, please keep as `"request": "launch"` and add `"purpose": ["debug-test"]` instead.');if(0===Object.keys(t).length)if(this.cacheDebugConfig)t=(0,a.cloneDeep)(this.cacheDebugConfig);else{const r=await this.provideDebugConfigurations(e,n);if(void 0===r)return;Array.isArray(r)&&1===r.length&&(t=r[0]),this.cacheDebugConfig=(0,a.cloneDeep)(t)}return this.launchResolver.resolveDebugConfiguration(e,t,n)}async resolveDebugConfigurationWithSubstitutedVariables(e,t,n){function r(r){return r.resolveDebugConfigurationWithSubstitutedVariables(e,t,n)}return"attach"===t.request?r(this.attachResolver):r(this.launchResolver)}static async pickDebugConfiguration(e,t){const n=[{func:h.buildFileLaunchDebugConfiguration,label:c.DebugConfigStrings.file.selectConfiguration.label,type:u.DebugConfigurationType.launchFile,description:c.DebugConfigStrings.file.selectConfiguration.description},{func:g.buildModuleLaunchConfiguration,label:c.DebugConfigStrings.module.selectConfiguration.label,type:u.DebugConfigurationType.launchModule,description:c.DebugConfigStrings.module.selectConfiguration.description},{func:y.buildRemoteAttachConfiguration,label:c.DebugConfigStrings.attach.selectConfiguration.label,type:u.DebugConfigurationType.remoteAttach,description:c.DebugConfigStrings.attach.selectConfiguration.description},{func:m.buildPidAttachConfiguration,label:c.DebugConfigStrings.attachPid.selectConfiguration.label,type:u.DebugConfigurationType.pidAttach,description:c.DebugConfigStrings.attachPid.selectConfiguration.description},{func:p.buildDjangoLaunchDebugConfiguration,label:c.DebugConfigStrings.django.selectConfiguration.label,type:u.DebugConfigurationType.launchDjango,description:c.DebugConfigStrings.django.selectConfiguration.description},{func:d.buildFastAPILaunchDebugConfiguration,label:c.DebugConfigStrings.fastapi.selectConfiguration.label,type:u.DebugConfigurationType.launchFastAPI,description:c.DebugConfigStrings.fastapi.selectConfiguration.description},{func:f.buildFlaskLaunchDebugConfiguration,label:c.DebugConfigStrings.flask.selectConfiguration.label,type:u.DebugConfigurationType.launchFlask,description:c.DebugConfigStrings.flask.selectConfiguration.description},{func:v.buildPyramidLaunchConfiguration,label:c.DebugConfigStrings.pyramid.selectConfiguration.label,type:u.DebugConfigurationType.launchPyramid,description:c.DebugConfigStrings.pyramid.selectConfiguration.description}],r=new Map;for(const e of n)r.set(e.type,e.func);t.config={};const i=await e.showQuickPick({title:c.DebugConfigStrings.selectConfiguration.title,placeholder:c.DebugConfigStrings.selectConfiguration.placeholder,activeItem:n[0],items:n});if(i)return r.get(i.type)(e,t)}};S=r=i([(0,s.injectable)(),o(0,(0,s.inject)(b.IDebugConfigurationResolver)),o(0,(0,s.named)("attach")),o(1,(0,s.inject)(b.IDebugConfigurationResolver)),o(1,(0,s.named)("launch")),o(2,(0,s.inject)(l.IMultiStepInputFactory))],S),t.PythonDebugConfigurationService=S},58184:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicPythonDebugConfigurationService=void 0;const o=n(71017),s=n(55674),a=n(86700),c=n(51097),l=n(99910),u=n(94146);let p=r=class{async provideDebugConfigurations(e,t){const n=[];n.push({name:"Python: File",type:c.DebuggerTypeName,request:"launch",program:"${file}",justMyCode:!0});const i=await r.getDjangoPath(e);i&&n.push({name:"Python: Django",type:c.DebuggerTypeName,request:"launch",program:`\${workspaceFolder}${o.sep}${i}`,args:["runserver"],django:!0,justMyCode:!0});const s=await r.getFlaskPath(e);s&&n.push({name:"Python: Flask",type:c.DebuggerTypeName,request:"launch",module:"flask",env:{FLASK_APP:o.relative(e.uri.fsPath,s),FLASK_DEBUG:"1"},args:["run","--no-debugger","--no-reload"],jinja:!0,justMyCode:!0});let a=await r.getFastApiPath(e);return a&&(a=(0,u.replaceAll)(o.relative(e.uri.fsPath,a),o.sep,".").replace(".py",""),n.push({name:"Python: FastAPI",type:c.DebuggerTypeName,request:"launch",module:"uvicorn",args:[`${a}:app`,"--reload"],jinja:!0,justMyCode:!0})),n}static async getDjangoPath(e){const t=await r.getPossiblePaths(e,["manage.py","*/manage.py","app.py","*/app.py"],/execute_from_command_line\(/);return t.length?o.relative(e.uri.fsPath,t[0]):null}static async getFastApiPath(e){const t=await r.getPossiblePaths(e,["main.py","app.py","*/main.py","*/app.py","*/*/main.py","*/*/app.py"],/app\s*=\s*FastAPI\(/);return t.length?t[0]:null}static async getFlaskPath(e){const t=await r.getPossiblePaths(e,["__init__.py","app.py","wsgi.py","*/__init__.py","*/app.py","*/wsgi.py"],/app(?:lication)?\s*=\s*(?:flask\.)?Flask\(|def\s+(?:create|make)_app\(/);return t.length?t[0]:null}static async getPossiblePaths(e,t,n){const r=await Promise.allSettled(t.map((async t=>await s.pathExists(o.join(e.uri.fsPath,t))?[o.join(e.uri.fsPath,t)]:[]))),i=[];return r.forEach((e=>i.push(...e.value))),await(0,l.asyncFilter)(i,(async e=>n.exec((await s.readFile(e)).toString())))}};p=r=i([(0,a.injectable)()],p),t.DynamicPythonDebugConfigurationService=p},88248:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchJsonCompletionProvider=void 0;const s=n(86700),a=n(60516),c=n(71017),l=n(66828),u=n(17585),p=n(61684),d=n(67098);var h;!function(e){e.json="json",e.jsonWithComments="jsonc"}(h||(h={}));let f=r=class{constructor(e,t){this.languageService=e,this.disposableRegistry=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){this.disposableRegistry.push(this.languageService.registerCompletionItemProvider({language:h.json},this)),this.disposableRegistry.push(this.languageService.registerCompletionItemProvider({language:h.jsonWithComments},this))}async provideCompletionItems(e,t,n){return r.canProvideCompletions(e,t)?[{command:{command:"python.SelectAndInsertDebugConfiguration",title:d.DebugConfigStrings.launchJsonCompletions.description,arguments:[e,t,n]},documentation:d.DebugConfigStrings.launchJsonCompletions.description,sortText:"AAAA",preselect:!0,kind:l.CompletionItemKind.Enum,label:d.DebugConfigStrings.launchJsonCompletions.label,insertText:new l.SnippetString}]:[]}static canProvideCompletions(e,t){if("launch.json"!==c.basename(e.uri.fsPath))return!1;const n=(0,a.getLocation)(e.getText(),e.offsetAt(t));return"configurations"===n.path[0]&&2===n.path.length}};f=r=i([(0,s.injectable)(),o(0,(0,s.inject)(u.ILanguageService)),o(1,(0,s.inject)(p.IDisposableRegistry))],f),t.LaunchJsonCompletionProvider=f},71762:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterPathCommand=void 0;const o=n(86700),s=n(66828),a=n(77570),c=n(61684),l=n(98638),u=n(18639);let p=class{constructor(e,t){this.interpreterService=e,this.disposables=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){this.disposables.push((0,l.registerCommand)(a.Commands.GetSelectedInterpreterPath,(e=>this._getSelectedInterpreterPath(e))))}async _getSelectedInterpreterPath(e){var t,n;let r,i;if("workspaceFolder"in e)r=e.workspaceFolder;else if(e[1]){const[,t]=e;r=t}else r=void 0;try{i=r?s.Uri.parse(r):void 0}catch(e){i=void 0}return null!==(n=null===(t=await this.interpreterService.getActiveInterpreter(i))||void 0===t?void 0:t.path)&&void 0!==n?n:"python"}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IInterpreterService)),i(1,(0,o.inject)(c.IDisposableRegistry))],p),t.InterpreterPathCommand=p},40169:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConfigurationsByUri=t.getConfigurationsForWorkspace=void 0;const r=n(71017),i=n(55674),o=n(60516),s=n(85261),a=n(19735);async function c(e){const t=r.join(e.uri.fsPath,".vscode","launch.json");if(!await i.pathExists(t)){const e=(0,s.getConfiguration)("launch");return e.configurations&&Array.isArray(e.configurations)?((0,a.traceLog)("Using launch configuration in workspace folder."),e.configurations):[]}const n=await i.readFile(t,"utf-8"),c=(0,o.parse)(n,[],{allowTrailingComma:!0,disallowComments:!1});if(!c.configurations||!Array.isArray(c.configurations))throw Error("Missing field in launch.json: configurations");if(!c.version)throw Error("Missing field in launch.json: version");return(0,a.traceLog)("Using launch configuration in launch.json file."),c.configurations}t.getConfigurationsForWorkspace=c,t.getConfigurationsByUri=async function(e){if(e){const t=(0,s.getWorkspaceFolder)(e);if(t)return c(t)}return[]}},75734:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchJsonUpdaterService=void 0;const o=n(86700),s=n(61684),a=n(98638),c=n(41691),l=n(50618);let u=class{constructor(e,t){this.disposableRegistry=e,this.configurationProvider=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){const e=new l.LaunchJsonUpdaterServiceHelper(this.configurationProvider);this.disposableRegistry.push((0,a.registerCommand)("python.SelectAndInsertDebugConfiguration",e.selectAndInsertDebugConfig,e))}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IDisposableRegistry)),i(1,(0,o.inject)(c.IDebugConfigurationService))],u),t.LaunchJsonUpdaterService=u},50618:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchJsonUpdaterServiceHelper=void 0;const i=n(60516),o=n(66828),s=n(3481),a=n(98638),c=n(56693),l=n(85261),u=n(54813),p=n(61522);class d{constructor(e){this.configurationProvider=e}async selectAndInsertDebugConfig(e,t,n){const r=(0,c.getActiveTextEditor)();if(r&&r.document===e){const r=(0,l.getWorkspaceFolder)(e.uri),i=await this.configurationProvider.provideDebugConfigurations(r,n);!n.isCancellationRequested&&Array.isArray(i)&&i.length>0&&await d.insertDebugConfiguration(e,t,i[0])}}static async insertDebugConfiguration(e,t,n){const r=d.getCursorPositionInConfigurationsArray(e,t);if(!r)return;const i=d.isCommaImmediatelyBeforeCursor(e,t)?"BeforeCursor":void 0,c=d.getTextForInsertion(n,r,i),u=new o.WorkspaceEdit;u.insert(e.uri,t,c),await(0,l.applyEdit)(u),(0,a.executeCommand)("editor.action.formatDocument").then(s.noop,s.noop)}static getTextForInsertion(e,t,n){const r=JSON.stringify(e);return"AfterItem"===t?"BeforeCursor"===n?r:`,${r}`:"BeforeItem"===t?`${r},`:r}static getCursorPositionInConfigurationsArray(e,t){if(d.isConfigurationArrayEmpty(e))return"InsideEmptyArray";const n=(0,i.createScanner)(e.getText(),!0);n.setPosition(e.offsetAt(t));const r=n.scan();return 5===r||4===r?"AfterItem":1===r?"BeforeItem":void 0}static isConfigurationArrayEmpty(e){const t=(0,i.parse)(e.getText(),[],{allowTrailingComma:!0,disallowComments:!1});return!t||!Array.isArray(t.configurations)||0===t.configurations.length}static isCommaImmediatelyBeforeCursor(e,t){const n=e.lineAt(t.line),r=e.getText(new o.Range(n.range.start,t));if(r.trim().endsWith(","))return!0;if(0!==r.trim().length)return!1;let i=t.line-1;for(;i>0;){const t=e.lineAt(i).text;if(t.trim().endsWith(","))return!0;if(0!==t.trim().length)return!1;i-=1}return!1}}r([(0,u.captureTelemetry)(p.EventName.DEBUGGER_CONFIGURATION_PROMPTS_IN_LAUNCH_JSON)],d.prototype,"selectAndInsertDebugConfig",null),t.LaunchJsonUpdaterServiceHelper=d},32442:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getManagePyPath=t.validateManagePy=t.buildDjangoLaunchDebugConfiguration=void 0;const r=n(71017),i=n(55674),o=n(67098),s=n(54813),a=n(61522),c=n(51097),l=n(41691),u=n(64551);async function p(e,t,n){const r=o.DebugConfigStrings.django.enterManagePyPath.invalid;if(!n||0===n.trim().length)return r;const s=(0,u.resolveVariables)(n,void 0,e);if(s){if(n!==t&&!await i.pathExists(s))return r;if(!s.trim().toLowerCase().endsWith(".py"))return r}}async function d(e){if(!e)return;const t=r.join(e.uri.fsPath,"manage.py");return await i.pathExists(t)?`\${workspaceFolder}${r.sep}manage.py`:void 0}t.buildDjangoLaunchDebugConfiguration=async function(e,t){const n=await d(t.folder);let i;const u=`\${workspaceFolder}${r.sep}manage.py`,h={name:o.DebugConfigStrings.django.snippet.name,type:c.DebuggerTypeName,request:"launch",program:n||u,args:["runserver"],django:!0,justMyCode:!0};if(!n){const n=await e.showInputBox({title:o.DebugConfigStrings.django.enterManagePyPath.title,value:u,prompt:o.DebugConfigStrings.django.enterManagePyPath.prompt,validate:e=>p(t.folder,u,e)});n&&(i=!0,h.program=n)}(0,s.sendTelemetryEvent)(a.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:l.DebugConfigurationType.launchDjango,autoDetectedDjangoManagePyPath:!!n,manuallyEnteredAValue:i}),Object.assign(t.config,h)},t.validateManagePy=p,t.getManagePyPath=d},80:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationPath=t.buildFastAPILaunchDebugConfiguration=void 0;const r=n(71017),i=n(55674),o=n(67098),s=n(54813),a=n(61522),c=n(51097),l=n(41691);async function u(e){if(!e)return;const t=r.join(e.uri.fsPath,"main.py");return await i.pathExists(t)?"main.py":void 0}t.buildFastAPILaunchDebugConfiguration=async function(e,t){const n=await u(t.folder);let i;const p={name:o.DebugConfigStrings.fastapi.snippet.name,type:c.DebuggerTypeName,request:"launch",module:"uvicorn",args:["main:app","--reload"],jinja:!0,justMyCode:!0};if(!n&&p.args){const t=await e.showInputBox({title:o.DebugConfigStrings.fastapi.enterAppPathOrNamePath.title,value:"main.py",prompt:o.DebugConfigStrings.fastapi.enterAppPathOrNamePath.prompt,validate:e=>Promise.resolve(e&&e.trim().length>0?void 0:o.DebugConfigStrings.fastapi.enterAppPathOrNamePath.invalid)});t&&(i=!0,p.args[0]=`${r.basename(t,".py").replace("/",".")}:app`)}(0,s.sendTelemetryEvent)(a.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:l.DebugConfigurationType.launchFastAPI,autoDetectedFastAPIMainPyPath:!!n,manuallyEnteredAValue:i}),Object.assign(t.config,p)},t.getApplicationPath=u},4846:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildFileLaunchDebugConfiguration=void 0;const r=n(67098),i=n(54813),o=n(61522),s=n(51097),a=n(41691);t.buildFileLaunchDebugConfiguration=async function(e,t){const n={name:r.DebugConfigStrings.file.snippet.name,type:s.DebuggerTypeName,request:"launch",program:"${file}",console:"integratedTerminal",justMyCode:!0};(0,i.sendTelemetryEvent)(o.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:a.DebugConfigurationType.launchFile}),Object.assign(t.config,n)}},74200:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationPath=t.buildFlaskLaunchDebugConfiguration=void 0;const r=n(71017),i=n(55674),o=n(67098),s=n(54813),a=n(61522),c=n(51097),l=n(41691);async function u(e){if(!e)return;const t=r.join(e.uri.fsPath,"app.py");return await i.pathExists(t)?"app.py":void 0}t.buildFlaskLaunchDebugConfiguration=async function(e,t){const n=await u(t.folder);let r;const i={name:o.DebugConfigStrings.flask.snippet.name,type:c.DebuggerTypeName,request:"launch",module:"flask",env:{FLASK_APP:n||"app.py",FLASK_DEBUG:"1"},args:["run","--no-debugger","--no-reload"],jinja:!0,justMyCode:!0};if(!n){const t=await e.showInputBox({title:o.DebugConfigStrings.flask.enterAppPathOrNamePath.title,value:"app.py",prompt:o.DebugConfigStrings.flask.enterAppPathOrNamePath.prompt,validate:e=>Promise.resolve(e&&e.trim().length>0?void 0:o.DebugConfigStrings.flask.enterAppPathOrNamePath.invalid)});t&&(r=!0,i.env.FLASK_APP=t)}(0,s.sendTelemetryEvent)(a.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:l.DebugConfigurationType.launchFlask,autoDetectedFlaskAppPyPath:!!n,manuallyEnteredAValue:r}),Object.assign(t.config,i)},t.getApplicationPath=u},37318:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildModuleLaunchConfiguration=void 0;const r=n(67098),i=n(54813),o=n(61522),s=n(51097),a=n(41691);t.buildModuleLaunchConfiguration=async function(e,t){let n;const c={name:r.DebugConfigStrings.module.snippet.name,type:s.DebuggerTypeName,request:"launch",module:r.DebugConfigStrings.module.snippet.default,justMyCode:!0},l=await e.showInputBox({title:r.DebugConfigStrings.module.enterModule.title,value:c.module||r.DebugConfigStrings.module.enterModule.default,prompt:r.DebugConfigStrings.module.enterModule.prompt,validate:e=>Promise.resolve(e&&e.trim().length>0?void 0:r.DebugConfigStrings.module.enterModule.invalid)});l&&(n=!0,c.module=l),(0,i.sendTelemetryEvent)(o.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:a.DebugConfigurationType.launchModule,manuallyEnteredAValue:n}),Object.assign(t.config,c)}},88372:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildPidAttachConfiguration=void 0;const r=n(67098),i=n(54813),o=n(61522),s=n(51097),a=n(41691);t.buildPidAttachConfiguration=async function(e,t){const n={name:r.DebugConfigStrings.attachPid.snippet.name,type:s.DebuggerTypeName,request:"attach",processId:"${command:pickProcess}",justMyCode:!0};(0,i.sendTelemetryEvent)(o.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:a.DebugConfigurationType.pidAttach}),Object.assign(t.config,n)}},32877:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDevelopmentIniPath=t.validateIniPath=t.buildPyramidLaunchConfiguration=void 0;const r=n(71017),i=n(55674),o=n(66828),s=n(67098),a=n(54813),c=n(61522),l=n(51097),u=n(41691),p=n(64551);async function d(e,t,n){if(!e)return;const r=s.DebugConfigStrings.pyramid.enterDevelopmentIniPath.invalid;if(!n||0===n.trim().length)return r;const o=(0,p.resolveVariables)(n,void 0,e);if(o){if(n!==t&&!i.pathExists(o))return r;if(!o.trim().toLowerCase().endsWith(".ini"))return r}}async function h(e){if(!e)return;const t=r.join(e.uri.fsPath,"development.ini");return await i.pathExists(t)?`\${workspaceFolder}${r.sep}development.ini`:void 0}t.buildPyramidLaunchConfiguration=async function(e,t){const n=await h(t.folder),i=`\${workspaceFolder}${r.sep}development.ini`;let p;const f={name:s.DebugConfigStrings.pyramid.snippet.name,type:l.DebuggerTypeName,request:"launch",module:"pyramid.scripts.pserve",args:[n||i],pyramid:!0,jinja:!0,justMyCode:!0};if(!n){const n=await e.showInputBox({title:s.DebugConfigStrings.pyramid.enterDevelopmentIniPath.title,value:i,prompt:o.l10n.t("Enter the path to development.ini ({0} points to the root of the current workspace folder)","${workspaceFolder}"),validate:e=>d(t?t.folder:void 0,i,e)});n&&(p=!0,f.args=[n])}(0,a.sendTelemetryEvent)(c.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:u.DebugConfigurationType.launchPyramid,autoDetectedPyramidIniPath:!!n,manuallyEnteredAValue:p}),Object.assign(t.config,f)},t.validateIniPath=d,t.getDevelopmentIniPath=h},36489:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildRemoteAttachConfiguration=void 0;const r=n(67098),i=n(54813),o=n(61522),s=n(51097),a=n(41691),c=n(84290),l="localhost";t.buildRemoteAttachConfiguration=async function(e,t){const n={name:r.DebugConfigStrings.attach.snippet.name,type:s.DebuggerTypeName,request:"attach",connect:{host:l,port:5678},pathMappings:[{localRoot:"${workspaceFolder}",remoteRoot:"."}],justMyCode:!0},u=n.connect;return u.host=await e.showInputBox({title:r.DebugConfigStrings.attach.enterRemoteHost.title,step:1,totalSteps:2,value:u.host||l,prompt:r.DebugConfigStrings.attach.enterRemoteHost.prompt,validate:e=>Promise.resolve(e&&e.trim().length>0?void 0:r.DebugConfigStrings.attach.enterRemoteHost.invalid)}),u.host||(u.host=l),(0,i.sendTelemetryEvent)(o.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:a.DebugConfigurationType.remoteAttach,manuallyEnteredAValue:u.host!==l}),Object.assign(t.config,n),n=>(0,c.configurePort)(e,t.config)}},91922:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.AttachConfigurationResolver=void 0;const o=n(86700),s=n(87450),a=n(7317),c=n(52062);let l=r=class extends c.BaseConfigurationResolver{async resolveDebugConfigurationWithSubstitutedVariables(e,t,n){const i=r.getWorkspaceFolder(e);await this.provideAttachDefaults(i,t);const o=t;return Array.isArray(o.debugOptions)&&(o.debugOptions=o.debugOptions.filter(((e,t)=>o.debugOptions.indexOf(e)===t))),void 0===t.clientOS&&(t.clientOS=(0,s.getOSType)()===s.OSType.Windows?"windows":"unix"),t}async provideAttachDefaults(e,t){Array.isArray(t.debugOptions)||(t.debugOptions=[]),t.connect||t.listen||t.host||(t.host="localhost"),void 0===t.justMyCode&&(t.justMyCode=!t.debugStdLib),t.showReturnValue=!1!==t.showReturnValue,t.workspaceFolder=e?e.fsPath:void 0;const n=t.debugOptions;t.justMyCode||r.debugOption(n,a.DebugOptions.DebugStdLib),t.django&&r.debugOption(n,a.DebugOptions.Django),t.jinja&&r.debugOption(n,a.DebugOptions.Jinja),!0===t.subProcess&&r.debugOption(n,a.DebugOptions.SubProcess),t.pyramid&&-1===n.indexOf(a.DebugOptions.Jinja)&&!1!==t.jinja&&r.debugOption(n,a.DebugOptions.Jinja),(t.redirectOutput||void 0===t.redirectOutput)&&r.debugOption(n,a.DebugOptions.RedirectOutput);const i=r.isLocalHost(t.host);(0,s.getOSType)()===s.OSType.Windows&&i&&r.debugOption(n,a.DebugOptions.FixFilePathCase),void 0===t.clientOS&&(t.clientOS=(0,s.getOSType)()===s.OSType.Windows?"windows":"unix"),t.showReturnValue&&r.debugOption(n,a.DebugOptions.ShowReturnValue),t.pathMappings=this.resolvePathMappings(t.pathMappings||[],t.host,t.localRoot,t.remoteRoot,e),r.sendTelemetry("attach",t)}resolvePathMappings(e,t,n,i,o){return n&&i&&e.push({localRoot:n,remoteRoot:i}),r.isLocalHost(t)&&(e=r.fixUpPathMappings(e,o?o.fsPath:"")),e.length>0?e:void 0}};l=r=i([(0,o.injectable)()],l),t.AttachConfigurationResolver=l},52062:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseConfigurationResolver=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(87450),l=n(85261),u=n(54813),p=n(61522),d=n(41691),h=n(64551),f=n(29741);let g=r=class{constructor(e,t){this.configurationService=e,this.interpreterService=t,this.pythonPathSource=d.PythonPathSource.launchJson}async resolveDebugConfiguration(e,t,n){return void 0===t.clientOS&&(t.clientOS=(0,c.getOSType)()===c.OSType.Windows?"windows":"unix"),t}static getWorkspaceFolder(e){if(e)return e.uri;const t=(0,f.getProgram)(),n=(0,l.getWorkspaceFolders)();if(!Array.isArray(n)||0===n.length)return t?a.Uri.file(s.dirname(t)):void 0;if(1===n.length)return n[0].uri;if(t){const e=(0,l.getWorkspaceFolder)(a.Uri.file(t));if(e)return e.uri}}async resolveAndUpdatePaths(e,t){r.resolveAndUpdateEnvFilePath(e,t),await this.resolveAndUpdatePythonPath(e,t)}static resolveAndUpdateEnvFilePath(e,t){t&&t.envFile&&(e||t.cwd)&&(t.envFile=(0,h.resolveVariables)(t.envFile,(e?e.fsPath:void 0)||t.cwd,void 0))}async resolveAndUpdatePythonPath(e,t){var n,r,i,o,s,a,c;if(t){if("${command:python.interpreterPath}"!==t.pythonPath&&t.pythonPath)t.pythonPath=(0,h.resolveVariables)(t.pythonPath?t.pythonPath:void 0,null==e?void 0:e.fsPath,void 0);else{const i=null!==(r=null===(n=await this.interpreterService.getActiveInterpreter(e))||void 0===n?void 0:n.path)&&void 0!==r?r:this.configurationService.getSettings(e).pythonPath;t.pythonPath=i}if("${command:python.interpreterPath}"===t.python){this.pythonPathSource=d.PythonPathSource.settingsJson;const n=null!==(o=null===(i=await this.interpreterService.getActiveInterpreter(e))||void 0===i?void 0:i.path)&&void 0!==o?o:this.configurationService.getSettings(e).pythonPath;t.python=n}else void 0===t.python?(this.pythonPathSource=d.PythonPathSource.settingsJson,t.python=t.pythonPath):(this.pythonPathSource=d.PythonPathSource.launchJson,t.python=(0,h.resolveVariables)(null!==(s=t.python)&&void 0!==s?s:t.pythonPath,null==e?void 0:e.fsPath,void 0));"${command:python.interpreterPath}"!==t.debugAdapterPython&&void 0!==t.debugAdapterPython||(t.debugAdapterPython=null!==(a=t.pythonPath)&&void 0!==a?a:t.python),"${command:python.interpreterPath}"!==t.debugLauncherPython&&void 0!==t.debugLauncherPython||(t.debugLauncherPython=null!==(c=t.pythonPath)&&void 0!==c?c:t.python),delete t.pythonPath}}static debugOption(e,t){e.indexOf(t)>=0||e.push(t)}static isLocalHost(e){return!!(e&&["localhost","127.0.0.1","::1"].indexOf(e.toLowerCase())>=0)}static fixUpPathMappings(e,t,n){return t?(n||(n=t),e=0===e.length?[{localRoot:t,remoteRoot:n}]:e.map((({localRoot:e,remoteRoot:n})=>({localRoot:(0,h.resolveVariables)(e,t,void 0)||"",remoteRoot:n}))),(0,c.getOSType)()===c.OSType.Windows&&(e=e.map((({localRoot:e,remoteRoot:t})=>{let n=e;return e.match(/^[A-Z]:/)&&(n=`${e[0].toLowerCase()}${e.substr(1)}`),{localRoot:n,remoteRoot:t}}))),e):[]}static isDebuggingFastAPI(e){return!(!e.module||"FASTAPI"!==e.module.toUpperCase())}static isDebuggingFlask(e){return!(!e.module||"FLASK"!==e.module.toUpperCase())}static sendTelemetry(e,t){const n=t.name||"",i=t.module||"",o={trigger:e,console:t.console,hasEnvVars:"object"==typeof t.env&&Object.keys(t.env).length>0,django:!!t.django,fastapi:r.isDebuggingFastAPI(t),flask:r.isDebuggingFlask(t),hasArgs:Array.isArray(t.args)&&t.args.length>0,isLocalhost:r.isLocalHost(t.host),isModule:i.length>0,isSudo:!!t.sudo,jinja:!!t.jinja,pyramid:!!t.pyramid,stopOnEntry:!!t.stopOnEntry,showReturnValue:!!t.showReturnValue,subProcess:!!t.subProcess,watson:n.toLowerCase().indexOf("watson")>=0,pyspark:n.toLowerCase().indexOf("pyspark")>=0,gevent:n.toLowerCase().indexOf("gevent")>=0,scrapy:"scrapy"===i.toLowerCase()};(0,u.sendTelemetryEvent)(p.EventName.DEBUGGER,void 0,o)}};g=r=i([(0,o.injectable)()],g),t.BaseConfigurationResolver=g},29741:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getProgram=t.DebugEnvironmentVariablesHelper=t.IDebugEnvironmentVariablesService=void 0;const o=n(86700),s=n(61684),a=n(19909),c=n(77570),l=n(56693),u=n(47237);t.IDebugEnvironmentVariablesService=Symbol("IDebugEnvironmentVariablesService");let p=class{constructor(e,t){this.envParser=e,this.process=t}async getEnvironmentVariables(e,t){var n;const r=(0,u.getSearchPathEnvVarNames)()[0],i=e.env&&Object.keys(e.env).length>0?{...e.env}:{},o=await this.envParser.parseFile(e.envFile,i),s=o?{...o}:{};return this.envParser.mergeVariables(i,s,{overwrite:!0}),t&&this.envParser.mergeVariables(t,s,{mergeAll:!0}),this.envParser.appendPath(s,null!==(n=i[r])&&void 0!==n?n:i[r.toUpperCase()]),this.envParser.appendPythonPath(s,i.PYTHONPATH),"string"==typeof s[r]&&s[r].length>0&&this.envParser.appendPath(s,this.process.env[r]),"string"==typeof s.PYTHONPATH&&s.PYTHONPATH.length>0&&this.envParser.appendPythonPath(s,this.process.env.PYTHONPATH),"internalConsole"===e.console&&(this.envParser.mergeVariables(this.process.env,s),void 0===s[r]&&"string"==typeof this.process.env[r]&&(s[r]=this.process.env[r]),void 0===s.PYTHONPATH&&"string"==typeof this.process.env.PYTHONPATH&&(s.PYTHONPATH=this.process.env.PYTHONPATH)),s.hasOwnProperty("PYTHONIOENCODING")||(s.PYTHONIOENCODING="UTF-8"),s.hasOwnProperty("PYTHONUNBUFFERED")||(s.PYTHONUNBUFFERED="1"),e.gevent&&(s.GEVENT_SUPPORT="True"),s}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IEnvironmentVariablesService)),i(1,(0,o.inject)(s.ICurrentProcess))],p),t.DebugEnvironmentVariablesHelper=p,t.getProgram=function(){const e=(0,l.getActiveTextEditor)();if(e&&e.document.languageId===c.PYTHON_LANGUAGE)return e.document.fileName}},18512:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchConfigurationResolver=void 0;const s=n(86700),a=n(42655),c=n(93971),l=n(61684),u=n(87450),p=n(80351),d=n(18639),h=n(51097),f=n(7317),g=n(52062),m=n(29741);let v=r=class extends g.BaseConfigurationResolver{constructor(e,t,n,r,i){super(t,r),this.invalidPythonPathInDebuggerService=e,this.debugEnvHelper=n,this.environmentActivationService=i,this.isCustomPythonSet=!1}async resolveDebugConfiguration(e,t,n){if(this.isCustomPythonSet=void 0!==t.python,void 0===t.name&&void 0===t.type&&void 0===t.request&&void 0===t.program&&void 0===t.env){const e=(0,m.getProgram)();t.name="Launch",t.type=h.DebuggerTypeName,t.request="launch",t.program=null!=e?e:"",t.env={}}const i=r.getWorkspaceFolder(e);return t.workspaceFolder=null==i?void 0:i.fsPath,await this.resolveAndUpdatePaths(i,t),void 0===t.clientOS&&(t.clientOS=(0,u.getOSType)()===u.OSType.Windows?"windows":"unix"),t}async resolveDebugConfigurationWithSubstitutedVariables(e,t,n){const i=r.getWorkspaceFolder(e);if(await this.provideLaunchDefaults(i,t),await this.validateLaunchConfiguration(e,t))return Array.isArray(t.debugOptions)&&(t.debugOptions=t.debugOptions.filter(((e,n)=>t.debugOptions.indexOf(e)===n))),t}async provideLaunchDefaults(e,t){var n,i;if(void 0===t.python&&(t.python=t.pythonPath),void 0===t.debugAdapterPython&&(t.debugAdapterPython=t.pythonPath),void 0===t.debugLauncherPython&&(t.debugLauncherPython=t.pythonPath),delete t.pythonPath,"string"!=typeof t.cwd&&e&&(t.cwd=e.fsPath),"string"!=typeof t.envFile&&e){const n=this.configurationService.getSettings(e);t.envFile=n.envFile}let o;(this.isCustomPythonSet||"integratedTerminal"!==t.console)&&(o=await this.environmentActivationService.getActivatedEnvironmentVariables(e,await this.interpreterService.getInterpreterDetails(null!==(n=t.python)&&void 0!==n?n:""))),t.env=await this.debugEnvHelper.getEnvironmentVariables(t,o),"boolean"!=typeof t.stopOnEntry&&(t.stopOnEntry=!1),t.showReturnValue=!1!==t.showReturnValue,t.console||(t.console="integratedTerminal"),"internalConsole"===t.console||t.internalConsoleOptions||(t.internalConsoleOptions="neverOpen"),Array.isArray(t.debugOptions)||(t.debugOptions=[]),void 0===t.justMyCode&&(t.justMyCode=!t.debugStdLib);const s=t.debugOptions;t.justMyCode||r.debugOption(s,f.DebugOptions.DebugStdLib),t.stopOnEntry&&r.debugOption(s,f.DebugOptions.StopOnEntry),t.showReturnValue&&r.debugOption(s,f.DebugOptions.ShowReturnValue),t.django&&r.debugOption(s,f.DebugOptions.Django),t.jinja&&r.debugOption(s,f.DebugOptions.Jinja),void 0===t.redirectOutput&&"internalConsole"===t.console&&(t.redirectOutput=!0),t.redirectOutput&&r.debugOption(s,f.DebugOptions.RedirectOutput),t.sudo&&r.debugOption(s,f.DebugOptions.Sudo),!0===t.subProcess&&r.debugOption(s,f.DebugOptions.SubProcess),(0,u.getOSType)()===u.OSType.Windows&&r.debugOption(s,f.DebugOptions.FixFilePathCase);const a=r.isDebuggingFastAPI(t),c=r.isDebuggingFlask(t);if((t.pyramid||c||a)&&-1===s.indexOf(f.DebugOptions.Jinja)&&!1!==t.jinja&&r.debugOption(s,f.DebugOptions.Jinja),t.pathMappings){let{pathMappings:n}=t;n.length>0&&(n=r.fixUpPathMappings(n||[],e?e.fsPath:"")),t.pathMappings=n.length>0?n:void 0}const l=(null===(i=t.purpose)||void 0===i?void 0:i.includes(f.DebugPurpose.DebugTest))||"test"===t.request?"test":"launch";r.sendTelemetry(l,t)}async validateLaunchConfiguration(e,t){const n=this.invalidPythonPathInDebuggerService;for(const r of[t.python,t.debugAdapterPython,t.debugLauncherPython])if(!await n.validatePythonPath(r,this.pythonPathSource,null==e?void 0:e.uri))return!1;return!0}};v=r=i([(0,s.injectable)(),o(0,(0,s.inject)(c.IDiagnosticsService)),o(0,(0,s.named)(a.InvalidPythonPathInDebuggerServiceId)),o(1,(0,s.inject)(l.IConfigurationService)),o(2,(0,s.inject)(m.IDebugEnvironmentVariablesService)),o(3,(0,s.inject)(d.IInterpreterService)),o(4,(0,s.inject)(p.IEnvironmentActivationService))],v),t.LaunchConfigurationResolver=v},45093:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDebugConfigurationResolver=void 0,t.IDebugConfigurationResolver=Symbol("IDebugConfigurationResolver")},64551:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveVariables=void 0;const r=n(85261);t.resolveVariables=function(e,t,n){if(e){const i=n?(0,r.getWorkspaceFolder)(n.uri):void 0,o={};o.workspaceFolder=i?i.uri.fsPath:t;const s=/\$\{(.*?)\}/g;return e.replace(s,((e,t)=>{const n=o[t];return"string"==typeof(r=n)||r instanceof String?n:e&&(e.indexOf("env.")>0||e.indexOf("env:")>0)?"":e;var r}))}return e}},84290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.configurePort=void 0;const r=n(67098),i=n(54813),o=n(61522),s=n(41691),a=5678;t.configurePort=async function(e,t){const n=t.connect||(t.connect={}),c=await e.showInputBox({title:r.DebugConfigStrings.attach.enterRemotePort.title,step:2,totalSteps:2,value:(n.port||a).toString(),prompt:r.DebugConfigStrings.attach.enterRemotePort.prompt,validate:e=>Promise.resolve(e&&/^\d+$/.test(e.trim())?void 0:r.DebugConfigStrings.attach.enterRemotePort.invalid)});c&&/^\d+$/.test(c.trim())&&(n.port=parseInt(c,10)),n.port||(n.port=a),(0,i.sendTelemetryEvent)(o.EventName.DEBUGGER_CONFIGURATION_PROMPTS,void 0,{configurationType:s.DebugConfigurationType.remoteAttach,manuallyEnteredAValue:n.port!==a})}},98730:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugCommands=void 0;const s=n(71017),a=n(86700),c=n(17585),l=n(77570),u=n(61684),p=n(54813),d=n(61522),h=n(7317),f=n(18639),g=n(3481),m=n(40169);let v=r=class{constructor(e,t,n,r){this.commandManager=e,this.debugService=t,this.disposables=n,this.interpreterService=r,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}activate(){return this.disposables.push(this.commandManager.registerCommand(l.Commands.Debug_In_Terminal,(async e=>{if((0,p.sendTelemetryEvent)(d.EventName.DEBUG_IN_TERMINAL_BUTTON),!await this.interpreterService.getActiveInterpreter(e))return void this.commandManager.executeCommand(l.Commands.TriggerEnvironmentSelection,e).then(g.noop,g.noop);const t=await r.getDebugConfiguration(e);this.debugService.startDebugging(void 0,t)}))),Promise.resolve()}static async getDebugConfiguration(e){var t,n,r;const i=(await(0,m.getConfigurationsByUri)(e)).filter((e=>"launch"===e.request));for(const r of i)if(null===(t=r.purpose)||void 0===t?void 0:t.includes(h.DebugPurpose.DebugInTerminal))return r.program||r.module||r.code||(r.program=null!==(n=null==e?void 0:e.fsPath)&&void 0!==n?n:"${file}"),r.purpose=[],r;return{name:`Debug ${e?s.basename(e.fsPath):"File"}`,type:"python",request:"launch",program:null!==(r=null==e?void 0:e.fsPath)&&void 0!==r?r:"${file}",console:"integratedTerminal"}}};v=r=i([(0,a.injectable)(),o(0,(0,a.inject)(c.ICommandManager)),o(1,(0,a.inject)(c.IDebugService)),o(2,(0,a.inject)(u.IDisposableRegistry)),o(3,(0,a.inject)(f.IInterpreterService))],v),t.DebugCommands=v},53964:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChildProcessAttachEventHandler=void 0;const o=n(86700),s=n(36952),a=n(27620),c=n(92378),l=n(51097);let u=class{constructor(e){this.childProcessAttachService=e}async handleCustomEvent(e){if(!e||e.session.configuration.type!==l.DebuggerTypeName)return;let t;e.event!==a.DebuggerEvents.PtvsdAttachToSubprocess&&e.event!==a.DebuggerEvents.DebugpyAttachToSubprocess||(t=e.body,Object.keys(t).length>0&&await this.childProcessAttachService.attach(t,e.session))}};r([(0,s.swallowExceptions)("Handle child process launch")],u.prototype,"handleCustomEvent",null),u=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IChildProcessAttachService))],u),t.ChildProcessAttachEventHandler=u},47282:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChildProcessAttachService=void 0;const o=n(86700),s=n(17585),a=n(66828),c=n(3481),l=n(54813),u=n(61522),p=n(56693),d=n(85261);let h=class{constructor(e){this.debugService=e}async attach(e,t){const n=e,r=this.getRelatedWorkspaceFolder(n),i={parentSession:t,lifecycleManagedByParent:!0};await this.debugService.startDebugging(r,n,i)||(0,p.showErrorMessage)(a.l10n.t("Failed to launch debugger for child process {0}",n.subProcessId)).then(c.noop,c.noop)}getRelatedWorkspaceFolder(e){var t;const n=e.workspaceFolder;if(((null===(t=(0,d.getWorkspaceFolders)())||void 0===t?void 0:t.length)||0)>0&&n)return(0,d.getWorkspaceFolders)().find((e=>e.uri.fsPath===n))}};r([(0,l.captureTelemetry)(u.EventName.DEBUGGER_ATTACH_TO_CHILD_PROCESS)],h.prototype,"attach",null),h=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IDebugService))],h),t.ChildProcessAttachService=h},27620:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerEvents=void 0,(n=t.DebuggerEvents||(t.DebuggerEvents={})).PtvsdAttachToSubprocess="ptvsd_attach",n.DebugpyAttachToSubprocess="debugpyAttach"},43397:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugSessionEventDispatcher=void 0;const o=n(86700),s=n(17585),a=n(61684),c=n(92378);let l=class{constructor(e,t,n){this.eventHandlers=e,this.debugService=t,this.disposables=n}registerEventHandlers(){this.disposables.push(this.debugService.onDidReceiveDebugSessionCustomEvent((e=>{this.eventHandlers.forEach((t=>t.handleCustomEvent?t.handleCustomEvent(e).ignoreErrors():void 0))}))),this.disposables.push(this.debugService.onDidTerminateDebugSession((e=>{this.eventHandlers.forEach((t=>t.handleTerminateEvent?t.handleTerminateEvent(e).ignoreErrors():void 0))})))}};l=r([i(0,(0,o.multiInject)(c.IDebugSessionEventHandlers)),i(1,(0,o.inject)(s.IDebugService)),i(2,(0,o.inject)(a.IDisposableRegistry))],l),t.DebugSessionEventDispatcher=l},92378:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IChildProcessAttachService=t.IDebugSessionEventHandlers=void 0,t.IDebugSessionEventHandlers=Symbol("IDebugSessionEventHandlers"),t.IChildProcessAttachService=Symbol("IChildProcessAttachService")},3509:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(11393),o=n(44673),s=n(2493),a=n(93951),c=n(56471),l=n(75791),u=n(23728),p=n(58184),d=n(88248),h=n(71762),f=n(75734),g=n(91922),m=n(29741),v=n(18512),y=n(45093),b=n(98730),S=n(53964),E=n(47282),_=n(92378),w=n(41691);t.registerTypes=function(e){e.addSingleton(r.IExtensionSingleActivationService,d.LaunchJsonCompletionProvider),e.addSingleton(r.IExtensionSingleActivationService,h.InterpreterPathCommand),e.addSingleton(r.IExtensionSingleActivationService,f.LaunchJsonUpdaterService),e.addSingleton(w.IDebugConfigurationService,u.PythonDebugConfigurationService),e.addSingleton(w.IDynamicDebugConfigurationService,p.DynamicPythonDebugConfigurationService),e.addSingleton(_.IChildProcessAttachService,E.ChildProcessAttachService),e.addSingleton(_.IDebugSessionEventHandlers,S.ChildProcessAttachEventHandler),e.addSingleton(y.IDebugConfigurationResolver,v.LaunchConfigurationResolver,"launch"),e.addSingleton(y.IDebugConfigurationResolver,g.AttachConfigurationResolver,"attach"),e.addSingleton(m.IDebugEnvironmentVariablesService,m.DebugEnvironmentVariablesHelper),e.addSingleton(r.IExtensionSingleActivationService,i.DebugAdapterActivator),e.addSingleton(w.IDebugAdapterDescriptorFactory,o.DebugAdapterDescriptorFactory),e.addSingleton(w.IDebugSessionLoggingFactory,s.DebugSessionLoggingFactory),e.addSingleton(w.IOutdatedDebuggerPromptFactory,a.OutdatedDebuggerPromptFactory),e.addSingleton(l.IAttachProcessProviderFactory,c.AttachProcessProviderFactory),e.addSingleton(r.IExtensionSingleActivationService,b.DebugCommands)}},41691:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.IProtocolParser=t.IOutdatedDebuggerPromptFactory=t.IDebugSessionLoggingFactory=t.IDebugAdapterDescriptorFactory=t.PythonPathSource=t.DebugConfigurationType=t.IDynamicDebugConfigurationService=t.IDebugConfigurationService=void 0,t.IDebugConfigurationService=Symbol("IDebugConfigurationService"),t.IDynamicDebugConfigurationService=Symbol("IDynamicDebugConfigurationService"),(r=t.DebugConfigurationType||(t.DebugConfigurationType={})).launchFile="launchFile",r.remoteAttach="remoteAttach",r.launchDjango="launchDjango",r.launchFastAPI="launchFastAPI",r.launchFlask="launchFlask",r.launchModule="launchModule",r.launchPyramid="launchPyramid",r.pidAttach="pidAttach",(n=t.PythonPathSource||(t.PythonPathSource={})).launchJson="launch.json",n.settingsJson="settings.json",t.IDebugAdapterDescriptorFactory=Symbol("IDebugAdapterDescriptorFactory"),t.IDebugSessionLoggingFactory=Symbol("IDebugSessionLoggingFactory"),t.IOutdatedDebuggerPromptFactory=Symbol("IOutdatedDebuggerPromptFactory"),t.IProtocolParser=Symbol("IProtocolParser")},7317:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPurpose=t.DebugOptions=void 0,(r=t.DebugOptions||(t.DebugOptions={})).RedirectOutput="RedirectOutput",r.Django="Django",r.Jinja="Jinja",r.DebugStdLib="DebugStdLib",r.Sudo="Sudo",r.Pyramid="Pyramid",r.FixFilePathCase="FixFilePathCase",r.WindowsClient="WindowsClient",r.UnixClient="UnixClient",r.StopOnEntry="StopOnEntry",r.ShowReturnValue="ShowReturnValue",r.SubProcess="Multiprocess",(n=t.DebugPurpose||(t.DebugPurpose={})).DebugTest="debug-test",n.DebugInTerminal="debug-in-terminal"},70301:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildDeprecatedProposedApi=t.reportActiveInterpreterChangedDeprecated=t.reportInterpretersChanged=void 0;const r=n(66828),i=n(48431),o=n(61684),s=n(18639),a=n(19735),c=n(44773),l=n(54813),u=n(61522),p=new r.EventEmitter;t.reportInterpretersChanged=function(e){p.fire(e)};const d=new r.EventEmitter;function h(e){const t=[`${e.version.major}`,`${e.version.minor}`,`${e.version.micro}`];return e.version.release&&(t.push(`${e.version.release}`),e.version.sysVersion&&t.push(`${e.version.release}`)),t}t.reportActiveInterpreterChangedDeprecated=function(e){d.fire(e)},t.buildDeprecatedProposedApi=function(e,t){const n=t.get(o.IInterpreterPathService),f=t.get(s.IInterpreterService),g=t.get(o.IExtensions),m=new Set;function v(e,t=!0){g.determineExtensionFromCallStack().then((n=>{(0,l.sendTelemetryEvent)(u.EventName.PYTHON_ENVIRONMENTS_API,void 0,{apiName:e,extensionId:n.extensionId}),(0,a.traceVerbose)(`Extension ${n.extensionId} accessed ${e}`),t&&!m.has(n.extensionId)&&(console.warn(`${n.extensionId} extension is using deprecated python APIs which will be removed soon.`),m.add(n.extensionId))})).ignoreErrors()}return{environment:{async getExecutionDetails(e){v("deprecated.getExecutionDetails");const t=await f.getActiveInterpreter(e);return t?{execCommand:[t.path]}:{execCommand:void 0}},async getActiveEnvironmentPath(e){v("deprecated.getActiveEnvironmentPath");const t=await f.getActiveInterpreter(e);if(t)return(0,c.getEnvPath)(t.path,t.envPath)},async getEnvironmentDetails(t,n){let r;if(v("deprecated.getEnvironmentDetails"),(null==n?void 0:n.useCache)&&(r=e.getEnvs().find((e=>function(e,t){return(0,i.arePathsSame)(e,t.location)||(0,i.arePathsSame)(e,t.executable.filename)}(t,e)))),r||(r=await e.resolveEnv(t),r))return{interpreterPath:r.executable.filename,envFolderPath:r.location.length?r.location:void 0,version:h(r),environmentType:[r.kind],metadata:{sysPrefix:r.executable.sysPrefix,bitness:r.arch,project:r.searchLocation}}},getEnvironmentPaths(){v("deprecated.getEnvironmentPaths");const t=e.getEnvs().map((e=>(0,c.getEnvPath)(e.executable.filename,e.location)));return Promise.resolve(t)},setActiveEnvironment:(e,t)=>(v("deprecated.setActiveEnvironment"),n.update(t,r.ConfigurationTarget.WorkspaceFolder,e)),async refreshEnvironment(){v("deprecated.refreshEnvironment"),await e.triggerRefresh();const t=e.getEnvs().map((e=>(0,c.getEnvPath)(e.executable.filename,e.location)));return Promise.resolve(t)},getRefreshPromise:t=>(v("deprecated.getRefreshPromise"),e.getRefreshPromise(t)),get onDidChangeExecutionDetails(){return v("deprecated.onDidChangeExecutionDetails",!1),f.onDidChangeInterpreterConfiguration},get onDidEnvironmentsChanged(){return v("deprecated.onDidEnvironmentsChanged",!1),p.event},get onDidActiveEnvironmentChanged(){return v("deprecated.onDidActiveEnvironmentChanged",!1),d.event},get onRefreshProgress(){return v("deprecated.onRefreshProgress",!1),e.onProgress}}}}},12304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertEnvInfo=t.convertCompleteEnvInfo=t.buildEnvironmentApi=t.EnvironmentReference=t.reportActiveInterpreterChanged=void 0;const r=n(66828),i=n(71017),o=n(61684),s=n(87450),a=n(45878),c=n(44773),l=n(29983),u=n(19735),p=n(48431),d=n(54813),h=n(61522),f=n(70301),g=n(19909),m=n(85261),v=n(85949),y=new r.EventEmitter;t.reportActiveInterpreterChanged=function(e){var t;y.fire({id:O(e.path),path:e.path,resource:e.resource}),(0,f.reportActiveInterpreterChangedDeprecated)({path:e.path,resource:null===(t=e.resource)||void 0===t?void 0:t.uri})};const b=new r.EventEmitter,S=new r.EventEmitter,E=new Map;class _{constructor(e){this.internal=e,this.id=e.id}get executable(){return Object.freeze(this.internal.executable)}get environment(){return Object.freeze(this.internal.environment)}get version(){return Object.freeze(this.internal.version)}get tools(){return Object.freeze(this.internal.tools)}get path(){return Object.freeze(this.internal.path)}updateEnv(e){this.internal=e}}function w(e){let t=E.get(e.id);return t?t.updateEnv(e):t=new _(e),E.set(e.id,t),t}function T(e){const t=(0,m.getWorkspaceFolders)();if(e.searchLocation){const n=e.searchLocation;return!!t&&t.some((e=>(0,p.isParentPath)(n.fsPath,e.uri.fsPath)))}return!0}function C(e){const t={...e.version,sysVersion:e.version.sysVersion};let n=function(e){switch(e){case a.PythonEnvKind.Venv:return"Venv";case a.PythonEnvKind.Pipenv:return"Pipenv";case a.PythonEnvKind.Poetry:return"Poetry";case a.PythonEnvKind.VirtualEnvWrapper:return"VirtualEnvWrapper";case a.PythonEnvKind.VirtualEnv:return"VirtualEnv";case a.PythonEnvKind.Conda:return"Conda";case a.PythonEnvKind.Pyenv:return"Pyenv";default:return}}(e.kind);e.type&&!n&&(n="Unknown");const{path:i}=(0,c.getEnvPath)(e.executable.filename,e.location);return{path:i,id:e.id,executable:{uri:"python"===e.executable.filename?void 0:r.Uri.file(e.executable.filename),bitness:x(e.arch),sysPrefix:e.executable.sysPrefix},environment:e.type?{type:(o=e.type,o===a.PythonEnvType.Conda?"Conda":o===a.PythonEnvType.Virtual?"VirtualEnvironment":"Unknown"),name:""===e.name?void 0:e.name,folderUri:r.Uri.file(e.location),workspaceFolder:(0,m.getWorkspaceFolder)(e.searchLocation)}:void 0,version:"python"===e.executable.filename?void 0:t,tools:n?[n]:[]};var o}function P(e){var t,n,r,i;const o=C(e);return""===o.executable.sysPrefix&&(o.executable.sysPrefix=void 0),""===(null===(t=o.version)||void 0===t?void 0:t.sysVersion)&&(o.version.sysVersion=void 0),-1===(null===(n=o.version)||void 0===n?void 0:n.major)&&(o.version.major=void 0),-1===(null===(r=o.version)||void 0===r?void 0:r.micro)&&(o.version.micro=void 0),-1===(null===(i=o.version)||void 0===i?void 0:i.minor)&&(o.version.minor=void 0),o}function I(e){return w(P(e))}function x(e){switch(e){case s.Architecture.x64:return"64-bit";case s.Architecture.x86:return"32-bit";default:return"Unknown"}}function O(e){return(0,p.normCasePath)(e)}t.EnvironmentReference=_,t.buildEnvironmentApi=function(e,t){const n=t.get(o.IInterpreterPathService),s=t.get(o.IConfigurationService),a=t.get(o.IDisposableRegistry),p=t.get(o.IExtensions),E=t.get(g.IEnvironmentVariablesProvider);function _(e,t){p.determineExtensionFromCallStack().then((n=>{(0,d.sendTelemetryEvent)(h.EventName.PYTHON_ENVIRONMENTS_API,void 0,{apiName:e,extensionId:n.extensionId}),(0,u.traceVerbose)(`Extension ${n.extensionId} accessed ${e} with args: ${JSON.stringify(t)}`)})).ignoreErrors()}a.push(e.onChanged((e=>{var t;const n=null!==(t=e.new)&&void 0!==t?t:e.old;n&&T(n)&&(e.old?e.new?((0,u.traceVerbose)("Python API env change detected",n.id,"update"),b.fire({type:"update",env:I(e.new)}),(0,f.reportInterpretersChanged)([{path:(0,c.getEnvPath)(e.new.executable.filename,e.new.location).path,type:"update"}])):((0,u.traceVerbose)("Python API env change detected",n.id,"remove"),b.fire({type:"remove",env:I(e.old)}),(0,f.reportInterpretersChanged)([{path:(0,c.getEnvPath)(e.old.executable.filename,e.old.location).path,type:"remove"}])):e.new&&((0,u.traceVerbose)("Python API env change detected",n.id,"add"),b.fire({type:"add",env:I(e.new)}),(0,f.reportInterpretersChanged)([{path:(0,c.getEnvPath)(e.new.executable.filename,e.new.location).path,type:"add"}])))})),E.onDidEnvironmentVariablesChange((e=>{S.fire({resource:(0,m.getWorkspaceFolder)(e),env:E.getEnvironmentVariablesSync(e)})})),b,S);const P={getEnvironmentVariables:e=>(_("getEnvironmentVariables"),e=e&&"uri"in e?e.uri:e,E.getEnvironmentVariablesSync(e)),get onDidEnvironmentVariablesChange(){return _("onDidEnvironmentVariablesChange"),S.event},getActiveEnvironmentPath(e){_("getActiveEnvironmentPath"),e=e&&"uri"in e?e.uri:e;const t=s.getSettings(e).pythonPath;return{id:"python"===t?"DEFAULT_PYTHON":O(t),path:t}},updateActiveEnvironmentPath(e,t){_("updateActiveEnvironmentPath");const i="string"!=typeof e?e.path:e;return t=t&&"uri"in t?t.uri:t,n.update(t,r.ConfigurationTarget.WorkspaceFolder,i)},get onDidChangeActiveEnvironmentPath(){return _("onDidChangeActiveEnvironmentPath"),y.event},resolveEnvironment:async n=>{if(!r.workspace.isTrusted)throw new Error("Not allowed to resolve environment in an untrusted workspace");let o="string"!=typeof n?n.path:n;if(i.basename(o)===o){const e=t.get(l.IPythonExecutionFactory),n=await e.create({pythonPath:o}),r=await n.getExecutablePath().catch((e=>{(0,u.traceError)("Cannot resolve full path",e)}));if(!r)return;o=r}return _("resolveEnvironment",n),async function(e,t){var n,r,i;const o=await t.resolveEnv(e);if(!o)return;const s=w(C(o));return-1!==(null===(n=s.version)||void 0===n?void 0:n.major)&&-1!==(null===(r=s.version)||void 0===r?void 0:r.minor)&&-1!==(null===(i=s.version)||void 0===i?void 0:i.micro)||(0,u.traceError)(`Invalid version for ${e}: ${JSON.stringify(o)}`),s}(o,e)},get known(){return _("known"),e.getEnvs().filter((e=>T(e))).map((e=>I(e)))},async refreshEnvironments(t){r.workspace.isTrusted?(await e.triggerRefresh(void 0,{ifNotTriggerredAlready:!(null==t?void 0:t.forceRefresh)}),_("refreshEnvironments")):(0,u.traceError)("Not allowed to refresh environments in an untrusted workspace")},get onDidChangeEnvironments(){return _("onDidChangeEnvironments"),b.event},...(0,v.buildEnvironmentCreationApi)()};return P},t.convertCompleteEnvInfo=C,t.convertEnvInfo=P},20910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.activateFeatures=t.activateComponents=void 0;const r=n(66828),i=n(76546),o=n(90819),s=n(30086),a=n(77651),c=n(17585),l=n(77570),u=n(34061),p=n(84974),d=n(61684),h=n(3481),f=n(51097),g=n(3509),m=n(41691),v=n(88681),y=n(18639),b=n(29917),S=n(10900),E=n(52842),_=n(6342),w=n(76687),T=n(43768),C=n(8593),P=n(72392),I=n(94611),x=n(73607),O=n(43200),R=n(59857),D=n(29817),A=n(14306),k=n(54144),N=n(43397),M=n(92378),L=n(56792),j=n(54351),F=n(63462),U=n(63369);t.activateComponents=async function(e,t){const n=await async function(e){const{context:t,legacyIOC:n}=e,{serviceManager:D,serviceContainer:L}=n,j=D.get(p.IFileSystem);await(0,P.setExtensionInstallTelemetryProperties)(j);const U=D.get(c.IApplicationEnvironment),{enableProposedApi:V}=U.packageJson;D.addSingletonInstance(l.UseProposedApi,V),(0,R.registerTypes)(D),(0,E.registerTypes)(D),(0,v.registerTypes)(D),(0,u.registerTypes)(D),(0,x.registerTypes)(D),(0,g.registerTypes)(D),(0,I.registerTypes)(D);const H=L.get(d.IExtensions);await(0,A.setDefaultLanguageServer)(H,D);const B=D.get(d.IConfigurationService);L.get(d.IConfigurationService).getSettings().register(),(0,s.registerTypes)(D),(0,T.registerTypes)(D),(0,i.registerTypes)(D);const W=D.get(d.IDisposableRegistry),q=L.get(c.IWorkspaceService),$=L.get(c.ICommandManager);if(r.languages.setLanguageConfiguration(l.PYTHON_LANGUAGE,(0,b.getLanguageConfiguration)()),q.isTrusted&&(L.get(y.IInterpreterService).initialize(),!q.isVirtualWorkspace)){const e=D.getAll(M.IDebugSessionEventHandlers);new N.DebugSessionEventDispatcher(e,k.DebugService.instance,W).registerEventHandlers();const n=D.get(d.ILogOutputChannel);W.push($.registerCommand(l.Commands.ViewOutput,(()=>n.show()))),$.executeCommand("setContext","python.vscode.channel",U.channel).then(h.noop,h.noop),L.get(a.IApplicationDiagnostics).register(),D.get(O.ITerminalAutoActivation).register();const i=B.getSettings();if(D.get(O.ICodeExecutionManager).registerCommands(),W.push(new S.LinterCommands(D)),i&&i.formatting&&"internalConsole"!==i.formatting.provider){const e=new _.PythonFormattingEditProvider(t,L);W.push(r.languages.registerDocumentFormattingEditProvider(l.PYTHON,e)),W.push(r.languages.registerDocumentRangeFormattingEditProvider(l.PYTHON,e))}W.push(new w.ReplProvider(L));const o=new C.TerminalProvider(L);o.initialize(r.window.activeTerminal).ignoreErrors(),W.push(o),L.getAll(m.IDebugConfigurationService).forEach((e=>{W.push(r.debug.registerDebugConfigurationProvider(f.DebuggerTypeName,e))})),W.push(r.debug.registerDebugConfigurationProvider(f.DebuggerTypeName,L.get(m.IDynamicDebugConfigurationService),r.DebugConfigurationProviderTriggerKind.Dynamic)),(0,F.registerInstallFormatterPrompt)(L)}const G=L.get(o.IExtensionActivationManager);return W.push(G),{fullyReady:G.activate()}}(e);if(!(new L.WorkspaceService).isTrusted)return[n];const j=[D.activate(t.pythonEnvs,e)];return Promise.all([n,...j])},t.activateFeatures=function(e,t){const n=e.legacyIOC.serviceContainer.get(j.IInterpreterQuickPick),r=e.legacyIOC.serviceContainer.get(d.IInterpreterPathService),i=e.legacyIOC.serviceContainer.get(d.IPathUtils);(0,U.registerAllCreateEnvironmentFeatures)(e.disposables,n,r,i)}},63912:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeComponents=t.initializeStandard=t.initializeGlobals=void 0;const r=n(86700),i=n(66828),o=n(74351),s=n(29992),a=n(52615),c=n(39702),l=n(51863),u=n(61684),p=n(28285),d=n(67098),h=n(61466),f=n(37104),g=n(77498),m=n(29817),v=n(19735),y=n(4247),b=n(56792);t.initializeGlobals=function(e){const t=e.subscriptions,n=new r.Container({skipBaseClassChecks:!0}),s=new f.ServiceManager(n),a=new h.ServiceContainer(n);s.addSingletonInstance(g.IServiceContainer,a),s.addSingletonInstance(g.IServiceManager,s),s.addSingletonInstance(u.IDisposableRegistry,t),s.addSingletonInstance(u.IMemento,e.globalState,u.GLOBAL_MEMENTO),s.addSingletonInstance(u.IMemento,e.workspaceState,u.WORKSPACE_MEMENTO),s.addSingletonInstance(u.IExtensionContext,e);const c=i.window.createOutputChannel(d.OutputChannelNames.python,{log:!0});t.push(c),t.push((0,v.registerLogger)(new y.OutputChannelLogger(c)));const l=new b.WorkspaceService,p=l.isVirtualWorkspace||!l.isTrusted?(0,o.instance)((0,o.mock)()):i.window.createOutputChannel(d.OutputChannelNames.pythonTest);return t.push(p),s.addSingletonInstance(u.ILogOutputChannel,c),s.addSingletonInstance(u.ITestOutputChannel,p),{context:e,disposables:t,legacyIOC:{serviceManager:s,serviceContainer:a}}},t.initializeStandard=function(e){const{serviceManager:t}=e.legacyIOC;(0,c.registerTypes)(t),(0,p.registerTypes)(t),(0,s.registerTypes)(t),(0,a.registerTypes)(t),(0,l.registerTypes)(t)},t.initializeComponents=async function(e){return{pythonEnvs:await m.initialize(e)}}},64314:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoPep8Formatter=void 0;const r=n(80819),i=n(61684),o=n(70057),s=n(54813),a=n(61522),c=n(40515);class l extends c.BaseFormatter{constructor(e){super("autopep8",r.Product.autopep8,e)}formatDocument(e,t,n,r){const c=new o.StopWatch,l=this.serviceContainer.get(i.IConfigurationService).getSettings(e.uri),u=Array.isArray(l.formatting.autopep8Args)&&l.formatting.autopep8Args.length>0,p=!!r&&!r.isEmpty,d=["--diff"];p&&d.push("--line-range",(r.start.line+1).toString(),(r.end.line+1).toString());const h=super.provideDocumentFormattingEdits(e,t,n,d);return(0,s.sendTelemetryWhenDone)(a.EventName.FORMAT,h,c,{tool:"autopep8",hasCustomArgs:u,formatSelection:p}),h}}t.AutoPep8Formatter=l},40515:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFormatter=void 0;const r=n(71017),i=n(66828),o=n(17585);n(32727);const s=n(40071),a=n(84974),c=n(29983),l=n(61684),u=n(3481),p=n(19735),d=n(84911),h=n(44263),f=n(39337);t.BaseFormatter=class{constructor(e,t,n){this.Id=e,this.product=t,this.serviceContainer=n,this.errorShown=!1,this.helper=n.get(h.IFormatterHelper),this.workspace=n.get(o.IWorkspaceService)}getDocumentPath(e,t){return r.basename(e.uri.fsPath)===e.uri.fsPath?t:r.dirname(e.fileName)}getWorkspaceUri(e){const t=this.workspace.getWorkspaceFolder(e.uri);if(t)return t.uri;const n=this.workspace.workspaceFolders;return Array.isArray(n)&&n.length>0?n[0].uri:i.Uri.file(__dirname)}async provideDocumentFormattingEdits(e,t,n,r,i){"string"==typeof i&&0!==i.length||(i=this.getWorkspaceUri(e).fsPath);const s=await this.createTempFile(e);if(this.checkCancellation(e.fileName,s,n))return[];const a=this.helper.getExecutionInfo(this.product,r,e.uri);a.args.push(s);const u=this.serviceContainer.get(c.IPythonToolExecutionService).exec(a,{cwd:i,throwOnStdErr:!1,token:n},e.uri).then((e=>e.stdout)).then((t=>this.checkCancellation(e.fileName,s,n)?[]:(0,d.getTextEditsFromPatch)(e.getText(),t))).catch((t=>(this.checkCancellation(e.fileName,s,n)||this.handleError(this.Id,t,e.uri).catch((()=>{})),[]))).then((t=>(this.deleteTempFile(e.fileName,s).ignoreErrors(),t))),p=this.serviceContainer.get(o.IApplicationShell),h=this.serviceContainer.get(l.IDisposableRegistry),f=p.setStatusBarMessage(`Formatting with ${this.Id}`,u);return h.push(f),u}async handleError(e,t,n){if((0,s.isNotInstalledError)(t)){const e=this.serviceContainer.get(f.IInstallFormatterPrompt);if(!await e.showInstallFormatterPrompt(n)){const e=this.serviceContainer.get(l.IInstaller);await e.isInstalled(this.product,n)||this.errorShown||((0,p.traceError)(`\nPlease install '${this.Id}' into your environment.`,"\nIf you don't want to use it you can turn it off or use another formatter in the settings."),this.errorShown=!0)}}(0,p.traceError)(`Formatting with ${this.Id} failed:\n${t}`)}async createTempFile(e){const t=this.serviceContainer.get(a.IFileSystem);return e.isDirty||(0,u.isNotebookCell)(e)?(0,d.getTempFileWithDocumentContents)(e,t):e.fileName}deleteTempFile(e,t){return e!==t?this.serviceContainer.get(a.IFileSystem).deleteFile(t):Promise.resolve()}checkCancellation(e,t,n){return!(!n||!n.isCancellationRequested||(this.deleteTempFile(e,t).ignoreErrors(),0))}}},23199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlackFormatter=void 0;const r=n(71017),i=n(66828),o=n(17585),s=n(80819),a=n(61684),c=n(3481),l=n(70057),u=n(54813),p=n(61522),d=n(40515);class h extends d.BaseFormatter{constructor(e){super("black",s.Product.black,e)}async formatDocument(e,t,n,s){const d=new l.StopWatch,h=this.serviceContainer.get(a.IConfigurationService).getSettings(e.uri),f=Array.isArray(h.formatting.blackArgs)&&h.formatting.blackArgs.length>0,g=!!s&&!s.isEmpty;if(g)return this.serviceContainer.get(o.IApplicationShell).showErrorMessage(i.l10n.t('Black does not support the "Format Selection" command')).then(c.noop,c.noop),[];const m=["--diff","--quiet"];".pyi"===r.extname(e.fileName)&&m.push("--pyi");const v=super.provideDocumentFormattingEdits(e,t,n,m);return(0,u.sendTelemetryWhenDone)(p.EventName.FORMAT,v,d,{tool:"black",hasCustomArgs:f,formatSelection:g}),v}}t.BlackFormatter=h},89027:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DummyFormatter=void 0;const r=n(61684),i=n(40515);class o extends i.BaseFormatter{constructor(e){super("none",r.Product.yapf,e)}formatDocument(e,t,n,r){return Promise.resolve([])}}t.DummyFormatter=o},6350:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.FormatterHelper=void 0;const o=n(86700),s=n(71017),a=n(61684),c=n(77498);let l=class{constructor(e){this.serviceContainer=e}translateToId(e){switch(e){case a.Product.autopep8:return"autopep8";case a.Product.black:return"black";case a.Product.yapf:return"yapf";default:throw new Error(`Unrecognized Formatter '${e}'`)}}getSettingsPropertyNames(e){const t=this.translateToId(e);return{argsName:`${t}Args`,pathName:`${t}Path`}}getExecutionInfo(e,t,n){const r=this.serviceContainer.get(a.IConfigurationService).getSettings(n),i=this.getSettingsPropertyNames(e),o=r.formatting[i.pathName];let c,l=Array.isArray(r.formatting[i.argsName])?r.formatting[i.argsName]:[];return l=l.concat(t),s.basename(o)===o&&(c=o),{execPath:o,moduleName:c,args:l,product:e}}};l=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],l),t.FormatterHelper=l},88681:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(6350),i=n(44263);t.registerTypes=function(e){e.addSingleton(i.IFormatterHelper,r.FormatterHelper)}},44263:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFormatterHelper=void 0,t.IFormatterHelper=Symbol("IFormatterHelper")},57619:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YapfFormatter=void 0;const r=n(61684),i=n(70057),o=n(54813),s=n(61522),a=n(40515);class c extends a.BaseFormatter{constructor(e){super("yapf",r.Product.yapf,e)}formatDocument(e,t,n,a){const c=new i.StopWatch,l=this.serviceContainer.get(r.IConfigurationService).getSettings(e.uri),u=Array.isArray(l.formatting.yapfArgs)&&l.formatting.yapfArgs.length>0,p=!!a&&!a.isEmpty,d=["--diff"];p&&void 0!==a&&d.push("--lines",`${a.start.line+1}-${a.end.line+1}`);const h=this.getWorkspaceUri(e).fsPath,f=this.getDocumentPath(e,h),g=super.provideDocumentFormattingEdits(e,t,n,d,f);return(0,o.sendTelemetryWhenDone)(s.EventName.FORMAT,g,c,{tool:"yapf",hasCustomArgs:u,formatSelection:p}),g}}t.YapfFormatter=c},94144:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentActivationService=t.EnvironmentActivationServiceCache=t.defaultShells=void 0,n(32727);const o=n(71017),s=n(86700),a=n(17585),c=n(77570),l=n(84974),u=n(4057),p=n(29983),d=n(58400),h=n(61684),f=n(59314),g=n(35144),m=n(87450),v=n(19909),y=n(81387),b=n(54813),S=n(61522),E=n(18639),_=n(49903),w=n(19735),T=n(75470),C=n(70057),P=n(89465),I=n(47237),x=n(36952),O="e8b39361-0157-4923-80e1-22d70d46dee6";t.defaultShells={[m.OSType.Windows]:{shell:"cmd",shellType:d.TerminalShellType.commandPrompt},[m.OSType.OSX]:{shell:"bash",shellType:d.TerminalShellType.bash},[m.OSType.Linux]:{shell:"bash",shellType:d.TerminalShellType.bash},[m.OSType.Unknown]:void 0};const R=["The process cannot access the file because it is being used by another process","The directory is not empty"];class D{constructor(){this.normalMap=new Map}static forceUseStatic(){D.useStatic=!0}static forceUseNormal(){D.useStatic=!1}get(e){return D.useStatic?D.staticMap.get(e):this.normalMap.get(e)}set(e,t){D.useStatic?D.staticMap.set(e,t):this.normalMap.set(e,t)}delete(e){D.useStatic?D.staticMap.delete(e):this.normalMap.delete(e)}clear(){D.useStatic||this.normalMap.clear()}}t.EnvironmentActivationServiceCache=D,D.useStatic=!1,D.staticMap=new Map;let A=class{constructor(e,t,n,r,i,o,s){this.helper=e,this.platform=t,this.processServiceFactory=n,this.currentProcess=r,this.workspace=i,this.interpreterService=o,this.envVarsService=s,this.disposables=[],this.activatedEnvVariablesCache=new D,this.envVarsService.onDidEnvironmentVariablesChange((()=>this.activatedEnvVariablesCache.clear()),this,this.disposables)}dispose(){this.disposables.forEach((e=>e.dispose()))}async getActivatedEnvironmentVariables(e,t,n,r){var i;const o=new C.StopWatch,s=this.workspace.getWorkspaceFolderIdentifier(e);t=null!=t?t:await this.interpreterService.getActiveInterpreter(e);const a=`${s}_${this.platform.isWindows?null==t?void 0:t.path.toLowerCase():null==t?void 0:t.path}_${r}`;if(null===(i=this.activatedEnvVariablesCache.get(a))||void 0===i?void 0:i.hasData)return this.activatedEnvVariablesCache.get(a).data;const c=new g.InMemoryCache(6e5);return this.getActivatedEnvironmentVariablesImpl(e,t,n,r).then((e=>(c.data=e,this.activatedEnvVariablesCache.set(a,c),(0,b.sendTelemetryEvent)(S.EventName.PYTHON_INTERPRETER_ACTIVATION_ENVIRONMENT_VARIABLES,o.elapsedTime,{failed:!1}),e))).catch((e=>{throw(0,b.sendTelemetryEvent)(S.EventName.PYTHON_INTERPRETER_ACTIVATION_ENVIRONMENT_VARIABLES,o.elapsedTime,{failed:!0}),e}))}async getProcessEnvironmentVariables(e,t){const n=this.interpreterService.getInterpreters().filter((e=>!y.virtualEnvTypes.includes(e.envType))),r=n.length>0&&n[0]?n[0].path:"python";try{const[n,i]=u.printEnvVariables();n.forEach(((e,t)=>{n[t]=e.toCommandArgumentForPythonExt()}));const o=`${r} ${n.join(" ")}`,s=await this.processServiceFactory.create(e,{doNotUseCustomEnvs:!0}),a=await s.shellExec(o,{shell:t,timeout:3e4,maxBuffer:1e6,throwOnStdErr:!1}),c=this.parseEnvironmentOutput(a.stdout,i);return null!=c?c:process.env}catch(e){return process.env}}async getEnvironmentActivationShellCommands(e,n){const r=t.defaultShells[this.platform.osType];return r?this.helper.getEnvironmentActivationShellCommands(e,r.shellType,n):[]}async getActivatedEnvironmentVariablesImpl(e,n,r,i){var s,a;let l=t.defaultShells[this.platform.osType];if(l){i&&(l={shellType:(0,P.identifyShellFromShellPath)(i),shell:i});try{const t=await this.processServiceFactory.create(e),r=null!==(s=await this.envVarsService.getEnvironmentVariables(e))&&void 0!==s?s:{},h=Object.keys(r).length,g=h?r:{...this.currentProcess.env};let m;const[v,b]=u.printEnvVariables();if(v.forEach(((e,t)=>{v[t]=e.toCommandArgumentForPythonExt()})),(null==n?void 0:n.envType)===y.EnvironmentType.Conda){const e=await T.Conda.getConda(i),t=await(null==e?void 0:e.getRunPythonArgs({name:n.envName,prefix:null!==(a=n.envPath)&&void 0!==a?a:""}));t&&(m=[...t,...v].map((e=>e.toCommandArgumentForPythonExt())).join(" "))}if(!m){const t=await this.helper.getEnvironmentActivationShellCommands(e,l.shellType,n);if((0,w.traceVerbose)(`Activation Commands received ${t} for shell ${l.shell}`),!t||!Array.isArray(t)||0===t.length){if(n&&[y.EnvironmentType.Venv,y.EnvironmentType.Pyenv].includes(null==n?void 0:n.envType)){const e=(0,I.getSearchPathEnvVarNames)()[0];return g[e]?g[e]=`${o.dirname(n.path)}${o.delimiter}${g[e]}`:g[e]=`${o.dirname(n.path)}`,g}return}const r=(p=t,p.map((e=>e.replace(/^source\s+/,". ")))).join(" && "),i=[d.TerminalShellType.powershell,d.TerminalShellType.powershellCore].includes(l.shellType)?";":"&&";m=`${r} ${i} echo '${O}' ${i} python ${v.join(" ")}`}const S=g[c.PYTHON_WARNINGS];let E;g[c.PYTHON_WARNINGS]="ignore",(0,w.traceVerbose)((h?"Has":"No")+" Custom Env Vars"),(0,w.traceVerbose)(`Activating Environment to capture Environment variables, ${m}`);let _,C=1;for(;!E;)try{E=await t.shellExec(m,{env:g,shell:l.shell,timeout:(null==n?void 0:n.envType)===y.EnvironmentType.Conda?6e4:3e4,maxBuffer:1e6,throwOnStdErr:!1});try{_=this.parseEnvironmentOutput(E.stdout,b)}catch(e){if(!E.stderr)throw e}if(E.stderr){if(!_)throw new Error(`StdErr from ShellExec, ${E.stderr} for ${m}`);(0,w.traceWarn)("Got env variables but with errors",E.stderr)}}catch(e){const t=e.toString();if(!(R.find((e=>t.includes(e)))&&C<10))throw e;(0,w.traceInfo)("Conda is busy, attempting to retry ..."),E=void 0,C+=1,await(0,f.sleep)(500)}return S&&_?_[c.PYTHON_WARNINGS]=S:_&&delete _[c.PYTHON_WARNINGS],_}catch(e){if((0,w.traceError)("getActivatedEnvironmentVariables",e),(0,b.sendTelemetryEvent)(S.EventName.ACTIVATE_ENV_TO_GET_ENV_VARS_FAILED,void 0,{isPossiblyCondaEnv:(null==n?void 0:n.envType)===y.EnvironmentType.Conda,terminal:l.shellType}),r)throw e}var p}}parseEnvironmentOutput(e,t){return-1===e.indexOf(O)?t(e):t((e=e.substring(e.indexOf(O)+O.length)).substring(e.indexOf("{")).trim())}};r([(0,w.traceDecoratorVerbose)("getActivatedEnvironmentVariables",_.TraceOptions.Arguments)],A.prototype,"getActivatedEnvironmentVariables",null),r([(0,x.cache)(-1,!0)],A.prototype,"getProcessEnvironmentVariables",null),r([(0,w.traceDecoratorError)("Failed to parse Environment variables"),(0,w.traceDecoratorVerbose)("parseEnvironmentOutput",_.TraceOptions.None)],A.prototype,"parseEnvironmentOutput",null),A=r([(0,s.injectable)(),i(0,(0,s.inject)(d.ITerminalHelper)),i(1,(0,s.inject)(l.IPlatformService)),i(2,(0,s.inject)(p.IProcessServiceFactory)),i(3,(0,s.inject)(h.ICurrentProcess)),i(4,(0,s.inject)(a.IWorkspaceService)),i(5,(0,s.inject)(E.IInterpreterService)),i(6,(0,s.inject)(v.IEnvironmentVariablesProvider))],A),t.EnvironmentActivationService=A},56446:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalEnvVarCollectionPrompt=t.terminalEnvCollectionPromptKey=void 0;const o=n(86700),s=n(66828),a=n(71017),c=n(17585),l=n(61684),u=n(67098),p=n(80351),d=n(46747),h=n(18639);t.terminalEnvCollectionPromptKey="TERMINAL_ENV_COLLECTION_PROMPT_KEY";let f=class{constructor(e,t,n,r,i,o,s,a,c){this.appShell=e,this.persistentStateFactory=t,this.terminalManager=n,this.disposableRegistry=r,this.activeResourceService=i,this.terminalEnvVarCollectionService=o,this.configurationService=s,this.interpreterService=a,this.experimentService=c,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){(0,d.inTerminalEnvVarExperiment)(this.experimentService)&&this.disposableRegistry.push(this.terminalManager.onDidOpenTerminal((async e=>{const t="cwd"in e.creationOptions&&e.creationOptions.cwd?e.creationOptions.cwd:this.activeResourceService.getActiveResource(),n="string"==typeof t?s.Uri.file(t):t;this.configurationService.getSettings(n).terminal.activateEnvironment&&(this.terminalEnvVarCollectionService.isTerminalPromptSetCorrectly(n)||await this.notifyUsers(n))})))}async notifyUsers(e){const n=this.persistentStateFactory.createGlobalPersistentState(t.terminalEnvCollectionPromptKey,!0);if(!n.value)return;const r=[u.Common.doNotShowAgain],i=(c=await this.interpreterService.getActiveInterpreter(e))?c.envName?`, ${s.l10n.t("i.e")} "(${c.envName})"`:c.envPath?`, ${s.l10n.t("i.e")} "(${a.basename(c.envPath)})"`:"":"",o=await this.appShell.showInformationMessage(u.Interpreters.terminalEnvVarCollectionPrompt.format(i),...r);var c;o&&o===r[0]&&await n.updateValue(!1)}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IApplicationShell)),i(1,(0,o.inject)(l.IPersistentStateFactory)),i(2,(0,o.inject)(c.ITerminalManager)),i(3,(0,o.inject)(l.IDisposableRegistry)),i(4,(0,o.inject)(c.IActiveResourceService)),i(5,(0,o.inject)(p.ITerminalEnvVarCollectionService)),i(6,(0,o.inject)(l.IConfigurationService)),i(7,(0,o.inject)(h.IInterpreterService)),i(8,(0,o.inject)(l.IExperimentService))],f),t.TerminalEnvVarCollectionPrompt=f},15850:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalEnvVarCollectionService=void 0;const o=n(71017),s=n(86700),a=n(66828),c=n(55674),l=n(17585),u=n(46747),p=n(84974),d=n(89465),h=n(61684),f=n(59314),g=n(67098),m=n(19735),v=n(18639),y=n(94144),b=n(80351),S=n(81387),E=n(47237),_=n(58400),w=n(87450);let T=class{constructor(e,t,n,r,i,o,s,a,c,l,u){this.platform=e,this.interpreterService=t,this.context=n,this.shell=r,this.experimentService=i,this.applicationEnvironment=o,this.disposables=s,this.environmentActivationService=a,this.workspaceService=c,this.configurationService=l,this.pathUtils=u,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.noPromptVariableShells=[_.TerminalShellType.powershell,_.TerminalShellType.powershellCore,_.TerminalShellType.fish],this.registeredOnce=!1,this.isPromptSet=new Map}async activate(e){try{if(!(0,u.inTerminalEnvVarExperiment)(this.experimentService))return this.context.environmentVariableCollection.clear(),await this.handleMicroVenv(e),void(this.registeredOnce||(this.interpreterService.onDidChangeInterpreter((async e=>{await this.handleMicroVenv(e)}),this,this.disposables),this.registeredOnce=!0));this.registeredOnce||(this.interpreterService.onDidChangeInterpreter((async e=>{this.showProgress(),await this._applyCollection(e).ignoreErrors(),this.hideProgress()}),this,this.disposables),this.applicationEnvironment.onDidChangeShell((async e=>{this.showProgress(),this.processEnvVars=void 0,await this._applyCollection(void 0,e).ignoreErrors(),this.hideProgress()}),this,this.disposables),this.registeredOnce=!0),this._applyCollection(e).ignoreErrors()}catch(e){(0,m.traceError)("Activating terminal env collection failed",e)}}async _applyCollection(e,t=this.applicationEnvironment.shell){const n=this.getWorkspaceFolder(e),r=this.configurationService.getSettings(e),i=this.getEnvironmentVariableCollection({workspaceFolder:n});if(i.clear(),!r.terminal.activateEnvironment)return void(0,m.traceVerbose)("Activating environments in terminal is disabled for",null==e?void 0:e.fsPath);const o=await this.environmentActivationService.getActivatedEnvironmentVariables(e,void 0,void 0,t);if(!o){const n=(0,d.identifyShellFromShellPath)(t),r=y.defaultShells[this.platform.osType];return(null==r?void 0:r.shellType)!==n?void await this._applyCollection(e,null==r?void 0:r.shell):(await this.trackTerminalPrompt(t,e,o),void(this.processEnvVars=void 0))}this.processEnvVars||(this.processEnvVars=await this.environmentActivationService.getProcessEnvironmentVariables(e,t));const s=this.processEnvVars;o.PS1=await this.getPS1(t,e,o),Object.keys(o).forEach((e=>{var t;if(function(e){return["_","SHLVL"].includes(e)}(e))return;let n=o[e];if(s[e]!==n&&void 0!==n){if("PS1"===e)return(0,m.traceVerbose)(`Prepending environment variable ${e} in collection with ${n}`),void i.prepend(e,n,{applyAtShellIntegration:!0,applyAtProcessCreation:!1});if("PATH"===e)return void(s.PATH&&(null===(t=o.PATH)||void 0===t?void 0:t.endsWith(s.PATH))?(n=o.PATH.slice(0,-s.PATH.length),(0,m.traceVerbose)(`Prepending environment variable ${e} in collection with ${n}`),i.prepend(e,n,{applyAtShellIntegration:!0,applyAtProcessCreation:!0})):((0,m.traceVerbose)(`Prepending environment variable ${e} in collection to ${n}`),i.prepend(e,n,{applyAtShellIntegration:!0,applyAtProcessCreation:!0})));(0,m.traceVerbose)(`Setting environment variable ${e} in collection to ${n}`),i.replace(e,n,{applyAtShellIntegration:!0,applyAtProcessCreation:!0})}}));const c=this.pathUtils.getDisplayName(r.pythonPath,null==n?void 0:n.uri.fsPath),l=new a.MarkdownString(`${g.Interpreters.activateTerminalDescription} \`${c}\``);i.description=l,await this.trackTerminalPrompt(t,e,o)}isTerminalPromptSetCorrectly(e){const t=this.getWorkspaceFolder(e);return!!this.isPromptSet.get(null==t?void 0:t.index)}terminalPromptIsCorrect(e){var t;const n=null===(t=this.getWorkspaceFolder(e))||void 0===t?void 0:t.index;this.isPromptSet.set(n,!0)}terminalPromptIsUnknown(e){var t;const n=null===(t=this.getWorkspaceFolder(e))||void 0===t?void 0:t.index;this.isPromptSet.delete(n)}async trackTerminalPrompt(e,t,n){if(this.terminalPromptIsUnknown(t),!n)return void this.terminalPromptIsCorrect(t);const r=(0,d.identifyShellFromShellPath)(e);if(!this.noPromptVariableShells.includes(r)){if(this.platform.osType!==w.OSType.Windows){const e=await this.interpreterService.getActiveInterpreter(t);if(void 0!==(null==e?void 0:e.type)&&!n.PS1)return;if(!this.workspaceService.getConfiguration("terminal").get("integrated.shellIntegration.enabled"))return void(0,m.traceVerbose)("PS1 is not set when shell integration is disabled.")}this.terminalPromptIsCorrect(t)}}async getPS1(e,t,n){if(n.PS1)return n.PS1;const r=(0,d.identifyShellFromShellPath)(e);if(!this.noPromptVariableShells.includes(r)&&this.platform.osType!==w.OSType.Windows){const e=await this.interpreterService.getActiveInterpreter(t);if(void 0!==(null==e?void 0:e.type)&&!n.PS1)return function(e){if(e){if(e.envName){if("base"===e.envName)return;return`(${e.envName}) `}return e.envPath?`(${o.basename(e.envPath)}) `:void 0}}(e)}}async handleMicroVenv(e){try{const t=this.getWorkspaceFolder(e),n=await this.interpreterService.getActiveInterpreter(e);if((null==n?void 0:n.envType)===S.EnvironmentType.Venv){const e=o.join(o.dirname(n.path),"activate");if(!await(0,c.pathExists)(e)){const e=this.getEnvironmentVariableCollection({workspaceFolder:t}),r=(0,E.getSearchPathEnvVarNames)()[0];return void e.replace("PATH",`${o.dirname(n.path)}${o.delimiter}${process.env[r]}`,{applyAtShellIntegration:!0,applyAtProcessCreation:!0})}this.getEnvironmentVariableCollection({workspaceFolder:t}).clear()}}catch(e){(0,m.traceWarn)("Microvenv failed as it is using proposed API which is constantly changing",e)}}getEnvironmentVariableCollection(e={}){return this.context.environmentVariableCollection.getScoped(e)}getWorkspaceFolder(e){let t=this.workspaceService.getWorkspaceFolder(e);return!t&&Array.isArray(this.workspaceService.workspaceFolders)&&this.workspaceService.workspaceFolders.length>0&&([t]=this.workspaceService.workspaceFolders),t}showProgress(){this.deferred||this.createProgress()}hideProgress(){this.deferred&&(this.deferred.resolve(),this.deferred=void 0)}createProgress(){const e={location:a.ProgressLocation.Window,title:g.Interpreters.activatingTerminals};this.shell.withProgress(e,(()=>(this.deferred=(0,f.createDeferred)(),this.deferred.promise)))}};r([(0,m.traceDecoratorVerbose)("Display activating terminals")],T.prototype,"showProgress",null),r([(0,m.traceDecoratorVerbose)("Hide activating terminals")],T.prototype,"hideProgress",null),T=r([(0,s.injectable)(),i(0,(0,s.inject)(p.IPlatformService)),i(1,(0,s.inject)(v.IInterpreterService)),i(2,(0,s.inject)(h.IExtensionContext)),i(3,(0,s.inject)(l.IApplicationShell)),i(4,(0,s.inject)(h.IExperimentService)),i(5,(0,s.inject)(l.IApplicationEnvironment)),i(6,(0,s.inject)(h.IDisposableRegistry)),i(7,(0,s.inject)(b.IEnvironmentActivationService)),i(8,(0,s.inject)(l.IWorkspaceService)),i(9,(0,s.inject)(h.IConfigurationService)),i(10,(0,s.inject)(h.IPathUtils))],T),t.TerminalEnvVarCollectionService=T},80351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITerminalEnvVarCollectionService=t.IEnvironmentActivationService=void 0,t.IEnvironmentActivationService=Symbol("IEnvironmentActivationService"),t.ITerminalEnvVarCollectionService=Symbol("ITerminalEnvVarCollectionService")},20741:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterAutoSelectionService=void 0;const o=n(86700),s=n(66828),a=n(17585);n(32727);const c=n(84974),l=n(61684),u=n(59314),p=n(95084),d=n(54813),h=n(61522),f=n(54351),g=n(18639),m=n(87282),v="preferredGlobalPyInterpreter";let y=class{constructor(e,t,n,r,i,o,a){this.workspaceService=e,this.stateFactory=t,this.fs=n,this.interpreterService=r,this.envTypeComparer=i,this.interpreterHelper=a,this.autoSelectedWorkspacePromises=new Map,this.didAutoSelectedInterpreterEmitter=new s.EventEmitter,this.autoSelectedInterpreterByWorkspace=new Map,this.globallyPreferredInterpreter=this.stateFactory.createGlobalPersistentState(v,void 0),o.registerInstance(this)}async autoSelectInterpreter(e){const t=this.getWorkspacePathKey(e),n=this.autoSelectedWorkspacePromises.has(t);if(!n){const n=(0,u.createDeferred)();this.autoSelectedWorkspacePromises.set(t,n),await this.initializeStore(e),await this.clearWorkspaceStoreIfInvalid(e),await this.autoselectInterpreterWithLocators(e),n.resolve()}return(0,d.sendTelemetryEvent)(h.EventName.PYTHON_INTERPRETER_AUTO_SELECTION,void 0,{useCachedInterpreter:n}),this.autoSelectedWorkspacePromises.get(t).promise}get onDidChangeAutoSelectedInterpreter(){return this.didAutoSelectedInterpreterEmitter.event}getAutoSelectedInterpreter(e){const t=this.getWorkspaceState(e);if(t&&t.value)return t.value;const n=this.getWorkspacePathKey(e);return this.autoSelectedInterpreterByWorkspace.has(n)?this.autoSelectedInterpreterByWorkspace.get(n):this.globallyPreferredInterpreter.value}async setWorkspaceInterpreter(e,t){await this.storeAutoSelectedInterpreter(e,t)}async setGlobalInterpreter(e){await this.storeAutoSelectedInterpreter(void 0,e)}async clearWorkspaceStoreIfInvalid(e){const t=this.getWorkspaceState(e);t&&t.value&&!await this.fs.fileExists(t.value.path)&&await t.updateValue(void 0)}async storeAutoSelectedInterpreter(e,t){const n=this.getWorkspacePathKey(e);if(""===n){if(this.globallyPreferredInterpreter.value&&this.globallyPreferredInterpreter.value.version&&t&&t.version&&(0,p.compareSemVerLikeVersions)(this.globallyPreferredInterpreter.value.version,t.version)>0)return;await this.globallyPreferredInterpreter.updateValue(t),this.autoSelectedInterpreterByWorkspace.set(n,t)}else{const r=this.getWorkspaceState(e);r&&t&&await r.updateValue(t),this.autoSelectedInterpreterByWorkspace.set(n,t)}}async initializeStore(e){const t=this.getWorkspacePathKey(e);this.autoSelectedInterpreterByWorkspace.delete(t),this.globallyPreferredInterpreter||await this.clearStoreIfFileIsInvalid()}async clearStoreIfFileIsInvalid(){this.globallyPreferredInterpreter=this.stateFactory.createGlobalPersistentState(v,void 0),this.globallyPreferredInterpreter.value&&!await this.fs.fileExists(this.globallyPreferredInterpreter.value.path)&&await this.globallyPreferredInterpreter.updateValue(void 0)}getWorkspacePathKey(e){return this.workspaceService.getWorkspaceFolderIdentifier(e,"")}getWorkspaceState(e){const t=this.interpreterHelper.getActiveWorkspaceUri(e);if(t){const e=`autoSelectedWorkspacePythonInterpreter-${t.folderUri.fsPath}`;return this.stateFactory.createWorkspacePersistentState(e,void 0)}}getAutoSelectionInterpretersQueryState(e){const t=this.interpreterHelper.getActiveWorkspaceUri(e),n=`autoSelectionInterpretersQueried-${(null==t?void 0:t.folderUri.fsPath)||"global"}`;return this.stateFactory.createWorkspacePersistentState(n,void 0)}async autoselectInterpreterWithLocators(e){const t=this.getAutoSelectionInterpretersQueryState(e);!0!==t.value&&e&&await this.interpreterService.triggerRefresh({searchLocations:{roots:[e],doNotIncludeNonRooted:!0}}),await this.interpreterService.refreshPromise;const n=this.interpreterService.getInterpreters(e),r=this.interpreterHelper.getActiveWorkspaceUri(e),i=this.envTypeComparer.getRecommended(n,null==r?void 0:r.folderUri);i&&(r?this.setWorkspaceInterpreter(r.folderUri,i):this.setGlobalInterpreter(i),t.updateValue(!0),this.didAutoSelectedInterpreterEmitter.fire())}};y=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IWorkspaceService)),i(1,(0,o.inject)(l.IPersistentStateFactory)),i(2,(0,o.inject)(c.IFileSystem)),i(3,(0,o.inject)(g.IInterpreterService)),i(4,(0,o.inject)(f.IInterpreterComparer)),i(5,(0,o.inject)(m.IInterpreterAutoSelectionProxyService)),i(6,(0,o.inject)(g.IInterpreterHelper))],y),t.InterpreterAutoSelectionService=y},45297:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterAutoSelectionProxyService=void 0;const o=n(86700),s=n(66828),a=n(61684);let c=class{constructor(e){this.disposables=e,this.didAutoSelectedInterpreterEmitter=new s.EventEmitter}registerInstance(e){this.instance=e,this.disposables.push(this.instance.onDidChangeAutoSelectedInterpreter((()=>this.didAutoSelectedInterpreterEmitter.fire())))}get onDidChangeAutoSelectedInterpreter(){return this.didAutoSelectedInterpreterEmitter.event}getAutoSelectedInterpreter(e){return this.instance?this.instance.getAutoSelectedInterpreter(e):void 0}async setWorkspaceInterpreter(e,t){return this.instance?this.instance.setWorkspaceInterpreter(e,t):void 0}};c=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IDisposableRegistry))],c),t.InterpreterAutoSelectionProxyService=c},87282:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AutoSelectionRule=t.IInterpreterAutoSelectionService=t.IInterpreterAutoSelectionProxyService=void 0,t.IInterpreterAutoSelectionProxyService=Symbol("IInterpreterAutoSelectionProxyService"),t.IInterpreterAutoSelectionService=Symbol("IInterpreterAutoSelectionService"),(n=t.AutoSelectionRule||(t.AutoSelectionRule={})).all="all",n.currentPath="currentPath",n.workspaceVirtualEnvs="workspaceEnvs",n.settings="settings",n.cachedInterpreters="cachedInterpreters",n.systemWide="system",n.windowsRegistry="windowsRegistry"},95356:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvLocationHeuristic=t.isProblematicCondaEnvironment=t.EnvironmentTypeComparer=t.EnvLocationHeuristic=void 0;const o=n(86700),s=n(87450),a=n(42694),c=n(37769),l=n(81387),u=n(18639);var p;!function(e){e[e.Local=1]="Local",e[e.Global=2]="Global"}(p=t.EnvLocationHeuristic||(t.EnvLocationHeuristic={}));let d=class{constructor(e){var t,n;this.interpreterHelper=e,this.workspaceFolderPath=null!==(n=null===(t=this.interpreterHelper.getActiveWorkspaceUri(void 0))||void 0===t?void 0:t.folderUri.fsPath)&&void 0!==n?n:""}compare(e,t){if(g(e))return 1;if(g(t))return-1;const n=function(e,t,n){const r=m(e,n),i=m(t,n);return Math.sign(r-i)}(e,t,this.workspaceFolderPath);if(0!==n)return n;const r=function(e,t){const n=[l.EnvironmentType.Poetry,l.EnvironmentType.Pipenv,l.EnvironmentType.VirtualEnvWrapper,l.EnvironmentType.Venv,l.EnvironmentType.VirtualEnv,l.EnvironmentType.ActiveState,l.EnvironmentType.Conda,l.EnvironmentType.Pyenv,l.EnvironmentType.MicrosoftStore,l.EnvironmentType.Global,l.EnvironmentType.System,l.EnvironmentType.Unknown];return Math.sign(n.indexOf(e.envType)-n.indexOf(t.envType))}(e,t);if(0!==r)return r;const i=function(e,t){return e?t?e.raw===t.raw?0:e.major===t.major?e.minor===t.minor?e.patch===t.patch?e.build.join(" ")>t.build.join(" ")?-1:1:e.patch>t.patch?-1:1:e.minor>t.minor?-1:1:e.major>t.major?-1:1:-1:1}(e.version,t.version);if(0!==i)return i;if(f(e))return 1;if(f(t))return-1;const o=h(e,this.interpreterHelper),s=h(t,this.interpreterHelper);return o===s?0:o>s?1:-1}getRecommended(e,t){const n=this.interpreterHelper.getActiveWorkspaceUri(t),r=e.filter((e=>{var t;return!g(e)&&!!(e.envType!==l.EnvironmentType.ActiveState||e.path&&n&&(0,a.isActiveStateEnvironmentForWorkspace)(e.path,n.folderUri.fsPath))&&(m(e,(null==n?void 0:n.folderUri.fsPath)||"")===p.Local||!l.virtualEnvTypes.includes(e.envType)&&2!==(null===(t=e.version)||void 0===t?void 0:t.major))}));return r.sort(this.compare.bind(this)),r.length?r[0]:void 0}};function h(e,t){const n=[],r=[];if(e.version&&n.push(e.version.raw),e.architecture&&n.push(function(e){switch(e){case s.Architecture.x64:return"x64";case s.Architecture.x86:return"x86";default:return""}}(e.architecture)),e.companyDisplayName&&e.companyDisplayName.length>0?n.push(e.companyDisplayName.trim()):n.push("Python"),e.envType){const n=t.getInterpreterTypeDisplayName(e.envType);n&&r.push(n)}e.envName&&e.envName.length>0&&r.push(e.envName);const i=0===r.length?"":`(${r.join(": ")})`;return`${n.join(" ")} ${i}`.trim()}function f(e){return e.envType===l.EnvironmentType.Conda&&("base"===e.envName||"miniconda"===e.envName)}function g(e){return e.envType===l.EnvironmentType.Conda&&"python"===e.path}function m(e,t){return t.length>0&&(e.envPath&&(0,c.isParentPath)(e.envPath,t)||e.path&&(0,c.isParentPath)(e.path,t))?p.Local:p.Global}d=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IInterpreterHelper))],d),t.EnvironmentTypeComparer=d,t.isProblematicCondaEnvironment=g,t.getEnvLocationHeuristic=m},74326:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseInterpreterSelectorCommand=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(67098);let l=class{constructor(e,t,n,r,i,o){this.pythonPathUpdaterService=e,this.commandManager=t,this.applicationShell=n,this.workspaceService=r,this.pathUtils=i,this.configurationService=o,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this.disposables=[],this.disposables.push(this)}dispose(){this.disposables.forEach((e=>e.dispose()))}async getConfigTargets(e){const t=this.workspaceService.workspaceFolders;if(void 0===t||0===t.length)return[{folderUri:void 0,configTarget:a.ConfigurationTarget.Global}];if(1===t.length)return[{folderUri:t[0].uri,configTarget:a.ConfigurationTarget.WorkspaceFolder}];let n=(null==e?void 0:e.resetTarget)?[{label:c.Common.clearAll}]:[];n.push(...t.map((e=>{const t=this.pathUtils.getDisplayName(this.configurationService.getSettings(e.uri).pythonPath,e.uri.fsPath);return{label:e.name,description:this.pathUtils.getDisplayName(s.dirname(e.uri.fsPath)),uri:e.uri,detail:t}})),{label:(null==e?void 0:e.resetTarget)?c.Interpreters.clearAtWorkspace:c.Interpreters.entireWorkspace,uri:t[0].uri});const r=await this.applicationShell.showQuickPick(n,{placeHolder:(null==e?void 0:e.resetTarget)?"Select the workspace folder to clear the interpreter for":"Select the workspace folder to set the interpreter"});return(null==r?void 0:r.label)===c.Common.clearAll?[...t.map((e=>({folderUri:e.uri,configTarget:a.ConfigurationTarget.WorkspaceFolder}))),{folderUri:t[0].uri,configTarget:a.ConfigurationTarget.Workspace}]:r?r.label===c.Interpreters.entireWorkspace||r.label===c.Interpreters.clearAtWorkspace?[{folderUri:r.uri,configTarget:a.ConfigurationTarget.Workspace}]:[{folderUri:r.uri,configTarget:a.ConfigurationTarget.WorkspaceFolder}]:void 0}};l=r([(0,o.injectable)(),i(0,(0,o.unmanaged)()),i(1,(0,o.unmanaged)()),i(2,(0,o.unmanaged)()),i(3,(0,o.unmanaged)()),i(4,(0,o.unmanaged)()),i(5,(0,o.unmanaged)())],l),t.BaseInterpreterSelectorCommand=l},89294:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstallPythonCommand=void 0;const o=n(86700),s=n(56994),a=n(17585),c=n(91932),l=n(77570),u=n(61684),p=n(84974);let d=class{constructor(e,t,n,r,i){this.commandManager=e,this.contextManager=t,this.browserService=n,this.platformService=r,this.disposables=i,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!1}}async activate(){this.disposables.push(this.commandManager.registerCommand(l.Commands.InstallPython,(()=>this._installPython())))}async _installPython(){this.platformService.isWindows&&(await this.platformService.getVersion()).major>8?this.browserService.launch("ms-windows-store://pdp/?ProductId=9NRWMJP3717K"):this.showInstallPythonTile()}showInstallPythonTile(){let e;this.contextManager.setContext(s.ExtensionContextKey.showInstallPythonTile,!0),e=this.platformService.isWindows?c.PythonWelcome.windowsInstallId:this.platformService.isLinux?c.PythonWelcome.linuxInstallId:c.PythonWelcome.macOSInstallId,this.commandManager.executeCommand("workbench.action.openWalkthrough",{category:`${l.PVSC_EXTENSION_ID}#${c.PythonWelcome.name}`,step:`${l.PVSC_EXTENSION_ID}#${c.PythonWelcome.name}#${e}`},!1)}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ICommandManager)),i(1,(0,o.inject)(a.IContextKeyManager)),i(2,(0,o.inject)(u.IBrowserService)),i(3,(0,o.inject)(p.IPlatformService)),i(4,(0,o.inject)(u.IDisposableRegistry))],d),t.InstallPythonCommand=d},65313:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InstallPythonViaTerminal=void 0;const o=n(86700),s=n(77570),a=n(61684),c=n(17585),l=n(59314),u=n(87450),p=n(19735),d=n(67098);var h;!function(e){e.brew="brew",e.apt="apt",e.dnf="dnf"}(h||(h={}));let f=class{constructor(e,t,n){this.commandManager=e,this.terminalManager=t,this.disposables=n,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!1},this.packageManagerCommands={brew:["brew install python3"],dnf:["sudo dnf install python3"],apt:["sudo apt-get update","sudo apt-get install python3 python3-venv python3-pip"]}}async activate(){this.disposables.push(this.commandManager.registerCommand(s.Commands.InstallPythonOnMac,(()=>this._installPythonOnUnix(u.OSType.OSX)))),this.disposables.push(this.commandManager.registerCommand(s.Commands.InstallPythonOnLinux,(()=>this._installPythonOnUnix(u.OSType.Linux))))}async _installPythonOnUnix(e){const t=await this.getCommands(e),n=e===u.OSType.OSX?d.Interpreters.installPythonTerminalMacMessage:d.Interpreters.installPythonTerminalMessageLinux,r=this.terminalManager.createTerminal({name:"Python",message:t.length?void 0:n});r.show(!0),await async function(){await(0,l.sleep)(100)}();for(const e of t)r.sendText(e),await m()}async getCommands(e){if(e===u.OSType.OSX)return this.getCommandsForPackageManagers([h.brew]);if(e===u.OSType.Linux)return this.getCommandsForPackageManagers([h.apt,h.dnf]);throw new Error("OS not supported")}async getCommandsForPackageManagers(e){for(const t of e)if(await g(t))return this.packageManagerCommands[t];return[]}};async function g(e){try{const t=n(22806),r=await t(e);return(0,p.traceVerbose)(`Resolved path to ${e} module:`,r),r.trim().length>0}catch(t){return(0,p.traceVerbose)(`${e} not found`,t),!1}}async function m(){await(0,l.sleep)(500)}f=r([(0,o.injectable)(),i(0,(0,o.inject)(c.ICommandManager)),i(1,(0,o.inject)(c.ITerminalManager)),i(2,(0,o.inject)(a.IDisposableRegistry))],f),t.InstallPythonViaTerminal=f},90780:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResetInterpreterCommand=void 0;const o=n(86700),s=n(17585),a=n(77570),c=n(61684),l=n(54351),u=n(74326);let p=class extends u.BaseInterpreterSelectorCommand{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o)}async activate(){this.disposables.push(this.commandManager.registerCommand(a.Commands.ClearWorkspaceInterpreter,this.resetInterpreter.bind(this)))}async resetInterpreter(){const e=await this.getConfigTargets({resetTarget:!0});e&&await Promise.all(e.map((async e=>{const t=e.configTarget,n=e.folderUri;await this.pythonPathUpdaterService.updatePythonPath(void 0,t,"ui",n)})))}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IPythonPathUpdaterServiceManager)),i(1,(0,o.inject)(s.ICommandManager)),i(2,(0,o.inject)(s.IApplicationShell)),i(3,(0,o.inject)(s.IWorkspaceService)),i(4,(0,o.inject)(c.IPathUtils)),i(5,(0,o.inject)(c.IConfigurationService))],p),t.ResetInterpreterCommand=p},50902:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SetInterpreterCommand=t.EnvGroups=void 0;const o=n(86700),s=n(96486),a=n(71017),c=n(66828),l=n(17585),u=n(77570),p=n(48431),d=n(84974),h=n(61684),f=n(67098),g=n(3481),m=n(22207),v=n(48683),y=n(81387),b=n(54813),S=n(61522),E=n(18639),_=n(95356),w=n(54351),T=n(74326),C=n(58967);function P(e){return"interpreter"in e}function I(e){return"alwaysShow"in e}function x(e){return"kind"in e&&e.kind===c.QuickPickItemKind.Separator}var O;!function(e){e.Workspace=f.InterpreterQuickPickList.workspaceGroupName,e.Conda="Conda",e.Global=f.InterpreterQuickPickList.globalGroupName,e.VirtualEnv="VirtualEnv",e.PipEnv="PipEnv",e.Pyenv="Pyenv",e.Venv="Venv",e.Poetry="Poetry",e.VirtualEnvWrapper="VirtualEnvWrapper",e.ActiveState="ActiveState",e.Recommended=f.Common.recommended}(O=t.EnvGroups||(t.EnvGroups={}));let R=class extends T.BaseInterpreterSelectorCommand{constructor(e,t,n,r,i,o,s,a,l,p){super(n,i,e,l,t,r),this.multiStepFactory=o,this.platformService=s,this.interpreterSelector=a,this.interpreterService=p,this.manualEntrySuggestion={label:`${u.Octicons.Add} ${f.InterpreterQuickPickList.enterPath.label}`,alwaysShow:!0},this.refreshButton={iconPath:new c.ThemeIcon(u.ThemeIcons.Refresh),tooltip:f.InterpreterQuickPickList.refreshInterpreterList},this.noPythonInstalled={label:`${u.Octicons.Error} ${f.InterpreterQuickPickList.noPythonInstalled}`,detail:f.InterpreterQuickPickList.clickForInstructions,alwaysShow:!0},this.wasNoPythonInstalledItemClicked=!1,this.tipToReloadWindow={label:`${u.Octicons.Lightbulb} Reload the window if you installed Python but don't see it`,detail:"Click to run `Developer: Reload Window` command",alwaysShow:!0}}async activate(){this.disposables.push(this.commandManager.registerCommand(u.Commands.Set_Interpreter,this.setInterpreter.bind(this)))}async _pickInterpreter(e,t,n,r){var i,o;const s=!!this.interpreterService.refreshPromise,a=this._getItems(t.workspace,n,r);t.path=void 0;const l=this.pathUtils.getDisplayName(this.configurationService.getSettings(t.workspace).pythonPath,t.workspace?t.workspace.fsPath:void 0),p=null===(null==r?void 0:r.placeholder)?void 0:null!==(i=null==r?void 0:r.placeholder)&&void 0!==i?i:c.l10n.t("Selected Interpreter: {0}",l),d=null===(null==r?void 0:r.title)?void 0:null!==(o=null==r?void 0:r.title)&&void 0!==o?o:f.InterpreterQuickPickList.browsePath.openButtonLabel,h=[{button:this.refreshButton,callback:e=>{this.refreshCallback(e,{isButton:!0,showBackButton:null==r?void 0:r.showBackButton})}}];(null==r?void 0:r.showBackButton)&&h.push({button:c.QuickInputButtons.Back,callback:()=>{}});const m=await e.showQuickPick({placeholder:p,items:a,sortByLabel:!s,keepScrollPosition:!0,activeItem:this.getActiveItem(t.workspace,a),matchOnDetail:!0,matchOnDescription:!0,title:d,customButtonSetups:h,initialize:e=>{0===this.interpreterService.getInterpreters().length?this.refreshCallback(e,{showBackButton:null==r?void 0:r.showBackButton}):this.refreshCallback(e,{ifNotTriggerredAlready:!0,showBackButton:null==r?void 0:r.showBackButton})},onChangeItem:{event:this.interpreterService.onDidChangeInterpreters,callback:(e,i)=>{this.interpreterService.refreshPromise&&(i.busy=!0,this.interpreterService.refreshPromise.then((()=>{i.busy=!1,this.updateQuickPickItems(i,{},t.workspace,n,r)}))),this.updateQuickPickItems(i,e,t.workspace,n,r)}}});if(void 0===m)(0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_SELECTED,void 0,{action:"escape"});else{if(m.label===this.manualEntrySuggestion.label)return(0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_ENTER_OR_FIND),this._enterOrBrowseInterpreterPath.bind(this);m.label===this.noPythonInstalled.label?(this.commandManager.executeCommand(u.Commands.InstallPython).then(g.noop,g.noop),this.wasNoPythonInstalledItemClicked=!0):m.label===this.tipToReloadWindow.label?this.commandManager.executeCommand("workbench.action.reloadWindow").then(g.noop,g.noop):((0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_SELECTED,void 0,{action:"selected"}),t.path=m.path)}}_getItems(e,t,n){const r=[this.manualEntrySuggestion],i=this.getDefaultInterpreterPathSuggestion(e);i&&r.push(i);const o=this.getSuggestions(e,t,n);return this.finalizeItems(o,e,n),r.push(...o),r}getSuggestions(e,t,n){var r;const i=this.workspaceService.getWorkspaceFolder(e),o=this.interpreterSelector.getSuggestions(e,!!this.interpreterService.refreshPromise).filter((e=>!t||t(e.interpreter)));if(this.interpreterService.refreshPromise)return o;const s=this.interpreterSelector.getSuggestions(e,!0).filter((e=>!t||t(e.interpreter)));let a;return(null==n?void 0:n.skipRecommended)||(a=this.interpreterSelector.getRecommendedSuggestion(s,null===(r=this.workspaceService.getWorkspaceFolder(e))||void 0===r?void 0:r.uri)),a&&o[0].interpreter.id===a.interpreter.id&&o.shift(),function(e,t,n){const r=[];t&&r.push({label:O.Recommended,kind:c.QuickPickItemKind.Separator},t);let i=O.Recommended;for(const t of e)i=D(r,t,n,i),r.push(t);return r}(o,a,null==i?void 0:i.uri.fsPath)}async getActiveItem(e,t){const n=await this.interpreterService.getActiveInterpreter(e),r=t.find((e=>P(e)&&e.interpreter.id===(null==n?void 0:n.id)));if(r)return r;const i=t.find((e=>P(e)));if(i)return i;const o=t.find((e=>I(e)&&e.label===this.noPythonInstalled.label));return null!=o?o:t[0]}getDefaultInterpreterPathSuggestion(e){const t=this.workspaceService.getConfiguration("python",e),n=new v.SystemVariables(e,void 0,this.workspaceService).resolveAny(t.get("defaultInterpreterPath"));if(n&&"python"!==n)return{label:`${u.Octicons.Gear} ${f.InterpreterQuickPickList.defaultInterpreterPath.label}`,description:this.pathUtils.getDisplayName(n,e?e.fsPath:void 0),path:n,alwaysShow:!0}}updateQuickPickItems(e,t,n,r,i){const o=e.activeItems.length>0?e.activeItems[0]:void 0;e.items=this.getUpdatedItems(e.items,t,n,r,i);const s=o?e.items.find((e=>P(e)&&P(o)?e.interpreter.id===o.interpreter.id:!(!I(e)||!I(o))&&e.label===o.label)):void 0;e.activeItems=s?[s]:[]}getUpdatedItems(e,t,n,r,i){var o,s;const a=[...e.values()],c=e.find((e=>x(e))),l=null!==(o=t.old)&&void 0!==o?o:t.new;r&&t.new&&!r(t.new)&&(t.new=void 0);let u=-1;if(l&&(u=a.findIndex((e=>P(e)&&e.interpreter.id===l.id))),t.new){const e=this.interpreterSelector.suggestionToQuickPickItem(t.new,n,!c);if(-1===u){const t=a.findIndex((e=>I(e)&&e.label===this.noPythonInstalled.label));-1!==t&&a.splice(t,1);const r=a.findIndex((e=>I(e)&&e.label===this.tipToReloadWindow.label));-1!==r&&a.splice(r,1),c&&D(a,e,null===(s=this.workspaceService.getWorkspaceFolder(n))||void 0===s?void 0:s.uri.fsPath),a.push(e)}else a[u]=e}return-1!==u&&void 0===t.new&&a.splice(u,1),this.finalizeItems(a,n,i),a}finalizeItems(e,t,n){const r=this.interpreterSelector.getSuggestions(t,!0);this.interpreterService.refreshPromise||(r.length?((null==n?void 0:n.skipRecommended)||this.setRecommendedItem(r,e,t),e.forEach(((t,n)=>{P(t)&&(0,_.isProblematicCondaEnvironment)(t.interpreter)&&(e[n].label.includes(u.Octicons.Warning)||(e[n].label=`${u.Octicons.Warning} ${e[n].label}`,e[n].tooltip=f.InterpreterQuickPickList.condaEnvWithoutPythonTooltip))}))):(e.some((e=>I(e)&&e.label===this.noPythonInstalled.label))||e.push(this.noPythonInstalled),this.wasNoPythonInstalledItemClicked&&!e.some((e=>I(e)&&e.label===this.tipToReloadWindow.label))&&e.push(this.tipToReloadWindow)))}setRecommendedItem(e,t,n){var r,i;const o=this.interpreterSelector.getRecommendedSuggestion(e,null===(r=this.workspaceService.getWorkspaceFolder(n))||void 0===r?void 0:r.uri);if(!o)return;const a=t.find((e=>x(e)&&e.label===O.Recommended)),c=(0,s.cloneDeep)(o);c.label=`${u.Octicons.Star} ${c.label}`,c.description=a?c.description:`${null!==(i=c.description)&&void 0!==i?i:""} - ${f.Common.recommended}`;const l=t.findIndex((e=>P(e)&&e.interpreter.id===c.interpreter.id));-1!==l&&(t[l]=c)}refreshCallback(e,t){e.buttons=this.getButtons(t),this.interpreterService.triggerRefresh(void 0,t).finally((()=>{e.buttons=this.getButtons({isButton:!1,showBackButton:null==t?void 0:t.showBackButton})})).ignoreErrors(),this.interpreterService.refreshPromise&&(e.busy=!0,this.interpreterService.refreshPromise.then((()=>{e.busy=!1})))}getButtons(e){const t=[];return(null==e?void 0:e.showBackButton)&&t.push(c.QuickInputButtons.Back),(null==e?void 0:e.isButton)?t.push({iconPath:new c.ThemeIcon(u.ThemeIcons.SpinningLoader),tooltip:f.InterpreterQuickPickList.refreshingInterpreterList}):t.push(this.refreshButton),t}async _enterOrBrowseInterpreterPath(e,t){const n=[{label:f.InterpreterQuickPickList.browsePath.label,detail:f.InterpreterQuickPickList.browsePath.detail}],r=await e.showQuickPick({placeholder:f.InterpreterQuickPickList.enterPath.placeholder,items:n,acceptFilterBoxTextAsSelection:!0});if("string"==typeof r)(0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_ENTER_CHOICE,void 0,{choice:"enter"}),t.path=r,this.sendInterpreterEntryTelemetry(r,t.workspace);else if(r&&r.label===f.InterpreterQuickPickList.browsePath.label){(0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_ENTER_CHOICE,void 0,{choice:"browse"});const e={Executables:["exe"]},n=await this.applicationShell.showOpenDialog({filters:this.platformService.isWindows?e:void 0,openLabel:f.InterpreterQuickPickList.browsePath.openButtonLabel,canSelectMany:!1,title:f.InterpreterQuickPickList.browsePath.title});if(!(n&&n.length>0))return Promise.reject(m.InputFlowAction.resume);t.path=n[0].fsPath,this.sendInterpreterEntryTelemetry(t.path,t.workspace)}return Promise.resolve()}async setInterpreter(){const e=await this.getConfigTargets();if(!e)return;const{configTarget:t}=e[0],n=e[0].folderUri,r={path:void 0,workspace:n},i=this.multiStepFactory.create();await i.run(((e,t)=>this._pickInterpreter(e,t,void 0)),r),void 0!==r.path&&await this.pythonPathUpdaterService.updatePythonPath(r.path,t,"ui",n)}async getInterpreterViaQuickPick(e,t,n){const r={path:void 0,workspace:e},i=this.multiStepFactory.create();return await i.run(((e,r)=>this._pickInterpreter(e,r,t,n)),r),r.path}sendInterpreterEntryTelemetry(e,t){const n=this._getItems(t,void 0);let r=a.normalize(C(e));a.isAbsolute(r)||(r=a.resolve((null==t?void 0:t.fsPath)||"",e));const i=n.map((e=>{const n=P(e)?e.interpreter.path:"";let r=a.normalize(C(n));return a.isAbsolute(n)||(r=a.resolve((null==t?void 0:t.fsPath)||"",n)),r})).includes(r);(0,b.sendTelemetryEvent)(S.EventName.SELECT_INTERPRETER_ENTERED_EXISTS,void 0,{discovered:i})}};function D(e,t,n,r){if(!r){const t=e.length?e[e.length-1]:void 0;r=t&&P(t)?A(t,n):void 0}const i=A(t,n);if(!r||i!==r){const t={label:i,kind:c.QuickPickItemKind.Separator};e.push(t),r=i}return r}function A(e,t){if(t&&(0,p.isParentPath)(e.path,t))return O.Workspace;switch(e.interpreter.envType){case y.EnvironmentType.Global:case y.EnvironmentType.System:case y.EnvironmentType.Unknown:case y.EnvironmentType.MicrosoftStore:return O.Global;default:return O[e.interpreter.envType]}}r([(0,b.captureTelemetry)(S.EventName.SELECT_INTERPRETER_ENTER_BUTTON)],R.prototype,"_enterOrBrowseInterpreterPath",null),r([(0,b.captureTelemetry)(S.EventName.SELECT_INTERPRETER)],R.prototype,"setInterpreter",null),R=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IApplicationShell)),i(1,(0,o.inject)(h.IPathUtils)),i(2,(0,o.inject)(w.IPythonPathUpdaterServiceManager)),i(3,(0,o.inject)(h.IConfigurationService)),i(4,(0,o.inject)(l.ICommandManager)),i(5,(0,o.inject)(m.IMultiStepInputFactory)),i(6,(0,o.inject)(d.IPlatformService)),i(7,(0,o.inject)(w.IInterpreterSelector)),i(8,(0,o.inject)(l.IWorkspaceService)),i(9,(0,o.inject)(E.IInterpreterService))],R),t.SetInterpreterCommand=R},49071:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterSelector=void 0;const o=n(86700),s=n(48431),a=n(61684),c=n(44773),l=n(18639),u=n(54351);let p=class{constructor(e,t,n){this.interpreterManager=e,this.envTypeComparer=t,this.pathUtils=n,this.disposables=[]}dispose(){this.disposables.forEach((e=>e.dispose()))}getSuggestions(e,t=!1){const n=this.interpreterManager.getInterpreters(e);return n.sort(this.envTypeComparer.compare.bind(this.envTypeComparer)),n.map((n=>this.suggestionToQuickPickItem(n,e,t)))}async getAllSuggestions(e){const t=await this.interpreterManager.getAllInterpreters(e);return t.sort(this.envTypeComparer.compare.bind(this.envTypeComparer)),Promise.all(t.map((t=>this.suggestionToQuickPickItem(t,e))))}suggestionToQuickPickItem(e,t,n=!1){const r=e.envPath&&"envFolderPath"===(0,c.getEnvPath)(e.path,e.envPath).pathType?e.envPath:e.path,i=this.pathUtils.getDisplayName(r,t?t.fsPath:void 0),o=e.cachedEntry?"(cached) ":"";return{label:(n?e.detailedDisplayName:e.displayName)||"Python",description:`${o}${i}`,path:r,interpreter:e}}getRecommendedSuggestion(e,t){const n=this.interpreterManager.getInterpreters(t),r=this.envTypeComparer.getRecommended(n,t);if(r)return e.find((e=>(0,s.arePathsSame)(e.interpreter.path,r.path)))}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IInterpreterService)),i(1,(0,o.inject)(u.IInterpreterComparer)),i(2,(0,o.inject)(a.IPathUtils))],p),t.InterpreterSelector=p},68618:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonPathUpdaterService=void 0;const o=n(86700),s=n(66828),a=n(70057),c=n(48683),l=n(19735),u=n(54813),p=n(61522),d=n(18639),h=n(54351);let f=class{constructor(e,t){this.pythonPathSettingsUpdaterFactory=e,this.pyenvs=t}async updatePythonPath(e,t,n,r){const i=new a.StopWatch,o=this.getPythonUpdaterService(t,r);let c=!1;try{await o.updatePythonPath(e)}catch(e){c=!0;const t=e,n=t&&"string"==typeof t.message?t.message:"";s.window.showErrorMessage(s.l10n.t("Failed to set interpreter path. Error: {0}",n)),(0,l.traceError)(t)}this.sendTelemetry(i.elapsedTime,c,n,e,r).catch((e=>(0,l.traceError)("Python Extension: sendTelemetry",e)))}async sendTelemetry(e,t,n,r,i){var o;const s={failed:t,trigger:n};if(!t&&r){const e=new c.SystemVariables(void 0,null==i?void 0:i.fsPath),t=await this.pyenvs.getInterpreterInformation(e.resolveAny(r));t&&(s.pythonVersion=null===(o=t.version)||void 0===o?void 0:o.raw)}(0,u.sendTelemetryEvent)(p.EventName.PYTHON_INTERPRETER,e,s)}getPythonUpdaterService(e,t){switch(e){case s.ConfigurationTarget.Global:return this.pythonPathSettingsUpdaterFactory.getGlobalPythonPathConfigurationService();case s.ConfigurationTarget.Workspace:if(!t)throw new Error("Workspace Uri not defined");return this.pythonPathSettingsUpdaterFactory.getWorkspacePythonPathConfigurationService(t);default:if(!t)throw new Error("Workspace Uri not defined");return this.pythonPathSettingsUpdaterFactory.getWorkspaceFolderPythonPathConfigurationService(t)}}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(h.IPythonPathUpdaterServiceFactory)),i(1,(0,o.inject)(d.IComponentAdapter))],f),t.PythonPathUpdaterService=f},79721:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonPathUpdaterServiceFactory=void 0;const o=n(86700),s=n(61684),a=n(77498),c=n(56798),l=n(95791),u=n(35543);let p=class{constructor(e){this.interpreterPathService=e.get(s.IInterpreterPathService)}getGlobalPythonPathConfigurationService(){return new c.GlobalPythonPathUpdaterService(this.interpreterPathService)}getWorkspacePythonPathConfigurationService(e){return new u.WorkspacePythonPathUpdaterService(e,this.interpreterPathService)}getWorkspaceFolderPythonPathConfigurationService(e){return new l.WorkspaceFolderPythonPathUpdaterService(e,this.interpreterPathService)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],p),t.PythonPathUpdaterServiceFactory=p},56798:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalPythonPathUpdaterService=void 0;const r=n(66828);t.GlobalPythonPathUpdaterService=class{constructor(e){this.interpreterPathService=e}async updatePythonPath(e){const t=this.interpreterPathService.inspect(void 0);t&&t.globalValue===e||await this.interpreterPathService.update(void 0,r.ConfigurationTarget.Global,e)}}},95791:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFolderPythonPathUpdaterService=void 0;const r=n(66828);t.WorkspaceFolderPythonPathUpdaterService=class{constructor(e,t){this.workspaceFolder=e,this.interpreterPathService=t}async updatePythonPath(e){const t=this.interpreterPathService.inspect(this.workspaceFolder);t&&t.workspaceFolderValue===e||await this.interpreterPathService.update(this.workspaceFolder,r.ConfigurationTarget.WorkspaceFolder,e)}}},35543:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspacePythonPathUpdaterService=void 0;const r=n(66828);t.WorkspacePythonPathUpdaterService=class{constructor(e,t){this.workspace=e,this.interpreterPathService=t}async updatePythonPath(e){const t=this.interpreterPathService.inspect(this.workspace);t&&t.workspaceValue===e||await this.interpreterPathService.update(this.workspace,r.ConfigurationTarget.Workspace,e)}}},54351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IInterpreterQuickPick=t.IInterpreterComparer=t.IInterpreterSelector=t.IPythonPathUpdaterServiceManager=t.IPythonPathUpdaterServiceFactory=void 0,t.IPythonPathUpdaterServiceFactory=Symbol("IPythonPathUpdaterServiceFactory"),t.IPythonPathUpdaterServiceManager=Symbol("IPythonPathUpdaterServiceManager"),t.IInterpreterSelector=Symbol("IInterpreterSelector"),t.IInterpreterComparer=Symbol("IInterpreterComparer"),t.IInterpreterQuickPick=Symbol("IInterpreterQuickPick")},18639:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IActivatedEnvironmentLaunch=t.IInterpreterStatusbarVisibilityFilter=t.IInterpreterHelper=t.IInterpreterDisplay=t.IInterpreterService=t.ICondaService=t.IComponentAdapter=void 0,t.IComponentAdapter=Symbol("IComponentAdapter"),t.ICondaService=Symbol("ICondaService"),t.IInterpreterService=Symbol("IInterpreterService"),t.IInterpreterDisplay=Symbol("IInterpreterDisplay"),t.IInterpreterHelper=Symbol("IInterpreterHelper"),t.IInterpreterStatusbarVisibilityFilter=Symbol("IInterpreterStatusbarVisibilityFilter"),t.IActivatedEnvironmentLaunch=Symbol("IActivatedEnvironmentLaunch")},36543:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterDisplay=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570);n(32727);const l=n(61684),u=n(67098),p=n(77498),d=n(19735),h=n(18639);let f=class{constructor(e){this.serviceContainer=e,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this.useLanguageStatus=!1,this.visibilityFilters=[],this.helper=e.get(h.IInterpreterHelper),this.workspaceService=e.get(a.IWorkspaceService),this.pathUtils=e.get(l.IPathUtils),this.interpreterService=e.get(h.IInterpreterService),this.disposableRegistry=e.get(l.IDisposableRegistry),this.interpreterService.onDidChangeInterpreterInformation(this.onDidChangeInterpreterInformation,this,this.disposableRegistry)}async activate(){const e=this.serviceContainer.get(a.IApplicationShell);if(this.useLanguageStatus)this.languageStatus=e.createLanguageStatusItem("python.selectedInterpreter",{language:c.PYTHON_LANGUAGE}),this.languageStatus.severity=s.LanguageStatusSeverity.Information,this.languageStatus.command={title:u.InterpreterQuickPickList.browsePath.openButtonLabel,command:c.Commands.Set_Interpreter},this.disposableRegistry.push(this.languageStatus);else{const[t,n]=[s.StatusBarAlignment.Right,100.09999];this.statusBar=e.createStatusBarItem(t,n,"python.selectedInterpreterDisplay"),this.statusBar.command=c.Commands.Set_Interpreter,this.disposableRegistry.push(this.statusBar),this.statusBar.name=u.Interpreters.selectedPythonInterpreter}}async refresh(e){if(e&&this.workspaceService.getWorkspaceFolder(e)&&(e=this.workspaceService.getWorkspaceFolder(e).uri),!e){const t=this.helper.getActiveWorkspaceUri(e);e=t?t.folderUri:void 0}await this.updateDisplay(e)}registerVisibilityFilter(e){const t=this.serviceContainer.get(l.IDisposableRegistry);this.visibilityFilters.push(e),e.changed&&e.changed(this.updateVisibility,this,t)}onDidChangeInterpreterInformation(e){this.currentlySelectedInterpreterPath===e.path&&this.updateDisplay(this.currentlySelectedWorkspaceFolder).ignoreErrors()}async updateDisplay(e){var t;const n=await this.interpreterService.getActiveInterpreter(e);if(!this.currentlySelectedInterpreterDisplay||this.currentlySelectedInterpreterDisplay!==(null==n?void 0:n.detailedDisplayName)||this.currentlySelectedInterpreterPath!==n.path){if(this.currentlySelectedWorkspaceFolder=e,this.statusBar)if(n){this.statusBar.color="",this.statusBar.tooltip=this.pathUtils.getDisplayName(n.path,null==e?void 0:e.fsPath),this.currentlySelectedInterpreterPath!==n.path&&((0,d.traceLog)(s.l10n.t("Python interpreter path: {0}",this.pathUtils.getDisplayName(n.path,null==e?void 0:e.fsPath))),this.currentlySelectedInterpreterPath=n.path);let r=n.detailedDisplayName;r=(null==r?void 0:r.startsWith("Python"))?null===(t=null==r?void 0:r.substring("Python".length))||void 0===t?void 0:t.trim():r,this.statusBar.text=null!=r?r:"",this.statusBar.backgroundColor=void 0,this.currentlySelectedInterpreterDisplay=n.detailedDisplayName}else this.statusBar.tooltip="",this.statusBar.color="",this.statusBar.backgroundColor=new s.ThemeColor("statusBarItem.warningBackground"),this.statusBar.text=`$(alert) ${u.InterpreterQuickPickList.browsePath.openButtonLabel}`,this.currentlySelectedInterpreterDisplay=void 0;else if(this.languageStatus)if(n){this.languageStatus.detail=this.pathUtils.getDisplayName(n.path,null==e?void 0:e.fsPath),this.currentlySelectedInterpreterPath!==n.path&&((0,d.traceLog)(s.l10n.t("Python interpreter path: {0}",this.pathUtils.getDisplayName(n.path,null==e?void 0:e.fsPath))),this.currentlySelectedInterpreterPath=n.path);let t=n.detailedDisplayName;t=t.startsWith("Python")?t.substring("Python".length).trim():t,this.languageStatus.text=t,this.currentlySelectedInterpreterDisplay=n.detailedDisplayName,this.languageStatus.severity=s.LanguageStatusSeverity.Information}else this.languageStatus.severity=s.LanguageStatusSeverity.Warning,this.languageStatus.text=`$(alert) ${u.InterpreterQuickPickList.browsePath.openButtonLabel}`,this.languageStatus.detail=void 0,this.currentlySelectedInterpreterDisplay=void 0;this.statusBarCanBeDisplayed=!0,this.updateVisibility()}}updateVisibility(){this.statusBar&&this.statusBarCanBeDisplayed&&(0===this.visibilityFilters.length||this.visibilityFilters.every((e=>!e.hidden))?this.statusBar.show():this.statusBar.hide())}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer))],f),t.InterpreterDisplay=f},24001:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterLocatorProgressStatubarHandler=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570),l=n(61684),u=n(59314),p=n(67098),d=n(19735),h=n(44538),f=n(18639);let g=class{constructor(e,t,n){this.shell=e,this.disposables=t,this.pyenvs=n,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this.isFirstTimeLoadingInterpreters=!0}async activate(){this.pyenvs.onProgress((e=>{if(e.stage===h.ProgressReportStage.discoveryStarted){this.showProgress();const e=this.pyenvs.getRefreshPromise();e&&e.then((()=>this.hideProgress()))}}),this,this.disposables)}showProgress(){this.deferred||this.createProgress()}hideProgress(){this.deferred&&(this.deferred.resolve(),this.deferred=void 0)}createProgress(){const e={location:s.ProgressLocation.Window,title:`[${this.isFirstTimeLoadingInterpreters?p.Interpreters.discovering:p.Interpreters.refreshing}](command:${c.Commands.Set_Interpreter})`};this.isFirstTimeLoadingInterpreters=!1,this.shell.withProgress(e,(()=>(this.deferred=(0,u.createDeferred)(),this.deferred.promise)))}};r([(0,d.traceDecoratorVerbose)("Display locator refreshing progress")],g.prototype,"showProgress",null),r([(0,d.traceDecoratorVerbose)("Hide locator refreshing progress")],g.prototype,"hideProgress",null),g=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IApplicationShell)),i(1,(0,o.inject)(l.IDisposableRegistry)),i(2,(0,o.inject)(f.IComponentAdapter))],g),t.InterpreterLocatorProgressStatubarHandler=g},43490:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterHelper=t.isInterpreterLocatedInWorkspace=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(48431),l=n(77498),u=n(95084),p=n(81387),d=n(18639);function h(e){if(0===e.length)return[];if(1===e.length)return[e[0]];const t=e.slice();return t.sort(((e,t)=>e.version&&t.version?(0,u.compareSemVerLikeVersions)(e.version,t.version):0)),t}t.isInterpreterLocatedInWorkspace=function(e,t){const n=c.FileSystemPaths.withDefaults(),r=n.normCase(e.path),i=n.normCase(t.fsPath);return r.startsWith(i)};let f=class{constructor(e,t){this.serviceContainer=e,this.pyenvs=t}getActiveWorkspaceUri(e){var t;const n=this.serviceContainer.get(a.IWorkspaceService);if(!(((null===(t=n.workspaceFolders)||void 0===t?void 0:t.length)||0)>0))return;if(Array.isArray(n.workspaceFolders)&&1===n.workspaceFolders.length)return{folderUri:n.workspaceFolders[0].uri,configTarget:s.ConfigurationTarget.Workspace};if(e){const t=n.getWorkspaceFolder(e);if(t)return{configTarget:s.ConfigurationTarget.WorkspaceFolder,folderUri:t.uri}}const r=this.serviceContainer.get(a.IDocumentManager);if(r.activeTextEditor){const e=n.getWorkspaceFolder(r.activeTextEditor.document.uri);if(e)return{configTarget:s.ConfigurationTarget.WorkspaceFolder,folderUri:e.uri}}}async getInterpreterInformation(e){return this.pyenvs.getInterpreterInformation(e)}async getInterpreters({resource:e,source:t}={}){return h(await this.pyenvs.getInterpreters(e,t))}async getInterpreterPath(e){const t=await this.getInterpreterInformation(e);return t?t.path:e}async isMacDefaultPythonPath(e){return this.pyenvs.isMacDefaultPythonPath(e)}getInterpreterTypeDisplayName(e){return(0,p.getEnvironmentTypeName)(e)}getBestInterpreter(e){if(!Array.isArray(e)||0===e.length)return;const t=h(e);return t[t.length-1]}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IServiceContainer)),i(1,(0,o.inject)(d.IComponentAdapter))],f),t.InterpreterHelper=f},62643:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpreterService=void 0;const o=n(86700),s=n(71017),a=n(66828);n(32727);const c=n(17585),l=n(61684),u=n(77498),p=n(18639),d=n(19735),h=n(77570),f=n(12304),g=n(29983),m=n(67098),v=n(54813),y=n(61522),b=n(36952),S=n(59314);let E=class{constructor(e,t){this.serviceContainer=e,this.pyenvs=t,this._pythonPathSetting="",this.didChangeInterpreterConfigurationEmitter=new a.EventEmitter,this.didChangeInterpreterEmitter=new a.EventEmitter,this.didChangeInterpreterInformation=new a.EventEmitter,this.configService=this.serviceContainer.get(l.IConfigurationService),this.interpreterPathService=this.serviceContainer.get(l.IInterpreterPathService),this.onDidChangeInterpreters=t.onChanged}async hasInterpreters(e=(async()=>!0)){return this.pyenvs.hasInterpreters(e)}triggerRefresh(e,t){return this.pyenvs.triggerRefresh(e,t)}get refreshPromise(){return this.pyenvs.getRefreshPromise()}get onDidChangeInterpreter(){return this.didChangeInterpreterEmitter.event}get onDidChangeInterpreterInformation(){return this.didChangeInterpreterInformation.event}get onDidChangeInterpreterConfiguration(){return this.didChangeInterpreterConfigurationEmitter.event}async refresh(e){const t=this.serviceContainer.get(p.IInterpreterDisplay);await t.refresh(e);const n=this.serviceContainer.get(c.IWorkspaceService).getWorkspaceFolder(e);this.ensureEnvironmentContainsPython(this.configService.getSettings(e).pythonPath,n).ignoreErrors()}initialize(){const e=this.serviceContainer.get(l.IDisposableRegistry),t=this.serviceContainer.get(c.IDocumentManager),n=this.serviceContainer.get(p.IInterpreterDisplay),r=new class{constructor(e,t,n){this.docManager=e,this.configService=t,this.disposablesReg=n,this.interpreterVisibilityEmitter=new a.EventEmitter,this.changed=this.interpreterVisibilityEmitter.event,this.disposablesReg.push(this.configService.onDidChange((async e=>{(null==e?void 0:e.affectsConfiguration("python.interpreter.infoVisibility"))&&this.interpreterVisibilityEmitter.fire()})))}get hidden(){var e;const t=this.configService.getSettings().interpreter.infoVisibility;if("never"===t)return!0;if("always"===t)return!1;const n=null===(e=this.docManager.activeTextEditor)||void 0===e?void 0:e.document,r=h.PVSC_EXTENSION_ID.split(".")[0];return!(null==n?void 0:n.fileName.endsWith("settings.json"))&&!(null==n?void 0:n.fileName.includes(r))&&(null==n?void 0:n.languageId)!==h.PYTHON_LANGUAGE}}(t,this.configService,e);n.registerVisibilityFilter(r),e.push(this.onDidChangeInterpreters((e=>{var t;const n=null!==(t=e.old)&&void 0!==t?t:e.new;n&&this.didChangeInterpreterInformation.fire(n)}))),e.push(t.onDidOpenTextDocument((()=>{r.interpreterVisibilityEmitter.fire()})),t.onDidChangeActiveTextEditor((e=>{r.interpreterVisibilityEmitter.fire(),e&&e.document&&this.refresh(e.document.uri)}))),e.push(this.interpreterPathService.onDidChange((e=>this._onConfigChanged(e.uri))))}getInterpreters(e){return this.pyenvs.getInterpreters(e)}async getAllInterpreters(e){return this.triggerRefresh(void 0,{ifNotTriggerredAlready:!0}).ignoreErrors(),await this.refreshPromise,this.getInterpreters(e)}dispose(){this.didChangeInterpreterEmitter.dispose(),this.didChangeInterpreterInformation.dispose()}async getActiveInterpreter(e){const t=this.serviceContainer.get(p.IActivatedEnvironmentLaunch);let n=await t.selectIfLaunchedViaActivatedEnv(!0);if(!n&&(n=this.configService.getSettings(e).pythonPath,s.basename(n)===n)){const t=this.serviceContainer.tryGet(g.IPythonExecutionFactory),r=t?await t.create({resource:e}):void 0,i=r?await r.getExecutablePath().catch((e=>{(0,d.traceError)(e)})):void 0;if(!i)return;n=i}return this.getInterpreterDetails(n)}async getInterpreterDetails(e){return this.pyenvs.getInterpreterDetails(e)}async _onConfigChanged(e){await(0,S.sleep)(1);const t=this.configService.getSettings(e);if(this.didChangeInterpreterConfigurationEmitter.fire(e),""===this._pythonPathSetting||this._pythonPathSetting!==t.pythonPath){this._pythonPathSetting=t.pythonPath,this.didChangeInterpreterEmitter.fire(e);const n=this.serviceContainer.get(c.IWorkspaceService).getWorkspaceFolder(e);(0,f.reportActiveInterpreterChanged)({path:t.pythonPath,resource:n}),this.serviceContainer.get(p.IInterpreterDisplay).refresh().catch((e=>(0,d.traceError)("Python Extension: display.refresh",e))),await this.ensureEnvironmentContainsPython(this._pythonPathSetting,n)}}async ensureEnvironmentContainsPython(e,t){const n=this.serviceContainer.get(l.IInstaller);if(!await n.isInstalled(l.Product.python)){(0,v.sendTelemetryEvent)(y.EventName.ENVIRONMENT_WITHOUT_PYTHON_SELECTED);const r=this.serviceContainer.get(c.IApplicationShell),i={location:a.ProgressLocation.Window,title:`[${m.Interpreters.installingPython}](command:${h.Commands.ViewOutput})`};(0,d.traceLog)("Conda envs without Python are known to not work well; fixing conda environment...");const o=n.install(l.Product.python,await this.getInterpreterDetails(e));r.withProgress(i,(()=>o)),o.then((async()=>{await this.getInterpreterDetails(e),this.didChangeInterpreterEmitter.fire(null==t?void 0:t.uri),(0,f.reportActiveInterpreterChanged)({path:e,resource:t})})).ignoreErrors()}}};r([(0,b.cache)(-1,!0)],E.prototype,"ensureEnvironmentContainsPython",null),E=r([(0,o.injectable)(),i(0,(0,o.inject)(u.IServiceContainer)),i(1,(0,o.inject)(p.IComponentAdapter))],E),t.InterpreterService=E},51863:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=t.registerInterpreterTypes=void 0;const r=n(90819),i=n(94144),o=n(56446),s=n(15850),a=n(80351),c=n(20741),l=n(45297),u=n(87282),p=n(95356),d=n(89294),h=n(65313),f=n(90780),g=n(50902),m=n(49071),v=n(68618),y=n(79721),b=n(54351),S=n(18639),E=n(36543),_=n(24001),w=n(43490),T=n(62643),C=n(40906),P=n(45107),I=n(66950);function x(e){e.addSingleton(r.IExtensionSingleActivationService,d.InstallPythonCommand),e.addSingleton(r.IExtensionSingleActivationService,h.InstallPythonViaTerminal),e.addSingleton(r.IExtensionSingleActivationService,g.SetInterpreterCommand),e.addSingleton(r.IExtensionSingleActivationService,f.ResetInterpreterCommand),e.addSingleton(b.IInterpreterQuickPick,g.SetInterpreterCommand),e.addSingleton(r.IExtensionActivationService,I.VirtualEnvironmentPrompt),e.addSingleton(S.IInterpreterService,T.InterpreterService),e.addSingleton(S.IInterpreterDisplay,E.InterpreterDisplay),e.addBinding(S.IInterpreterDisplay,r.IExtensionSingleActivationService),e.addSingleton(b.IPythonPathUpdaterServiceFactory,y.PythonPathUpdaterServiceFactory),e.addSingleton(b.IPythonPathUpdaterServiceManager,v.PythonPathUpdaterService),e.addSingleton(b.IInterpreterSelector,m.InterpreterSelector),e.addSingleton(S.IInterpreterHelper,w.InterpreterHelper),e.addSingleton(b.IInterpreterComparer,p.EnvironmentTypeComparer),e.addSingleton(r.IExtensionSingleActivationService,_.InterpreterLocatorProgressStatubarHandler),e.addSingleton(u.IInterpreterAutoSelectionService,c.InterpreterAutoSelectionService),e.addSingleton(r.IExtensionActivationService,P.CondaInheritEnvPrompt),e.addSingleton(S.IActivatedEnvironmentLaunch,C.ActivatedEnvironmentLaunch)}t.registerInterpreterTypes=x,t.registerTypes=function(e){x(e),e.addSingleton(u.IInterpreterAutoSelectionProxyService,l.InterpreterAutoSelectionProxyService),e.addSingleton(i.EnvironmentActivationService,i.EnvironmentActivationService),e.addSingleton(a.IEnvironmentActivationService,i.EnvironmentActivationService),e.addSingleton(a.ITerminalEnvVarCollectionService,s.TerminalEnvVarCollectionService),e.addBinding(a.ITerminalEnvVarCollectionService,r.IExtensionActivationService),e.addSingleton(r.IExtensionSingleActivationService,o.TerminalEnvVarCollectionPrompt)}},40906:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ActivatedEnvironmentLaunch=void 0;const o=n(86700),s=n(66828),a=n(71017),c=n(17585),l=n(29983),u=n(59314),p=n(36952),d=n(67098),h=n(19735),f=n(75470),g=n(54813),m=n(61522),v=n(54351),y=n(18639);let b=class{constructor(e,t,n,r,i,o=!1){this.workspaceService=e,this.appShell=t,this.pythonPathUpdaterService=n,this.interpreterService=r,this.processServiceFactory=i,this.wasSelected=o,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async _promptIfApplicable(){const e=S();if(!e)return;const t=await this.interpreterService.getInterpreterDetails(e);if("base"!==(null==t?void 0:t.envName))return;const n=await f.Conda.getConda();if(!n)return void(0,h.traceWarn)("Conda not found even though activated environment vars are set");const r=await this.processServiceFactory.create();(await r.shellExec(`${n.shellCommand} config --get auto_activate_base`).catch((e=>((0,h.traceError)(e),{stdout:""})))).stdout.trim().toLowerCase().endsWith("false")&&await this.promptAndUpdate(e)}async promptAndUpdate(e){this.wasSelected=!0;const t=[d.Common.bannerLabelYes,d.Common.bannerLabelNo],n=await this.appShell.showInformationMessage(d.Interpreters.activatedCondaEnvLaunch,...t);(0,g.sendTelemetryEvent)(m.EventName.ACTIVATED_CONDA_ENV_LAUNCH,void 0,{selection:n?["Yes","No"][t.indexOf(n)]:void 0}),n&&n===t[0]&&await this.setInterpeterInStorage(e)}async selectIfLaunchedViaActivatedEnv(e=!1){return this.wasSelected?this.inMemorySelection:this._selectIfLaunchedViaActivatedEnv(e)}async _selectIfLaunchedViaActivatedEnv(e=!1){if(this.workspaceService.workspaceFile)return;if("1"!==process.env.VSCODE_CLI)return void(0,h.traceVerbose)("VS Code was not launched from the command line, not selecting activated interpreter");const t=await this.getPrefixOfSelectedActivatedEnv();if(t)return this.wasSelected=!0,this.inMemorySelection=t,(0,h.traceLog)(`VS Code was launched from an activated environment: '${a.basename(t)}', selecting it as the interpreter for workspace.`),e?this.setInterpeterInStorage(t).ignoreErrors():(await this.setInterpeterInStorage(t),await(0,u.sleep)(1)),this.inMemorySelection=void 0,t;this._promptIfApplicable().ignoreErrors()}async setInterpeterInStorage(e){const{workspaceFolders:t}=this.workspaceService;t&&0!==t.length?await this.pythonPathUpdaterService.updatePythonPath(e,s.ConfigurationTarget.WorkspaceFolder,"load",t[0].uri):await this.pythonPathUpdaterService.updatePythonPath(e,s.ConfigurationTarget.Global,"load")}async getPrefixOfSelectedActivatedEnv(){const e=process.env.VIRTUAL_ENV;if(void 0!==e&&e.length>0)return e;const t=S();if(!t)return;const n=await this.interpreterService.getInterpreterDetails(t);return"base"!==(null==n?void 0:n.envName)||void 0!==process.env.CONDA_AUTO_ACTIVATE_BASE&&"false"===process.env.CONDA_AUTO_ACTIVATE_BASE.toLowerCase()?t:void 0}};function S(){const e=process.env.CONDA_PREFIX;if(e&&e.length>0){const t=process.env.CONDA_SHLVL;if(void 0!==t&&t.length>0&&t>"0")return e}}r([(0,p.cache)(-1,!0)],b.prototype,"_promptIfApplicable",null),r([(0,p.cache)(-1,!0)],b.prototype,"_selectIfLaunchedViaActivatedEnv",null),b=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IWorkspaceService)),i(1,(0,o.inject)(c.IApplicationShell)),i(2,(0,o.inject)(v.IPythonPathUpdaterServiceManager)),i(3,(0,o.inject)(y.IInterpreterService)),i(4,(0,o.inject)(l.IProcessServiceFactory)),i(5,(0,o.optional)())],b),t.ActivatedEnvironmentLaunch=b},45107:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CondaInheritEnvPrompt=t.condaInheritEnvPromptKey=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(84974),l=n(61684),u=n(67098),p=n(19735),d=n(81387),h=n(54813),f=n(61522),g=n(18639);t.condaInheritEnvPromptKey="CONDA_INHERIT_ENV_PROMPT_KEY";let m=class{constructor(e,t,n,r,i,o,s=!1){this.interpreterService=e,this.workspaceService=t,this.appShell=n,this.persistentStateFactory=r,this.platformService=i,this.appEnvironment=o,this.hasPromptBeenShownInCurrentSession=s,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(e){this.initializeInBackground(e).ignoreErrors()}async initializeInBackground(e){await this.shouldShowPrompt(e)&&await this.promptAndUpdate()}async promptAndUpdate(){const e=this.persistentStateFactory.createGlobalPersistentState(t.condaInheritEnvPromptKey,!0);if(!e.value)return;const n=[u.Common.allow,u.Common.close],r=await this.appShell.showInformationMessage(u.Interpreters.condaInheritEnvMessage,...n);(0,h.sendTelemetryEvent)(f.EventName.CONDA_INHERIT_ENV_PROMPT,void 0,{selection:r?["Allow","Close"][n.indexOf(r)]:void 0}),r&&(r===n[0]?await this.workspaceService.getConfiguration("terminal").update("integrated.inheritEnv",!1,s.ConfigurationTarget.Global):r===n[1]&&await e.updateValue(!1))}async shouldShowPrompt(e){if(this.hasPromptBeenShownInCurrentSession)return!1;if(this.appEnvironment.remoteName)return!1;if(this.platformService.isWindows)return!1;const t=await this.interpreterService.getActiveInterpreter(e);if(!t||t.envType!==d.EnvironmentType.Conda)return!1;const n=this.workspaceService.getConfiguration("terminal",e).inspect("integrated.inheritEnv");return n?void 0===n.globalValue&&void 0===n.workspaceValue&&void 0===n.workspaceFolderValue&&(this.hasPromptBeenShownInCurrentSession=!0,!0):((0,p.traceError)("WorkspaceConfiguration.inspect returns `undefined` for setting `terminal.integrated.inheritEnv`"),!1)}};r([(0,p.traceDecoratorError)("Failed to intialize conda inherit env prompt")],m.prototype,"initializeInBackground",null),r([(0,p.traceDecoratorError)("Failed to display conda inherit env prompt")],m.prototype,"promptAndUpdate",null),r([(0,p.traceDecoratorError)("Failed to check whether to display prompt for conda inherit env setting")],m.prototype,"shouldShowPrompt",null),m=r([(0,o.injectable)(),i(0,(0,o.inject)(g.IInterpreterService)),i(1,(0,o.inject)(a.IWorkspaceService)),i(2,(0,o.inject)(a.IApplicationShell)),i(3,(0,o.inject)(l.IPersistentStateFactory)),i(4,(0,o.inject)(c.IPlatformService)),i(5,(0,o.inject)(a.IApplicationEnvironment)),i(6,(0,o.optional)())],m),t.CondaInheritEnvPrompt=m},66950:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualEnvironmentPrompt=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(61684),l=n(67098),u=n(19735),p=n(85949),d=n(54813),h=n(61522),f=n(54351),g=n(18639);let m=class{constructor(e,t,n,r,i,o,s){this.persistentStateFactory=e,this.helper=t,this.pythonPathUpdaterService=n,this.disposableRegistry=r,this.appShell=i,this.pyenvs=o,this.interpreterService=s,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(e){const t=this.pyenvs.onDidCreate(e,(()=>this.handleNewEnvironment(e)));this.disposableRegistry.push(t)}async handleNewEnvironment(e){if((0,p.isCreatingEnvironment)())return;const t=await this.pyenvs.getWorkspaceVirtualEnvInterpreters(e),n=Array.isArray(t)&&t.length>0?this.helper.getBestInterpreter(t):void 0;if(!n)return;const r=await this.interpreterService.getActiveInterpreter(e);(null==r?void 0:r.id)!==n.id?await this.notifyUser(n,e):(0,u.traceVerbose)("New environment has already been selected")}async notifyUser(e,t){const n=this.persistentStateFactory.createWorkspacePersistentState("MESSAGE_KEY_FOR_VIRTUAL_ENV",!0);if(!n.value)return;const r=[l.Common.bannerLabelYes,l.Common.bannerLabelNo,l.Common.doNotShowAgain],i=await this.appShell.showInformationMessage(l.Interpreters.environmentPromptMessage,...r);(0,d.sendTelemetryEvent)(h.EventName.PYTHON_INTERPRETER_ACTIVATE_ENVIRONMENT_PROMPT,void 0,{selection:i?["Yes","No","Ignore"][r.indexOf(i)]:void 0}),i&&(i===r[0]?await this.pythonPathUpdaterService.updatePythonPath(e.path,s.ConfigurationTarget.WorkspaceFolder,"ui",t):i===r[2]&&await n.updateValue(!1))}};r([(0,u.traceDecoratorError)("Error in event handler for detection of new environment")],m.prototype,"handleNewEnvironment",null),m=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IPersistentStateFactory)),i(1,(0,o.inject)(g.IInterpreterHelper)),i(2,(0,o.inject)(f.IPythonPathUpdaterServiceManager)),i(3,(0,o.inject)(c.IDisposableRegistry)),i(4,(0,o.inject)(a.IApplicationShell)),i(5,(0,o.inject)(g.IComponentAdapter)),i(6,(0,o.inject)(g.IInterpreterService))],m),t.VirtualEnvironmentPrompt=m},61466:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceContainer=void 0;const i=n(82361),o=n(86700),s=n(19735);try{(0,o.decorate)((0,o.injectable)(),i.EventEmitter)}catch(e){(0,s.traceWarn)("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",e)}let a=class{constructor(e){this.container=e}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(e){}}};a=r([(0,o.injectable)()],a),t.ServiceContainer=a},37104:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceManager=void 0;const i=n(86700);let o=class{constructor(e){this.container=e}add(e,t,n,r){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),r&&r.forEach((t=>{this.addBinding(e,t)}))}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,r){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),r&&r.forEach((t=>{this.addBinding(e,t)}))}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(e){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};o=r([(0,i.injectable)()],o),t.ServiceManager=o},77498:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IServiceContainer=t.IServiceManager=void 0,t.IServiceManager=Symbol("IServiceManager"),t.IServiceContainer=Symbol("IServiceContainer")},11272:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.JupyterExtensionDependencyManager=void 0;const o=n(86700),s=n(77570),a=n(61684);let c=class{constructor(e){this.extensions=e}get isJupyterExtensionInstalled(){return void 0!==this.extensions.getExtension(s.JUPYTER_EXTENSION_ID)}};c=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IExtensions))],c),t.JupyterExtensionDependencyManager=c},66259:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.JupyterExtensionIntegration=void 0;const o=n(86700),s=n(71017),a=n(17585),c=n(77570),l=n(61684),u=n(12187),p=n(80351),d=n(54351),h=n(18639),f=n(56994);let g=class{constructor(e,t,n,r,i,o,s,a){this.extensions=e,this.interpreterSelector=t,this.envActivation=n,this.globalState=r,this.interpreterDisplay=i,this.workspaceService=o,this.condaService=s,this.contextManager=a}registerApi(e){this.contextManager.setContext(f.ExtensionContextKey.IsJupyterInstalled,!0),this.workspaceService.isTrusted?e.registerPythonApi({getActivatedEnvironmentVariables:async(e,t,n)=>this.envActivation.getActivatedEnvironmentVariables(e,t,n),getSuggestions:async e=>this.interpreterSelector.getAllSuggestions(e),getKnownSuggestions:e=>this.interpreterSelector.getSuggestions(e),getDebuggerPath:async()=>(0,s.dirname)((0,u.getDebugpyPackagePath)()),getInterpreterPathSelectedForJupyterServer:()=>this.globalState.get("INTERPRETER_PATH_SELECTED_FOR_JUPYTER_SERVER"),registerInterpreterStatusFilter:this.interpreterDisplay.registerVisibilityFilter.bind(this.interpreterDisplay),getCondaFile:()=>this.condaService.getCondaFile(),getCondaVersion:()=>this.condaService.getCondaVersion(),registerJupyterPythonPathFunction:e=>this.registerJupyterPythonPathFunction(e),registerGetNotebookUriForTextDocumentUriFunction:e=>this.registerGetNotebookUriForTextDocumentUriFunction(e)}):this.workspaceService.onDidGrantWorkspaceTrust((()=>this.registerApi(e)))}async integrateWithJupyterExtension(){const e=await this.getExtensionApi();e&&this.registerApi(e)}async getExtensionApi(){if(!this.pylanceExtension){const e=this.extensions.getExtension(c.PYLANCE_EXTENSION_ID);e&&!e.isActive&&await e.activate(),this.pylanceExtension=e}if(this.jupyterExtension)return this.jupyterExtension.exports;{const e=this.extensions.getExtension(c.JUPYTER_EXTENSION_ID);if(!e)return;if(await e.activate(),e.isActive)return this.jupyterExtension=e,this.jupyterExtension.exports}}getPylanceApi(){var e;const t=null===(e=this.pylanceExtension)||void 0===e?void 0:e.exports;return t&&t.notebook&&t.client&&t.client.isEnabled()?t:void 0}registerJupyterPythonPathFunction(e){this.jupyterPythonPathFunction=e;const t=this.getPylanceApi();t&&t.notebook.registerJupyterPythonPathFunction(e)}getJupyterPythonPathFunction(){return this.jupyterPythonPathFunction}registerGetNotebookUriForTextDocumentUriFunction(e){this.getNotebookUriForTextDocumentUriFunction=e;const t=this.getPylanceApi();t&&t.notebook.registerGetNotebookUriForTextDocumentUriFunction(e)}getGetNotebookUriForTextDocumentUriFunction(){return this.getNotebookUriForTextDocumentUriFunction}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IExtensions)),i(1,(0,o.inject)(d.IInterpreterSelector)),i(2,(0,o.inject)(p.IEnvironmentActivationService)),i(3,(0,o.inject)(l.IMemento)),i(3,(0,o.named)(l.GLOBAL_MEMENTO)),i(4,(0,o.inject)(h.IInterpreterDisplay)),i(5,(0,o.inject)(a.IWorkspaceService)),i(6,(0,o.inject)(h.ICondaService)),i(7,(0,o.inject)(a.IContextKeyManager))],g),t.JupyterExtensionIntegration=g},35657:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RequireJupyterPrompt=void 0;const o=n(86700),s=n(17585),a=n(67098),c=n(77570),l=n(61684),u=n(54813),p=n(61522);let d=class{constructor(e,t,n){this.appShell=e,this.commandManager=t,this.disposables=n,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0}}async activate(){this.disposables.push(this.commandManager.registerCommand(c.Commands.InstallJupyter,(()=>this._showPrompt())))}async _showPrompt(){const e=[a.Common.bannerLabelYes,a.Common.bannerLabelNo],t=await this.appShell.showInformationMessage(a.Interpreters.requireJupyter,...e);(0,u.sendTelemetryEvent)(p.EventName.REQUIRE_JUPYTER_PROMPT,void 0,{selection:t?["Yes","No"][e.indexOf(t)]:void 0}),t&&t===e[0]&&await this.commandManager.executeCommand("workbench.extensions.installExtension",c.JUPYTER_EXTENSION_ID,void 0)}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IApplicationShell)),i(1,(0,o.inject)(s.ICommandManager)),i(2,(0,o.inject)(l.IDisposableRegistry))],d),t.RequireJupyterPrompt=d},29917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLanguageConfiguration=void 0;const r=n(66828),i=n(45940);t.getLanguageConfiguration=function(){return{onEnterRules:[{beforeText:(0,i.verboseRegExp)("\n                    ^\n                    (?! \\s+ \\\\ )\n                    [^#\n]+\n                    \\\\\n                    $\n                "),action:{indentAction:r.IndentAction.Indent}},{beforeText:/^\s*#.*/,afterText:/.+$/,action:{indentAction:r.IndentAction.None,appendText:"# "}},{beforeText:(0,i.verboseRegExp)("\n                    ^\n                    \\s*\n                    (?:\n                        (?:\n                            (?:\n                                class |\n                                def |\n                                async \\s+ def |\n                                except |\n                                for |\n                                async \\s+ for |\n                                if |\n                                elif |\n                                while |\n                                with |\n                                async \\s+ with |\n                                match |\n                                case\n                            )\n                            \\b .*\n                        ) |\n                        else |\n                        try |\n                        finally\n                    )\n                    \\s*\n                    [:]\n                    \\s*\n                    (?: [#] .* )?\n                    $\n                "),action:{indentAction:r.IndentAction.Indent}},{beforeText:(0,i.verboseRegExp)("\n                    ^\n                    (?:\n                        (?:\n                            \\s*\n                            (?:\n                                pass\n                            )\n                        ) |\n                        (?:\n                            \\s+\n                            (?:\n                                raise |\n                                break |\n                                continue\n                            )\n                        )\n                    )\n                    \\s*\n                    (?: [#] .* )?\n                    $\n                "),action:{indentAction:r.IndentAction.Outdent}}]}}},75715:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JediLSExtensionManager=void 0;const r=n(67220),i=n(49532),o=n(17192),s=n(73461),a=n(19735);t.JediLSExtensionManager=class{constructor(e,t,n,a,c,l,u,p,d){this.analysisOptions=new r.JediLanguageServerAnalysisOptions(p,t,c,a),this.clientFactory=new i.JediLanguageClientFactory(u),this.serverProxy=new o.JediLanguageServerProxy(this.clientFactory),this.serverManager=new s.JediLanguageServerManager(e,this.analysisOptions,this.serverProxy,d)}dispose(){this.serverManager.disconnect(),this.serverManager.dispose(),this.serverProxy.dispose(),this.analysisOptions.dispose()}async startLanguageServer(e,t){await this.serverManager.start(e,t),this.serverManager.connect()}async stopLanguageServer(){this.serverManager.disconnect(),await this.serverProxy.stop()}canStartLanguageServer(e){return!!e||((0,a.traceError)("Unable to start Jedi language server as a valid interpreter is not selected"),!1)}languageServerNotAvailable(){return Promise.resolve()}}},34181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoneLSExtensionManager=void 0,t.NoneLSExtensionManager=class{dispose(){}startLanguageServer(){return Promise.resolve()}stopLanguageServer(){return Promise.resolve()}canStartLanguageServer(){return!0}languageServerNotAvailable(){return Promise.resolve()}}},30588:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PylanceLSExtensionManager=void 0;const r=n(65188),i=n(22473),o=n(46888),s=n(82602),a=n(57582),c=n(77570),l=n(67098),u=n(19735);t.PylanceLSExtensionManager=class{constructor(e,t,n,r,c,l,u,p,d,h,f,g){this.workspaceService=r,this.configurationService=c,this.commandManager=d,this.extensions=f,this.applicationShell=g,this.analysisOptions=new i.NodeLanguageServerAnalysisOptions(t,r),this.clientFactory=new o.NodeLanguageClientFactory(h,f),this.serverProxy=new s.NodeLanguageServerProxy(this.clientFactory,n,l,p,r,f),this.serverManager=new a.NodeLanguageServerManager(e,this.analysisOptions,this.serverProxy,d,f)}dispose(){this.serverManager.disconnect(),this.serverManager.dispose(),this.serverProxy.dispose(),this.analysisOptions.dispose()}async startLanguageServer(e,t){await this.serverManager.start(e,t),this.serverManager.connect()}async stopLanguageServer(){this.serverManager.disconnect(),await this.serverProxy.stop()}canStartLanguageServer(){return!!this.extensions.getExtension(c.PYLANCE_EXTENSION_ID)}async languageServerNotAvailable(){await(0,r.promptForPylanceInstall)(this.applicationShell,this.commandManager,this.workspaceService,this.configurationService),(0,u.traceLog)(l.Pylance.pylanceNotInstalledMessage)}}},72391:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ILanguageServerWatcher=void 0,t.ILanguageServerWatcher=Symbol("ILanguageServerWatcher")},8335:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageServerWatcher=void 0;const o=n(71017),s=n(86700),a=n(66828),c=n(65188),l=n(90819),u=n(17585),p=n(84974),d=n(61684),h=n(67098),f=n(19909),g=n(18639),m=n(77498),v=n(19735),y=n(75715),b=n(34181),S=n(30588),E=n(54813),_=n(61522);let w=class{constructor(e,t,n,r,i,o,s,a,c,l,u,p,d,h){this.serviceContainer=e,this.lsOutputChannel=t,this.configurationService=n,this.experimentService=r,this.interpreterHelper=i,this.interpreterPathService=o,this.interpreterService=s,this.environmentService=a,this.workspaceService=c,this.commandManager=l,this.fileSystem=u,this.extensions=p,this.applicationShell=d,this.disposables=h,this.supportedWorkspaceTypes={untrustedWorkspace:!0,virtualWorkspace:!0},this.registered=!1,this.workspaceInterpreters=new Map,this.workspaceLanguageServers=new Map,this.languageServerType=this.configurationService.getSettings().languageServer}async activate(e){this.register(),await this.startLanguageServer(this.languageServerType,e)}async startLanguageServer(e,t){await this.startAndGetLanguageServer(e,t)}register(){this.registered||(this.registered=!0,this.disposables.push(this.workspaceService.onDidChangeConfiguration(this.onDidChangeConfiguration.bind(this))),this.disposables.push(this.workspaceService.onDidChangeWorkspaceFolders(this.onDidChangeWorkspaceFolders.bind(this))),this.disposables.push(this.interpreterService.onDidChangeInterpreterInformation(this.onDidChangeInterpreterInformation,this)),this.workspaceService.isTrusted&&this.disposables.push(this.interpreterPathService.onDidChange(this.onDidChangeInterpreter.bind(this))),this.disposables.push(this.extensions.onDidChange((async()=>{await this.extensionsChangeHandler()}))),this.disposables.push(new c.LanguageServerChangeHandler(this.languageServerType,this.extensions,this.applicationShell,this.commandManager,this.workspaceService,this.configurationService)))}async startAndGetLanguageServer(e,t){var n,r,i;const o=this.getWorkspaceUri(t),s=this.workspaceInterpreters.get(o.fsPath),a=await(null===(n=this.interpreterService)||void 0===n?void 0:n.getActiveInterpreter(t));s&&a!==s&&await this.stopLanguageServer(o);let c=e;a&&(null!==(i=null===(r=a.version)||void 0===r?void 0:r.major)&&void 0!==i?i:0)<3&&(c===l.LanguageServerType.Jedi?c=l.LanguageServerType.None:this.getCurrentLanguageServerTypeIsDefault()&&(c=l.LanguageServerType.Node)),this.workspaceService.isTrusted||c===l.LanguageServerType.Node||c===l.LanguageServerType.None||((0,v.traceLog)(h.LanguageService.untrustedWorkspaceMessage),c=l.LanguageServerType.None);const u=this.getWorkspaceKey(t,c),p=this.workspaceLanguageServers.get(u);if((c===l.LanguageServerType.Node||c===l.LanguageServerType.None)&&p)return T(c,o),p;const d=this.createLanguageServer(c);return this.workspaceLanguageServers.set(u,d),d.canStartLanguageServer(a)?(await d.startLanguageServer(o,a),T(e,o),this.languageServerType=e,this.workspaceInterpreters.set(o.fsPath,a)):await d.languageServerNotAvailable(),d}async restartLanguageServers(){this.workspaceLanguageServers.forEach((async(e,t)=>{(0,E.sendTelemetryEvent)(_.EventName.LANGUAGE_SERVER_RESTART,void 0,{reason:"notebooksExperiment"});const n=a.Uri.parse(t);await this.stopLanguageServer(n),await this.startLanguageServer(this.languageServerType,n)}))}async get(e){const t=this.getWorkspaceKey(e,this.languageServerType);let n=this.workspaceLanguageServers.get(t);return n||(n=await this.startAndGetLanguageServer(this.languageServerType,e)),Promise.resolve(n)}async stopLanguageServer(e){const t=this.getWorkspaceKey(e,this.languageServerType),n=this.workspaceLanguageServers.get(t);n&&(await n.stopLanguageServer(),n.dispose(),this.workspaceLanguageServers.delete(t))}createLanguageServer(e){let t;switch(e){case l.LanguageServerType.Jedi:t=new y.JediLSExtensionManager(this.serviceContainer,this.lsOutputChannel,this.experimentService,this.workspaceService,this.configurationService,this.interpreterPathService,this.interpreterService,this.environmentService,this.commandManager);break;case l.LanguageServerType.Node:t=new S.PylanceLSExtensionManager(this.serviceContainer,this.lsOutputChannel,this.experimentService,this.workspaceService,this.configurationService,this.interpreterPathService,this.interpreterService,this.environmentService,this.commandManager,this.fileSystem,this.extensions,this.applicationShell);break;case l.LanguageServerType.None:default:t=new b.NoneLSExtensionManager}return this.disposables.push({dispose:async()=>{await t.stopLanguageServer(),t.dispose()}}),t}async refreshLanguageServer(e,t){const n=this.getWorkspaceUri(e),r=this.configurationService.getSettings(n).languageServer;(r!==this.languageServerType||t)&&(await this.stopLanguageServer(e),await this.startLanguageServer(r,n))}getCurrentLanguageServerTypeIsDefault(){return this.configurationService.getSettings().languageServerIsDefault}async onDidChangeConfiguration(e){var t,n;(null!==(n=null===(t=this.workspaceService.workspaceFolders)||void 0===t?void 0:t.map((e=>e.uri)))&&void 0!==n?n:[]).forEach((async t=>{e.affectsConfiguration("python.languageServer",t)?await this.refreshLanguageServer(t):e.affectsConfiguration("python.analysis.pylanceLspClientEnabled",t)&&await this.refreshLanguageServer(t,!0)}))}async onDidChangeInterpreter(e){return this.languageServerType===l.LanguageServerType.Node?Promise.resolve():this.activate(e.uri)}async onDidChangeInterpreterInformation(e){if(!e.envPath||""===e.envPath)return;const t=this.workspaceInterpreters.entries();let n=t.next(),r=n.done||!1;for(;!r;){const[i,o]=n.value,s=a.Uri.parse(i);e.envPath===(null==o?void 0:o.envPath)&&e.path!==(null==o?void 0:o.path)?(await this.activate(s),r=!0):(n=t.next(),r=n.done||!1)}}async extensionsChangeHandler(){this.configurationService.getSettings().languageServer!==this.languageServerType&&await this.refreshLanguageServer()}async onDidChangeWorkspaceFolders(e){if(e.removed.length&&this.languageServerType===l.LanguageServerType.Jedi)for(const t of e.removed)await this.stopLanguageServer(t.uri)}getWorkspaceUri(e){var t,n;let r;return r=e?null===(t=this.workspaceService.getWorkspaceFolder(e))||void 0===t?void 0:t.uri:null===(n=this.interpreterHelper.getActiveWorkspaceUri(e))||void 0===n?void 0:n.folderUri,null!=r?r:a.Uri.parse("default")}getWorkspaceKey(e,t){switch(t){case l.LanguageServerType.Node:return"Pylance";case l.LanguageServerType.None:return"None";default:return this.getWorkspaceUri(e).fsPath}}};function T(e,t){let n;const r=o.basename(t.fsPath);switch(e){case l.LanguageServerType.Jedi:n=a.l10n.t("Starting Jedi language server for {0}.",r);break;case l.LanguageServerType.Node:n=h.LanguageService.startingPylance;break;case l.LanguageServerType.None:n=h.LanguageService.startingNone;break;default:throw new Error(`Unknown language server type: ${e}`)}(0,v.traceLog)(n)}w=r([(0,s.injectable)(),i(0,(0,s.inject)(m.IServiceContainer)),i(1,(0,s.inject)(l.ILanguageServerOutputChannel)),i(2,(0,s.inject)(d.IConfigurationService)),i(3,(0,s.inject)(d.IExperimentService)),i(4,(0,s.inject)(g.IInterpreterHelper)),i(5,(0,s.inject)(d.IInterpreterPathService)),i(6,(0,s.inject)(g.IInterpreterService)),i(7,(0,s.inject)(f.IEnvironmentVariablesProvider)),i(8,(0,s.inject)(u.IWorkspaceService)),i(9,(0,s.inject)(u.ICommandManager)),i(10,(0,s.inject)(p.IFileSystem)),i(11,(0,s.inject)(d.IExtensions)),i(12,(0,s.inject)(u.IApplicationShell)),i(13,(0,s.inject)(d.IDisposableRegistry))],w),t.LanguageServerWatcher=w},98779:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bandit=t.BANDIT_REGEX=void 0,n(32727);const r=n(61684),i=n(95981),o=n(62964),s={LOW:o.LintMessageSeverity.Information,MEDIUM:o.LintMessageSeverity.Warning,HIGH:o.LintMessageSeverity.Error};t.BANDIT_REGEX="(?<line>\\d+),(?<column>(col)?(\\d+)?),(?<type>\\w+),(?<code>\\w+\\d+):(?<message>.*)\\r?(\\n|$)";class a extends i.BaseLinter{constructor(e){super(r.Product.bandit,e)}async runLinter(e,n){const r=await this.run([e.uri.fsPath],e,n,t.BANDIT_REGEX);return r.forEach((e=>{e.severity=s[e.type]})),r}}t.Bandit=a},95981:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLinter=t.parseLine=void 0;const r=n(71017),i=n(17585),o=n(77570);n(32727);const s=n(29983),a=n(94146),c=n(61684),l=n(19735),u=n(92488),p=n(62964),d=n(84266);function h(e,t,n,r=0){const i=function(e,t){const n=d(t,"g").exec(e);if(null!==n)return n.groups()}(e,t);if(i)return i.line=Number(i.line),i.column=Number(i.column),{code:i.code,message:i.message,column:Number.isNaN(i.column)||i.column<=0?0:i.column-r,line:i.line,type:i.type,provider:n}}t.parseLine=h,t.BaseLinter=class{constructor(e,t,n=0){this.serviceContainer=t,this.columnOffset=n,this._info=t.get(p.ILinterManager).getLinterInfo(e),this.errorHandler=new u.ErrorHandler(this.info.product,t),this.configService=t.get(c.IConfigurationService),this.workspace=t.get(i.IWorkspaceService)}get pythonSettings(){return this._pythonSettings}get info(){return this._info}async lint(e,t){return this._pythonSettings=this.configService.getSettings(e.uri),this.runLinter(e,t)}getWorkspaceRootPath(e){const t=this.workspace.getWorkspaceFolder(e.uri),n=t&&"string"==typeof t.uri.fsPath?t.uri.fsPath:void 0;return"string"==typeof n?n:r.dirname(e.uri.fsPath)}getWorkingDirectoryPath(e){return this._pythonSettings.linting.cwd||this.getWorkspaceRootPath(e)}parseMessagesSeverity(e,t){const n=e;if(t[n]){const e=t[n];switch(e){case"Error":return p.LintMessageSeverity.Error;case"Hint":return p.LintMessageSeverity.Hint;case"Information":return p.LintMessageSeverity.Information;case"Warning":return p.LintMessageSeverity.Warning;default:if(p.LintMessageSeverity[e])return p.LintMessageSeverity[e]}}return p.LintMessageSeverity.Information}async run(e,t,n,r="(?<line>\\d+),(?<column>-?\\d+),(?<type>\\w+),(?<code>\\w+\\d+):(?<message>.*)\\r?(\\n|$)"){if(!this.info.isEnabled(t.uri))return[];const i=this.info.getExecutionInfo(e,t.uri),o=this.getWorkingDirectoryPath(t),a=this.serviceContainer.get(s.IPythonToolExecutionService);try{const e=await a.execForLinter(i,{cwd:o,token:n,mergeStdOutErr:!1},t.uri);return this.displayLinterResultHeader(e.stdout),await this.parseMessages(e.stdout,t,n,r)}catch(e){return await this.handleError(e,t.uri,i),[]}}async parseMessages(e,t,n,r){const i=(0,a.splitLines)(e,{removeEmptyEntries:!1,trim:!1});return this.parseLines(i,r)}async handleError(e,t,n){(0,o.isTestExecution)()?this.errorHandler.handleError(e,t,n).ignoreErrors():this.errorHandler.handleError(e,t,n).catch((e=>(0,l.traceError)("Error in errorHandler.handleError",e))).ignoreErrors()}parseLine(e,t){return h(e,t,this.info.id,this.columnOffset)}parseLines(e,t){const n=[];for(const r of e)try{const e=this.parseLine(r,t);if(e&&(n.push(e),n.length>=this.pythonSettings.linting.maxNumberOfProblems))break}catch(e){(0,l.traceError)(`Linter '${this.info.id}' failed to parse the line '${r}.`,e)}return n}displayLinterResultHeader(e){(0,l.traceLog)(`${"#".repeat(10)}Linting Output - ${this.info.id}${"#".repeat(10)}\n`),(0,l.traceLog)(e)}}},43022:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseErrorHandler=void 0;const r=n(61684);t.BaseErrorHandler=class{constructor(e,t){this.product=e,this.serviceContainer=t,this.installer=this.serviceContainer.get(r.IInstaller)}get nextHandler(){return this.handler}setNextHandler(e){this.handler=e}}},92488:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorHandler=void 0;const r=n(92261),i=n(49748);t.ErrorHandler=class{constructor(e,t){const n=new i.StandardErrorHandler(e,t);this.handler=new r.NotInstalledErrorHandler(e,t),this.handler.setNextHandler(n)}handleError(e,t,n){return this.handler.handleError(e,t,n)}}},92261:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotInstalledErrorHandler=void 0;const r=n(29983),i=n(19735),o=n(62964),s=n(43022);class a extends s.BaseErrorHandler{async handleError(e,t,n){const s=await this.serviceContainer.get(r.IPythonExecutionFactory).create({resource:t});if(await s.isModuleInstalled(n.moduleName))return!!this.nextHandler&&this.nextHandler.handleError(e,t,n);this.installer.promptToInstall(this.product,t).catch((e=>(0,i.traceError)("NotInstalledErrorHandler.promptToInstall",e)));const a=`Linter '${this.serviceContainer.get(o.ILinterManager).getLinterInfo(n.product).id}' is not installed. Please install it or select another linter".`;return(0,i.traceLog)(`\n${a}\n${e}`),(0,i.traceWarn)(a,e),!0}}t.NotInstalledErrorHandler=a},49748:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardErrorHandler=void 0;const r=n(66828),i=n(17585),o=n(61684),s=n(19735),a=n(62964),c=n(43022);class l extends c.BaseErrorHandler{async handleError(e,t,n){if("string"==typeof e&&e.includes("OSError: [Errno 2] No such file or directory: '/"))return this.nextHandler?this.nextHandler.handleError(e,t,n):Promise.resolve(!1);const r=this.serviceContainer.get(a.ILinterManager).getLinterInfo(n.product);return(0,s.traceError)(`There was an error in running the linter ${r.id}`,e),(0,s.traceLog)(`Linting with ${r.id} failed.`),(0,s.traceLog)(e.toString()),this.displayLinterError(r.id).ignoreErrors(),!0}async displayLinterError(e){const t=r.l10n.t("There was an error in running the linter '{0}'",e),n=this.serviceContainer.get(i.IApplicationShell),s=this.serviceContainer.get(o.ILogOutputChannel);"View Errors"===await n.showErrorMessage(t,"View Errors")&&s.show()}}t.StandardErrorHandler=l},87351:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Flake8=void 0,n(32727);const r=n(61684),i=n(19735),o=n(95981),s=n(39086),a=n(35124);class c extends o.BaseLinter{constructor(e,t){super(r.Product.flake8,e,1),this.prompt=t}async runLinter(e,t){if(await this.prompt.showPrompt(),(0,s.isExtensionEnabled)(this.serviceContainer,a.FLAKE8_EXTENSION))return(0,i.traceLog)("LINTING: Skipping linting from Python extension, since Flake8 extension is installed and enabled."),[];const n=await this.run([e.uri.fsPath],e,t);return n.forEach((e=>{e.severity=this.parseMessagesSeverity(e.type,this.pythonSettings.linting.flake8CategorySeverity),0===e.line&&(e.line=1)})),n}}t.Flake8=c},10900:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinterCommands=void 0;const r=n(66828),i=n(17585),o=n(77570),s=n(67098),a=n(54813),c=n(61522),l=n(62964);t.LinterCommands=class{constructor(e){this.serviceContainer=e,this.disposables=[],this.linterManager=this.serviceContainer.get(l.ILinterManager),this.appShell=this.serviceContainer.get(i.IApplicationShell),this.documentManager=this.serviceContainer.get(i.IDocumentManager);const t=this.serviceContainer.get(i.ICommandManager);t.registerCommand(o.Commands.Set_Linter,this.setLinterAsync.bind(this)),t.registerCommand(o.Commands.Enable_Linter,this.enableLintingAsync.bind(this)),t.registerCommand(o.Commands.Run_Linter,this.runLinting.bind(this))}dispose(){this.disposables.forEach((e=>e.dispose()))}async setLinterAsync(){const e=this.linterManager.getAllLinterInfos(),t=["Disable Linting",...e.map((e=>e.id)).sort()],n=await this.linterManager.getActiveLinters(this.settingsUri);let i;switch(n.length){case 0:i="none";break;case 1:i=n[0].id;break;default:i="multiple selected"}const o={matchOnDetail:!0,matchOnDescription:!0,placeHolder:`current: ${i}`},l=await this.appShell.showQuickPick(t,o);if(void 0!==l)if("Disable Linting"===l)await this.linterManager.enableLintingAsync(!1),(0,a.sendTelemetryEvent)(c.EventName.SELECT_LINTER,void 0,{enabled:!1});else{const t=e.findIndex((e=>e.id===l));if(n.length>1&&await this.appShell.showWarningMessage(r.l10n.t("Multiple linters are enabled in settings. Replace with '{0}'?",l),s.Common.bannerLabelYes,s.Common.bannerLabelNo)!==s.Common.bannerLabelYes)return;await this.linterManager.setActiveLintersAsync([e[t].product],this.settingsUri),(0,a.sendTelemetryEvent)(c.EventName.SELECT_LINTER,void 0,{tool:l,enabled:!0})}}async enableLintingAsync(){const e=["Enable","Disable"],t={matchOnDetail:!0,matchOnDescription:!0,placeHolder:`current: ${await this.linterManager.isLintingEnabled(this.settingsUri)?e[0]:e[1]}`},n=await this.appShell.showQuickPick(e,t);if(void 0!==n){const t=n===e[0];await this.linterManager.enableLintingAsync(t,this.settingsUri)}}runLinting(){return this.serviceContainer.get(l.ILintingEngine).lintOpenPythonFiles("manual")}get settingsUri(){return this.documentManager.activeTextEditor?this.documentManager.activeTextEditor.document.uri:void 0}}},33621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinterInfo=void 0;const r=n(71017),i=n(4057);t.LinterInfo=class{constructor(e,t,n,r=[]){this.configService=n,this._product=e,this._id=t,this._configFileNames=r}get id(){return this._id}get product(){return this._product}get pathSettingName(){return`${this.id}Path`}get argsSettingName(){return`${this.id}Args`}get enabledSettingName(){return`${this.id}Enabled`}get configFileNames(){return this._configFileNames}async enableAsync(e,t){return this.configService.updateSetting(`linting.${this.enabledSettingName}`,e,t)}isEnabled(e){const t=this.configService.getSettings(e),n=this.enabledSettingName;return t.linting[n]}pathName(e){const t=this.configService.getSettings(e),n=this.pathSettingName;return t.linting[n]}linterArgs(e){const t=this.configService.getSettings(e),n=this.argsSettingName,r=t.linting[n];return Array.isArray(r)?r:[]}getExecutionInfo(e,t){const n=this.pathName(t),o=this.linterArgs(t).concat(e),s=(0,i.linterScript)();return r.basename(n)===n?{execPath:void 0,args:[s,"-m",this.id,...o],product:this.product,moduleName:n}:{execPath:n,moduleName:this.id,args:[s,"-p",this.id,n,...o],product:this.product}}}},68882:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinterManager=void 0;const o=n(86700),s=n(61684),a=n(19735),c=n(98779),l=n(87351),u=n(33621),p=n(67060),d=n(35124),h=n(47677),f=n(39415),g=n(52607),m=n(18310),v=n(10032),y=n(16393),b=n(62964);class S{constructor(e){this.configService=e}get info(){return new u.LinterInfo(s.Product.pylint,b.LinterId.PyLint,this.configService)}async lint(e,t){return[]}}let E=class{constructor(e){this.configService=e,this.linters=[new u.LinterInfo(s.Product.bandit,b.LinterId.Bandit,this.configService),new u.LinterInfo(s.Product.flake8,b.LinterId.Flake8,this.configService),new u.LinterInfo(s.Product.pylint,b.LinterId.PyLint,this.configService,["pylintrc",".pylintrc"]),new u.LinterInfo(s.Product.mypy,b.LinterId.MyPy,this.configService),new u.LinterInfo(s.Product.pycodestyle,b.LinterId.PyCodeStyle,this.configService),new u.LinterInfo(s.Product.prospector,b.LinterId.Prospector,this.configService),new u.LinterInfo(s.Product.pydocstyle,b.LinterId.PyDocStyle,this.configService),new u.LinterInfo(s.Product.pylama,b.LinterId.PyLama,this.configService)]}getAllLinterInfos(){return this.linters}getLinterInfo(e){const t=this.linters.findIndex(((t,n,r)=>t.product===e));if(t>=0)return this.linters[t];throw new Error(`Invalid linter '${s.Product[e]}'`)}async isLintingEnabled(e){const t=this.configService.getSettings(e),n=await this.getActiveLinters(e);return t.linting.enabled&&n.length>0}async enableLintingAsync(e,t){await this.configService.updateSetting("linting.enabled",e,t)}async getActiveLinters(e){return this.linters.filter((t=>t.isEnabled(e)))}async setActiveLintersAsync(e,t){if(e.filter((e=>-1!==this.linters.findIndex((t=>t.product===e)))).length>0){const n=await this.getActiveLinters(t);for(const e of n)await e.enableAsync(!1,t);if(e.length>0){const n=this.linters.filter((t=>e.findIndex((e=>t.product===e))>=0));for(const e of n)await e.enableAsync(!0,t);await this.enableLintingAsync(!0,t)}}}async createLinter(e,t,n){if(!await this.isLintingEnabled(n))return new S(this.configService);const r="Linter manager: Unknown linter";switch(e){case s.Product.bandit:return new c.Bandit(t);case s.Product.flake8:return new l.Flake8(t,(0,d.getOrCreateFlake8Prompt)(t));case s.Product.pylint:return new y.Pylint(t,(0,h.getOrCreatePylintPrompt)(t));case s.Product.mypy:return new p.MyPy(t);case s.Product.prospector:return new f.Prospector(t);case s.Product.pylama:return new v.PyLama(t);case s.Product.pydocstyle:return new m.PyDocStyle(t);case s.Product.pycodestyle:return new g.Pycodestyle(t);default:(0,a.traceError)(r)}throw new Error(r)}};E=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IConfigurationService))],E),t.LinterManager=E},53193:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LintingEngine=void 0;const o=n(86700),s=n(91171),a=n(71017),c=n(66828),l=n(17585),u=n(77570),p=n(84974),d=n(61684),h=n(3481),f=n(70057),g=n(18639),m=n(77498),v=n(54813),y=n(61522),b=n(62964),S=new Map;S.set(b.LintMessageSeverity.Error,c.DiagnosticSeverity.Error),S.set(b.LintMessageSeverity.Hint,c.DiagnosticSeverity.Hint),S.set(b.LintMessageSeverity.Information,c.DiagnosticSeverity.Information),S.set(b.LintMessageSeverity.Warning,c.DiagnosticSeverity.Warning);let E=class{constructor(e){this.serviceContainer=e,this.pendingLintings=new Map,this.documents=e.get(l.IDocumentManager),this.workspace=e.get(l.IWorkspaceService),this.configurationService=e.get(d.IConfigurationService),this.linterManager=e.get(b.ILinterManager),this.fileSystem=e.get(p.IFileSystem),this.diagnosticCollection=c.languages.createDiagnosticCollection("python")}get diagnostics(){return this.diagnosticCollection}clearDiagnostics(e){this.diagnosticCollection.has(e.uri)&&this.diagnosticCollection.delete(e.uri)}async lintOpenPythonFiles(e="auto"){this.diagnosticCollection.clear();const t=this.documents.textDocuments.map((async t=>this.lintDocument(t,e)));return await Promise.all(t),this.diagnosticCollection}async lintDocument(e,t){if((0,h.isNotebookCell)(e))return;if(this.diagnosticCollection.set(e.uri,[]),!await this.shouldLintDocument(e,t))return;this.pendingLintings.has(e.uri.fsPath)&&(this.pendingLintings.get(e.uri.fsPath).cancel(),this.pendingLintings.delete(e.uri.fsPath));const n=new c.CancellationTokenSource;n.token.onCancellationRequested((()=>{this.pendingLintings.has(e.uri.fsPath)&&this.pendingLintings.delete(e.uri.fsPath)})),this.pendingLintings.set(e.uri.fsPath,n);const r=(await this.linterManager.getActiveLinters(e.uri)).map((async r=>{const i=new f.StopWatch,o=(await this.linterManager.createLinter(r.product,this.serviceContainer,e.uri)).lint(e,n.token);return this.sendLinterRunTelemetry(r,e.uri,o,i,t),o}));let i=[];const o=this.configurationService.getSettings(e.uri);for(const t of r){const r=await t;if(n.token.isCancellationRequested)break;if(this.isDocumentOpen(e.uri)){for(const t of r)i.push(this.createDiagnostics(t,e));i=i.filter(((e,t)=>t<=o.linting.maxNumberOfProblems))}}this.diagnosticCollection.set(e.uri,i)}sendLinterRunTelemetry(e,t,n,r,i){const o=e.pathName(t),s={tool:e.id,hasCustomArgs:e.linterArgs(t).length>0,trigger:i,executableSpecified:o!==e.id};(0,v.sendTelemetryWhenDone)(y.EventName.LINTING,n,r,s)}isDocumentOpen(e){return this.documents.textDocuments.some((t=>t.uri.fsPath===e.fsPath))}createDiagnostics(e,t){const n=new c.Position(e.line-1,e.column);let r=n;e.endLine&&e.endColumn&&(r=new c.Position(e.endLine-1,e.endColumn));const i=new c.Range(n,r),o=S.get(e.severity),s=new c.Diagnostic(i,e.message,o);return s.code=e.code,s.source=e.provider,s}async shouldLintDocument(e,t){const n=this.serviceContainer.get(g.IInterpreterService);if(!await n.getActiveInterpreter(e.uri)&&"manual"===t)return this.serviceContainer.get(l.ICommandManager).executeCommand(u.Commands.TriggerEnvironmentSelection,e.uri).then(h.noop,h.noop),!1;if(!await this.linterManager.isLintingEnabled(e.uri))return this.diagnosticCollection.set(e.uri,[]),!1;if("python"!==e.languageId)return!1;const r=this.workspace.getWorkspaceFolder(e.uri),i=r&&"string"==typeof r.uri.fsPath?r.uri.fsPath:void 0,o="string"==typeof i?a.relative(i,e.fileName):e.fileName;return!this.configurationService.getSettings(e.uri).linting.ignorePatterns.map((e=>new s.Minimatch(e,{dot:!0}))).some((t=>t.match(e.fileName)||t.match(o)))&&!("file"!==e.uri.scheme||!e.uri.fsPath)&&this.fileSystem.fileExists(e.uri.fsPath)}};E=r([(0,o.injectable)(),i(0,(0,o.inject)(m.IServiceContainer))],E),t.LintingEngine=E},67060:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MyPy=t.getRegex=void 0,n(32727);const r=n(96486),i=n(61684),o=n(95981);function s(e){return`${(0,r.escapeRegExp)(e)}:(?<line>\\d+)(:(?<column>\\d+))?: (?<type>\\w+): (?<message>.*)\\r?(\\n|$)`}t.getRegex=s;class a extends o.BaseLinter{constructor(e){super(i.Product.mypy,e,1)}async runLinter(e,t){const n=s(e.uri.fsPath.slice(this.getWorkspaceRootPath(e).length+1)),r=await this.run([e.uri.fsPath],e,t,n);return r.forEach((e=>{e.severity=this.parseMessagesSeverity(e.type,this.pythonSettings.linting.mypyCategorySeverity),e.code=e.type})),r}}t.MyPy=a},39086:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inToolsExtensionsExperiment=t.doNotShowPromptState=t.isExtensionEnabled=t.isExtensionDisabled=void 0;const r=n(55674),i=n(71017),o=n(60717),s=n(61684),a=n(19735);t.isExtensionDisabled=function(e,t){const n=e.get(s.IExtensions).getExtension("ms-python.python");if(n){let e=!1;return(0,a.traceLog)(`Extension search path: ${i.dirname(n.extensionPath)}`),r.readdirSync(i.dirname(n.extensionPath),{withFileTypes:!1}).forEach((n=>{n.toString().startsWith(t)&&(e=!0)})),e}return!1},t.isExtensionEnabled=function(e,t){return void 0!==e.get(s.IExtensions).getExtension(t)},t.doNotShowPromptState=function(e,t){return e.get(s.IPersistentStateFactory).createWorkspacePersistentState(t,!1)},t.inToolsExtensionsExperiment=function(e){return e.get(s.IExperimentService).inExperiment(o.ShowToolsExtensionPrompt.experiment)}},35124:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrCreateFlake8Prompt=t.Flake8ExtensionPrompt=t.FLAKE8_EXTENSION=void 0;const r=n(17585),i=n(67098),o=n(98638),s=n(56693),a=n(54813),c=n(61522),l=n(39086);t.FLAKE8_EXTENSION="ms-python.flake8";class u{constructor(e){this.serviceContainer=e,this.shownThisSession=!1}async showPrompt(){const e=(0,l.isExtensionEnabled)(this.serviceContainer,t.FLAKE8_EXTENSION);if(e||(0,l.isExtensionDisabled)(this.serviceContainer,t.FLAKE8_EXTENSION))return(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_ALREADY_INSTALLED,void 0,{extensionId:t.FLAKE8_EXTENSION,isEnabled:e}),!0;const n=(0,l.doNotShowPromptState)(this.serviceContainer,"showFlake8ExtensionPrompt");if(this.shownThisSession||n.value)return!1;if(!await(0,l.inToolsExtensionsExperiment)(this.serviceContainer))return!1;this.shownThisSession=!0;const u=await(0,s.showInformationMessage)(i.ToolsExtensions.flake8PromptMessage,i.ToolsExtensions.installFlake8Extension,i.Common.doNotShowAgain);if(u===i.Common.doNotShowAgain)return n.updateValue(!0),!1;if(u===i.ToolsExtensions.installFlake8Extension){const e=this.serviceContainer.get(r.IApplicationEnvironment);return await(0,o.executeCommand)("workbench.extensions.installExtension",t.FLAKE8_EXTENSION,{installPreReleaseVersion:"insiders"===e.extensionChannel}),!0}return!1}}let p;t.Flake8ExtensionPrompt=u,t.getOrCreateFlake8Prompt=function(e){return p||(p=new u(e)),p}},47677:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrCreatePylintPrompt=t.PylintExtensionPrompt=t.PYLINT_EXTENSION=void 0;const r=n(17585),i=n(67098),o=n(98638),s=n(56693),a=n(54813),c=n(61522),l=n(39086);t.PYLINT_EXTENSION="ms-python.pylint";class u{constructor(e){this.serviceContainer=e,this.shownThisSession=!1}async showPrompt(){const e=(0,l.isExtensionEnabled)(this.serviceContainer,t.PYLINT_EXTENSION);if(e||(0,l.isExtensionDisabled)(this.serviceContainer,t.PYLINT_EXTENSION))return(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_ALREADY_INSTALLED,void 0,{extensionId:t.PYLINT_EXTENSION,isEnabled:e}),!0;const n=(0,l.doNotShowPromptState)(this.serviceContainer,"showPylintExtensionPrompt");if(this.shownThisSession||n.value)return!1;if(!await(0,l.inToolsExtensionsExperiment)(this.serviceContainer))return!1;(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_PROMPT_SHOWN,void 0,{extensionId:t.PYLINT_EXTENSION}),this.shownThisSession=!0;const u=await(0,s.showInformationMessage)(i.ToolsExtensions.pylintPromptMessage,i.ToolsExtensions.installPylintExtension,i.Common.doNotShowAgain);if(u===i.Common.doNotShowAgain)return await n.updateValue(!0),(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_PROMPT_DISMISSED,void 0,{extensionId:t.PYLINT_EXTENSION,dismissType:"doNotShow"}),!1;if(u===i.ToolsExtensions.installPylintExtension){(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_INSTALL_SELECTED,void 0,{extensionId:t.PYLINT_EXTENSION});const e=this.serviceContainer.get(r.IApplicationEnvironment);return await(0,o.executeCommand)("workbench.extensions.installExtension",t.PYLINT_EXTENSION,{installPreReleaseVersion:"insiders"===e.extensionChannel}),!0}return(0,a.sendTelemetryEvent)(c.EventName.TOOLS_EXTENSIONS_PROMPT_DISMISSED,void 0,{extensionId:t.PYLINT_EXTENSION,dismissType:"close"}),!1}}let p;t.PylintExtensionPrompt=u,t.getOrCreatePylintPrompt=function(e){return p||(p=new u(e)),p}},39415:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Prospector=void 0;const r=n(71017);n(32727);const i=n(61684),o=n(19735),s=n(95981);class a extends s.BaseLinter{constructor(e){super(i.Product.prospector,e)}async runLinter(e,t){const n=this.getWorkingDirectoryPath(e),i=r.relative(n,e.uri.fsPath);return this.run([i],e,t)}async parseMessages(e,t,n,r){let i;try{i=JSON.parse(e)}catch(t){return(0,o.traceLog)(`${"#".repeat(10)}Linting Output - ${this.info.id}${"#".repeat(10)}`),(0,o.traceLog)(e),(0,o.traceError)("Failed to parse Prospector output",t),[]}return i.messages.filter(((e,t)=>t<=this.pythonSettings.linting.maxNumberOfProblems)).map((e=>{const t=null===e.location.line||Number.isNaN(e.location.line)?1:e.location.line;return{code:e.code,message:e.message,column:e.location.character,line:t,type:e.code,provider:`${this.info.id} - ${e.source}`}}))}}t.Prospector=a},52607:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pycodestyle=void 0,n(32727);const r=n(61684),i=n(95981);class o extends i.BaseLinter{constructor(e){super(r.Product.pycodestyle,e,1)}async runLinter(e,t){const n=await this.run([e.uri.fsPath],e,t);return n.forEach((e=>{e.severity=this.parseMessagesSeverity(e.type,this.pythonSettings.linting.pycodestyleCategorySeverity)})),n}}t.Pycodestyle=o},18310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PyDocStyle=void 0;const r=n(71017);n(32727);const i=n(61684),o=n(19735),s=n(95981),a=n(62964),c=n(65243);class l extends s.BaseLinter{constructor(e){super(i.Product.pydocstyle,e)}async runLinter(e,t){const n=await this.run([e.uri.fsPath],e,t);return n.forEach((e=>{e.severity=a.LintMessageSeverity.Warning})),n}async parseMessages(e,t,n,i){let s=e.split(/\r?\n/g);const a=r.basename(t.uri.fsPath),l=2*this.pythonSettings.linting.maxNumberOfProblems,u=s.filter((e=>e.length>0));s=[];for(let e=0;e<u.length/2;e+=1)s.push(u[2*e]+u[2*e+1]);return s.filter(((e,t)=>t<l&&e.indexOf(":")>=0)).map((e=>(0,c.isWindows)()?e.substring(e.indexOf(`${a}:`)+a.length+1).trim():e.substring(e.indexOf(":")+1).trim())).map((e=>{try{if(0===e.trim().length)return;const n=parseInt(e.substring(0,e.indexOf(" ")),10),r=e.substring(e.indexOf(":")+1).trim(),i=r.substring(0,r.indexOf(":")).trim(),o=r.substring(r.indexOf(":")+1).trim(),s=t.lineAt(n-1).text,a=s.trim();return{code:i,message:o,column:s.indexOf(a),line:n,type:"",provider:this.info.id}}catch(t){(0,o.traceError)(`Failed to parse pydocstyle line '${e}'`,t)}})).filter((e=>void 0!==e)).map((e=>e))}}t.PyDocStyle=l},10032:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PyLama=void 0,n(32727);const r=n(61684),i=n(95981),o=n(62964);class s extends i.BaseLinter{constructor(e){super(r.Product.pylama,e,1)}async runLinter(e,t){const n=await this.run([e.uri.fsPath],e,t,"(?<file>.py):(?<line>\\d+):(?<column>\\d+):? \\[(?<type>\\w+)\\]( (?<code>\\w\\d+)?:?)? (?<message>.*)\\r?(\\n|$)");return n.forEach((e=>{e.severity=o.LintMessageSeverity.Warning})),n}}t.PyLama=s},16393:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pylint=void 0,n(32727);const r=n(61684),i=n(19735),o=n(95981),s=n(39086),a=n(47677);class c extends o.BaseLinter{constructor(e,t){super(r.Product.pylint,e),this.prompt=t}async runLinter(e,t){if(await this.prompt.showPrompt(),(0,s.isExtensionEnabled)(this.serviceContainer,a.PYLINT_EXTENSION))return(0,i.traceLog)("LINTING: Skipping linting from Python extension, since Pylint extension is installed and enabled."),[];const{uri:n}=e,r=this.configService.getSettings(n),o=[n.fsPath],c=await this.run(o,e,t);return c.forEach((e=>{e.severity=this.parseMessagesSeverity(e.type,r.linting.pylintCategorySeverity)})),c}parseOutputMessage(e,t=0){return e.endColumn?e.endColumn=e.endColumn<=0?0:e.endColumn-t:e.endColumn=void 0,{code:e.symbol,message:e.message,column:null===e.column||e.column<=0?0:e.column-t,line:e.line,type:e.type,provider:this.info.id,endLine:null===e.endLine?void 0:e.endLine,endColumn:e.endColumn}}async parseMessages(e,t,n,r){const o=[];try{const t=JSON.parse(e);for(const e of t){const t=this.parseOutputMessage(e,this.columnOffset);if(t&&(o.push(t),o.length>=this.pythonSettings.linting.maxNumberOfProblems))break}}catch(t){(0,i.traceError)(`Linter '${this.info.id}' failed to parse the output '${e}.`,t)}return o}}t.Pylint=c},52842:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(54273),o=n(68882),s=n(53193),a=n(62964);t.registerTypes=function(e){e.addSingleton(a.ILintingEngine,s.LintingEngine),e.addSingleton(a.ILinterManager,o.LinterManager),e.addSingleton(r.IExtensionActivationService,i.LinterProvider)}},62964:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ILintingEngine=t.LintMessageSeverity=t.ILinterManager=t.LinterId=void 0,(r=t.LinterId||(t.LinterId={})).Flake8="flake8",r.MyPy="mypy",r.PyCodeStyle="pycodestyle",r.Prospector="prospector",r.PyDocStyle="pydocstyle",r.PyLama="pylama",r.PyLint="pylint",r.Bandit="bandit",t.ILinterManager=Symbol("ILinterManager"),(n=t.LintMessageSeverity||(t.LintMessageSeverity={}))[n.Hint=0]="Hint",n[n.Error=1]="Error",n[n.Warning=2]="Warning",n[n.Information=3]="Information",t.ILintingEngine=Symbol("ILintingEngine")},42310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileLogger=void 0;const r=n(73837),i=n(41719);function o(e,...t){return e?`[${e.toUpperCase()} ${(0,i.getTimeForLogging)()}]: ${r.format(...t)}\r\n`:`${r.format(...t)}\r\n`}t.FileLogger=class{constructor(e){this.stream=e}traceLog(...e){this.stream.write(o(void 0,...e))}traceError(...e){this.stream.write(o("error",...e))}traceWarn(...e){this.stream.write(o("warn",...e))}traceInfo(...e){this.stream.write(o("info",...e))}traceVerbose(...e){this.stream.write(o("debug",...e))}dispose(){try{this.stream.close()}catch(e){}}}},19735:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTo=t.traceDecoratorWarn=t.traceDecoratorInfo=t.traceDecoratorError=t.traceDecoratorVerbose=t.traceVerbose=t.traceInfo=t.traceWarn=t.traceError=t.traceLog=t.initializeFileLogging=t.registerLogger=void 0;const r=n(55674),i=n(25472),o=n(70057),s=n(54813),a=n(42310),c=n(49903),l=n(41719),u=c.TraceOptions.Arguments|c.TraceOptions.ReturnValue;let p=[];function d(e){return p.push(e),{dispose:()=>{p=p.filter((t=>t!==e))}}}function h(...e){p.forEach((t=>t.traceError(...e)))}function f(...e){p.forEach((t=>t.traceWarn(...e)))}function g(...e){p.forEach((t=>t.traceInfo(...e)))}function m(...e){p.forEach((t=>t.traceVerbose(...e)))}function v(e){return function(t,n,r){const s=r.value;return r.value=function(...n){const r={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:n},a=this;return function(e,t){const r=new o.StopWatch;try{const t=s.apply(a,n);return(0,i.isPromise)(t)?t.then((t=>(e({elapsed:r.elapsedTime,returnValue:t}),t))).catch((t=>{e({elapsed:r.elapsedTime,err:t})})):e({elapsed:r.elapsedTime,returnValue:t}),t}catch(t){throw e({elapsed:r.elapsedTime,err:t}),t}}((t=>e(r,t)))},r}}function y(e){return v(((t,n)=>function(e,t,n){const r=function(e,t,n){n=function(e){let{kind:t,name:n,args:r}=e;return t&&""!==t||(t="Function"),n&&""!==n||(n="<anon>"),r||(r=[]),{kind:t,name:n,args:r}}(n);const r=[e.message];return r.push(`${n.kind} name = ${n.name}`.trim(),`completed in ${t.elapsed}ms`,`has a ${t.returnValue?"truthy":"falsy"} return value`),(e.opts&c.TraceOptions.Arguments)===c.TraceOptions.Arguments&&r.push((0,l.argsToLogString)(n.args)),(e.opts&c.TraceOptions.ReturnValue)===c.TraceOptions.ReturnValue&&r.push((0,l.returnValueToLogString)(t.returnValue)),r.join(", ")}(e,t,n);void 0===t.err?(!e.level||e.level>c.LogLevel.Error)&&b(c.LogLevel.Info,[r]):(b(c.LogLevel.Error,[r,t.err]),(0,s.sendTelemetryEvent)("ERROR",void 0,void 0,t.err))}(e,n,t)))}function b(e,...t){switch(e){case c.LogLevel.Error:h(...t);break;case c.LogLevel.Warning:f(...t);break;case c.LogLevel.Info:g(...t);break;case c.LogLevel.Debug:m(...t)}}t.registerLogger=d,t.initializeFileLogging=function(e){if(process.env.VSC_PYTHON_LOG_FILE){const t=new a.FileLogger((0,r.createWriteStream)(process.env.VSC_PYTHON_LOG_FILE));e.push(t),e.push(d(t))}},t.traceLog=function(...e){p.forEach((t=>t.traceLog(...e)))},t.traceError=h,t.traceWarn=f,t.traceInfo=g,t.traceVerbose=m,t.traceDecoratorVerbose=function(e,t=u){return y({message:e,opts:t,level:c.LogLevel.Debug})},t.traceDecoratorError=function(e){return y({message:e,opts:u,level:c.LogLevel.Error})},t.traceDecoratorInfo=function(e){return y({message:e,opts:u,level:c.LogLevel.Info})},t.traceDecoratorWarn=function(e){return y({message:e,opts:u,level:c.LogLevel.Warning})},t.logTo=b},4247:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutputChannelLogger=void 0;const r=n(73837);t.OutputChannelLogger=class{constructor(e){this.channel=e}traceLog(...e){this.channel.appendLine(r.format(...e))}traceError(...e){this.channel.error(r.format(...e))}traceWarn(...e){this.channel.warn(r.format(...e))}traceInfo(...e){this.channel.info(r.format(...e))}traceVerbose(...e){this.channel.debug(r.format(...e))}}},49903:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceOptions=t.LogLevel=void 0,(r=t.LogLevel||(t.LogLevel={}))[r.Off=0]="Off",r[r.Trace=1]="Trace",r[r.Debug=2]="Debug",r[r.Info=3]="Info",r[r.Warning=4]="Warning",r[r.Error=5]="Error",(n=t.TraceOptions||(t.TraceOptions={}))[n.None=0]="None",n[n.Arguments=1]="Arguments",n[n.ReturnValue=2]="ReturnValue"},41719:(e,t)=>{"use strict";function n(e,t){if(void 0===e)return"undefined";if(null===e)return"null";try{return e&&e.fsPath?`<Uri:${e.fsPath}>`:JSON.stringify(e)}catch(e){return`<${t} cannot be serialized for logging>`}}Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeForLogging=t.returnValueToLogString=t.argsToLogString=void 0,t.argsToLogString=function(e){if(!e)return"";try{return e.map(((e,t)=>`Arg ${t+1}: ${n(e,"argument")}`)).join(", ")}catch(e){return""}},t.returnValueToLogString=function(e){return`Return Value: ${n(e,"Return value")}`},t.getTimeForLogging=function(){const e=new Date;return`${e.getFullYear()}-${e.getMonth()}-${e.getDate()} ${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`}},65854:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildProposedApi=void 0;const r=n(70301);t.buildProposedApi=function(e,t){let n;try{n={...(0,r.buildDeprecatedProposedApi)(e,t)}}catch(e){n={}}return{...n}}},24674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrCreateISortPrompt=t.ISortExtensionPrompt=t.ISORT_EXTENSION=void 0;const r=n(17585),i=n(61684),o=n(67098),s=n(98638),a=n(50189),c=n(56693),l=n(54813),u=n(61522);t.ISORT_EXTENSION="ms-python.isort";class p{constructor(e){this.serviceContainer=e,this.shownThisSession=!1}async showPrompt(){const e=(0,a.isExtensionEnabled)(t.ISORT_EXTENSION);if(e||(0,a.isExtensionDisabled)(t.ISORT_EXTENSION))return(0,l.sendTelemetryEvent)(u.EventName.TOOLS_EXTENSIONS_ALREADY_INSTALLED,void 0,{extensionId:t.ISORT_EXTENSION,isEnabled:e}),!0;const n=("showISortExtensionPrompt",this.serviceContainer.get(i.IPersistentStateFactory).createWorkspacePersistentState("showISortExtensionPrompt",!1));if(this.shownThisSession||n.value)return!1;(0,l.sendTelemetryEvent)(u.EventName.TOOLS_EXTENSIONS_PROMPT_SHOWN,void 0,{extensionId:t.ISORT_EXTENSION}),this.shownThisSession=!0;const p=await(0,c.showInformationMessage)(o.ToolsExtensions.isortPromptMessage,o.ToolsExtensions.installISortExtension,o.Common.doNotShowAgain);if(p===o.Common.doNotShowAgain)return await n.updateValue(!0),(0,l.sendTelemetryEvent)(u.EventName.TOOLS_EXTENSIONS_PROMPT_DISMISSED,void 0,{extensionId:t.ISORT_EXTENSION,dismissType:"doNotShow"}),!1;if(p===o.ToolsExtensions.installISortExtension){(0,l.sendTelemetryEvent)(u.EventName.TOOLS_EXTENSIONS_INSTALL_SELECTED,void 0,{extensionId:t.ISORT_EXTENSION});const e=this.serviceContainer.get(r.IApplicationEnvironment);return await(0,s.executeCommand)("workbench.extensions.installExtension",t.ISORT_EXTENSION,{installPreReleaseVersion:"insiders"===e.extensionChannel}),!0}return(0,l.sendTelemetryEvent)(u.EventName.TOOLS_EXTENSIONS_PROMPT_DISMISSED,void 0,{extensionId:t.ISORT_EXTENSION,dismissType:"close"}),!1}}let d;t.ISortExtensionPrompt=p,t.getOrCreateISortPrompt=function(e){return d||(d=new p(e)),d}},61673:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LaunchJsonCodeActionProvider=void 0;const r=n(66828);t.LaunchJsonCodeActionProvider=class{provideCodeActions(e,t,n){return n.diagnostics.filter((e=>'Incorrect type. Expected "string".'===e.message)).map((t=>this.createFix(e,t)))}createFix(e,t){const n=`"${e.getText(t.range)}"`,i=new r.CodeAction(`Convert to ${n}`,r.CodeActionKind.QuickFix);return i.edit=new r.WorkspaceEdit,i.edit.replace(e.uri,t.range,n),i}}},76530:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeActionProviderService=void 0;const o=n(86700),s=n(77570),a=n(61684),c=n(98638),l=n(50189),u=n(77498),p=n(19735),d=n(24674),h=n(61673);let f=class{constructor(e,t){this.disposableRegistry=e,this.serviceContainer=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){const e=n(66828);this.disposableRegistry.push(e.languages.registerCodeActionsProvider({scheme:"file",language:"jsonc",pattern:"**/launch.json"},new h.LaunchJsonCodeActionProvider,{providedCodeActionKinds:[e.CodeActionKind.QuickFix]})),this.disposableRegistry.push((0,c.registerCommand)(s.Commands.Sort_Imports,(async()=>{const e=(0,d.getOrCreateISortPrompt)(this.serviceContainer);await e.showPrompt(),(0,l.isExtensionEnabled)(d.ISORT_EXTENSION)?(0,c.executeCommand)("editor.action.organizeImports"):(0,p.traceLog)("Sort Imports: Please install and enable `ms-python.isort` extension to use this feature.")})))}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IDisposableRegistry)),i(1,(0,o.inject)(u.IServiceContainer))],f),t.CodeActionProviderService=f},6342:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonFormattingEditProvider=void 0;const r=n(17585),i=n(77570),o=n(61684),s=n(18639),a=n(64314),c=n(23199),l=n(89027),u=n(57619);t.PythonFormattingEditProvider=class{constructor(e,t){this.formatters=new Map,this.disposables=[],this.documentVersionBeforeFormatting=-1,this.formatterMadeChanges=!1,this.saving=!1;const n=new u.YapfFormatter(t),i=new a.AutoPep8Formatter(t),p=new c.BlackFormatter(t),d=new l.DummyFormatter(t);this.formatters.set(n.Id,n),this.formatters.set(p.Id,p),this.formatters.set(i.Id,i),this.formatters.set(d.Id,d),this.commands=t.get(r.ICommandManager),this.workspace=t.get(r.IWorkspaceService),this.documentManager=t.get(r.IDocumentManager),this.config=t.get(o.IConfigurationService);const h=t.get(s.IInterpreterService);this.disposables.push(this.documentManager.onDidSaveTextDocument((async e=>this.onSaveDocument(e)))),this.disposables.push(h.onDidChangeInterpreter((async()=>{if(this.documentManager.activeTextEditor)return this.onSaveDocument(this.documentManager.activeTextEditor.document)})))}dispose(){this.disposables.forEach((e=>e.dispose()))}provideDocumentFormattingEdits(e,t,n){return this.provideDocumentRangeFormattingEdits(e,void 0,t,n)}async provideDocumentRangeFormattingEdits(e,t,n,r){if(this.saving||e.languageId!==i.PYTHON_LANGUAGE)return[];!0===this.workspace.getConfiguration("editor",e.uri).get("formatOnSave")&&(this.documentVersionBeforeFormatting=e.version);const o=this.config.getSettings(e.uri),s=this.formatters.get(o.formatting.provider),a=await s.formatDocument(e,n,r,t);return this.formatterMadeChanges=a.length>0,a}async onSaveDocument(e){setTimeout((()=>{try{this.formatterMadeChanges&&!e.isDirty&&e.version===this.documentVersionBeforeFormatting&&this.commands.executeCommand("editor.action.formatDocument").then((async()=>{this.saving=!0,await e.save(),this.saving=!1}))}finally{this.documentVersionBeforeFormatting=-1,this.saving=!1,this.formatterMadeChanges=!1}}),50)}}},54273:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinterProvider=void 0;const o=n(86700),s=n(71017),a=n(66828),c=n(17585),l=n(77570);n(32727);const u=n(84974),p=n(61684),d=n(18639),h=n(77498),f=n(62964);let g=class{constructor(e){this.serviceContainer=e,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.disposables=[],this.activatedOnce=!1,this.serviceContainer=e,this.fs=this.serviceContainer.get(u.IFileSystem),this.engine=this.serviceContainer.get(f.ILintingEngine),this.linterManager=this.serviceContainer.get(f.ILinterManager),this.interpreterService=this.serviceContainer.get(d.IInterpreterService),this.documents=this.serviceContainer.get(c.IDocumentManager),this.configuration=this.serviceContainer.get(p.IConfigurationService),this.workspaceService=this.serviceContainer.get(c.IWorkspaceService)}async activate(){if(this.activatedOnce)return;this.activatedOnce=!0,this.disposables.push(this.interpreterService.onDidChangeInterpreter((()=>this.engine.lintOpenPythonFiles()))),this.documents.onDidOpenTextDocument((e=>this.onDocumentOpened(e)),this.disposables),this.documents.onDidCloseTextDocument((e=>this.onDocumentClosed(e)),this.disposables),this.documents.onDidSaveTextDocument((e=>this.onDocumentSaved(e)),this.disposables);const e=this.workspaceService.onDidChangeConfiguration(this.lintSettingsChangedHandler.bind(this));if(this.disposables.push(e),!(0,l.isTestExecution)()){const e=setTimeout((()=>this.engine.lintOpenPythonFiles().ignoreErrors()),1200);this.disposables.push({dispose:()=>clearTimeout(e)})}}dispose(){this.disposables.forEach((e=>e.dispose()))}isDocumentOpen(e){return this.documents.textDocuments.some((t=>this.fs.arePathsSame(t.uri.fsPath,e.fsPath)))}lintSettingsChangedHandler(e){a.workspace.textDocuments.forEach((t=>{e.affectsConfiguration("python.linting",t.uri)&&this.engine.lintDocument(t,"auto").ignoreErrors()}))}onDocumentOpened(e){this.engine.lintDocument(e,"auto").ignoreErrors()}onDocumentSaved(e){const t=this.configuration.getSettings(e.uri);"python"===e.languageId&&t.linting.enabled&&t.linting.lintOnSave?this.engine.lintDocument(e,"save").ignoreErrors():this.linterManager.getActiveLinters(e.uri).then((t=>{const n=s.basename(e.uri.fsPath).toLowerCase();t.filter((e=>e.configFileNames.indexOf(n)>=0)).length>0&&setTimeout((()=>this.engine.lintOpenPythonFiles()),1e3)})).ignoreErrors()}onDocumentClosed(e){e&&e.fileName&&e.uri&&(this.isDocumentOpen(e.uri)||this.engine.clearDiagnostics(e))}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(h.IServiceContainer))],g),t.LinterProvider=g},63462:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerInstallFormatterPrompt=t.InstallFormatterPrompt=void 0;const o=n(86700),s=n(61684),a=n(67098),c=n(50189),l=n(56693),u=n(85261),p=n(77498),d=n(4240),h=n(39337);let f=class{constructor(e){this.serviceContainer=e,this.currentlyShown=!1}async showInstallFormatterPrompt(e){if(!(0,d.inFormatterExtensionExperiment)(this.serviceContainer))return!1;const t=(0,d.doNotShowPromptState)("showFormatterExtensionInstallPrompt",this.serviceContainer);if(this.currentlyShown||t.value)return!1;const n=(0,u.getConfiguration)("python",e).get("formatting.provider","none");if(!["autopep8","black"].includes(n))return!1;const r=(0,u.getConfiguration)("editor",{uri:e,languageId:"python"}).get("defaultFormatter","");if([h.BLACK_EXTENSION,h.AUTOPEP8_EXTENSION].includes(r))return!1;const i=(0,c.isExtensionEnabled)(h.BLACK_EXTENSION),o=(0,c.isExtensionEnabled)(h.AUTOPEP8_EXTENSION);let s;i||o?(this.currentlyShown=!0,i&&o?s=await(0,l.showInformationMessage)(a.ToolsExtensions.selectMultipleFormattersPrompt,"Black","Autopep8",a.Common.doNotShowAgain):i?(s=await(0,l.showInformationMessage)(a.ToolsExtensions.selectBlackFormatterPrompt,a.Common.bannerLabelYes,a.Common.doNotShowAgain),s===a.Common.bannerLabelYes&&(s="Black")):o&&(s=await(0,l.showInformationMessage)(a.ToolsExtensions.selectAutopep8FormatterPrompt,a.Common.bannerLabelYes,a.Common.doNotShowAgain),s===a.Common.bannerLabelYes&&(s="Autopep8"))):"black"!==n||i?"autopep8"!==n||o||(this.currentlyShown=!0,s=await(0,l.showInformationMessage)(a.ToolsExtensions.installAutopep8FormatterPrompt,"Black","Autopep8",a.Common.doNotShowAgain)):(this.currentlyShown=!0,s=await(0,l.showInformationMessage)(a.ToolsExtensions.installBlackFormatterPrompt,"Black","Autopep8",a.Common.doNotShowAgain));let p=!1;return"Black"===s?i?(p=!0,await(0,d.updateDefaultFormatter)(h.BLACK_EXTENSION,e)):(p=!0,await(0,d.installFormatterExtension)(h.BLACK_EXTENSION,e)):"Autopep8"===s?o?(p=!0,await(0,d.updateDefaultFormatter)(h.AUTOPEP8_EXTENSION,e)):(p=!0,await(0,d.installFormatterExtension)(h.AUTOPEP8_EXTENSION,e)):s===a.Common.doNotShowAgain?(p=!1,await t.updateValue(!0)):p=!1,this.currentlyShown=!1,p}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer))],f),t.InstallFormatterPrompt=f,t.registerInstallFormatterPrompt=function(e){const t=e.get(s.IDisposableRegistry),n=e.get(h.IInstallFormatterPrompt);t.push((0,u.onDidSaveTextDocument)((async e=>{const t=(0,u.getConfiguration)("editor",{uri:e.uri,languageId:"python"});"python"===e.languageId&&t.get("formatOnSave")&&await n.showInstallFormatterPrompt(e.uri)})))}},4240:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.installFormatterExtension=t.updateDefaultFormatter=t.doNotShowPromptState=t.inFormatterExtensionExperiment=void 0;const r=n(66828),i=n(60717),o=n(61684),s=n(98638),a=n(50189),c=n(85261);async function l(e,t){const n=(0,c.getWorkspaceFolder)(t)?r.ConfigurationTarget.Workspace:r.ConfigurationTarget.Global,i=(0,c.getConfiguration)("python",t),o=(0,c.getConfiguration)("editor",{uri:t,languageId:"python"});await o.update("defaultFormatter",e,n,!0),await i.update("formatting.provider","none",n)}t.inFormatterExtensionExperiment=function(e){return e.get(o.IExperimentService).inExperimentSync(i.ShowFormatterExtensionPrompt.experiment)},t.doNotShowPromptState=function(e,t){return t.get(o.IPersistentStateFactory).createWorkspacePersistentState(e,!1)},t.updateDefaultFormatter=l,t.installFormatterExtension=async function(e,t){await(0,s.executeCommand)("workbench.extensions.installExtension",e,{installPreReleaseVersion:(0,a.isInsider)()}),await l(e,t)}},39337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IInstallFormatterPrompt=t.AUTOPEP8_EXTENSION=t.BLACK_EXTENSION=void 0,t.BLACK_EXTENSION="ms-python.black-formatter",t.AUTOPEP8_EXTENSION="ms-python.autopep8",t.IInstallFormatterPrompt=Symbol("IInstallFormatterPrompt")},76687:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ReplProvider=void 0;const i=n(17585),o=n(77570),s=n(3481),a=n(18639),c=n(54813),l=n(61522),u=n(43200);class p{constructor(e){this.serviceContainer=e,this.disposables=[],this.activeResourceService=this.serviceContainer.get(i.IActiveResourceService),this.registerCommand()}dispose(){this.disposables.forEach((e=>e.dispose()))}registerCommand(){const e=this.serviceContainer.get(i.ICommandManager).registerCommand(o.Commands.Start_REPL,this.commandHandler,this);this.disposables.push(e)}async commandHandler(){const e=this.activeResourceService.getActiveResource(),t=this.serviceContainer.get(a.IInterpreterService);if(!await t.getActiveInterpreter(e))return void this.serviceContainer.get(i.ICommandManager).executeCommand(o.Commands.TriggerEnvironmentSelection,e).then(s.noop,s.noop);const n=this.serviceContainer.get(u.ICodeExecutionService,"repl");await n.initializeRepl(e)}}r([(0,c.captureTelemetry)(l.EventName.REPL)],p.prototype,"commandHandler",null),t.ReplProvider=p},43768:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(76530),o=n(63462),s=n(39337);t.registerTypes=function(e){e.addSingleton(r.IExtensionSingleActivationService,i.CodeActionProviderService),e.addSingleton(s.IInstallFormatterPrompt,o.InstallFormatterPrompt)}},8593:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalProvider=void 0;const i=n(17585),o=n(77570),s=n(46747),a=n(58400),c=n(61684),l=n(36952),u=n(54813),p=n(61522);class d{constructor(e){this.serviceContainer=e,this.disposables=[],this.registerCommands(),this.activeResourceService=this.serviceContainer.get(i.IActiveResourceService)}async initialize(e){const t=this.serviceContainer.get(c.IConfigurationService),n=this.serviceContainer.get(c.IExperimentService),r=t.getSettings(this.activeResourceService.getActiveResource());if(e&&r.terminal.activateEnvInCurrentTerminal&&!(0,s.inTerminalEnvVarExperiment)(n)){const t="hideFromUser"in e.creationOptions&&e.creationOptions.hideFromUser;if(!t){const t=this.serviceContainer.get(a.ITerminalActivator);await t.activateEnvironmentInTerminal(e,{preserveFocus:!0})}(0,u.sendTelemetryEvent)(p.EventName.ACTIVATE_ENV_IN_CURRENT_TERMINAL,void 0,{isTerminalVisible:!t})}}dispose(){this.disposables.forEach((e=>e.dispose()))}registerCommands(){const e=this.serviceContainer.get(i.ICommandManager).registerCommand(o.Commands.Create_Terminal,this.onCreateTerminal,this);this.disposables.push(e)}async onCreateTerminal(){const e=this.serviceContainer.get(a.ITerminalServiceFactory),t=this.activeResourceService.getActiveResource();await e.createTerminalService(t,"Python").show(!1)}}r([(0,l.swallowExceptions)("Failed to initialize terminal provider")],d.prototype,"initialize",null),r([(0,u.captureTelemetry)(p.EventName.TERMINAL_CREATE,{triggeredBy:"commandpalette"})],d.prototype,"onCreateTerminal",null),t.TerminalProvider=d},11069:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPythonEnvironments=void 0;class n{constructor(e){this.getLocator=e}async activate(){this.locator=await this.getLocator()}get onProgress(){return this.locator.onProgress}get refreshState(){return this.locator.refreshState}getRefreshPromise(e){return this.locator.getRefreshPromise(e)}get onChanged(){return this.locator.onChanged}getEnvs(e){return this.locator.getEnvs(e)}async resolveEnv(e){return this.locator.resolveEnv(e)}async triggerRefresh(e,t){return this.locator.triggerRefresh(e,t)}}t.createPythonEnvironments=async function(e){const t=new n(e);return await t.activate(),t}},44773:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparePythonVersionSpecificity=t.areSameEnv=t.getEnvID=t.getEnvPath=t.setEnvDisplayString=t.copyEnvInfo=t.areEnvsDeepEqual=t.buildEnvInfo=void 0;const r=n(96486),i=n(71017),o=n(3522),s=n(87450),a=n(37769),c=n(24563),l=n(95084),u=n(45878);function p(e,t){void 0!==t.kind&&(e.kind=t.kind),void 0!==t.executable&&(e.executable.filename=t.executable),void 0!==t.location&&(e.location=t.location),void 0!==t.version&&(e.version=t.version),void 0!==t.searchLocation&&(e.searchLocation=t.searchLocation),void 0!==t.type&&(e.type=t.type)}function d(e,t=!1){const n=t||e.searchLocation||u.globallyInstalledEnvKinds.includes(e.kind),r=!u.virtualEnvKinds.includes(e.kind),i=["Python"];if(e.version&&!(0,l.isVersionEmpty)(e.version)&&i.push((0,l.getVersionDisplayString)(e.version)),r){const t=(0,o.getArchitectureDisplayName)(e.arch);""!==t&&i.push(t)}const s=[];if(e.name&&""!==e.name&&s.push(`'${e.name}'`),n){const t=(0,c.getKindDisplayName)(e.kind);""!==t&&s.push(t)}const a=0===s.length?"":`(${s.join(": ")})`;return`${i.join(" ")} ${a}`.trim()}function h(e){if("string"==typeof e){if(""===e)return;return{id:"",executable:{filename:e,sysPrefix:"",ctime:-1,mtime:-1}}}return"executablePath"in e?{id:"",executable:{filename:e.executablePath,sysPrefix:"",ctime:-1,mtime:-1},location:e.envPath,kind:e.kind,source:e.source}:e}function f(e,t){let n={path:e,pathType:"interpreterPath"};return t&&!(0,a.isParentPath)(e,t)&&(n={path:t,pathType:"envFolderPath"}),n}function g(e,t){return(0,a.normCasePath)(f(e,t).path)}function m(e){var t,n;let r=0;return e.major>0&&(r+=20),e.minor>=0&&(r+=10),e.micro>=0&&(r+=5),(null===(t=e.release)||void 0===t?void 0:t.level)&&(r+=3),((null===(n=e.release)||void 0===n?void 0:n.serial)||e.sysVersion)&&(r+=1),r}t.buildEnvInfo=function(e){var t,n,r,i,o,a,c,l,d;const h={name:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",location:"",kind:u.PythonEnvKind.Unknown,executable:{filename:"",sysPrefix:null!==(n=null==e?void 0:e.sysPrefix)&&void 0!==n?n:"",ctime:null!==(i=null===(r=null==e?void 0:e.fileInfo)||void 0===r?void 0:r.ctime)&&void 0!==i?i:-1,mtime:null!==(a=null===(o=null==e?void 0:e.fileInfo)||void 0===o?void 0:o.mtime)&&void 0!==a?a:-1},searchLocation:void 0,display:null==e?void 0:e.display,version:{major:-1,minor:-1,micro:-1,release:{level:u.PythonReleaseLevel.Final,serial:0}},arch:null!==(c=null==e?void 0:e.arch)&&void 0!==c?c:s.Architecture.Unknown,distro:{org:null!==(l=null==e?void 0:e.org)&&void 0!==l?l:""},source:null!==(d=null==e?void 0:e.source)&&void 0!==d?d:[]};return void 0!==e&&p(h,e),h.id=g(h.executable.filename,h.location),h},t.areEnvsDeepEqual=function(e,t){var n,i,o,s,c,l,u,p;const d=(0,r.cloneDeep)(e),h=(0,r.cloneDeep)(t);delete d.searchLocation,delete h.searchLocation,d.source=d.source.sort(),h.source=h.source.sort();const f=null!==(i=null===(n=e.searchLocation)||void 0===n?void 0:n.fsPath)&&void 0!==i?i:"",g=null!==(s=null===(o=t.searchLocation)||void 0===o?void 0:o.fsPath)&&void 0!==s?s:"",m=null!==(l=null===(c=e.searchLocation)||void 0===c?void 0:c.scheme)&&void 0!==l?l:"",v=null!==(p=null===(u=t.searchLocation)||void 0===u?void 0:u.scheme)&&void 0!==p?p:"";return(0,r.isEqual)(d,h)&&(0,a.arePathsSame)(f,g)&&m===v},t.copyEnvInfo=function(e,t){const n=(0,r.cloneDeep)(e);return void 0!==t&&p(n,t),n},t.setEnvDisplayString=function(e){e.display=d(e),e.detailedDisplayName=d(e,!0)},t.getEnvPath=f,t.getEnvID=g,t.areSameEnv=function(e,t,n=!0){const r=h(e),o=h(t);if(void 0===r||void 0===o)return;const s=r.executable.filename,c=o.executable.filename;if(r.id&&r.id===o.id)return!0;if(g(s,r.location)===g(c,o.location))return!0;if(n&&"python"!==s&&"python"!==c&&(0,a.arePathsSame)(i.dirname(s),i.dirname(c))){const n="string"==typeof e?void 0:r.version,i="string"==typeof t?void 0:o.version;if(n&&i&&((0,l.areIdenticalVersion)(n,i)||(0,l.areSimilarVersions)(n,i)))return!0}return!1},t.comparePythonVersionSpecificity=function(e,t){return Math.sign(m(e)-m(t))}},24563:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrioritizedEnvKinds=t.getKindDisplayName=void 0;const r=n(45878);t.getKindDisplayName=function(e){for(const[t,n]of[[r.PythonEnvKind.System,"system"],[r.PythonEnvKind.MicrosoftStore,"microsoft store"],[r.PythonEnvKind.Pyenv,"pyenv"],[r.PythonEnvKind.Poetry,"poetry"],[r.PythonEnvKind.Custom,"custom"],[r.PythonEnvKind.Venv,"venv"],[r.PythonEnvKind.VirtualEnv,"virtualenv"],[r.PythonEnvKind.VirtualEnvWrapper,"virtualenv"],[r.PythonEnvKind.Pipenv,"pipenv"],[r.PythonEnvKind.Conda,"conda"],[r.PythonEnvKind.ActiveState,"ActiveState"]])if(e===t)return n;return""},t.getPrioritizedEnvKinds=function(){return[r.PythonEnvKind.Pyenv,r.PythonEnvKind.Conda,r.PythonEnvKind.MicrosoftStore,r.PythonEnvKind.Pipenv,r.PythonEnvKind.Poetry,r.PythonEnvKind.Venv,r.PythonEnvKind.VirtualEnvWrapper,r.PythonEnvKind.VirtualEnv,r.PythonEnvKind.ActiveState,r.PythonEnvKind.OtherVirtual,r.PythonEnvKind.OtherGlobal,r.PythonEnvKind.System,r.PythonEnvKind.Custom,r.PythonEnvKind.Unknown]}},67931:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvironmentInfoService=t.EnvironmentInfoServiceQueuePriority=void 0;const r=n(59314),i=n(97749),o=n(67029),s=n(24708),a=n(19735),c=n(75470),l=n(45878),u=n(37769),p=n(4057),d=n(87450),h=n(95084);var f;async function g(e,t=!0){const n=[e.executable.filename];return t?n.push("-I",p.OUTPUT_MARKER_SCRIPT):n.push(p.OUTPUT_MARKER_SCRIPT),await(0,o.getInterpreterInfo)((0,s.buildPythonExecInfo)(n,void 0,e.executable.filename))}async function m(e){const t=await c.Conda.getConda(),n=e.location.length?e.location:e.executable.filename,r=await(null==t?void 0:t.getCondaEnvironment(n));if(!r)return;const i=await(null==t?void 0:t.getRunPythonArgs(r,!0,!0));return i?await(0,o.getInterpreterInfo)((0,s.buildPythonExecInfo)(i,void 0,e.executable.filename),c.CONDA_ACTIVATION_TIMEOUT):void 0}!function(e){e[e.Default=0]="Default",e[e.High=1]="High"}(f=t.EnvironmentInfoServiceQueuePriority||(t.EnvironmentInfoServiceQueuePriority={}));class v{constructor(){this.cache=new Map}dispose(){void 0!==this.workerPool&&(this.workerPool.stop(),this.workerPool=void 0),void 0!==this.condaRunWorkerPool&&(this.condaRunWorkerPool.stop(),this.condaRunWorkerPool=void 0)}async getEnvironmentInfo(e,t){const n=e.executable.filename,i=this.cache.get((0,u.normCasePath)(n));if(void 0!==i)return i.promise;const o=(0,r.createDeferred)();return this.cache.set((0,u.normCasePath)(n),o),this._getEnvironmentInfo(e,t).then((e=>{o.resolve(e)})).catch((e=>{o.reject(e)})),o.promise}async _getEnvironmentInfo(e,t,n=!0){if(e.kind===l.PythonEnvKind.Conda&&"python"===e.executable.filename)return{arch:d.Architecture.Unknown,executable:{filename:"python",ctime:-1,mtime:-1,sysPrefix:""},version:(0,h.getEmptyVersion)()};let o;void 0===this.workerPool&&(this.workerPool=(0,i.createRunningWorkerPool)(g));let s=await y(this.workerPool,e,t).catch((e=>{o=e}));if(void 0===s)if(e.kind===l.PythonEnvKind.Conda||await(0,c.isCondaEnvironment)(e.executable.filename))(0,a.traceVerbose)(`Validating ${e.executable.filename} normally failed with error, falling back to using conda run: (${o})`),void 0===this.condaRunWorkerPool&&(this.condaRunWorkerPool=(0,i.createRunningWorkerPool)(m)),s=await y(this.condaRunWorkerPool,e,t).catch((e=>{(0,a.traceError)(e)}));else if(o){if(o.message.includes("Unknown option: -I")||o.message.includes("ModuleNotFoundError: No module named 'encodings'"))return(0,a.traceWarn)(o),o.message.includes("Unknown option: -I")&&(0,a.traceError)("Support for Python 2.7 has been dropped by the Python extension so certain features may not work, upgrade to using Python 3."),g(e,!1).catch((e=>{(0,a.traceError)(e)}));(0,a.traceError)(o)}return void 0===s&&n?(0,r.sleep)(2e3).then((()=>this._getEnvironmentInfo(e,t,!1))):s}resetInfo(e){const t=e.fsPath;Array.from(this.cache.keys()).forEach((e=>{e.startsWith((0,u.normCasePath)(t))&&this.cache.delete(e)}))}}function y(e,t,n){return n===f.High?e.addToQueue(t,i.QueuePosition.Front):e.addToQueue(t,i.QueuePosition.Back)}let b;t.getEnvironmentInfoService=function(e){if(void 0===b){const t=new v;null==e||e.push({dispose:()=>{t.dispose(),b=void 0}}),b=t}return b}},82035:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseVersionFromExecutable=void 0;const r=n(71017),i=n(87450),o=n(95084),s=n(37769);t.parseVersionFromExecutable=function(e){const t=function(e){if(e=(0,s.normCasePath)(e),(0,i.getOSType)()===i.OSType.Windows){if("python.exe"===e)return(0,o.getEmptyVersion)()}else if("python"===e)return(0,o.parseVersion)("2.7");if(!e.startsWith("python"))throw Error(`not a Python executable (expected "python..", got "${e}")`);return(0,o.parseVersion)(e)}(r.basename(e));return 2===t.major&&-1===t.minor&&(t.minor=7),t}},45878:(e,t)=>{"use strict";var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.UNKNOWN_PYTHON_VERSION=t.PythonReleaseLevel=t.PythonEnvSource=t.globallyInstalledEnvKinds=t.virtualEnvKinds=t.PythonEnvType=t.PythonEnvKind=void 0,function(e){e.Unknown="unknown",e.System="global-system",e.MicrosoftStore="global-microsoft-store",e.Pyenv="global-pyenv",e.Poetry="poetry",e.ActiveState="activestate",e.Custom="global-custom",e.OtherGlobal="global-other",e.Venv="virt-venv",e.VirtualEnv="virt-virtualenv",e.VirtualEnvWrapper="virt-virtualenvwrapper",e.Pipenv="virt-pipenv",e.Conda="virt-conda",e.OtherVirtual="virt-other"}(n=t.PythonEnvKind||(t.PythonEnvKind={})),(o=t.PythonEnvType||(t.PythonEnvType={})).Conda="Conda",o.Virtual="Virtual",t.virtualEnvKinds=[n.Poetry,n.Pipenv,n.Venv,n.VirtualEnvWrapper,n.Conda,n.VirtualEnv],t.globallyInstalledEnvKinds=[n.OtherGlobal,n.Unknown,n.MicrosoftStore,n.System,n.Custom],(i=t.PythonEnvSource||(t.PythonEnvSource={})).PathEnvVar="path env var",i.WindowsRegistry="windows registry",function(e){e.Alpha="alpha",e.Beta="beta",e.Candidate="candidate",e.Final="final"}(r=t.PythonReleaseLevel||(t.PythonReleaseLevel={})),t.UNKNOWN_PYTHON_VERSION={major:-1,minor:-1,micro:-1,release:{level:r.Final,serial:-1},sysVersion:void 0},Object.freeze(t.UNKNOWN_PYTHON_VERSION)},67029:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInterpreterInfo=void 0;const r=n(77570),i=n(4057),o=n(87450),s=n(19735),a=n(37769),c=n(24708),l=n(95084);t.getInterpreterInfo=async function(e,t){const[n,u]=(0,i.interpreterInfo)(),p=(0,c.copyPythonExecInfo)(e,n),d=[p.command,...p.args].reduce(((e,t)=>e?`${e} ${t.toCommandArgumentForPythonExt()}`:`${t.toCommandArgumentForPythonExt()}`),""),h=r.isCI?3e4:15e3,f=await(0,a.shellExecute)(d,{timeout:null!=t?t:h});let g;f.stderr&&(0,s.traceError)(`Stderr when executing script with >> ${d} << stderr: ${f.stderr}, still attempting to parse output`);try{g=u(f.stdout)}catch(e){return void(0,s.traceError)(`Failed to parse interpreter information for >> ${d} << with ${e}`)}return(0,s.traceVerbose)(`Found interpreter for >> ${d} <<: ${JSON.stringify(g)}`),function(e,t){let n=`${t.versionInfo.slice(0,3).join(".")}`;if(void 0!==t.versionInfo[3]&&["final","alpha","beta","candidate"].includes(t.versionInfo[3])&&(n=`${n}-${t.versionInfo[3]}`,void 0!==t.versionInfo[4])){let e=-1;try{e=parseInt(`${t.versionInfo[4]}`,10)}catch(t){e=-1}n=e>=0?`${n}${e}`:n}return{arch:t.is64Bit?o.Architecture.x64:o.Architecture.x86,executable:{filename:e,sysPrefix:t.sysPrefix,mtime:-1,ctime:-1},version:{...(0,l.parseVersion)(n),sysVersion:t.sysVersion}}}(e.pythonExecutable,g)}},95084:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareSemVerLikeVersions=t.toSemverLikeVersion=t.areSimilarVersions=t.areIdenticalVersion=t.getShortVersionString=t.getVersionDisplayString=t.isVersionEmpty=t.getEmptyVersion=t.parseBasicVersion=t.parseRelease=t.parseVersion=t.getPythonVersionFromPath=void 0;const r=n(96486),i=n(71017),o=n(52439),s=n(45878),a=n(19735);function c(e){const[t,n]=u(e);if(-1===t.micro)return t;const[r]=l(n);return t.release=r,t}function l(e){let t,n,r,i,o,a,c,l=e.match(/^(?:-?final|\.final(?:\.0)?)(.*)$/);if(l)[,t]=l,o="final",a="0";else for(const o of[/^(?:(a)|(b)|(rc))([1-9]\d*)(.*)$/,/^-(?:(?:(alpha)|(beta)|(candidate))([1-9]\d*))(.*)$/,/^\.(?:(?:(alpha)|(beta)|(candidate))\.([1-9]\d*))(.*)$/])if(l=e.match(o),l){[,n,r,i,a,t]=l;break}if(o)c=s.PythonReleaseLevel.Final;else if(i)c=s.PythonReleaseLevel.Candidate;else if(r)c=s.PythonReleaseLevel.Beta;else{if(!n)return[void 0,e];c=s.PythonReleaseLevel.Alpha}return[{level:c,serial:parseInt(a,10)},t]}function u(e){const t=o.parseBasicVersionInfo(`ignored-${e}`);if(!t){if(""===e)return[p(),""];throw Error(`invalid version ${e}`)}const{version:n,after:r}=t;if(n.release=void 0,-1===n.minor&&n.major>9){const e=10**(n.major.toString().length-1);n.minor=n.major%e,n.major=Math.floor(n.major/e)}return[n,r]}function p(){return(0,r.cloneDeep)(o.EMPTY_VERSION)}function d(e){return o.isVersionInfoEmpty(e)}function h(e){let t=o.getVersionString(e);if(void 0===e.release)return t;if(e.release.level===s.PythonReleaseLevel.Final)return t;if(e.release.level===s.PythonReleaseLevel.Candidate)t=`${t}rc${e.release.serial}`;else if(e.release.level===s.PythonReleaseLevel.Beta)t=`${t}b${e.release.serial}`;else{if(e.release.level!==s.PythonReleaseLevel.Alpha)throw Error(`unsupported release level ${e.release.level}`);t=`${t}a${e.release.serial}`}return t}function f(e,t){return void 0===e.release?void 0===t.release?[0,""]:[1,"level"]:void 0===t.release?[-1,"level"]:e.release.level<t.release.level?[1,"level"]:e.release.level>t.release.level?[-1,"level"]:e.release.level===s.PythonReleaseLevel.Final?[0,""]:e.release.serial<t.release.serial?[1,"serial"]:e.release.serial>t.release.serial?[-1,"serial"]:[0,""]}t.getPythonVersionFromPath=function(e){let t=s.UNKNOWN_PYTHON_VERSION;try{t=c(i.basename(e))}catch(t){(0,a.traceError)(`Failed to parse version from path: ${e}`,t)}return t},t.parseVersion=c,t.parseRelease=l,t.parseBasicVersion=u,t.getEmptyVersion=p,t.isVersionEmpty=d,t.getVersionDisplayString=function(e){return d(e)?"":-1!==e.micro?h(e):`${h(e)}.x`},t.getShortVersionString=h,t.areIdenticalVersion=function(e,t){return o.areIdenticalVersion(e,t,f)},t.areSimilarVersions=function(e,t){return!!o.areSimilarVersions(e,t,f)&&(2===e.major||e.minor>-1&&t.minor>-1)},t.toSemverLikeVersion=function(e){const t=o.getVersionString(e);let n=[];return e.release&&(n=e.release.serial<0?[`${e.release.level}`]:[`${e.release.level}`,`${e.release.serial}`]),{raw:t,major:e.major,minor:e.minor,patch:e.micro,build:[],prerelease:n}},t.compareSemVerLikeVersions=function(e,t){return e.major===t.major?e.minor===t.minor?e.patch===t.patch?0:e.patch>t.patch?1:-1:e.minor>t.minor?1:-1:e.major>t.major?1:-1}},44538:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Locator=t.NOOP_ITERATOR=t.isProgressEvent=t.ProgressReportStage=void 0;const r=n(59314),i=n(34354);var o;(o=t.ProgressReportStage||(t.ProgressReportStage={})).discoveryStarted="discoveryStarted",o.allPathsDiscovered="allPathsDiscovered",o.discoveryFinished="discoveryFinished",t.isProgressEvent=function(e){return"stage"in e},t.NOOP_ITERATOR=(0,r.iterEmpty)(),t.Locator=class extends class{constructor(e){this.emitter=e,this.onChanged=e.onChanged}}{constructor(){super(new i.PythonEnvsWatcher)}}},69270:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvs=t.getQueryFilter=void 0;const r=n(59314),i=n(3481),o=n(19735),s=n(44538);t.getQueryFilter=function(e){var t;const n=void 0!==e.kinds&&e.kinds.length>0?e.kinds:void 0,r=!(null===(t=e.searchLocations)||void 0===t?void 0:t.doNotIncludeNonRooted),o=function(e){if(void 0!==e.searchLocations)return 0===e.searchLocations.roots.length?[]:e.searchLocations.roots.map((e=>(0,i.getURIFilter)(e,{checkParent:!0})))}(e);return e=>!!function(e){return void 0===n||n.includes(e.kind)}(e)&&!!function(e){if(void 0===e.searchLocation)return r;const t=e.searchLocation;return void 0===o||o.some((e=>e(t)))}(e)},t.getEnvs=async function(e){const t=[],n=(0,r.createDeferred)();if(void 0===e.onUpdated)n.resolve();else{const r=e.onUpdated((e=>{if((0,s.isProgressEvent)(e)){if(e.stage!==s.ProgressReportStage.discoveryFinished)return;n.resolve(),r.dispose()}else{const{index:n,update:r}=e;if(void 0===t[n]){const e=JSON.stringify(r);(0,o.traceVerbose)(`Updates sent for an env which was classified as invalid earlier, currently not expected, ${e}`)}t[n]=r}}))}let i=0;for await(const n of e)void 0===t[i]&&(t[i]=n),i+=1;return await n.promise,t.filter((e=>void 0!==e)).map((e=>e))}},2839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Locators=t.combineIterators=void 0;const r=n(59314),i=n(81837),o=n(44538),s=n(38514);function a(e){const t=(0,r.chain)(e),n=e.map((e=>e.onUpdated)).filter((e=>e));return n&&0!==n.length?(t.onUpdated=e=>{const t=new i.Disposables;let r=n.length;return n.forEach((n=>{const i=n((t=>{(0,o.isProgressEvent)(t)?t.stage===o.ProgressReportStage.discoveryFinished?(r-=1,0===r&&e({stage:o.ProgressReportStage.discoveryFinished})):e({stage:t.stage}):e(t)}));t.push(i)})),t},t):t}t.combineIterators=a;class c extends s.PythonEnvsWatchers{constructor(e){super(e),this.locators=e,this.providerId=e.map((e=>e.providerId)).join("+")}iterEnvs(e){return a(this.locators.map((t=>t.iterEnvs(e))))}}t.Locators=c},77882:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LazyResourceBasedLocator=void 0;const r=n(59314),i=n(81837),o=n(19735),s=n(37769),a=n(44773),c=n(44538);class l extends c.Locator{constructor(){super(...arguments),this.disposables=new i.Disposables}async activate(){await this.ensureResourcesReady(),this.ensureWatchersReady().ignoreErrors()}async dispose(){await this.disposables.dispose()}async*iterEnvs(e){await this.activate();const t=this.doIterEnvs(e);if(null==e?void 0:e.envPath){let n=await t.next();for(;!n.done;){const r=n.value,{path:i}=(0,a.getEnvPath)(r.executablePath,r.envPath);if((0,s.arePathsSame)(i,e.envPath)){yield r;break}n=await t.next()}}else yield*t}async initResources(){}async initWatchers(){}async ensureResourcesReady(){void 0===this.resourcesReady?(this.resourcesReady=(0,r.createDeferred)(),await this.initResources().catch((e=>{var t;(0,o.traceError)(e),null===(t=this.resourcesReady)||void 0===t||t.reject(e)})),this.resourcesReady.resolve()):await this.resourcesReady.promise}async ensureWatchersReady(){void 0===this.watchersReady?(this.watchersReady=(0,r.createDeferred)(),(0,s.isVirtualWorkspace)()||await this.initWatchers().catch((e=>{var t;(0,o.traceError)(e),null===(t=this.watchersReady)||void 0===t||t.reject(e)})),this.watchersReady.resolve()):await this.watchersReady.promise}}t.LazyResourceBasedLocator=l},97954:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCollectionCache=t.PythonEnvInfoCache=void 0;const r=n(77570),i=n(19735),o=n(37769),s=n(45878),a=n(44773),c=n(34354),l=n(75470);class u extends c.PythonEnvsWatcher{constructor(e){super(),this.persistentStorage=e,this.envs=[],this.validatedEnvs=new Set,this.flushedEnvs=new Set}async validateCache(e,t){(await Promise.all(this.envs.map((async n=>{const{path:r}=(0,a.getEnvPath)(n.executable.filename,n.location);if(await(0,o.pathExists)(r)){if(!e||!t)return!0;if(n.searchLocation)return!0;if(e.some((e=>n.id===e.id)))return!0;if(Array.from(this.validatedEnvs.keys()).some((e=>n.id===e)))return!0}return!1})))).map(((e,t)=>e?-1:t)).filter((e=>-1!==e)).reverse().forEach((e=>{const t=this.envs.splice(e,1)[0];(0,i.traceVerbose)(`Removing invalid env from cache ${t.id}`),this.fire({old:t,new:void 0})})),e&&e.forEach((e=>{const t=this.envs.find((t=>t.id===e.id));t&&!(0,a.areEnvsDeepEqual)(t,e)&&this.updateEnv(t,e,!0)}))}getAllEnvs(){return this.envs}addEnv(e,t){const n=this.envs.find((t=>(0,a.areSameEnv)(t,e)));n?t&&!this.validatedEnvs.has(e.id)&&this.updateEnv(n,e,!0):(this.envs.push(e),this.fire({new:e})),t&&((0,i.traceVerbose)(`Flushing env to cache ${e.id}`),this.validatedEnvs.add(e.id),this.flush(e).ignoreErrors())}updateEnv(e,t,n=!1){if(this.flushedEnvs.has(e.id)&&!n)return;const r=this.envs.findIndex((t=>(0,a.areSameEnv)(t,e)));-1!==r&&(void 0===t?this.envs.splice(r,1):this.envs[r]=t,this.fire({old:e,new:t}))}async getLatestInfo(e){var t;const n=null!==(t=this.envs.find((t=>(0,o.arePathsSame)(t.location,e))))&&void 0!==t?t:this.envs.find((t=>(0,a.areSameEnv)(t,e)));if((null==n?void 0:n.kind)===s.PythonEnvKind.Conda&&"envFolderPath"===(0,a.getEnvPath)(n.executable.filename,n.location).pathType)return await(0,o.pathExists)((0,l.getCondaInterpreterPath)(n.location))?void this.validatedEnvs.delete(n.id):(this.validatedEnvs.add(n.id),n);if(n){if(this.validatedEnvs.has(n.id))return(0,i.traceVerbose)(`Found cached env for ${e}`),n;if(await this.validateInfo(n))return(0,i.traceVerbose)(`Needed to validate ${e} with latest info`),this.validatedEnvs.add(n.id),n}(0,i.traceVerbose)(`No cached env found for ${e}`)}clearAndReloadFromStorage(){this.envs=this.persistentStorage.get(),this.markAllEnvsAsFlushed()}async flush(e){if(e){const t=this.persistentStorage.get(),n=t.findIndex((t=>t.id===e.id));return t[n]=e,this.flushedEnvs.add(e.id),void await this.persistentStorage.store(t)}(0,i.traceVerbose)("Environments added to cache",JSON.stringify(this.envs)),this.markAllEnvsAsFlushed(),await this.persistentStorage.store(this.envs)}markAllEnvsAsFlushed(){this.envs.forEach((e=>{this.flushedEnvs.add(e.id)}))}async validateInfo(e){if(!this.flushedEnvs.has(e.id))return!1;const{ctime:t,mtime:n}=await(0,o.getFileInfo)(e.executable.filename);return-1!==t&&-1!==n&&t===e.executable.ctime&&n===e.executable.mtime||(e.executable.ctime=t,e.executable.mtime=n,!1)}}t.PythonEnvInfoCache=u,t.createCollectionCache=async function(e){const t=new u(e);return t.clearAndReloadFromStorage(),await async function(e){return(0,r.isTestExecution)()?e.validateCache():e.validateCache().ignoreErrors()}(t),t}},17021:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnvsCollectionService=void 0;const r=n(66828);n(32727);const i=n(59314),o=n(70057),s=n(19735),a=n(54813),c=n(61522),l=n(37769),u=n(44773),p=n(44538),d=n(69270),h=n(34354);class f extends h.PythonEnvsWatcher{constructor(e,t){super(),this.cache=e,this.locator=t,this.refreshesPerQuery=new Map,this.scheduledRefreshesPerQuery=new Map,this.progressPromises=new Map,this.hasRefreshFinishedForQuery=new Map,this.progress=new r.EventEmitter,this.refreshState=p.ProgressReportStage.discoveryFinished,this.locator.onChanged((e=>{const t=e.providerId?{providerId:e.providerId,envPath:e.envPath}:void 0;let n=this.scheduledRefreshesPerQuery.get(t);n||(n=this.scheduleNewRefresh(t)),n.then((()=>{this.fire(e)}))})),this.cache.onChanged((e=>{this.fire(e)})),this.onProgress((e=>{var t;this.refreshState=e.stage,null===(t=this.progressPromises.get(e.stage))||void 0===t||t.resolve(),this.progressPromises.delete(e.stage)}))}get onProgress(){return this.progress.event}getRefreshPromise(e){var t,n;const r=null!==(t=null==e?void 0:e.stage)&&void 0!==t?t:p.ProgressReportStage.discoveryFinished;return null===(n=this.progressPromises.get(r))||void 0===n?void 0:n.promise}async resolveEnv(e){e=(0,l.normalizePath)(e);const t=await this.cache.getLatestInfo(e);if(t)return(0,s.traceVerbose)(`Resolved ${e} from cache: ${JSON.stringify(t)}`),t;const n=await this.locator.resolveEnv(e).catch((t=>{(0,s.traceError)(`Failed to resolve ${e}`,t)}));return(0,s.traceVerbose)(`Resolved ${e} to ${JSON.stringify(n)}`),n&&this.cache.addEnv(n,!0),n}getEnvs(e){const t=this.cache.getAllEnvs();return e?t.filter((0,d.getQueryFilter)(e)):t}triggerRefresh(e,t){const n=new o.StopWatch;let r=this.getRefreshPromiseForQuery(e);if(!r){if((null==t?void 0:t.ifNotTriggerredAlready)&&this.hasRefreshFinished(e))return Promise.resolve();r=this.startRefresh(e)}return r.then((()=>this.sendTelemetry(e,n)))}startRefresh(e){return this.createProgressStates(e),this.addEnvsToCacheForQuery(e).then((async()=>{this.resolveProgressStates(e)})).catch((t=>{this.rejectProgressStates(e,t)}))}async addEnvsToCacheForQuery(e){const t=this.locator.iterEnvs(e),n=[],r={done:!1,pending:0},o=(0,i.createDeferred)();if(void 0!==t.onUpdated){const i=t.onUpdated((async t=>{if((0,p.isProgressEvent)(t))switch(t.stage){case p.ProgressReportStage.discoveryFinished:r.done=!0,i.dispose();break;case p.ProgressReportStage.allPathsDiscovered:e||this.progress.fire(t);break;default:this.progress.fire(t)}else r.pending+=1,this.cache.updateEnv(n[t.index],t.update),t.update&&(n[t.index]=t.update),r.pending-=1;r.done&&0===r.pending&&o.resolve()}))}else this.progress.fire({stage:p.ProgressReportStage.discoveryStarted}),o.resolve();for await(const e of t)n.push(e),this.cache.addEnv(e);await o.promise,await this.cache.validateCache(n,void 0===e),this.cache.flush().ignoreErrors()}getRefreshPromiseForQuery(e){var t,n,r;return null!==(n=null===(t=this.refreshesPerQuery.get(e))||void 0===t?void 0:t.promise)&&void 0!==n?n:null===(r=this.refreshesPerQuery.get(void 0))||void 0===r?void 0:r.promise}hasRefreshFinished(e){var t;return null!==(t=this.hasRefreshFinishedForQuery.get(e))&&void 0!==t?t:this.hasRefreshFinishedForQuery.get(void 0)}async scheduleNewRefresh(e){const t=this.getRefreshPromiseForQuery(e);let n;return t?(n=t.then((()=>{this.scheduledRefreshesPerQuery.delete(e),this.startRefresh(e)})),this.scheduledRefreshesPerQuery.set(e,n)):n=this.startRefresh(e),n}createProgressStates(e){this.refreshesPerQuery.set(e,(0,i.createDeferred)()),Object.values(p.ProgressReportStage).forEach((e=>{this.progressPromises.set(e,(0,i.createDeferred)())})),p.ProgressReportStage.allPathsDiscovered&&e&&this.progressPromises.delete(p.ProgressReportStage.allPathsDiscovered)}rejectProgressStates(e,t){var n;null===(n=this.refreshesPerQuery.get(e))||void 0===n||n.reject(t),this.refreshesPerQuery.delete(e),Object.values(p.ProgressReportStage).forEach((e=>{var n;null===(n=this.progressPromises.get(e))||void 0===n||n.reject(t),this.progressPromises.delete(e)}))}resolveProgressStates(e){var t;null===(t=this.refreshesPerQuery.get(e))||void 0===t||t.resolve(),this.refreshesPerQuery.delete(e),Array.from(this.refreshesPerQuery.values()).every((e=>e.completed))&&this.progress.fire({stage:p.ProgressReportStage.discoveryFinished})}sendTelemetry(e,t){e||this.hasRefreshFinished(e)||(0,a.sendTelemetryEvent)(c.EventName.PYTHON_INTERPRETER_DISCOVERY,t.elapsedTime,{interpreters:this.cache.getAllEnvs().length,environmentsWithoutPython:this.cache.getAllEnvs().filter((e=>"envFolderPath"===(0,u.getEnvPath)(e.executable.filename,e.location).pathType)).length}),this.hasRefreshFinishedForQuery.set(e,!0)}}t.EnvsCollectionService=f},30752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonEnvsReducer=void 0;const r=n(96486),i=n(66828),o=n(19735),s=n(44773),a=n(24563),c=n(44538);async function l(e,t,n,i,o){n.pending+=1;const s=o[e],c=function(e,t){var n,i;const[o]=function(...e){const t=(0,a.getPrioritizedEnvKinds)();return e.sort(((e,n)=>t.indexOf(e.kind)-t.indexOf(n.kind)))}(e,t),s=(0,r.cloneDeep)(o);return s.source=(0,r.uniq)((null!==(n=e.source)&&void 0!==n?n:[]).concat(null!==(i=t.source)&&void 0!==i?i:[])),s}(s,t);(0,r.isEqual)(s,c)||(o[e]=c,i.fire({index:e,old:s,update:c})),n.pending-=1,u(n,i)}function u(e,t){e.done&&0===e.pending&&(t.fire({stage:c.ProgressReportStage.discoveryFinished}),t.dispose(),(0,o.traceVerbose)("Finished with environment reducer"))}t.PythonEnvsReducer=class{constructor(e){this.parentLocator=e}get onChanged(){return this.parentLocator.onChanged}iterEnvs(e){const t=new i.EventEmitter,n=async function*(e,t){const n={done:!1,pending:0},r=[];if(void 0!==e.onUpdated){const i=e.onUpdated((e=>{if(n.pending+=1,(0,c.isProgressEvent)(e))e.stage===c.ProgressReportStage.discoveryFinished?(n.done=!0,i.dispose()):t.fire(e);else{if(void 0===e.update)throw new Error("Unsupported behavior: `undefined` environment updates are not supported from downstream locators in reducer");if(void 0!==r[e.index]){const n=r[e.index];r[e.index]=e.update,t.fire({index:e.index,old:n,update:e.update})}else(0,o.traceVerbose)(`Expected already iterated env, got ${e.old} (#${e.index})`)}n.pending-=1,u(n,t)}))}else t.fire({stage:c.ProgressReportStage.discoveryStarted});let i=await e.next();for(;!i.done;){const o=i.value,a=r.findIndex((e=>(0,s.areSameEnv)(e,o)));-1!==a?l(a,o,n,t,r).ignoreErrors():(yield o,r.push(o)),i=await e.next()}void 0===e.onUpdated&&(n.done=!0,u(n,t))}(this.parentLocator.iterEnvs(e),t);return n.onUpdated=t.event,n}}},27736:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonEnvsResolver=void 0;const r=n(96486),i=n(66828),o=n(13367),s=n(44773),a=n(44538),c=n(80640),l=n(19735),u=n(29616),p=n(95084);async function d(e,t){const{path:n}=(0,s.getEnvPath)(e.executablePath,e.envPath);let r=t.get(n);r||(r=await(0,o.identifyEnvironment)(n),t.set(n,r)),e.kind=r}function h(e,t){e.done&&0===e.pending&&(t.fire({stage:a.ProgressReportStage.discoveryFinished}),t.dispose(),(0,l.traceVerbose)("Finished with environment resolver"))}function f(e,t){const n=(0,r.cloneDeep)(t);n.executable.sysPrefix=e.executable.sysPrefix;const i="envFolderPath"===(0,s.getEnvPath)(n.executable.filename,n.location).pathType;return n.version=i?(0,p.getEmptyVersion)():e.version,n.arch=e.arch,(0,s.setEnvDisplayString)(n),n}t.PythonEnvsResolver=class{constructor(e,t){this.parentLocator=e,this.environmentInfoService=t,this.parentLocator.onChanged((e=>{e.type&&void 0!==e.searchLocation&&this.environmentInfoService.resetInfo(e.searchLocation)}))}get onChanged(){return this.parentLocator.onChanged}async resolveEnv(e){const[t,n]=await async function(e){var t;let n,r;return await(0,u.isPythonExecutable)(e).catch((t=>((0,l.traceWarn)("Failed to check if",e,"is an executable",t),!0)))?(n=e,r=(0,u.getEnvironmentDirFromPath)(n)):(r=e,n=null!==(t=await(0,u.getInterpreterPathFromDir)(r))&&void 0!==t?t:""),[n,r]}(e);e=t.length?t:n;const r=await(0,o.identifyEnvironment)(e),i=await(0,c.resolveBasicEnv)({kind:r,executablePath:t,envPath:n}),s=await this.environmentInfoService.getEnvironmentInfo(i);if((0,l.traceVerbose)(`Environment resolver resolved ${e} for ${JSON.stringify(i)} to ${JSON.stringify(s)}`),s)return f(s,i)}iterEnvs(e){const t=new i.EventEmitter,n=this.parentLocator.iterEnvs(e),r=this.iterEnvsIterator(n,t);return r.onUpdated=t.event,r}async*iterEnvsIterator(e,t){const n=new Map,r={done:!1,pending:0},i=[];if(void 0!==e.onUpdated){const o=e.onUpdated((async e=>{if(r.pending+=1,(0,a.isProgressEvent)(e))e.stage===a.ProgressReportStage.discoveryFinished?(t.fire({stage:a.ProgressReportStage.allPathsDiscovered}),r.done=!0,o.dispose()):t.fire(e);else{if(void 0===e.update)throw new Error("Unsupported behavior: `undefined` environment updates are not supported from downstream locators in resolver");if(void 0!==i[e.index]){const o=i[e.index];await d(e.update,n),i[e.index]=await(0,c.resolveBasicEnv)(e.update),t.fire({old:o,index:e.index,update:i[e.index]}),this.resolveInBackground(e.index,r,t,i).ignoreErrors()}else(0,l.traceVerbose)(`Expected already iterated env, got ${e.old} (#${e.index})`)}r.pending-=1,h(r,t)}))}else t.fire({stage:a.ProgressReportStage.discoveryStarted});let o=await e.next();for(;!o.done;){await d(o.value,n);const s=await(0,c.resolveBasicEnv)(o.value);i.push(s),yield s,this.resolveInBackground(i.indexOf(s),r,t,i).ignoreErrors(),o=await e.next()}void 0===e.onUpdated&&(r.done=!0,h(r,t))}async resolveInBackground(e,t,n,r){t.pending+=1;const i=await this.environmentInfoService.getEnvironmentInfo(r[e]),o=r[e];if(i){const t=f(i,r[e]);r[e]=t,n.fire({old:o,index:e,update:t})}else n.fire({old:o,index:e,update:void 0});t.pending-=1,h(t,n)}}},80640:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveBasicEnv=void 0;const r=n(71017),i=n(66828),o=n(96486),s=n(45878),a=n(44773),c=n(29616),l=n(37769),u=n(75470),p=n(77826),d=n(87450),h=n(95084),f=n(38366),g=n(82035),m=n(19735),v=n(64715),y=n(85261),b=n(42694);async function S(e){const{executablePath:t}=e;let n;try{n=(0,g.parseVersionFromExecutable)(t)}catch(e){n=s.UNKNOWN_PYTHON_VERSION}return(0,a.buildEnvInfo)({kind:e.kind,version:n,executable:t})}async function E(e){const{executablePath:t,kind:n}=e,i=(0,a.buildEnvInfo)({kind:n,version:await(0,c.getPythonVersionFromPath)(t),executable:t,type:s.PythonEnvType.Virtual}),o=(0,c.getEnvironmentDirFromPath)(t);return i.location=o,i.name=r.basename(o),i}async function _(e){var t;const{executablePath:n}=e,i=await u.Conda.getConda();if(void 0===i){(0,m.traceWarn)(`${n} identified as Conda environment even though Conda is not found`),e.kind=s.PythonEnvKind.Unknown;const t=await E(e);return t.type=s.PythonEnvType.Conda,t.name="",t}const o=null!==(t=e.envPath)&&void 0!==t?t:(0,c.getEnvironmentDirFromPath)(e.executablePath);let l;l=e.executablePath.length>0?e.executablePath:await i.getInterpreterPathForEnvironment({prefix:o});const p=(0,a.buildEnvInfo)({executable:l,kind:s.PythonEnvKind.Conda,org:u.AnacondaCompanyName,location:o,source:[],version:l?await(0,c.getPythonVersionFromPath)(l):void 0,type:s.PythonEnvType.Conda}),d=await(null==i?void 0:i.getName(o));if(d&&(p.name=d),e.envPath&&r.basename(l)===l){const t=(0,u.getCondaInterpreterPath)(e.envPath);p.id=(0,a.getEnvID)(t,e.envPath)}return p}async function w(e){const{executablePath:t}=e,n=(0,c.getEnvironmentDirFromPath)(t),i=r.basename(n),o=(0,p.parsePyenvVersion)(i),d=(0,a.buildEnvInfo)({kind:s.PythonEnvKind.Pyenv,executable:t,source:[],location:n,version:await(0,c.getPythonVersionFromPath)(t,null==o?void 0:o.pythonVer),org:o&&o.distro?o.distro:""});return await async function(e){if(!await(0,u.isCondaEnvironment)(e))return!1;const t=(0,c.getEnvironmentDirFromPath)(e),n=(0,p.getPyenvVersionsDir)();return(0,l.arePathsSame)(r.dirname(t),n)}(t)?d.name="base":d.name=i,d}async function T(e){const t=(0,a.buildEnvInfo)({kind:e.kind,executable:e.executablePath}),n=await b.ActiveState.getState().then((e=>null==e?void 0:e.getProjects()));if(n)for(const i of n)for(const n of i.executables)if((0,l.arePathsSame)(n,r.dirname(e.executablePath)))return t.name=`${i.organization}/${i.name}`,t;return t}async function C(e){const{executablePath:t}=e;return(0,a.buildEnvInfo)({kind:s.PythonEnvKind.MicrosoftStore,executable:t,version:(0,h.getPythonVersionFromPath)(t),org:"Microsoft",arch:d.Architecture.x64,source:[s.PythonEnvSource.PathEnvVar]})}t.resolveBasicEnv=async function(e){var t;const{kind:n,source:r}=e,c=function(){const e=new Map;return Object.values(s.PythonEnvKind).forEach((t=>{e.set(t,S)})),s.virtualEnvKinds.forEach((t=>{e.set(t,E)})),e.set(s.PythonEnvKind.Conda,_),e.set(s.PythonEnvKind.MicrosoftStore,C),e.set(s.PythonEnvKind.Pyenv,w),e.set(s.PythonEnvKind.ActiveState,T),e}().get(n),p=await c(e);p.searchLocation=function(e){if((0,y.getWorkspaceFolderPaths)().some((t=>(0,l.isParentPath)(e.executable.filename,t)||(0,l.isParentPath)(e.location,t))))return i.Uri.file(e.location)}(p),p.source=(0,o.uniq)(p.source.concat(null!=r?r:[])),(0,d.getOSType)()===d.OSType.Windows&&(null===(t=p.source)||void 0===t?void 0:t.includes(s.PythonEnvSource.WindowsRegistry))&&await async function(e){var t,n,r;let i=(0,f.getRegistryInterpretersSync)();i||((0,m.traceError)("Expected registry interpreter cache to be initialized already"),i=await(0,f.getRegistryInterpreters)());const c=i.find((t=>(0,l.arePathsSame)(t.interpreterPath,e.executable.filename)));if(c){const i=null!==(n=null!==(t=c.versionStr)&&void 0!==t?t:c.sysVersionStr)&&void 0!==n?n:c.interpreterPath;let l;try{l=(0,h.parseVersion)(i)}catch(e){l=s.UNKNOWN_PYTHON_VERSION}e.kind=e.kind===s.PythonEnvKind.Unknown?s.PythonEnvKind.OtherGlobal:e.kind,e.version=(0,a.comparePythonVersionSpecificity)(l,e.version)>0?l:e.version,e.distro.defaultDisplayName=c.companyDisplayName,e.arch="32bit"===c.bitnessStr?d.Architecture.x86:d.Architecture.x64,e.distro.org=null!==(r=c.distroOrgName)&&void 0!==r?r:e.distro.org,e.source=(0,o.uniq)(e.source.concat(s.PythonEnvSource.WindowsRegistry))}else(0,m.traceWarn)("Expected registry to find the interpreter as source was set")}(p),(0,a.setEnvDisplayString)(p);const{ctime:g,mtime:b}=await(0,l.getFileInfo)(p.executable.filename);p.executable.ctime=g,p.executable.mtime=b;const P=await async function(e){return e.type?e.type:await(0,v.isVirtualEnvironment)(e.executable.filename)?s.PythonEnvType.Virtual:await(0,u.isCondaEnvironment)(e.executable.filename)?s.PythonEnvType.Conda:void 0}(p);return P&&(p.type=P),p}},96255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveStateLocator=void 0;const r=n(42694),i=n(45878),o=n(19735),s=n(77882),a=n(29616);class c extends s.LazyResourceBasedLocator{constructor(){super(...arguments),this.providerId="activestate"}async*doIterEnvs(){const e=await r.ActiveState.getState();if(void 0===e)return void(0,o.traceVerbose)("Couldn't locate the state binary.");(0,o.traceVerbose)("Searching for active state environments");const t=await e.getProjects();if(void 0!==t){for(const e of t)if(e.executables)for(const t of e.executables)try{(0,o.traceVerbose)(`Looking for Python in: ${e.name}`);for await(const e of(0,a.findInterpretersInDir)(t))(0,o.traceVerbose)(`Found Python executable: ${e.filename}`),yield{kind:i.PythonEnvKind.ActiveState,executablePath:e.filename}}catch(t){(0,o.traceError)(`Failed to process State Tool project: ${JSON.stringify(e)}`,t)}(0,o.traceVerbose)("Finished searching for active state environments")}else(0,o.traceVerbose)("Couldn't fetch State Tool projects.")}}t.ActiveStateLocator=c},74437:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CondaEnvironmentLocator=void 0,n(32727);const r=n(45878),i=n(75470),o=n(19735),s=n(65349);class a extends s.FSWatchingLocator{constructor(){super((()=>(0,i.getCondaEnvironmentsTxt)()),(async()=>r.PythonEnvKind.Conda),{isFile:!0}),this.providerId="conda-envs"}async*doIterEnvs(){const e=await i.Conda.getConda();if(void 0===e)return void(0,o.traceVerbose)("Couldn't locate the conda binary.");(0,o.traceVerbose)(`Searching for conda environments using ${e.command}`);const t=await e.getEnvList();for(const n of t)try{(0,o.traceVerbose)(`Looking into conda env for executable: ${JSON.stringify(n)}`);const t=await e.getInterpreterPathForEnvironment(n);(0,o.traceVerbose)(`Found conda executable: ${t}`),yield{kind:r.PythonEnvKind.Conda,executablePath:t,envPath:n.prefix}}catch(e){(0,o.traceError)(`Failed to process conda env: ${JSON.stringify(n)}`,e)}(0,o.traceVerbose)("Finished searching for conda environments")}}t.CondaEnvironmentLocator=a},82399:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomVirtualEnvironmentLocator=t.VENVFOLDERS_SETTING_KEY=t.VENVPATH_SETTING_KEY=void 0;const r=n(96486),i=n(71017),o=n(59314),s=n(87450),a=n(45878),c=n(65349),l=n(29616),u=n(37769),p=n(37924),d=n(64715);n(32727);const h=n(99910),f=n(19735);async function g(){var e;const n=[],o=(0,u.getPythonSetting)(t.VENVPATH_SETTING_KEY);o&&n.push((0,u.untildify)(o));const a=null!==(e=(0,u.getPythonSetting)(t.VENVFOLDERS_SETTING_KEY))&&void 0!==e?e:[],c=(0,s.getUserHomeDir)();return c&&await(0,u.pathExists)(c)&&a.map((e=>i.join(c,e))).forEach((e=>n.push(e))),(0,h.asyncFilter)((0,r.uniq)(n),u.pathExists)}async function m(e){return await(0,p.isPipenvEnvironment)(e)?a.PythonEnvKind.Pipenv:await(0,d.isVirtualenvwrapperEnvironment)(e)?a.PythonEnvKind.VirtualEnvWrapper:await(0,d.isVenvEnvironment)(e)?a.PythonEnvKind.Venv:await(0,d.isVirtualenvEnvironment)(e)?a.PythonEnvKind.VirtualEnv:a.PythonEnvKind.Unknown}t.VENVPATH_SETTING_KEY="venvPath",t.VENVFOLDERS_SETTING_KEY="venvFolders";class v extends c.FSWatchingLocator{constructor(){super(g,m,{delayOnCreated:1e3}),this.providerId="custom-virtual-envs"}async initResources(){this.disposables.push((0,u.onDidChangePythonSetting)(t.VENVPATH_SETTING_KEY,(()=>this.emitter.fire({})))),this.disposables.push((0,u.onDidChangePythonSetting)(t.VENVFOLDERS_SETTING_KEY,(()=>this.emitter.fire({}))))}doIterEnvs(){return async function*(){const e=(await g()).map((e=>async function*(){(0,f.traceVerbose)(`Searching for custom virtual envs in: ${e}`);const t=(0,l.findInterpretersInDir)(e,2);for await(const e of t){const{filename:t}=e;if(await(0,l.looksLikeBasicVirtualPython)(e))try{const e=await m(t);yield{kind:e,executablePath:t},(0,f.traceVerbose)(`Custom Virtual Environment: [added] ${t}`)}catch(e){(0,f.traceError)(`Failed to process environment: ${t}`,e)}else(0,f.traceVerbose)(`Custom Virtual Environment: [skipped] ${t}`)}}()));yield*(0,o.iterable)((0,o.chain)(e)),(0,f.traceVerbose)("Finished searching for custom virtual envs")}()}}t.CustomVirtualEnvironmentLocator=v},3649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirFilesLocator=void 0;const r=n(29616),i=n(34354);async function*o(e){for await(const t of(0,r.iterPythonExecutablesInDir)(e))yield t.filename}t.DirFilesLocator=class extends class{constructor(e,t,n){this.kind=e,this.getExecutables=t,this.source=n,this.watcher=new i.PythonEnvsWatcher,this.onChanged=this.watcher.onChanged}iterEnvs(e){const t=this.getExecutables();return async function*(e,n){for await(const r of t)yield{executablePath:r,kind:e,source:n}}(this.kind,this.source)}}{constructor(e,t,n=o,r){super(t,(()=>n(e)),r),this.providerId=`dir-files-${e}`}}},65349:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FSWatchingLocator=t.FSWatcherKind=void 0;const r=n(57147),i=n(71017),o=n(66828),s=n(88409),a=n(59314),c=n(19735),l=n(29616),u=n(53476),p=n(77882);var d;!function(e){e[e.Global=0]="Global",e[e.Workspace=1]="Workspace"}(d=t.FSWatcherKind||(t.FSWatcherKind={}));class h extends p.LazyResourceBasedLocator{constructor(e,t,n={},r=d.Global){super(),this.getRoots=e,this.getKind=t,this.creationOptions=n,this.watcherKind=r,this.activate().ignoreErrors()}async initWatchers(){if(this.watcherKind===d.Global&&!f(this.creationOptions))return;(0,c.traceVerbose)("Getting roots");let e=await this.getRoots();(0,c.traceVerbose)("Found roots"),"string"==typeof e&&(e=[e]);const t=e.map((async e=>{if(f(this.creationOptions))return e;const t=await function(e){let t;try{t=r.readdirSync(e)}catch(e){const t=e;if((0,c.traceError)("Reading directory to watch failed",t),"ENOENT"===t.code)return"directory does not exist";throw e}if(t.length>200)return"too many files"}(e);if(!t)return e;(0,c.traceError)(`Dir "${e}" is not watchable (${t})`)}));(await Promise.all(t)).filter((e=>!!e)).forEach((e=>this.startWatchers(e)))}startWatchers(e){const t=this.creationOptions;if(f(t))return(0,c.traceVerbose)("Start watching file for changes",e),void this.disposables.push((0,s.watchLocationForPattern)(i.dirname(e),i.basename(e),(()=>{(0,c.traceVerbose)("Detected change in file: ",e,"initiating a refresh"),this.emitter.fire({providerId:this.providerId})})));const n=async(e,n)=>{var r;e===s.FileChangeType.Created&&void 0!==t.delayOnCreated&&await(0,a.sleep)(t.delayOnCreated);const u=await this.getKind(n).catch((()=>{})),p=o.Uri.file(null!==(r=t.searchLocation)&&void 0!==r?r:i.dirname((0,l.getEnvironmentDirFromPath)(n)));(0,c.traceVerbose)("Fired event ",JSON.stringify({type:e,kind:u,searchLocation:p}),"from locator"),this.emitter.fire({type:e,kind:u,searchLocation:p,providerId:this.providerId,envPath:n})},r=(0,u.resolvePythonExeGlobs)(t.baseGlob,t.envStructure);(0,c.traceVerbose)("Start watching root",e,"for globs",JSON.stringify(r));const p=r.map((t=>(0,u.watchLocationForPythonBinaries)(e,n,t)));this.disposables.push(...p)}}function f(e){return"isFile"in e&&e.isFile}t.FSWatchingLocator=h},93235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalVirtualEnvironmentLocator=void 0;const r=n(96486),i=n(71017),o=n(59314),s=n(87450),a=n(45878),c=n(65349),l=n(29616),u=n(37769),p=n(37924),d=n(64715);n(32727);const h=n(99910),f=n(19735);async function g(){const e=[];let t=(0,s.getEnvironmentVariable)("WORKON_HOME");t&&(t=(0,u.untildify)(t),await(0,u.pathExists)(t)&&e.push(t));const n=(0,s.getUserHomeDir)();if(n&&await(0,u.pathExists)(n)){const t=["Envs",".direnv",".venvs",".virtualenvs",i.join(".local","share","virtualenvs")];(0,s.getOSType)()!==s.OSType.Windows&&t.push("envs"),(await(0,h.asyncFilter)(t.map((e=>i.join(n,e))),u.pathExists)).forEach((t=>e.push(t)))}return(0,r.uniq)(e)}async function m(e){return await(0,p.isPipenvEnvironment)(e)?a.PythonEnvKind.Pipenv:await(0,d.isVirtualenvwrapperEnvironment)(e)?a.PythonEnvKind.VirtualEnvWrapper:await(0,d.isVenvEnvironment)(e)?a.PythonEnvKind.Venv:await(0,d.isVirtualenvEnvironment)(e)?a.PythonEnvKind.VirtualEnv:a.PythonEnvKind.Unknown}class v extends c.FSWatchingLocator{constructor(e){super(g,m,{delayOnCreated:1e3}),this.searchDepth=e,this.providerId="global-virtual-env"}doIterEnvs(){var e;const t=null!==(e=this.searchDepth)&&void 0!==e?e:2;return async function*(){const e=(await g()).map((e=>async function*(){(0,f.traceVerbose)(`Searching for global virtual envs in: ${e}`);const n=(0,l.findInterpretersInDir)(e,t);for await(const e of n){const{filename:t}=e;if(await(0,l.looksLikeBasicVirtualPython)(e)){const e=await m(t);try{yield{kind:e,executablePath:t},(0,f.traceVerbose)(`Global Virtual Environment: [added] ${t}`)}catch(e){(0,f.traceError)(`Failed to process environment: ${t}`,e)}}else(0,f.traceVerbose)(`Global Virtual Environment: [skipped] ${t}`)}}()));yield*(0,o.iterable)((0,o.chain)(e)),(0,f.traceVerbose)("Finished searching for global virtual envs")}()}}t.GlobalVirtualEnvironmentLocator=v},39046:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftStoreLocator=t.getMicrosoftStorePythonExes=void 0;const r=n(55674),i=n(91171),o=n(71017),s=n(45878),a=n(65349),c=n(53476),l=n(10423),u=n(19735),p="python3.{[0-9],[0-9][0-9]}.exe";function d(e){return i(o.basename(e),p,{nocase:!0})}async function h(){if(await(0,l.isStorePythonInstalled)()){const e=(0,l.getMicrosoftStoreAppsRoot)();return(await r.readdir(e)).map((t=>o.join(e,t))).filter(d)}return[]}t.getMicrosoftStorePythonExes=h;class f extends a.FSWatchingLocator{constructor(){super(l.getMicrosoftStoreAppsRoot,(async()=>this.kind),{baseGlob:p,searchLocation:(0,l.getMicrosoftStoreAppsRoot)(),envStructure:c.PythonEnvStructure.Flat}),this.providerId="microsoft-store",this.kind=s.PythonEnvKind.MicrosoftStore}doIterEnvs(){return async function*(e){(0,u.traceVerbose)("Searching for windows store envs");const t=await h();yield*t.map((async t=>({kind:e,executablePath:t}))),(0,u.traceVerbose)("Finished searching for windows store envs")}(this.kind)}}t.MicrosoftStoreLocator=f},68624:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoetryLocator=void 0;const r=n(71017),i=n(59314),o=n(45878),s=n(29616),a=n(37769),c=n(13298);n(32727);const l=n(99910),u=n(19735),p=n(77882);class d extends p.LazyResourceBasedLocator{constructor(e){super(),this.root=e,this.providerId="poetry"}doIterEnvs(){return async function*(e){const t=await async function(e){const t=[r.join(e,c.localPoetryEnvDirName)],n=await c.Poetry.getPoetry(e),i=await(null==n?void 0:n.getEnvList());return i&&t.push(...i),(0,l.asyncFilter)(t,a.pathExists)}(e),n=t.map((e=>async function*(){(0,u.traceVerbose)(`Searching for poetry virtual envs in: ${e}`);const t=await(0,s.getInterpreterPathFromDir)(e);if(void 0!==t){const e=await async function(e){return await(0,c.isPoetryEnvironment)(e)?o.PythonEnvKind.Poetry:o.PythonEnvKind.Unknown}(t);try{yield{executablePath:t,kind:e},(0,u.traceVerbose)(`Poetry Virtual Environment: [added] ${t}`)}catch(e){(0,u.traceError)(`Failed to process environment: ${t}`,e)}}}()));yield*(0,i.iterable)((0,i.chain)(n)),(0,u.traceVerbose)("Finished searching for poetry envs")}(this.root)}}t.PoetryLocator=d},43160:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PosixKnownPathsLocator=void 0;const r=n(22037),i=n(81249),o=n(45878),s=n(44538),a=n(72927),c=n(77826),l=n(87450),u=n(35271),p=n(19735);class d extends s.Locator{constructor(){super(...arguments),this.providerId="posixKnownPaths",this.kind=o.PythonEnvKind.OtherGlobal}iterEnvs(){let e=!1;return(0,l.getOSType)()===l.OSType.OSX&&(0,i.gte)(r.release(),"21.0.0")&&(e=!0),async function*(t){(0,p.traceVerbose)("Searching for interpreters in posix paths locator");try{const n=(await(0,a.commonPosixBinPaths)()).filter((e=>!(0,c.isPyenvShimDir)(e)));let r=await(0,a.getPythonBinFromPosixPaths)(n);(0,p.traceVerbose)(`Found ${r.length} python binaries in posix paths`),e&&(r=r.filter((e=>!(0,u.isMacDefaultPythonPath)(e))));for(const e of r)try{yield{executablePath:e,kind:t,source:[o.PythonEnvSource.PathEnvVar]}}catch(t){(0,p.traceError)(`Failed to process environment: ${e}`,t)}}catch(e){(0,p.traceError)("Failed to process posix paths",e)}(0,p.traceVerbose)("Finished searching for interpreters in posix paths locator")}(this.kind)}}t.PosixKnownPathsLocator=d},41770:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PyenvLocator=void 0;const r=n(45878),i=n(65349),o=n(29616),s=n(37769),a=n(77826),c=n(19735);class l extends i.FSWatchingLocator{constructor(){super(a.getPyenvVersionsDir,(async()=>r.PythonEnvKind.Pyenv)),this.providerId="pyenv"}doIterEnvs(){return async function*(){(0,c.traceVerbose)("Searching for pyenv environments");const e=(0,a.getPyenvVersionsDir)(),t=(0,s.getSubDirs)(e,{resolveSymlinks:!0});for await(const e of t){const t=await(0,o.getInterpreterPathFromDir)(e);if(t)try{yield{kind:r.PythonEnvKind.Pyenv,executablePath:t}}catch(e){(0,c.traceError)(`Failed to process environment: ${t}`,e)}}(0,c.traceVerbose)("Finished searching for pyenv environments")}()}}t.PyenvLocator=l},44644:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsPathEnvVarLocator=void 0;const r=n(47237),i=n(81837),o=n(29616),s=n(77826),a=n(10423),c=n(45878),l=n(2839),u=n(69270),p=n(3649),d=n(19735);async function*h(e){for await(const t of(0,o.iterPythonExecutablesInDir)(e))await(0,o.looksLikeBasicGlobalPython)(t)&&(yield t.filename)}t.WindowsPathEnvVarLocator=class{constructor(){this.providerId="windows-path-env-var-locator",this.disposables=new i.Disposables;const e=(0,r.getSearchPathEntries)().filter((e=>!(0,a.isMicrosoftStoreDir)(e)&&!(0,s.isPyenvShimDir)(e))).map((e=>function(e,t,n){const r=new p.DirFilesLocator(e,t,h,n);return{providerId:r.providerId,iterEnvs:async function*(e){(0,d.traceVerbose)("Searching for windows path interpreters"),yield*await(0,u.getEnvs)(r.iterEnvs(e)).then((e=>((0,d.traceVerbose)("Finished searching for windows path interpreters"),e)))},dispose:async()=>{},onChanged:r.onChanged}}(e,c.PythonEnvKind.System,[c.PythonEnvSource.PathEnvVar])));this.disposables.push(...e),this.locators=new l.Locators(e),this.onChanged=this.locators.onChanged}async dispose(){this.locators.dispose(),await this.disposables.dispose()}iterEnvs(e){return this.locators.iterEnvs(e)}}},5613:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WindowsRegistryLocator=void 0;const r=n(45878),i=n(44538),o=n(38366),s=n(19735),a=n(10423);class c extends i.Locator{constructor(){super(...arguments),this.providerId="windows-registry"}iterEnvs(){return async function*(){(0,s.traceVerbose)("Searching for windows registry interpreters");const e=await(0,o.getRegistryInterpreters)();for(const t of e)try{if((0,a.isMicrosoftStoreDir)(t.interpreterPath))continue;const e={kind:r.PythonEnvKind.OtherGlobal,executablePath:t.interpreterPath,source:[r.PythonEnvSource.WindowsRegistry]};yield e}catch(e){(0,s.traceError)(`Failed to process environment: ${t}`,e)}(0,s.traceVerbose)("Finished searching for windows registry interpreters")}()}}t.WindowsRegistryLocator=c},3143:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceVirtualEnvironmentLocator=void 0;const r=n(71017),i=n(59314),o=n(29616),s=n(37769),a=n(37924),c=n(64715),l=n(45878),u=n(65349);n(32727);const p=n(99910),d=n(19735);function h(e){return(0,p.asyncFilter)([e,r.join(e,".direnv")],s.pathExists)}async function f(e){return await(0,a.isPipenvEnvironment)(e)?l.PythonEnvKind.Pipenv:await(0,c.isVenvEnvironment)(e)?l.PythonEnvKind.Venv:await(0,c.isVirtualenvEnvironment)(e)?l.PythonEnvKind.VirtualEnv:l.PythonEnvKind.Unknown}class g extends u.FSWatchingLocator{constructor(e){super((()=>h(this.root)),f,{delayOnCreated:1e3},u.FSWatcherKind.Workspace),this.root=e,this.providerId="workspaceVirtualEnvLocator"}doIterEnvs(){return async function*(e){const t=(await h(e)).map((e=>async function*(){(0,d.traceVerbose)(`Searching for workspace virtual envs in: ${e}`);const t=(0,o.findInterpretersInDir)(e,2);for await(const e of t){const{filename:t}=e;if(await(0,o.looksLikeBasicVirtualPython)(e)){const e=await f(t);yield{kind:e,executablePath:t},(0,d.traceVerbose)(`Workspace Virtual Environment: [added] ${t}`)}else(0,d.traceVerbose)(`Workspace Virtual Environment: [skipped] ${t}`)}}()));yield*(0,i.iterable)((0,i.chain)(t)),(0,d.traceVerbose)("Finished searching for workspace virtual envs")}(this.root)}}t.WorkspaceVirtualEnvironmentLocator=g},14424:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceLocators=t.ExtensionLocators=void 0;const r=n(59314),i=n(3481),o=n(81837),s=n(2839),a=n(77882);class c extends s.Locators{constructor(e,t){super([...e,t]),this.nonWorkspace=e,this.workspace=t}iterEnvs(e){var t;const n=[this.workspace.iterEnvs(e)];if(!(null===(t=null==e?void 0:e.searchLocations)||void 0===t?void 0:t.doNotIncludeNonRooted)){const t=(null==e?void 0:e.providerId)?this.nonWorkspace.filter((t=>e.providerId===t.providerId)):this.nonWorkspace;n.push(...t.map((t=>t.iterEnvs(e))))}return(0,s.combineIterators)(n)}}t.ExtensionLocators=c;class l extends a.LazyResourceBasedLocator{constructor(e,t){super(),this.watchRoots=e,this.factories=t,this.providerId="workspace-locators",this.locators={},this.roots={},this.activate().ignoreErrors()}async dispose(){await super.dispose(),Object.keys(this.roots).map((e=>this.roots[e])).forEach((e=>this.removeRoot(e)))}doIterEnvs(e){const t=Object.keys(this.locators).map((t=>{if(void 0!==(null==e?void 0:e.searchLocations)){const n=this.roots[t],o=(0,i.getURIFilter)(n,{checkParent:!0,checkChild:!0});if(!e.searchLocations.roots.some(o))return(0,r.iterEmpty)();if(e.providerId&&e.providerId!==this.providerId)return(0,r.iterEmpty)()}const[n]=this.locators[t];return n.iterEnvs(e)}));return(0,s.combineIterators)(t)}async initResources(){const e=this.watchRoots({initRoot:e=>this.addRoot(e),addRoot:e=>{this.removeRoot(e),this.addRoot(e),this.emitter.fire({searchLocation:e})},removeRoot:e=>{this.removeRoot(e),this.emitter.fire({searchLocation:e})}});this.disposables.push(e)}addRoot(e){const t=[],n=new o.Disposables;this.factories.forEach((r=>{r(e).forEach((e=>{t.push(e),void 0!==e.dispose&&n.push(e)}))}));const r=new s.Locators(t),i=e.toString();this.locators[i]=[r,n],this.roots[i]=e,n.push(r.onChanged((t=>{void 0===t.searchLocation&&(t.searchLocation=e),this.emitter.fire(t)})))}removeRoot(e){const t=e.toString(),n=this.locators[t];if(void 0===n)return;const[,r]=n;delete this.locators[t],delete this.roots[t],r.dispose()}}t.WorkspaceLocators=l},34354:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonEnvsWatcher=void 0;const r=n(66828);t.PythonEnvsWatcher=class{constructor(){this.didChange=new r.EventEmitter,this.onChanged=this.didChange.event}fire(e){this.didChange.fire(e)}}},38514:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonEnvsWatchers=void 0;const r=n(81837),i=n(34354);t.PythonEnvsWatchers=class{constructor(e){this.watcher=new i.PythonEnvsWatcher,this.disposables=new r.Disposables,this.onChanged=this.watcher.onChanged,e.forEach((e=>{const t=e.onChanged((e=>this.watcher.fire(e)));this.disposables.push(t)}))}async dispose(){await this.disposables.dispose()}}},29616:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvironmentDirFromPath=t.getInterpreterPathFromDir=t.looksLikeBasicVirtualPython=t.looksLikeBasicGlobalPython=t.getPythonVersionFromPath=t.iterPythonExecutablesInDir=t.findInterpretersInDir=t.isPythonExecutable=void 0;const r=n(57147),i=n(71017),o=n(56091),s=n(87450),a=n(19735),c=n(45878),l=n(44773),u=n(95084),p=n(75470),d=n(64715),h=n(37769),f=n(72927),g=n(38366),m=(0,s.getOSType)()===s.OSType.Windows?g.matchPythonBinFilename:f.matchPythonBinFilename;async function*v(e,t,n,r=!0){const i=(0,s.getOSType)()===s.OSType.Windows?g.matchPythonBinFilename:f.matchPythonBinFilename,a={ignoreErrors:r,filterSubDir:n,filterFile:i,maxDepth:t||0};for await(const t of y(e,1,a)){const{filename:e,filetype:n}=t;n!==o.FileType.File&&n!==o.FileType.SymbolicLink||S(e,i,r)&&(yield t)}}async function*y(e,t,n){const r=await b(e,n);for(const e of r){yield e;const{filename:r,filetype:i}=e;i===o.FileType.Directory&&(n.maxDepth<0||t<=n.maxDepth)&&S(r,n.filterSubDir,n.ignoreErrors)&&(yield*y(r,t+1,n))}}async function b(e,t={ignoreErrors:!0}){const n=t.ignoreErrors||!1;if(t.filterFilename&&(0,s.getOSType)()===s.OSType.Windows){let s;try{s=await r.promises.readdir(e)}catch(t){if("ENOENT"===t.code)return[];if(n)return(0,a.traceError)(`readdir() failed for "${e}" (${t})`),[];throw t}const c=s.map((t=>i.join(e,t))).filter((e=>S(e,t.filterFilename,n)));return Promise.all(c.map((async e=>({filename:e,filetype:await(0,o.getFileType)(e,t)||o.FileType.Unknown}))))}let c;try{c=await r.promises.readdir(e,{withFileTypes:!0})}catch(t){if("ENOENT"===t.code)return[];if(n)return(0,a.traceError)(`readdir() failed for "${e}" (${t})`),[];throw t}const l=c.map((t=>({filename:i.join(e,t.name),filetype:(0,o.convertFileType)(t)})));return t.filterFilename?l.filter((e=>S(e.filename,t.filterFilename,n))):l}function S(e,t,n=!0){if(void 0===t)return!0;try{return t(e)}catch(t){if(n)return(0,a.traceError)(`filter failed for "${e}" (${t})`),!1;throw t}}async function E(e,t){return!(!(t.matchFilename||m)("string"==typeof e?e:e.filename)||t.filterFile&&!await t.filterFile(e))}t.isPythonExecutable=async function(e){return!(!m(e)||(0,s.getOSType)()!==s.OSType.Windows)||!!await(0,h.isFile)(e)},t.findInterpretersInDir=v,t.iterPythonExecutablesInDir=async function*(e,t={ignoreErrors:!0}){const n={...t,filterFile:m},r=await b(e,n);for(const e of r){const{filetype:t}=e;t!==o.FileType.File&&t!==o.FileType.SymbolicLink||(yield e)}},t.getPythonVersionFromPath=async function(e,t){let n;try{n=t?(0,u.parseVersion)(t):c.UNKNOWN_PYTHON_VERSION}catch(e){n=c.UNKNOWN_PYTHON_VERSION}const r=e?await async function(e){const t=i.dirname(e);let n=c.UNKNOWN_PYTHON_VERSION;for await(const e of v(t)){const{filename:t}=e;try{const e=(0,u.parseVersion)(i.basename(t));(0,l.comparePythonVersionSpecificity)(e,n)>0&&(n=e)}catch(e){}}return n}(e):c.UNKNOWN_PYTHON_VERSION,o=e?await(0,d.getPythonVersionFromPyvenvCfg)(e):c.UNKNOWN_PYTHON_VERSION,s=e?await(0,p.getPythonVersionFromConda)(e):c.UNKNOWN_PYTHON_VERSION;let a=c.UNKNOWN_PYTHON_VERSION;for(const e of[n,r,o,s])a=(0,l.comparePythonVersionSpecificity)(a,e)>0?a:e;return a};const _=(0,o.getFileFilter)({ignoreFileType:o.FileType.SymbolicLink});async function w(e){return E(e,{matchFilename:(0,s.getOSType)()===s.OSType.Windows?g.matchBasicPythonBinFilename:f.matchBasicPythonBinFilename,filterFile:_})}async function T(e){return E(e,{matchFilename:(0,s.getOSType)()===s.OSType.Windows?g.matchBasicPythonBinFilename:f.matchBasicPythonBinFilename,filterFile:void 0})}t.looksLikeBasicGlobalPython=w,t.looksLikeBasicVirtualPython=T,t.getInterpreterPathFromDir=async function(e,t={}){const n=t.global?w:T,r=v(e,2,(function(e){const t=i.basename(e).toLowerCase();return["bin","scripts"].includes(t)}),t.ignoreErrors);for await(const e of r)if(await n(e))return e.filename},t.getEnvironmentDirFromPath=function(e){const t=i.basename(i.dirname(e));return["bin","scripts"].map((e=>(0,h.normCasePath)(e))).includes((0,h.normCasePath)(t))?i.dirname(i.dirname(e)):i.dirname(e)}},13367:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identifyEnvironment=void 0;const r=n(19735),i=n(45878),o=n(24563),s=n(75470),a=n(89235),c=n(37924),l=n(13298),u=n(77826),p=n(64715),d=n(10423),h=n(42694);t.identifyEnvironment=async function(e){const t=function(){const e=()=>Promise.resolve(!1),t=new Map;return Object.values(i.PythonEnvKind).forEach((n=>{t.set(n,e)})),t.set(i.PythonEnvKind.Conda,s.isCondaEnvironment),t.set(i.PythonEnvKind.MicrosoftStore,d.isMicrosoftStoreEnvironment),t.set(i.PythonEnvKind.Pipenv,c.isPipenvEnvironment),t.set(i.PythonEnvKind.Pyenv,u.isPyenvEnvironment),t.set(i.PythonEnvKind.Poetry,l.isPoetryEnvironment),t.set(i.PythonEnvKind.Venv,p.isVenvEnvironment),t.set(i.PythonEnvKind.VirtualEnvWrapper,p.isVirtualenvwrapperEnvironment),t.set(i.PythonEnvKind.VirtualEnv,p.isVirtualenvEnvironment),t.set(i.PythonEnvKind.ActiveState,h.isActiveStateEnvironment),t.set(i.PythonEnvKind.Unknown,(()=>Promise.resolve(!0))),t.set(i.PythonEnvKind.OtherGlobal,a.isGloballyInstalledEnv),t}(),n=(0,o.getPrioritizedEnvKinds)();for(const i of n){const n=t.get(i);if(n&&await n(e).catch((t=>((0,r.traceWarn)(`Identifier for ${i} failed to identify ${e}`,t),!1))))return i}return i.PythonEnvKind.Unknown}},42694:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.isActiveStateEnvironmentForWorkspace=t.ActiveState=t.isActiveStateEnvironment=t.ACTIVESTATETOOLPATH_SETTING_KEY=void 0;const i=n(71017),o=n(71017),s=n(37769),a=n(36952),c=n(19735),l=n(87450);t.ACTIVESTATETOOLPATH_SETTING_KEY="activeStateToolPath",t.isActiveStateEnvironment=async function(e){const t=i.dirname(e),n=i.dirname(t);return(0,s.pathExists)(i.join(n,"_runtime_store"))};class u{constructor(){(0,s.onDidChangePythonSetting)(t.ACTIVESTATETOOLPATH_SETTING_KEY,(()=>{u.statePromise=void 0}))}static async getState(){return void 0===u.statePromise&&(u.statePromise=u.locate()),u.statePromise}static getStateToolDir(){const e=(0,l.getUserHomeDir)();if(e)return(0,l.getOSType)()===l.OSType.Windows?i.join(e,"AppData","Local","ActiveState","StateTool"):i.join(e,".local","ActiveState","StateTool")}static async locate(){var e;const n=this.getStateToolDir(),r=null!==(e=(0,s.getPythonSetting)(t.ACTIVESTATETOOLPATH_SETTING_KEY))&&void 0!==e?e:u.defaultStateCommand;if(n&&(await(0,s.pathExists)(n)||r!==this.defaultStateCommand))return new u}async getProjects(){return this.getProjectsCached()}async getProjectsCached(){var e;try{const n=null!==(e=(0,s.getPythonSetting)(t.ACTIVESTATETOOLPATH_SETTING_KEY))&&void 0!==e?e:u.defaultStateCommand,r=await(0,s.shellExecute)(`${n} projects -o editor`,{timeout:5e3});if(!r)return;let i=r.stdout.trimEnd();"\0"===i[i.length-1]&&(i=i.substring(0,i.length-1)),(0,c.traceVerbose)(`${n} projects -o editor: ${i}`);const o=JSON.parse(i);return u.setCachedProjectInfo(o),o}catch(e){return void(0,c.traceError)(e)}}static getCachedProjectInfo(){return this.cachedProjectInfo}static setCachedProjectInfo(e){this.cachedProjectInfo=e}}u.defaultStateCommand="state",u.cachedProjectInfo=[],r([(0,a.cache)(3e4,!0,1e4)],u.prototype,"getProjectsCached",null),t.ActiveState=u,t.isActiveStateEnvironmentForWorkspace=function(e,t){const n=(0,o.dirname)(e);for(const e of u.getCachedProjectInfo())if(e.executables)for(const[r,i]of e.executables.entries())if((0,s.arePathsSame)(i,n)&&(0,s.arePathsSame)(t,e.local_checkouts[r]))return!0;return!1}},75470:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.Conda=t.CONDA_ACTIVATION_TIMEOUT=t.CONDA_RUN_VERSION=t.getCondaInterpreterPath=t.getPythonVersionFromConda=t.getCondaEnvironmentsTxt=t.isCondaEnvironment=t.getCondaMetaPaths=t.parseCondaInfo=t.CONDAPATH_SETTING_KEY=t.AnacondaCompanyName=void 0;const i=n(55674),o=n(71017),s=n(81249),a=n(87450),c=n(37769),l=n(45878),u=n(95084),p=n(38366),d=n(81387),h=n(36952),f=n(77570),g=n(19735),m=n(4057),v=n(94146);function y(e){const t="conda-meta";return[o.join(o.dirname(e),t),o.join(o.dirname(o.dirname(e)),t),o.join(e,t)]}function b(e){const t=(0,a.getOSType)()===a.OSType.Windows?"python.exe":o.join("bin","python");return o.join(e,t)}t.AnacondaCompanyName="Anaconda, Inc.",t.CONDAPATH_SETTING_KEY="condaPath",t.parseCondaInfo=async function(e,n,r,i){const o=Array.isArray(e.envs)?e.envs:[];e.default_prefix&&e.default_prefix.length>0&&o.push(e.default_prefix);const s=o.map((async e=>{const o=n(e);if(!await r(o))return;const s=await i(o);return s?{...s,path:o,companyDisplayName:t.AnacondaCompanyName,envType:d.EnvironmentType.Conda,envPath:e}:void 0}));return Promise.all(s).then((e=>e.filter((e=>null!=e)))).then((e=>e.map((e=>e))))},t.getCondaMetaPaths=y,t.isCondaEnvironment=async function(e){const t=y(e);for(const e of t)if(await(0,c.pathExists)(e))return!0;return!1},t.getCondaEnvironmentsTxt=async function(){const e=(0,a.getUserHomeDir)();return e?[o.join(e,".conda","environments.txt")]:[]},t.getPythonVersionFromConda=async function(e){const t=y(e).map((e=>o.join(e,"history"))),n=/\:python-(([\d\.a-z]?)+)/;for(const e of t)if(await(0,c.pathExists)(e))try{const t=(0,v.splitLines)(await(0,c.readFile)(e)).map((e=>{const t=n.exec(e);return t?t[1]:""})).filter((e=>e.length>0));if(t.length>0){const e=t.length-1;return(0,u.parseVersion)(t[e].trim())}}catch(e){return l.UNKNOWN_PYTHON_VERSION}return l.UNKNOWN_PYTHON_VERSION},t.getCondaInterpreterPath=b,t.CONDA_RUN_VERSION="4.9.0",t.CONDA_ACTIVATION_TIMEOUT=45e3;class S{constructor(e,n,r){this.command=e,this.shellPath=r,this.condaInfoCached=new Map,this.shellCommand=null!=n?n:e,(0,c.onDidChangePythonSetting)(t.CONDAPATH_SETTING_KEY,(()=>{S.condaPromise=new Map}))}static async getConda(e){return(void 0===S.condaPromise.get(e)||(0,f.isTestExecution)())&&S.condaPromise.set(e,S.locate(e)),S.condaPromise.get(e)}static async locate(e){(0,g.traceVerbose)("Searching for conda.");const n=(0,a.getUserHomeDir)(),r=(0,c.getPythonSetting)(t.CONDAPATH_SETTING_KEY),s=(0,a.getOSType)()===a.OSType.Windows?"Scripts\\conda.exe":"bin/conda";async function l(e){const t=o.dirname(e),n=o.join(t,"..","condabin","conda.bat");if(await(0,c.pathExists)(n))return n}for await(const t of async function*(){r&&"conda"!==r&&(yield r),yield"conda",(0,a.getOSType)()===a.OSType.Windows&&(yield*async function*(){const e=(await(0,p.getRegistryInterpreters)()).filter((e=>e.interpreterPath&&"ContinuumAnalytics"===e.distroOrgName)).map((e=>o.join(o.win32.dirname(e.interpreterPath),s)));yield*e}()),yield*async function*(){const e=[];if((0,a.getOSType)()===a.OSType.Windows){const t=(0,a.getEnvironmentVariable)("PROGRAMDATA")||"C:\\ProgramData";if(e.push(t),n){const t=(0,a.getEnvironmentVariable)("LOCALAPPDATA")||o.join(n,"AppData","Local");e.push(n,o.join(t,"Continuum"))}}else e.push("/usr/share","/usr/local/share","/opt"),n&&e.push(n,o.join(n,"opt"));for(const t of e){let e;try{e=await i.readdir(t)}catch(t){e=void 0}void 0!==e&&(yield*e.filter((e=>e.toLowerCase().includes("conda"))).map((e=>o.join(t,e,s))))}}(),yield*async function*(){if(!n)return;let e;try{e=await i.readFile(o.join(n,".conda","environments.txt"),"utf8")}catch(t){e=""}yield*e.split(/\r?\n/g).map((e=>e.trim())).filter((e=>""!==e&&!e.startsWith("#"))).map((e=>o.join(e,s)))}()}()){(0,g.traceVerbose)(`Probing conda binary: ${t}`);let n=new S(t,void 0,e);try{if(await n.getInfo(),(0,a.getOSType)()===a.OSType.Windows&&((0,f.isTestExecution)()||t!==r)){const r=await l(t);try{if(r){const i=new S(r,void 0,e);await i.getInfo(),n=new S(t,r,e)}}catch(e){(0,g.traceVerbose)("Failed to spawn conda bat file",r,e)}}return(0,g.traceVerbose)(`Found conda via filesystem probing: ${t}`),n}catch(e){(0,g.traceVerbose)("Failed to spawn conda binary",t,e)}}(0,g.traceVerbose)("Couldn't locate the conda binary.")}async getInfo(e){let t=this.condaInfoCached.get(this.shellPath);return e&&t||(t=this.getInfoImpl(this.command,this.shellPath),this.condaInfoCached.set(this.shellPath,t)),t}async getInfoImpl(e,t){const n={timeout:5e4};t&&(n.shell=t);const r=await(0,c.exec)(e,["info","--json"],n);return(0,g.traceVerbose)(`${e} info --json: ${r.stdout}`),JSON.parse(r.stdout)}async getEnvList(){const e=await this.getInfo(),{envs:t}=e;return void 0===t?[]:Promise.all(t.map((async t=>({prefix:t,name:await this.getName(t,e)}))))}async getName(e,t){if((t=null!=t?t:await this.getInfo(!0)).root_prefix&&(0,c.arePathsSame)(e,t.root_prefix))return"base";const n=o.dirname(e);if(void 0!==t.envs_dirs)for(const r of t.envs_dirs)if((0,c.arePathsSame)(n,r))return o.basename(e)}async getCondaEnvironment(e){const t=await this.getEnvList();return t.find((t=>(0,c.arePathsSame)(e,t.prefix)))||t.find((t=>(0,c.isParentPath)(e,t.prefix)))}async getInterpreterPathForEnvironment(e){const t=b(e.prefix);return await(0,c.pathExists)(t)?((0,g.traceVerbose)("Found executable within conda env",JSON.stringify(e)),t):((0,g.traceVerbose)("Executable does not exist within conda env, assume the executable to be `python`",JSON.stringify(e)),"python")}async getRunPythonArgs(e,n,r=!1){const i=await this.getCondaVersion();if(i&&(0,s.lt)(i,t.CONDA_RUN_VERSION))return void(0,g.traceError)("`conda run` is not supported for conda version",i.raw);const o=[];e.name?o.push("-n",e.name):o.push("-p",e.prefix);const a=[n?this.shellCommand:this.command,"run",...o,"--no-capture-output","python"];return r&&a.push("-I"),[...a,m.OUTPUT_MARKER_SCRIPT]}async getCondaVersion(){const e=await this.getInfo(!0).catch((()=>{}));let t;if(e&&e.conda_version)t=e.conda_version;else{const e=await(0,c.exec)(this.command,["--version"],{timeout:5e4}).then((e=>e.stdout.trim())).catch((()=>{}));t=e&&e.startsWith("conda ")?e.substring("conda ".length).trim():e}if(!t)return;const n=t.match(/(?<major>\d+)\.(?<minor>\d+)\.(?<micro>\d+)(?:.*)?/);if(n&&n.groups){const e=n.groups.major.concat(".",n.groups.minor,".",n.groups.micro),t=new s.SemVer(e);if(t)return t}return(0,g.traceError)(`Unable to parse version of Conda, ${t}`),new s.SemVer("0.0.1")}async isCondaRunSupported(){const e=await this.getCondaVersion();return!e||!(0,s.lt)(e,t.CONDA_RUN_VERSION)}}S.condaPromise=new Map,r([(0,h.cache)(3e4,!0,1e4)],S.prototype,"getInfoImpl",null),r([(0,h.cache)(3e4,!0,1e4)],S.prototype,"getEnvList",null),r([(0,h.cache)(-1,!0)],S.prototype,"getCondaVersion",null),t.Conda=S},1132:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CondaService=void 0;const o=n(86700),s=n(71017),a=n(84974),c=n(36952),l=n(19735),u=n(75470);let p=class{constructor(e,t){this.platform=e,this.fileSystem=t}async getActivationScriptFromInterpreter(e,t){const n=await this.getCondaFileFromInterpreter(e,t),r=(n?s.join(s.dirname(n),"activate"):"activate").fileToCommandArgumentForPythonExt();if(this.platform.isLinux||this.platform.isMac){const e=await this.getCondaInfo();if(null==e?void 0:e.root_prefix){const t=s.join(e.root_prefix,this.platform.virtualEnvBinName,"activate").fileToCommandArgumentForPythonExt();if(r===t||!await this.fileSystem.fileExists(r))return{path:t,type:"global"}}}return{path:r,type:"local"}}async getCondaFile(e){return u.Conda.getConda().then((t=>{const n=e?null==t?void 0:t.shellCommand:null==t?void 0:t.command;return null!=n?n:"conda"}))}async getInterpreterPathForEnvironment(e){const t=await u.Conda.getConda();return null==t?void 0:t.getInterpreterPathForEnvironment({name:e.name,prefix:e.path})}async isCondaAvailable(){return"boolean"==typeof this.isAvailable?this.isAvailable:this.getCondaVersion().then((e=>this.isAvailable=void 0!==e)).catch((()=>this.isAvailable=!1))}async getCondaVersion(){return u.Conda.getConda().then((e=>null==e?void 0:e.getCondaVersion()))}async getCondaFileFromInterpreter(e,t){const n=this.platform.isWindows?"conda.exe":"conda",r=this.platform.isWindows?"Scripts":"bin",i=e?s.dirname(e):"",o=t?i.indexOf(s.join("envs",t)):-1;if(o>0){const e=i.slice(0,o);let t=s.join(e,n);if(await this.fileSystem.fileExists(t))return t;if(t=s.join(e,r,n),await this.fileSystem.fileExists(t))return t}let a=s.join(i,n);return await this.fileSystem.fileExists(a)?a:(a=s.join(i,r,n),await this.fileSystem.fileExists(a)?a:this.getCondaFile())}async getCondaInfo(){const e=await u.Conda.getConda();return null==e?void 0:e.getInfo()}};r([(0,l.traceDecoratorVerbose)("Get Conda File from interpreter"),(0,c.cache)(12e4)],p.prototype,"getCondaFileFromInterpreter",null),r([(0,c.cache)(6e4)],p.prototype,"getCondaInfo",null),p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IPlatformService)),i(1,(0,o.inject)(a.IFileSystem))],p),t.CondaService=p},89235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGloballyInstalledEnv=void 0;const r=n(47237),i=n(87450),o=n(37769),s=n(72927),a=n(77826);t.isGloballyInstalledEnv=async function(e){return async function(e){let t=[];t=(0,i.getOSType)()===i.OSType.Windows?(0,r.getSearchPathEntries)():await(0,s.commonPosixBinPaths)(),t=t.filter((e=>!(0,a.isPyenvShimDir)(e)));for(const n of t)if((0,o.isParentPath)(e,n))return!0;return!1}(e)}},35271:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMacDefaultPythonPath=void 0;const r=n(87450);t.isMacDefaultPythonPath=function(e){return(0,r.getOSType)()===r.OSType.OSX&&(["/usr/bin/python"].includes(e)||e.startsWith("/usr/bin/python2"))}},10423:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMicrosoftStoreEnvironment=t.isStorePythonInstalled=t.isMicrosoftStoreDir=t.getMicrosoftStoreAppsRoot=void 0;const r=n(71017),i=n(87450),o=n(19735),s=n(37769);function a(){const e=(0,i.getEnvironmentVariable)("LOCALAPPDATA")||"";return r.join(e,"Microsoft","WindowsApps")}function c(e){const t=r.join((0,i.getEnvironmentVariable)("ProgramFiles")||"Program Files","WindowsApps").normalize().toUpperCase();return r.normalize(e).toUpperCase().includes(t)}async function l(e){let t=await Promise.all([(0,s.pathExists)(r.join(a(),"idle.exe")),(0,s.pathExists)(r.join(a(),"pip.exe"))]);return!!t.includes(!0)||!!e&&(t=await Promise.all([(0,s.pathExists)(r.join(r.dirname(e),"idle.exe")),(0,s.pathExists)(r.join(r.dirname(e),"pip.exe"))]),t.includes(!0))}t.getMicrosoftStoreAppsRoot=a,t.isMicrosoftStoreDir=function(e){const t=r.normalize(a()).toUpperCase();return r.normalize(e).toUpperCase().includes(t)||c(e)},t.isStorePythonInstalled=l,t.isMicrosoftStoreEnvironment=async function(e){if(await l(e)){const t=r.normalize(e).toUpperCase(),n=r.normalize(a()).toUpperCase();if(t.includes(n))return!0;if(c(t))return(0,o.traceWarn)("isMicrosoftStoreEnvironment called with Program Files store path."),!0}return!1}},37924:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPipenvEnvironmentRelatedToFolder=t.isPipenvEnvironment=t._getAssociatedPipfile=void 0;const r=n(71017),i=n(87450),o=n(19735),s=n(37769);async function a(e,t){const n=(0,i.getEnvironmentVariable)("PIPENV_PIPFILE")||"Pipfile";let a=t.lookIntoParentDirectories?function(){const e=(0,i.getEnvironmentVariable)("PIPENV_MAX_DEPTH");if(void 0===e)return 3;const t=parseInt(e,10);return isNaN(t)?((0,o.traceError)(`PIPENV_MAX_DEPTH is incorrectly set. Converting value '${e}' to number results in NaN`),1):t}():1;for(;a>0&&!(0,s.arePathsSame)(e,r.dirname(e));){const t=r.join(e,n);if(await(0,s.pathExists)(t))return t;e=r.dirname(e),a-=1}}async function c(e){const t=r.dirname(r.dirname(e)),n=await async function(e){const t=r.join(e,".project");if(!await(0,s.pathExists)(t))return;const n=(await(0,s.readFile)(t)).trim();if(await(0,s.pathExists)(n))return n;(0,o.traceError)(`The .project file inside environment folder: ${e} doesn't contain a valid path to the project`)}(t);if(void 0!==n)return r.basename((0,s.normCasePath)(t)).startsWith(`${r.basename((0,s.normCasePath)(n))}-`)?a(n,{lookIntoParentDirectories:!1}):void 0}t._getAssociatedPipfile=a,t.isPipenvEnvironment=async function(e){return!!await async function(e){const t=r.dirname(r.dirname(e));if(".venv"===r.basename(t))return a(r.dirname(t),{lookIntoParentDirectories:!1})}(e)||!!await c(e)},t.isPipenvEnvironmentRelatedToFolder=async function(e,t){const n=await c(e);if(!n)return!1;const r=void 0===(0,i.getEnvironmentVariable)("PIPENV_NO_INHERIT"),o=await a(t,{lookIntoParentDirectories:r});return!!o&&(0,s.arePathsSame)(n,o)}},13298:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.isPoetryEnvironmentRelatedToFolder=t.Poetry=t.isPoetryEnvironment=t.localPoetryEnvDirName=void 0;const i=n(71017),o=n(87450),s=n(37769),a=n(29616),c=n(64715),l=n(70057),u=n(36952),p=n(77570),d=n(19735),h=n(94146),f=/^(.+)-(.+)-py(\d).(\d){1,2}$/;t.localPoetryEnvDirName=".venv",t.isPoetryEnvironment=async function(e){return!!await async function(e){const t=(0,a.getEnvironmentDirFromPath)(e);return!!f.test(i.basename(t))&&(0,c.isVirtualenvEnvironment)(e)}(e)||!!await async function(e){const n=(0,a.getEnvironmentDirFromPath)(e);return i.basename(n)===t.localPoetryEnvDirName&&!!m(i.dirname(n))}(e)};class g{constructor(e,t){this.command=e,this.cwd=t,this.fixCwd()}static async getPoetry(e){if(m(e))return(void 0===g.poetryPromise.get(e)||(0,p.isTestExecution)())&&g.poetryPromise.set(e,g.locate(e)),g.poetryPromise.get(e)}static async locate(e){(0,d.traceVerbose)(`Getting poetry for cwd ${e}`);for(const t of function*(){try{const e=(0,s.getPythonSetting)("poetryPath");e&&"poetry"!==e&&(yield e)}catch(e){(0,d.traceError)("Failed to get poetry setting",e)}yield"poetry";const e=(0,o.getUserHomeDir)();if(e){const t=i.join(e,".poetry","bin","poetry");(0,s.pathExistsSync)(t)&&(yield t)}}()){(0,d.traceVerbose)(`Probing poetry binary for ${e}: ${t}`);const n=new g(t,e);if(void 0!==await n.getEnvList())return(0,d.traceVerbose)(`Found poetry via filesystem probing for ${e}: ${t}`),n;(0,d.traceVerbose)(`Failed to find poetry for ${e}: ${t}`)}(0,d.traceVerbose)(`No poetry binary found for ${e}`)}async getEnvList(){return this.getEnvListCached(this.cwd)}async getEnvListCached(e){const t=await this.safeShellExecute(`${this.command} env list --full-path`);if(!t)return;const n="(Activated)";return(await Promise.all((0,h.splitLines)(t.stdout).map((async e=>{e.endsWith(n)&&(e=e.slice(0,-n.length));const t=e.trim();return await(0,s.pathExists)(t)?t:void 0})))).filter((e=>void 0!==e)).map((e=>e))}async getActiveEnvPath(){return this.getActiveEnvPathCached(this.cwd)}async getActiveEnvPathCached(e){const t=await this.safeShellExecute(`${this.command} env info -p`,!0);if(t)return t.stdout.trim()}async getVirtualenvsPathSetting(){const e=await this.safeShellExecute(`${this.command} config virtualenvs.path`);if(e)return e.stdout.trim()}fixCwd(){if((0,o.getOSType)()===o.OSType.Windows&&/^[a-z]:/.test(this.cwd)){const e=this.cwd.split(":");e[0]=e[0].toUpperCase(),this.cwd=e.join(":")}}async safeShellExecute(e,t=!1){const n=new l.StopWatch,r=await(0,s.shellExecute)(e,{cwd:this.cwd,throwOnStdErr:!0,timeout:5e4}).catch((e=>{t?(0,d.traceVerbose)(e):(0,d.traceError)(e)}));return(0,d.traceVerbose)(`Time taken to run ${e} in ms`,n.elapsedTime),r}}function m(e){const t=i.join(e,"pyproject.toml");return!!(0,s.pathExistsSync)(t)&&!!(0,s.readFileSync)(t).includes("[tool.poetry]")}g.poetryPromise=new Map,r([(0,u.cache)(3e4,!0,1e4)],g.prototype,"getEnvListCached",null),r([(0,u.cache)(2e4,!0,1e4)],g.prototype,"getActiveEnvPathCached",null),t.Poetry=g,t.isPoetryEnvironmentRelatedToFolder=async function(e,t,n){const r=n?new g(n,t):await g.getPoetry(t),i=await(null==r?void 0:r.getActiveEnvPath());return!!i&&(0,s.isParentPath)(e,i)}},77826:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePyenvVersion=t.isPyenvEnvironment=t.isPyenvShimDir=t.getPyenvVersionsDir=t.getPyenvDir=void 0;const r=n(71017),i=n(87450),o=n(37769);function s(){var e;let t=null!==(e=(0,i.getEnvironmentVariable)("PYENV_ROOT"))&&void 0!==e?e:(0,i.getEnvironmentVariable)("PYENV");if(!t){const e=(0,i.getUserHomeDir)()||"";t=(0,i.getOSType)()===i.OSType.Windows?r.join(e,".pyenv","pyenv-win"):r.join(e,".pyenv")}return t}t.getPyenvDir=s,t.getPyenvVersionsDir=function(){return r.join(s(),"versions")},t.isPyenvShimDir=function(e){const t=r.join(s(),"shims");return(0,o.arePathsSame)(t,e)||(0,o.arePathsSame)(`${t}${r.sep}`,e)},t.isPyenvEnvironment=async function(e){const t=e,n=s();return!!await(0,o.pathExists)(n)&&(0,o.isParentPath)(t,n)},t.parsePyenvVersion=function(e){const t=function(){function e(e){return{pythonVer:e,distro:void 0,distroVer:void 0}}function t(e){const t=e.split("-");return 3===t.length?{pythonVer:void 0,distroVer:`${t[1]}-${t[2]}`,distro:t[0]}:2===t.length?{pythonVer:void 0,distroVer:t[1],distro:t[0]}:{pythonVer:void 0,distroVer:void 0,distro:e}}const n=new Map;return n.set("activepython",t),n.set("anaconda",t),n.set("graalpython",t),n.set("ironpython",t),n.set("jython",t),n.set("micropython",t),n.set("miniconda",t),n.set("miniforge",t),n.set("pypy",(function(e){const t=e.split("-"),n=t[0].search(/[0-9\.]+/)>0?t[0].substr("pypy".length):void 0;return 2===t.length?{pythonVer:n,distroVer:t[1],distro:"pypy"}:3===t.length&&(t[2].startsWith("src")||t[2].startsWith("beta")||t[2].startsWith("alpha")||t[2].startsWith("win64"))?{pythonVer:n,distroVer:`${t[1].startsWith("v")?t[1].substr(1):t[1]}-${t[2]}`,distro:"pypy"}:3===t.length&&"stm"===t[1]?{pythonVer:n,distroVer:t[2],distro:`${t[0]}-${t[1]}`}:4===t.length&&"c"===t[1]?{pythonVer:n,distroVer:t[3],distro:`pypy-${t[1]}-${t[2]}`}:4===t.length&&t[3].startsWith("src")?{pythonVer:n,distroVer:`${t[1]}-${t[2]}-${t[3]}`,distro:"pypy"}:{pythonVer:n,distroVer:void 0,distro:"pypy"}})),n.set("pyston",t),n.set("stackless",t),n.set("3",e),n.set("2",e),n}(),n=Array.from(t.keys()).filter((t=>e.startsWith(t))).map((e=>t.get(e))).filter((e=>void 0!==e));if(n.length>0&&n[0])return n[0](e)}},64715:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPythonVersionFromPyvenvCfg=t.isVirtualenvwrapperEnvironment=t.isVirtualenvEnvironment=t.isVenvEnvironment=t.isVirtualEnvironment=void 0;const r=n(55674),i=n(71017);n(32727);const o=n(94146),s=n(87450),a=n(45878),c=n(44773),l=n(95084),u=n(37769);function p(e){const t="pyvenv.cfg";return[i.join(i.dirname(i.dirname(e)),t),i.join(i.dirname(e),t)]}async function d(e){const t=p(e);for(const e of t)if(await(0,u.pathExists)(e))return!0;return!1}async function h(e){const t=i.dirname(e),n=await r.readdir(t),o=/^activate(\.([A-z]|\d)+)?$/i;return void 0!==n.find((e=>o.test(e)))}function f(e){let t,n;try{[t,n]=(0,l.parseBasicVersion)(e)}catch(e){return a.UNKNOWN_PYTHON_VERSION}return-1!==t.micro&&n.startsWith(".")&&([t.release]=(0,l.parseRelease)(n)),t}t.isVirtualEnvironment=async function(e){return d(e)},t.isVenvEnvironment=d,t.isVirtualenvEnvironment=h,t.isVirtualenvwrapperEnvironment=async function(e){const t=await function(){const e=(0,s.getEnvironmentVariable)("WORKON_HOME");return e?Promise.resolve(e):async function(){const e=(0,s.getUserHomeDir)()||"";if((0,s.getOSType)()===s.OSType.Windows){const t=i.join(e,"Envs");if(await(0,u.pathExists)(t))return t}return i.join(e,".virtualenvs")}()}();return await(0,u.pathExists)(t)&&(0,u.isParentPath)(e,t)&&h(e)},t.getPythonVersionFromPyvenvCfg=async function(e){const t=p(e);let n=a.UNKNOWN_PYTHON_VERSION;for(const e of t)if(await(0,u.pathExists)(e))try{const t=(0,o.splitLines)(await(0,u.readFile)(e)).map((e=>{const t=e.split("=");if(2===t.length){const e=t[0].toLowerCase().trim(),n=t[1].trim();if("version"===e)try{return(0,l.parseVersion)(n)}catch(e){return}else if("version_info"===e)try{return f(n)}catch(e){return}}})).filter((e=>void 0!==e)).map((e=>e));if(t.length>0)for(const e of t)(0,c.comparePythonVersionSpecificity)(e,n)>0&&(n=e)}catch(e){return a.UNKNOWN_PYTHON_VERSION}return n}},37769:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onDidChangePythonSetting=t.getPythonSetting=t.getSubDirs=t.isFile=t.getFileInfo=t.resolveSymbolicLink=t.arePathsSame=t.normCasePath=t.resolvePath=t.normalizePath=t.isDirectory=t.isParentPath=t.untildify=t.readFileSync=t.readFile=t.pathExistsSync=t.pathExists=t.isVirtualWorkspace=t.exec=t.shellExecute=t.initializeExternalDependencies=void 0;const r=n(55674),i=n(71017),o=n(66828),s=n(17585),a=n(29983),c=n(61684),l=n(59314),u=n(87450),p=n(19735);let d;function h(e){return(0,u.getOSType)()===u.OSType.Windows?i.normalize(e).toUpperCase():i.normalize(e)}async function f(e,t,n){if((t=null!=t?t:await r.lstat(e)).isSymbolicLink()){if(n&&n>5)return(0,p.traceError)(`Detected a potential symbolic link loop at ${e}, terminating resolution.`),e;const t=await r.readlink(e);return f(i.isAbsolute(t)?t:i.resolve(i.dirname(e),t),void 0,n=n?n+1:1)}return e}t.initializeExternalDependencies=function(e){d=e},t.shellExecute=async function(e,t={}){return(await d.get(a.IProcessServiceFactory).create()).shellExec(e,t)},t.exec=async function(e,t,n={}){return(await d.get(a.IProcessServiceFactory).create()).exec(e,t,n)},t.isVirtualWorkspace=function(){return d.get(s.IWorkspaceService).isVirtualWorkspace},t.pathExists=function(e){return r.pathExists(e)},t.pathExistsSync=function(e){return r.pathExistsSync(e)},t.readFile=function(e){return r.readFile(e,"utf-8")},t.readFileSync=function(e){return r.readFileSync(e,"utf-8")},t.untildify=n(58967),t.isParentPath=function(e,t){return t.endsWith(i.sep)||(t+=i.sep),e.endsWith(i.sep)||(e+=i.sep),h(e).startsWith(h(t))},t.isDirectory=async function(e){return(await r.lstat(e)).isDirectory()},t.normalizePath=function(e){return i.normalize(e)},t.resolvePath=function(e){return i.resolve(e)},t.normCasePath=h,t.arePathsSame=function(e,t){return h(e)===h(t)},t.resolveSymbolicLink=f,t.getFileInfo=async function(e){try{const t=await r.lstat(e);return{ctime:t.ctime.valueOf(),mtime:t.mtime.valueOf()}}catch(t){return(0,p.traceVerbose)(`Failed to get file info for ${e}`,t),{ctime:-1,mtime:-1}}},t.isFile=async function(e){const t=await r.lstat(e);if(t.isSymbolicLink()){const n=await f(e,t);return(await r.lstat(n)).isFile()}return t.isFile()},t.getSubDirs=async function*(e,t){const n=(await r.promises.readdir(e,{withFileTypes:!0})).map((n=>async function*(){const o=i.join(e,n.name);if(n.isDirectory())yield o;else if((null==t?void 0:t.resolveSymlinks)&&n.isSymbolicLink()){const e=await f(o);(await r.lstat(e)).isDirectory()&&(yield e)}}()));yield*(0,l.iterable)((0,l.chain)(n))},t.getPythonSetting=function(e){return d.get(c.IConfigurationService).getSettings()[e]},t.onDidChangePythonSetting=function(e,t){return o.workspace.onDidChangeConfiguration((n=>{n.affectsConfiguration(`python.${e}`)&&t()}))}},72927:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPythonBinFromPosixPaths=t.commonPosixBinPaths=t.matchPythonBinFilename=t.matchBasicPythonBinFilename=void 0;const r=n(57147),i=n(55674),o=n(71017),s=n(96486),a=n(47237),c=n(37769),l=n(19735);function u(e){return/^python(\d+(\.\d+)?)?$/.test(o.basename(e))}async function p(e){return(await r.promises.readdir(e,{withFileTypes:!0})).filter((e=>!e.isDirectory())).map((t=>o.join(e,t.name))).filter(u)}t.matchBasicPythonBinFilename=function(e){return"python"===o.basename(e)},t.matchPythonBinFilename=u,t.commonPosixBinPaths=async function(){const e=(0,a.getSearchPathEntries)(),t=Array.from(new Set(["/bin","/etc","/lib","/lib/x86_64-linux-gnu","/lib64","/sbin","/snap/bin","/usr/bin","/usr/games","/usr/include","/usr/lib","/usr/lib/x86_64-linux-gnu","/usr/lib64","/usr/libexec","/usr/local","/usr/local/bin","/usr/local/etc","/usr/local/games","/usr/local/lib","/usr/local/sbin","/usr/sbin","/usr/share","~/.local/bin"].concat(e))),n=await Promise.all(t.map((e=>i.pathExists(e))));return t.filter(((e,t)=>n[t]))},t.getPythonBinFromPosixPaths=async function(e){var t;const n=new Map;for(const r of e){const e=await p(r);for(const r of e)try{(0,l.traceVerbose)(`Attempting to resolve symbolic link: ${r}`);const e=await(0,c.resolveSymbolicLink)(r);n.has(e)?null===(t=n.get(e))||void 0===t||t.push(r):n.set(e,[r]),(0,l.traceInfo)(`Found: ${r} --\x3e ${e}`)}catch(e){(0,l.traceError)("Failed to resolve symbolic link: ",e)}}const r=Array.from(n.keys()).map((e=>{var t;return function(e){let t=e[0].length,n=e[0];for(const r of e)r.length<=t&&(t=r.length,n=r);return n}([e,...null!==(t=n.get(e))&&void 0!==t?t:[]])}));return(0,s.uniq)(r)}},53476:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePythonExeGlobs=t.PythonEnvStructure=t.watchLocationForPythonBinaries=void 0;const r=n(91171),i=n(71017),o=n(88409),s=n(87450),a=n(19735),[c,l]=(0,s.getOSType)()===s.OSType.Windows?["python.exe","Scripts"]:["python","bin"];var u;t.watchLocationForPythonBinaries=function(e,t,n=c){const l=i.posix.normalize(n),[u]=l.split("/").slice(-1);return(0,o.watchLocationForPattern)(e,l,(function(e,n){(0,a.traceVerbose)("Received event",e,JSON.stringify(n),"for baseglob",u),r(i.basename(n),u,{nocase:(0,s.getOSType)()===s.OSType.Windows})&&t(e,n)}))},function(e){e.Standard="standard",e.Flat="flat"}(u=t.PythonEnvStructure||(t.PythonEnvStructure={})),t.resolvePythonExeGlobs=function(e=c,t=u.Standard){if(i.posix.normalize(e).includes("/"))throw Error(`invalid basename glob "${e}"`);const n=[];return t===u.Standard?n.push(e,`*/${e}`,`*/${l}/${e}`):t===u.Flat&&n.push(e),n}},91057:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readRegistryKeys=t.readRegistryValues=t.REG_SZ=t.HKLM=t.HKCU=void 0;const r=n(1283);Object.defineProperty(t,"HKCU",{enumerable:!0,get:function(){return r.HKCU}}),Object.defineProperty(t,"HKLM",{enumerable:!0,get:function(){return r.HKLM}}),Object.defineProperty(t,"REG_SZ",{enumerable:!0,get:function(){return r.REG_SZ}});const i=n(59314);t.readRegistryValues=async function(e){const t=new(n(1283))(e),r=(0,i.createDeferred)();return t.values(((e,t)=>{e&&r.reject(e),r.resolve(t)})),r.promise},t.readRegistryKeys=async function(e){const t=new(n(1283))(e),r=(0,i.createDeferred)();return t.keys(((e,t)=>{e&&r.reject(e),r.resolve(t)})),r.promise}},38366:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRegistryInterpreters=t.getRegistryInterpretersSync=t.getInterpreterDataFromRegistry=t.matchPythonBinFilename=t.matchBasicPythonBinFilename=void 0;const r=n(96486),i=n(71017),o=n(77570),s=n(19735),a=n(91057);async function c(e,t,n){const r=await(0,a.readRegistryKeys)({arch:e,hive:t,key:n}),i=n.substr(n.lastIndexOf("\\")+1),o=await Promise.all(r.map((e=>async function({arch:e,hive:t,key:n},r){const i={interpreterPath:"",distroOrgName:r},o=await(0,a.readRegistryValues)({arch:e,hive:t,key:n});for(const e of o)switch(e.name){case"SysArchitecture":i.bitnessStr=e.value;break;case"SysVersion":i.sysVersionStr=e.value;break;case"Version":i.versionStr=e.value;break;case"DisplayName":i.companyDisplayName=e.value}const c=(await(0,a.readRegistryKeys)({arch:e,hive:t,key:n})).map((e=>e.key)).find((e=>e.endsWith("InstallPath")));if(c){const n=(await(0,a.readRegistryValues)({arch:e,hive:t,key:c})).find((e=>"ExecutablePath"===e.name));n&&(i.interpreterPath=n.value,n.type!==a.REG_SZ&&(0,s.traceVerbose)(`Registry interpreter path type [${n.type}]: ${n.value}`))}if(i.interpreterPath.length>0)return i}(e,i))));return o.filter((e=>void 0!==e))||[]}let l,u;t.matchBasicPythonBinFilename=function(e){return"python.exe"===i.basename(e).toLowerCase()},t.matchPythonBinFilename=function(e){return/^python(\d+(.\d+)?)?\.exe$/.test(i.basename(e))},t.getInterpreterDataFromRegistry=c,t.getRegistryInterpretersSync=function(){return(0,o.isTestExecution)()?void 0:l},t.getRegistryInterpreters=async function(){return(0,o.isTestExecution)()||void 0===u?(u=async function(){let e=[];for(const t of["x64","x86"])for(const n of[a.HKLM,a.HKCU]){const r="\\SOFTWARE\\Python";let i=[];try{i=(await(0,a.readRegistryKeys)({arch:t,hive:n,key:r})).map((e=>e.key))}catch(e){(0,s.traceError)(`Failed to access Registry: ${t}\\${n}\\${r}`,e)}for(const r of i)e=e.concat(await c(t,n,r))}return l=(0,r.uniqBy)(e,(e=>e.interpreterPath)),l}(),u):u}},83606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVenvExecutable=t.hasVenv=t.getVenvPath=t.showErrorMessageWithLogs=void 0;const r=n(55674),i=n(71017),o=n(77570),s=n(67098),a=n(98638),c=n(56693),l=n(65243);function u(e){return i.join(e.uri.fsPath,".venv")}t.showErrorMessageWithLogs=async function(e){const t=await(0,c.showErrorMessage)(e,s.Common.openOutputPanel,s.Common.selectPythonInterpreter);t===s.Common.openOutputPanel?await(0,a.executeCommand)(o.Commands.ViewOutput):t===s.Common.selectPythonInterpreter&&await(0,a.executeCommand)(o.Commands.Set_Interpreter)},t.getVenvPath=u,t.hasVenv=async function(e){return r.pathExists(u(e))},t.getVenvExecutable=function(e){return(0,l.isWindows)()?i.join(u(e),"Scripts","python.exe"):i.join(u(e),"bin","python")}},83624:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInstalledPackagesDiagnostics=t.INSTALL_CHECKER_SOURCE=void 0;const r=n(66828),i=n(4057),o=n(18699),s=n(19735),a=n(85261);function c(e){const t=(0,a.getConfiguration)("python",e.uri).get("missingPackage.severity","Hint");return"Error"===t?r.DiagnosticSeverity.Error:"Warning"===t?r.DiagnosticSeverity.Warning:"Information"===t?r.DiagnosticSeverity.Information:r.DiagnosticSeverity.Hint}t.INSTALL_CHECKER_SOURCE="Python-InstalledPackagesChecker",t.getInstalledPackagesDiagnostics=async function(e,n){const a=e.get(n.uri),l=(0,i.installedCheckScript)();try{(0,s.traceInfo)("Running installed packages checker: ",a,l,n.uri.fsPath);const e=await(0,o.plainExec)(a,[l,n.uri.fsPath],{env:{VSCODE_MISSING_PGK_SEVERITY:`${c(n)}`}});return(0,s.traceVerbose)("Installed packages check result:\n",e.stdout),e.stderr&&(0,s.traceError)("Installed packages check error:\n",e.stderr),function(e){let n=[];try{n=JSON.parse(e).map((e=>{const n=new r.Diagnostic(new r.Range(e.line,e.character,e.endLine,e.endCharacter),r.l10n.t(`Package \`${e.package}\` is not installed in the selected environment.`),e.severity);return n.code={value:e.code,target:r.Uri.parse(`https://pypi.org/p/${e.package}`)},n.source=t.INSTALL_CHECKER_SOURCE,n}))}catch(e){n=[]}return n}(e.stdout)}catch(e){(0,s.traceError)("Error while getting installed packages check result:\n",e)}return[]}},67995:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pickWorkspaceFolder=void 0;const r=n(55674),i=n(71017),o=n(56693),s=n(85261),a=n(67098),c=n(98638);function l(e){return Promise.race([r.pathExists(i.join(e.uri.fsPath,".venv")),r.pathExists(i.join(e.uri.fsPath,".conda"))])}t.pickWorkspaceFolder=async function(e,t){const n=(0,s.getWorkspaceFolders)();if(!n||0===n.length){if(t===o.MultiStepAction.Back)throw o.MultiStepAction.Back;return void(await(0,o.showErrorMessage)(a.CreateEnv.noWorkspace,a.Common.openFolder)===a.Common.openFolder&&await(0,c.executeCommand)("vscode.openFolder"))}if(1===n.length){if(t===o.MultiStepAction.Back)throw o.MultiStepAction.Back;return n[0]}const r=await(0,o.showQuickPickWithBack)(await async function(e){const t=[];for(const n of e)t.push({label:n.name,detail:n.uri.fsPath,description:await l(n)?a.CreateEnv.hasVirtualEnv:void 0});return t}(n),{placeHolder:a.CreateEnv.pickWorkspacePlaceholder,ignoreFocusOut:!0,canPickMany:null==e?void 0:e.allowMultiSelect,matchOnDescription:!0,matchOnDetail:!0},null==e?void 0:e.token);if(r){if(Array.isArray(r)){const e=r.map((e=>e.detail)).filter((e=>void 0!==e));return n.filter((t=>e.includes(t.uri.fsPath)))}return n.filter((e=>e.uri.fsPath===r.detail))[0]}}},85949:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.buildEnvironmentCreationApi=t.registerCreateEnvironmentFeatures=t.isCreatingEnvironment=t.onCreateEnvironmentExited=t.onCreateEnvironmentStarted=t.registerCreateEnvironmentProvider=void 0;const i=n(66828),o=n(77570),s=n(98638),a=n(83720),c=n(31867),l=n(15739),u=n(56693),p=n(67098),d=n(54813),h=n(61522),f=new class{constructor(){this._createEnvProviders=[],this._createEnvProviders=[]}add(e){if(this._createEnvProviders.filter((t=>t.id===e.id)).length>0)throw new Error(`Create Environment provider with id ${e.id} already registered`);this._createEnvProviders.push(e)}remove(e){this._createEnvProviders=this._createEnvProviders.filter((t=>t!==e))}getAll(){return this._createEnvProviders}};function g(e){return f.add(e),new i.Disposable((()=>{f.remove(e)}))}t.registerCreateEnvironmentProvider=g,r=(0,a.getCreationEvents)(),t.onCreateEnvironmentStarted=r.onCreateEnvironmentStarted,t.onCreateEnvironmentExited=r.onCreateEnvironmentExited,t.isCreatingEnvironment=r.isCreatingEnvironment,t.registerCreateEnvironmentFeatures=function(e,n,r,m){e.push((0,s.registerCommand)(o.Commands.Create_Environment,(e=>{const t=f.getAll();return(0,a.handleCreateEnvironmentCommand)(t,e)})),(0,s.registerCommand)(o.Commands.Create_Environment_Button,(async()=>{(0,d.sendTelemetryEvent)(h.EventName.ENVIRONMENT_BUTTON,void 0,void 0),await(0,s.executeCommand)(o.Commands.Create_Environment)})),g(new l.VenvCreationProvider(n)),g((0,c.condaCreationProvider)()),(0,t.onCreateEnvironmentExited)((async e=>{var t,n;e.path&&(null===(t=e.options)||void 0===t?void 0:t.selectEnvironment)&&(await r.update(null===(n=e.workspaceFolder)||void 0===n?void 0:n.uri,i.ConfigurationTarget.WorkspaceFolder,e.path),(0,u.showInformationMessage)(`${p.CreateEnv.informEnvCreation} ${m.getDisplayName(e.path)}`))})))},t.buildEnvironmentCreationApi=function(){return{onWillCreateEnvironment:t.onCreateEnvironmentStarted,onDidCreateEnvironment:t.onCreateEnvironmentExited,createEnvironment:async e=>{const t=f.getAll();try{return await(0,a.handleCreateEnvironmentCommand)(t,e)}catch(e){return{path:void 0,workspaceFolder:void 0,action:void 0,error:e}}},registerCreateEnvironmentProvider:e=>g(e)}}},61267:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCreateEnvironmentButtonFeatures=void 0;const r=n(98638),i=n(85261);async function o(){const e="show"===(0,i.getConfiguration)("python").get("createEnvironment.contentButton","show");await(0,r.executeCommand)("setContext","showCreateEnvButton",e)}t.registerCreateEnvironmentButtonFeatures=function(e){e.push((0,i.onDidChangeConfiguration)((async()=>{await o()}))),o()}},83720:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCreateEnvironmentCommand=t.getCreationEvents=void 0;const r=n(66828),i=n(67098),o=n(56693),s=n(19735),a=new r.EventEmitter,c=new r.EventEmitter;let l=0;function u(){return l>0}t.getCreationEvents=function(){return{onCreateEnvironmentStarted:a.event,onCreateEnvironmentExited:c.event,isCreatingEnvironment:u}},t.handleCreateEnvironmentCommand=async function(e,t){const n=function(e){return{installPackages:!0,ignoreSourceControl:!0,showBackButton:!1,selectEnvironment:!0,...e}}(t);let u;const p=new o.MultiStepNode(void 0,(async t=>{if(e.length>0){try{u=await async function(e,t){const n=e.map((e=>({label:e.name,description:e.description,id:e.id})));let r;if(r=(null==t?void 0:t.showBackButton)?await(0,o.showQuickPickWithBack)(n,{placeHolder:i.CreateEnv.providersQuickPickPlaceholder,matchOnDescription:!0,ignoreFocusOut:!0}):await(0,o.showQuickPick)(n,{placeHolder:i.CreateEnv.providersQuickPickPlaceholder,matchOnDescription:!0,ignoreFocusOut:!0}),r){const t=Array.isArray(r)?r[0]:r;if(t){const n=e.filter((e=>e.id===t.id));if(n.length>0)return n[0]}}}(e,n)}catch(e){if(e===o.MultiStepAction.Back||e===o.MultiStepAction.Cancel)return e;throw e}if(!u)return o.MultiStepAction.Cancel}else if((0,s.traceError)("No Environment Creation providers were registered."),t===o.MultiStepAction.Back)return o.MultiStepAction.Back;return o.MultiStepAction.Continue}),void 0);let d;const h=new o.MultiStepNode(p,(async e=>{if(e===o.MultiStepAction.Back)return o.MultiStepAction.Back;if(u)try{d=await async function(e,t){let n,i;try{!function(e){a.fire({options:e}),l+=1}(t),n=await e.createEnvironment(t)}catch(e){if(e===r.QuickInputButtons.Back&&((0,s.traceVerbose)("Create Env: User clicked back button during environment creation"),!t.showBackButton))return;throw i=e,i}finally{!function(e,t,n){l-=1,e?c.fire({options:t,...e}):n&&c.fire({options:t,error:n})}(n,t,i)}return n}(u,n)}catch(e){if(e===o.MultiStepAction.Back||e===o.MultiStepAction.Cancel)return e;throw e}return o.MultiStepAction.Continue}),void 0);p.next=h;const f=await o.MultiStepNode.run(p);if((null==t?void 0:t.showBackButton)&&(f!==o.MultiStepAction.Back&&f!==o.MultiStepAction.Cancel||(d={action:f,workspaceFolder:void 0,path:void 0,error:void 0})),d)return Object.freeze(d)}},50939:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerInstalledPackagesDiagnosticsProvider=t.DEPS_NOT_INSTALLED_KEY=void 0;const r=n(98638),i=n(64061),o=n(56693),s=n(85261),a=n(19735),c=n(83624);async function l(e){var n;const i=null===(n=(0,o.getActiveTextEditor)())||void 0===n?void 0:n.document;if(i&&("pip-requirements"===i.languageId||i.fileName.endsWith("pyproject.toml"))){const n=e.get(i.uri);if(n&&n.length>0)return(0,a.traceVerbose)(`Setting context for python dependencies not installed: ${i.uri.fsPath}`),void await(0,r.executeCommand)("setContext",t.DEPS_NOT_INSTALLED_KEY,!0)}(0,a.traceVerbose)(`Clearing context for python dependencies not installed: ${null==i?void 0:i.uri.fsPath}`),await(0,r.executeCommand)("setContext",t.DEPS_NOT_INSTALLED_KEY,!1)}t.DEPS_NOT_INSTALLED_KEY="pythonDepsNotInstalled",t.registerInstalledPackagesDiagnosticsProvider=function(e,t){const n=(0,i.createDiagnosticCollection)(c.INSTALL_CHECKER_SOURCE),r=(e,t)=>{t.length>0?n.set(e,t):n.has(e)&&n.delete(e)};e.push(n),e.push((0,s.onDidOpenTextDocument)((async e=>{if("pip-requirements"===e.languageId||e.fileName.endsWith("pyproject.toml")){const n=await(0,c.getInstalledPackagesDiagnostics)(t,e);r(e.uri,n)}})),(0,s.onDidSaveTextDocument)((async e=>{if("pip-requirements"===e.languageId||e.fileName.endsWith("pyproject.toml")){const n=await(0,c.getInstalledPackagesDiagnostics)(t,e);r(e.uri,n)}})),(0,s.onDidCloseTextDocument)((e=>{r(e.uri,[])})),(0,i.onDidChangeDiagnostics)((async()=>{await l(n)})),(0,o.onDidChangeActiveTextEditor)((async()=>{await l(n)})),t.onDidChange((()=>{(0,s.getOpenTextDocuments)().forEach((async e=>{if("pip-requirements"===e.languageId||e.fileName.endsWith("pyproject.toml")){const n=await(0,c.getInstalledPackagesDiagnostics)(t,e);r(e.uri,n)}}))}))),(0,s.getOpenTextDocuments)().forEach((async e=>{if("pip-requirements"===e.languageId||e.fileName.endsWith("pyproject.toml")){const n=await(0,c.getInstalledPackagesDiagnostics)(t,e);r(e.uri,n)}}))}},31867:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.condaCreationProvider=void 0;const r=n(66828),i=n(71017),o=n(77570),s=n(19735),a=n(67995),c=n(18699),l=n(59314),u=n(87450),p=n(4057),d=n(67098),h=n(83741),f=n(83606),g=n(56693),m=n(61522),v=n(54813),y=n(22180),b=n(94146);async function S(e){const t=await(0,h.getCondaBaseEnv)();if(!t)return;let n;const S=new g.MultiStepNode(void 0,(async e=>{try{n=await(0,a.pickWorkspaceFolder)(void 0,e)}catch(e){if(e===g.MultiStepAction.Back||e===g.MultiStepAction.Cancel)return e;throw e}return void 0===n?((0,s.traceError)("Workspace was not selected or found for creating conda environment."),g.MultiStepAction.Cancel):((0,s.traceInfo)(`Selected workspace ${n.uri.fsPath} for creating conda environment.`),g.MultiStepAction.Continue)}),void 0);let E;const _=new g.MultiStepNode(S,(async()=>{try{E=await(0,h.pickPythonVersion)()}catch(e){if(e===g.MultiStepAction.Back||e===g.MultiStepAction.Cancel)return e;throw e}return void 0===E?((0,s.traceError)("Python version was not selected for creating conda environment."),g.MultiStepAction.Cancel):((0,s.traceInfo)(`Selected Python version ${E} for creating conda environment.`),g.MultiStepAction.Continue)}),void 0);S.next=_;const w=await g.MultiStepNode.run(S);if(w===g.MultiStepAction.Back||w===g.MultiStepAction.Cancel)throw w;return(0,g.withProgress)({location:r.ProgressLocation.Notification,title:`${d.CreateEnv.statusTitle} ([${d.Common.showLogs}](command:${o.Commands.ViewOutput}))`,cancellable:!0},(async(r,o)=>{let a;r.report({message:d.CreateEnv.statusStarting});try{if((0,v.sendTelemetryEvent)(m.EventName.ENVIRONMENT_CREATING,void 0,{environmentType:"conda",pythonVersion:E}),n){if(a=await async function(e,t,n,r,o){r.report({message:d.CreateEnv.Conda.creating});const a=(0,l.createDeferred)();let p=(0,u.getEnvironmentVariable)("PATH")||(0,u.getEnvironmentVariable)("Path")||"";if((0,u.getOSType)()===u.OSType.Windows){const e=i.dirname(t);p=`${[i.join(e,"Library","bin"),i.join(e,"Library","mingw-w64","bin"),i.join(e,"Library","usr","bin"),i.join(e,"bin"),i.join(e,"Scripts")].join(i.delimiter)}${i.delimiter}${p}`}(0,s.traceLog)("Running Conda Env creation script: ",[t,...n]);const{proc:h,out:f,dispose:g}=(0,c.execObservable)(t,n,{mergeStdOutErr:!0,token:o,cwd:e.uri.fsPath,env:{PATH:p}}),m=new y.CondaProgressAndTelemetry(r);let v;return f.subscribe((e=>{const t=(0,b.splitLines)(e.out).join("\r\n");(0,s.traceLog)(t),(t.includes(y.CONDA_ENV_CREATED_MARKER)||t.includes(y.CONDA_ENV_EXISTING_MARKER))&&(v=function(e){try{const t=e.split(/\r?\n/g).map((e=>e.trim())).filter((e=>e.startsWith(y.CONDA_ENV_CREATED_MARKER)||e.startsWith(y.CONDA_ENV_EXISTING_MARKER)))[0];return t.includes(y.CONDA_ENV_CREATED_MARKER)?t.substring(y.CONDA_ENV_CREATED_MARKER.length):t.substring(y.CONDA_ENV_EXISTING_MARKER.length)}catch(e){return void(0,s.traceError)("Parsing out environment path failed.")}}(t)),m.process(t)}),(async e=>{(0,s.traceError)("Error while running conda env creation script: ",e),a.reject(e)}),(()=>{g(),0!==(null==h?void 0:h.exitCode)?((0,s.traceError)("Error while running venv creation script: ",m.getLastError()),a.reject(m.getLastError()||`Conda env creation failed with exitCode: ${null==h?void 0:h.exitCode}`)):a.resolve(v)})),a.promise}(n,(h=t,(0,u.getOSType)()===u.OSType.Windows?i.join(h,"python.exe"):i.join(h,"bin","python")),function(e,t){let n=!0,r=!0;t&&(n=void 0===(null==t?void 0:t.ignoreSourceControl)||t.ignoreSourceControl,r=void 0===(null==t?void 0:t.installPackages)||t.installPackages);const i=[(0,p.createCondaScript)()];return n&&i.push("--git-ignore"),r&&i.push("--install"),e&&(i.push("--python"),i.push(e)),i}(E,e),r,o),a)return{path:a,workspaceFolder:n};throw new Error("Failed to create conda environment. See Output > Python for more info.")}throw new Error("A workspace is needed to create conda environment")}catch(e){return(0,s.traceError)(e),(0,f.showErrorMessageWithLogs)(d.CreateEnv.Conda.errorCreatingEnvironment),{error:e}}var h}))}t.condaCreationProvider=function(){return{createEnvironment:S,name:"Conda",description:d.CreateEnv.Conda.providerDescription,id:`${o.PVSC_EXTENSION_ID}:conda`,tools:["Conda"]}}},22180:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CondaProgressAndTelemetry=t.CREATE_FAILED_INSTALL_YML=t.CREATE_CONDA_INSTALLED_YML=t.CREATE_CONDA_FAILED_MARKER=t.CONDA_INSTALLING_YML=t.CONDA_ENV_EXISTING_MARKER=t.CONDA_ENV_CREATED_MARKER=void 0;const r=n(67098),i=n(54813),o=n(61522);t.CONDA_ENV_CREATED_MARKER="CREATED_CONDA_ENV:",t.CONDA_ENV_EXISTING_MARKER="EXISTING_CONDA_ENV:",t.CONDA_INSTALLING_YML="CONDA_INSTALLING_YML:",t.CREATE_CONDA_FAILED_MARKER="CREATE_CONDA.ENV_FAILED_CREATION",t.CREATE_CONDA_INSTALLED_YML="CREATE_CONDA.INSTALLED_YML",t.CREATE_FAILED_INSTALL_YML="CREATE_CONDA.FAILED_INSTALL_YML",t.CondaProgressAndTelemetry=class{constructor(e){this.progress=e,this.condaCreatedReported=!1,this.condaFailedReported=!1,this.condaInstallingPackagesReported=!1,this.condaInstallingPackagesFailedReported=!1,this.condaInstalledPackagesReported=!1,this.lastError=void 0}process(e){!this.condaCreatedReported&&e.includes(t.CONDA_ENV_CREATED_MARKER)?(this.condaCreatedReported=!0,this.progress.report({message:r.CreateEnv.Conda.created}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"conda",reason:"created"})):!this.condaCreatedReported&&e.includes(t.CONDA_ENV_EXISTING_MARKER)?(this.condaCreatedReported=!0,this.progress.report({message:r.CreateEnv.Conda.created}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"conda",reason:"existing"})):!this.condaFailedReported&&e.includes(t.CREATE_CONDA_FAILED_MARKER)?(this.condaFailedReported=!0,(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"conda",reason:"other"}),this.lastError=t.CREATE_CONDA_FAILED_MARKER):!this.condaInstallingPackagesReported&&e.includes(t.CONDA_INSTALLING_YML)?(this.condaInstallingPackagesReported=!0,this.progress.report({message:r.CreateEnv.Conda.installingPackages}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"conda",using:"environment.yml"})):!this.condaInstallingPackagesFailedReported&&e.includes(t.CREATE_FAILED_INSTALL_YML)?(this.condaInstallingPackagesFailedReported=!0,(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"conda",using:"environment.yml"}),this.lastError=t.CREATE_FAILED_INSTALL_YML):!this.condaInstalledPackagesReported&&e.includes(t.CREATE_CONDA_INSTALLED_YML)&&(this.condaInstalledPackagesReported=!0,(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLED_PACKAGES,void 0,{environmentType:"conda",using:"environment.yml"}))}getLastError(){return this.lastError}}},83741:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pickPythonVersion=t.getCondaBaseEnv=void 0;const r=n(66828),i=n(41659),o=n(77570),s=n(67098),a=n(98638),c=n(56693),l=n(19735),u=n(75470);t.getCondaBaseEnv=async function(){const e=await u.Conda.getConda();if(!e)return void(await(0,c.showErrorMessage)(s.CreateEnv.Conda.condaMissing,i.Common.learnMore)===i.Common.learnMore&&await(0,a.executeCommand)("vscode.open",r.Uri.parse("https://docs.anaconda.com/anaconda/install/")));const t=(await e.getEnvList()).filter((e=>"base"===e.name));if(1===t.length)return t[0].prefix;t.length>1&&(0,l.traceLog)("Multiple conda base envs detected: ",t.map((e=>e.prefix)))},t.pickPythonVersion=async function(e){const t=["3.10","3.11","3.9","3.8","3.7"].map((e=>({label:"3.10"===e?`${o.Octicons.Star} Python`:"Python",description:e}))),n=await(0,c.showQuickPickWithBack)(t,{placeHolder:s.CreateEnv.Conda.selectPythonQuickPickPlaceholder,matchOnDescription:!0,ignoreFocusOut:!0},e);if(n)return n.description}},15739:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VenvCreationProvider=void 0;const r=n(22037),i=n(66828),o=n(77570),s=n(4057),a=n(18699),c=n(59314),l=n(67098),u=n(19735),p=n(67995),d=n(81387),h=n(56693),f=n(54813),g=n(61522),m=n(78970),v=n(83606),y=n(12771),b=n(22207);t.VenvCreationProvider=class{constructor(e){this.interpreterQuickPick=e,this.name="Venv",this.description=l.CreateEnv.Venv.providerDescription,this.id=`${o.PVSC_EXTENSION_ID}:venv`,this.tools=["Venv"]}async createEnvironment(e){let t;const n=new h.MultiStepNode(void 0,(async e=>{try{t=await(0,p.pickWorkspaceFolder)(void 0,e)}catch(e){if(e===h.MultiStepAction.Back||e===h.MultiStepAction.Cancel)return e;throw e}return void 0===t?((0,u.traceError)("Workspace was not selected or found for creating virtual environment."),h.MultiStepAction.Cancel):((0,u.traceInfo)(`Selected workspace ${t.uri.fsPath} for creating virtual environment.`),h.MultiStepAction.Continue)}),void 0);let S;const E=new h.MultiStepNode(n,(async e=>{if(t&&e===h.MultiStepAction.Continue)try{return S=await(0,y.pickExistingVenvAction)(t),h.MultiStepAction.Continue}catch(e){if(e===h.MultiStepAction.Back||e===h.MultiStepAction.Cancel)return e;throw e}else if(e===h.MultiStepAction.Back)return h.MultiStepAction.Back;return h.MultiStepAction.Continue}),void 0);let _;n.next=E;const w=new h.MultiStepNode(E,(async e=>{if(t)if(S===y.ExistingVenvAction.Recreate||S===y.ExistingVenvAction.Create)try{_=await this.interpreterQuickPick.getInterpreterViaQuickPick(t.uri,(e=>[d.EnvironmentType.System,d.EnvironmentType.MicrosoftStore,d.EnvironmentType.Global,d.EnvironmentType.Pyenv].includes(e.envType)&&void 0===e.type),{skipRecommended:!0,showBackButton:!0,placeholder:l.CreateEnv.Venv.selectPythonPlaceHolder,title:null})}catch(e){if(e===b.InputFlowAction.back)return h.MultiStepAction.Back;_=void 0}else if(S===y.ExistingVenvAction.UseExisting){if(e===h.MultiStepAction.Back)return h.MultiStepAction.Back;_=(0,v.getVenvExecutable)(t)}return _?((0,u.traceInfo)(`Selected interpreter ${_} for creating virtual environment.`),h.MultiStepAction.Continue):((0,u.traceError)("Virtual env creation requires an interpreter."),h.MultiStepAction.Cancel)}),void 0);E.next=w;let T,C=!0,P=!0;e&&(C=void 0===(null==e?void 0:e.ignoreSourceControl)||e.ignoreSourceControl,P=void 0===(null==e?void 0:e.installPackages)||e.installPackages);const I=new h.MultiStepNode(w,(async e=>{if(t&&P)if(S!==y.ExistingVenvAction.UseExisting){try{T=await(0,y.pickPackagesToInstall)(t)}catch(e){if(e===h.MultiStepAction.Back||e===h.MultiStepAction.Cancel)return e;throw e}if(!T)return(0,u.traceVerbose)("Virtual env creation exited during dependencies selection."),h.MultiStepAction.Cancel}else if(e===h.MultiStepAction.Back)return h.MultiStepAction.Back;return h.MultiStepAction.Continue}),void 0);w.next=I;const x=await h.MultiStepNode.run(n);if(x===h.MultiStepAction.Back||x===h.MultiStepAction.Cancel)throw x;if(t)if(S===y.ExistingVenvAction.Recreate){if((0,f.sendTelemetryEvent)(g.EventName.ENVIRONMENT_DELETE,void 0,{environmentType:"venv",status:"triggered"}),!await(0,y.deleteEnvironment)(t,_))throw(0,f.sendTelemetryEvent)(g.EventName.ENVIRONMENT_DELETE,void 0,{environmentType:"venv",status:"failed"}),h.MultiStepAction.Cancel;(0,f.sendTelemetryEvent)(g.EventName.ENVIRONMENT_DELETE,void 0,{environmentType:"venv",status:"deleted"})}else if(S===y.ExistingVenvAction.UseExisting)return(0,f.sendTelemetryEvent)(g.EventName.ENVIRONMENT_REUSE,void 0,{environmentType:"venv"}),{path:(0,v.getVenvExecutable)(t),workspaceFolder:t};const O=function(e,t){var n;const r=[(0,s.createVenvScript)()];if(t&&r.push("--git-ignore"),e){if(e.some((e=>"toml"===e.installType))){const t=null===(n=e.find((e=>"toml"===e.installType)))||void 0===n?void 0:n.source;r.push("--toml",(null==t?void 0:t.fileToCommandArgumentForPythonExt())||"pyproject.toml")}e.filter((e=>"toml"===e.installType)).map((e=>e.installItem)).forEach((e=>{e&&r.push("--extras",e)})),e.filter((e=>"requirements"===e.installType)).map((e=>e.installItem)).forEach((e=>{e&&r.push("--requirements",e)}))}return r}(T,C);return(0,h.withProgress)({location:i.ProgressLocation.Notification,title:`${l.CreateEnv.statusTitle} ([${l.Common.showLogs}](command:${o.Commands.ViewOutput}))`,cancellable:!0},(async(e,n)=>{let i;e.report({message:l.CreateEnv.statusStarting});try{if(_&&t){if(i=await async function(e,t,n,i,o){i.report({message:l.CreateEnv.Venv.creating}),(0,f.sendTelemetryEvent)(g.EventName.ENVIRONMENT_CREATING,void 0,{environmentType:"venv",pythonVersion:void 0});const s=(0,c.createDeferred)();(0,u.traceLog)("Running Env creation script: ",[t,...n]);const{proc:p,out:d,dispose:h}=(0,a.execObservable)(t,n,{mergeStdOutErr:!0,token:o,cwd:e.uri.fsPath}),v=new m.VenvProgressAndTelemetry(i);let y;return d.subscribe((e=>{const t=e.out.split(/\r?\n/g).join(r.EOL);(0,u.traceLog)(t),(t.includes(m.VENV_CREATED_MARKER)||t.includes(m.VENV_EXISTING_MARKER))&&(y=function(e){try{const t=e.split(/\r?\n/g).map((e=>e.trim())).filter((e=>e.startsWith(m.VENV_CREATED_MARKER)||e.startsWith(m.VENV_EXISTING_MARKER)))[0];return t.includes(m.VENV_CREATED_MARKER)?t.substring(m.VENV_CREATED_MARKER.length):t.substring(m.VENV_EXISTING_MARKER.length)}catch(e){return void(0,u.traceError)("Parsing out environment path failed.")}}(t)),v.process(t)}),(e=>{(0,u.traceError)("Error while running venv creation script: ",e),s.reject(e)}),(()=>{h(),0!==(null==p?void 0:p.exitCode)?((0,u.traceError)("Error while running venv creation script: ",v.getLastError()),s.reject(v.getLastError()||`Failed to create virtual environment with exitCode: ${null==p?void 0:p.exitCode}`)):s.resolve(y)})),s.promise}(t,_,O,e,n),i)return{path:i,workspaceFolder:t};throw new Error("Failed to create virtual environment. See Output > Python for more info.")}throw new Error("Failed to create virtual environment. Either interpreter or workspace is undefined.")}catch(e){return(0,u.traceError)(e),(0,v.showErrorMessageWithLogs)(l.CreateEnv.Venv.errorCreatingEnvironment),{error:e}}}))}}},12790:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteEnvironmentWindows=t.deleteEnvironmentNonWindows=void 0;const r=n(55674),i=n(71017),o=n(19735),s=n(83606),a=n(67098),c=n(59314),l=n(41152);async function u(e){try{return!await r.pathExists(e)||(await r.rmdir(e,{recursive:!0,maxRetries:10,retryDelay:200}),!0)}catch(t){return(0,o.traceError)(`Failed to delete directory [${e}]:`,t),!1}}t.deleteEnvironmentNonWindows=async function(e){const t=(0,s.getVenvPath)(e);return await u(t)?((0,o.traceInfo)(`Deleted venv dir: ${t}`),!0):((0,s.showErrorMessageWithLogs)(a.CreateEnv.Venv.errorDeletingEnvironment),!1)},t.deleteEnvironmentWindows=async function(e,t){const n=(0,s.getVenvPath)(e),p=i.join(n,"Scripts","python.exe");if(await async function(e){try{return!await r.pathExists(e)||(await r.unlink(e),!0)}catch(t){return(0,o.traceError)(`Failed to delete file [${e}]:`,t),!1}}(p))return(0,o.traceInfo)(`Deleted python executable: ${p}`),await u(n)?((0,o.traceInfo)(`Deleted ".venv" dir: ${n}`),!0):((0,o.traceError)(`Failed to delete ".venv" dir: ${n}`),(0,o.traceError)("This happens if the virtual environment is still in use, or some binary in the venv is still running."),(0,o.traceError)(`Please delete the ".venv" manually: [${n}]`),(0,s.showErrorMessageWithLogs)(a.CreateEnv.Venv.errorDeletingEnvironment),!1);if((0,o.traceError)(`Failed to delete python executable: ${p}`),(0,o.traceError)("This happens if the virtual environment is still in use."),t){(0,o.traceError)('We will attempt to switch python temporarily to delete the ".venv"'),await(0,l.switchSelectedPython)(t,e.uri,'temporarily to delete the ".venv"'),(0,o.traceInfo)(`Attempting to delete ".venv" again: ${n}`);const r=500;for(let e=0;e<5;e+=1){if((0,o.traceInfo)(`Waiting for ${r}ms to let processes exit, before a delete attempt.`),await(0,c.sleep)(r),await u(n))return(0,o.traceInfo)(`Deleted ".venv" dir: ${n}`),!0;(0,o.traceError)(`Failed to delete ".venv" dir [${n}] (attempt ${e+1}/5).`)}}else(0,o.traceError)(`Please delete the ".venv" dir manually: [${n}]`);return(0,s.showErrorMessageWithLogs)(a.CreateEnv.Venv.errorDeletingEnvironment),!1}},78970:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VenvProgressAndTelemetry=t.VENV_EXISTING_MARKER=t.VENV_CREATED_MARKER=void 0;const r=n(67098),i=n(54813),o=n(61522);t.VENV_CREATED_MARKER="CREATED_VENV:",t.VENV_EXISTING_MARKER="EXISTING_VENV:";const s="CREATE_VENV.PIP_NOT_FOUND",a="CREATE_VENV.VENV_NOT_FOUND",c="CREATE_VENV.PIP_FAILED_INSTALL_REQUIREMENTS",l="CREATE_VENV.PIP_FAILED_INSTALL_PYPROJECT",u="CREATE_VENV.VENV_FAILED_CREATION",p="CREATE_VENV.UPGRADE_PIP_FAILED",d="CREATE_VENV.MICROVENV_FAILED_CREATION",h="CREATE_MICROVENV.MICROVENV_FAILED_CREATION",f="CREATE_VENV.INSTALL_PIP_FAILED",g="CREATE_VENV.DOWNLOAD_PIP_FAILED";t.VenvProgressAndTelemetry=class{constructor(e){this.progress=e,this.processed=new Set,this.reportActions=new Map([[t.VENV_CREATED_MARKER,e=>{e.report({message:r.CreateEnv.Venv.created}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"venv",reason:"created"})}],[t.VENV_EXISTING_MARKER,e=>{e.report({message:r.CreateEnv.Venv.existing}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"venv",reason:"existing"})}],["VENV_INSTALLING_REQUIREMENTS:",e=>{e.report({message:r.CreateEnv.Venv.installingPackages}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"venv",using:"requirements.txt"})}],["VENV_INSTALLING_PYPROJECT:",e=>{e.report({message:r.CreateEnv.Venv.installingPackages}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"venv",using:"pyproject.toml"})}],[s,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"venv",reason:"noPip"}),s)],["CREATE_VENV.DISTUTILS_NOT_INSTALLED",e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"venv",reason:"noDistUtils"}),a)],[a,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"venv",reason:"noVenv"}),a)],[c,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"venv",using:"requirements.txt"}),c)],[l,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"venv",using:"pyproject.toml"}),l)],[u,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"venv",reason:"other"}),u)],["CREATE_VENV.VENV_ALREADY_EXISTS",e=>{(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"venv",reason:"existing"})}],["CREATE_VENV.PIP_INSTALLED_REQUIREMENTS",e=>{(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLED_PACKAGES,void 0,{environmentType:"venv",using:"requirements.txt"})}],["CREATE_VENV.PIP_INSTALLED_PYPROJECT",e=>{(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLED_PACKAGES,void 0,{environmentType:"venv",using:"pyproject.toml"})}],["CREATE_VENV.UPGRADED_PIP",e=>{(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLED_PACKAGES,void 0,{environmentType:"venv",using:"pipUpgrade"})}],[p,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"venv",using:"pipUpgrade"}),p)],["CREATE_VENV.DOWNLOADING_PIP",e=>{e.report({message:r.CreateEnv.Venv.downloadingPip}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"venv",using:"pipDownload"})}],[g,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"venv",using:"pipDownload"}),g)],["CREATE_VENV.INSTALLING_PIP",e=>{e.report({message:r.CreateEnv.Venv.installingPip}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"venv",using:"pipInstall"})}],[f,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES_FAILED,void 0,{environmentType:"venv",using:"pipInstall"}),f)],["CREATE_MICROVENV.CREATING_MICROVENV",e=>{e.report({message:r.CreateEnv.Venv.creatingMicrovenv}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATING,void 0,{environmentType:"microvenv",pythonVersion:void 0})}],[d,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"microvenv",reason:"other"}),d)],[h,e=>((0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_FAILED,void 0,{environmentType:"microvenv",reason:"other"}),h)],["CREATE_MICROVENV.CREATED_MICROVENV",e=>{(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_CREATED,void 0,{environmentType:"microvenv",reason:"created"})}],["CREATE_VENV.UPGRADING_PIP",e=>{e.report({message:r.CreateEnv.Venv.upgradingPip}),(0,i.sendTelemetryEvent)(o.EventName.ENVIRONMENT_INSTALLING_PACKAGES,void 0,{environmentType:"venv",using:"pipUpgrade"})}]]),this.lastError=void 0}getLastError(){return this.lastError}process(e){const t=Array.from(this.reportActions.keys());for(const n of t)if(e.includes(n)&&!this.processed.has(n)){const e=this.reportActions.get(n);if(e){const t=e(this.progress);t&&(this.lastError=t)}this.processed.add(n)}}}},41152:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchSelectedPython=void 0;const r=n(71017),i=n(59314),o=n(50189),s=n(5899),a=n(19735);t.switchSelectedPython=async function(e,t,n){var c;let l;try{const u=(0,i.createDeferred)(),p=null===(c=(0,o.getExtension)(s.PVSC_EXTENSION_ID))||void 0===c?void 0:c.exports;l=p.environments.onDidChangeActiveEnvironmentPath((async t=>{r.normalize(t.path)===r.normalize(e)&&((0,a.traceInfo)(`Switched to interpreter ${n}: ${e}`),u.resolve())})),p.environments.updateActiveEnvironmentPath(e,t),(0,a.traceInfo)(`Switching interpreter ${n}: ${e}`),await u.promise}finally{null==l||l.dispose()}}},12771:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pickExistingVenvAction=t.ExistingVenvAction=t.deleteEnvironment=t.pickPackagesToInstall=t.isPipInstallableToml=void 0;const r=n(5022),i=n(55674),o=n(96486),s=n(71017),a=n(66828),c=n(67098),l=n(56693),u=n(85261),p=n(19735),d=n(77570),h=n(65243),f=n(83606),g=n(12790),m="**/{.venv*,.git,.nox,.tox,.conda,site-packages,__pypackages__}/**";function v(e){try{return r.parse(e)}catch(e){(0,p.traceError)("Failed to parse `pyproject.toml`:",e)}return{}}function y(e){return void 0!==e["build-system"]}var b;t.isPipInstallableToml=function(e){return y(v(e))},t.pickPackagesToInstall=async function(e,t){const n=s.join(e.uri.fsPath,"pyproject.toml"),r=[],d=new l.MultiStepNode(void 0,(async e=>{(0,p.traceVerbose)(`Looking for toml pyproject.toml with optional dependencies at: ${n}`);let s=[],a=!1;if(await i.pathExists(n)){const e=v(await i.readFile(n,"utf-8"));s=function(e){const t=[];if(e.project&&e.project["optional-dependencies"]){const n=e.project["optional-dependencies"];for(const e of Object.keys(n))t.push(e)}return t}(e),a=y(e),a||(0,p.traceVerbose)("Create env: Found toml without build system. So we will not use editable install."),0===s.length&&(0,p.traceVerbose)("Create env: Found toml without optional dependencies.")}else if(e===l.MultiStepAction.Back)return l.MultiStepAction.Back;if(a)if(s.length>0){(0,p.traceVerbose)("Create Env: Found toml with optional dependencies.");try{const e=await async function(e,t){const n=e.map((e=>({label:e}))),r=await(0,l.showQuickPickWithBack)(n,{placeHolder:c.CreateEnv.Venv.tomlExtrasQuickPickTitle,canPickMany:!0,ignoreFocusOut:!0},t);if(r&&(0,o.isArray)(r))return r.map((e=>e.label))}(s,t);if(!e)return l.MultiStepAction.Cancel;e.length>0&&e.forEach((e=>{r.push({installType:"toml",installItem:e,source:n})})),r.push({installType:"toml",source:n})}catch(e){if(e===l.MultiStepAction.Back||e===l.MultiStepAction.Cancel)return e;throw e}}else{if(e===l.MultiStepAction.Back)return l.MultiStepAction.Back;r.push({installType:"toml",source:n})}else if(e===l.MultiStepAction.Back)return l.MultiStepAction.Back;return l.MultiStepAction.Continue}),void 0),h=new l.MultiStepNode(d,(async n=>{var i;(0,p.traceVerbose)("Looking for pip requirements.");const d=null===(i=await async function(e,t){return(0,o.flatten)(await Promise.all([(0,u.findFiles)(new a.RelativePattern(e,"**/*requirement*.txt"),m,void 0,t),(0,u.findFiles)(new a.RelativePattern(e,"**/requirements/*.txt"),m,void 0,t)])).map((e=>e.fsPath))}(e,t))||void 0===i?void 0:i.map((t=>s.relative(e.uri.fsPath,t)));if(d&&d.length>0){(0,p.traceVerbose)("Found pip requirements.");try{const n=await async function(e,t){const n=e.sort(((e,t)=>{const n=e.split(/[\\\/]/).length,r=t.split(/[\\\/]/).length;return n===r?e.length===t.length?e.localeCompare(t):e.length-t.length:n-r})).map((e=>({label:e}))),r=await(0,l.showQuickPickWithBack)(n,{placeHolder:c.CreateEnv.Venv.requirementsQuickPickTitle,ignoreFocusOut:!0,canPickMany:!0},t);if(r&&(0,o.isArray)(r))return r.map((e=>e.label))}(d,t),i=null==n?void 0:n.map((t=>s.join(e.uri.fsPath,t)));if(!i)return l.MultiStepAction.Cancel;i.forEach((e=>{r.push({installType:"requirements",installItem:e})}))}catch(e){if(e===l.MultiStepAction.Back||e===l.MultiStepAction.Cancel)return e;throw e}}else if(n===l.MultiStepAction.Back)return l.MultiStepAction.Back;return l.MultiStepAction.Continue}),void 0);d.next=h;const f=await l.MultiStepNode.run(d);if(f===l.MultiStepAction.Back||f===l.MultiStepAction.Cancel)throw f;return r},t.deleteEnvironment=async function(e,t){const n=(0,f.getVenvPath)(e);return(0,l.withProgress)({location:a.ProgressLocation.Notification,title:`${c.CreateEnv.Venv.deletingEnvironmentProgress} ([${c.Common.showLogs}](command:${d.Commands.ViewOutput})): ${n}`,cancellable:!1},(async()=>(0,h.isWindows)()?(0,g.deleteEnvironmentWindows)(e,t):(0,g.deleteEnvironmentNonWindows)(e)))},function(e){e[e.Recreate=0]="Recreate",e[e.UseExisting=1]="UseExisting",e[e.Create=2]="Create"}(b=t.ExistingVenvAction||(t.ExistingVenvAction={})),t.pickExistingVenvAction=async function(e){if(e){if(!await(0,f.hasVenv)(e))return b.Create;{const e=[{label:c.CreateEnv.Venv.recreate,description:c.CreateEnv.Venv.recreateDescription},{label:c.CreateEnv.Venv.useExisting,description:c.CreateEnv.Venv.useExistingDescription}],t=await(0,l.showQuickPickWithBack)(e,{placeHolder:c.CreateEnv.Venv.existingVenvQuickPickPlaceholder,ignoreFocusOut:!0},void 0);if((null==t?void 0:t.label)===c.CreateEnv.Venv.recreate)return b.Recreate;if((null==t?void 0:t.label)===c.CreateEnv.Venv.useExisting)return b.UseExisting}}throw l.MultiStepAction.Cancel}},21190:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerPyProjectTomlFeatures=void 0;const r=n(98638),i=n(85261),o=n(12771);async function s(e){(0,o.isPipInstallableToml)(e.getText())?await(0,r.executeCommand)("setContext","pipInstallableToml",!0):await(0,r.executeCommand)("setContext","pipInstallableToml",!1)}t.registerPyProjectTomlFeatures=function(e){e.push((0,i.onDidOpenTextDocument)((async e=>{e.fileName.endsWith("pyproject.toml")&&await s(e)})),(0,i.onDidSaveTextDocument)((async e=>{e.fileName.endsWith("pyproject.toml")&&await s(e)}))),(0,i.getOpenTextDocuments)().filter((e=>e.fileName.endsWith("pyproject.toml")&&(0,o.isPipInstallableToml)(e.getText()))).length>0?(0,r.executeCommand)("setContext","pipInstallableToml",!0):(0,r.executeCommand)("setContext","pipInstallableToml",!1)}},63369:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAllCreateEnvironmentFeatures=void 0;const r=n(85949),i=n(61267),o=n(50939),s=n(21190);t.registerAllCreateEnvironmentFeatures=function(e,t,n,a){(0,r.registerCreateEnvironmentFeatures)(e,t,n,a),(0,i.registerCreateEnvironmentButtonFeatures)(e),(0,s.registerPyProjectTomlFeatures)(e),(0,o.registerInstalledPackagesDiagnosticsProvider)(e,n)}},24708:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyPythonExecInfo=t.buildPythonExecInfo=void 0,t.buildPythonExecInfo=function(e,t,n){if(Array.isArray(e)){const r=e.slice(1);return t&&r.push(...t),{args:r,command:e[0],python:[...e],pythonExecutable:null!=n?n:e[e.length-1]}}return{command:e,args:t||[],python:[e],pythonExecutable:e}},t.copyPythonExecInfo=function(e,t){const n={command:e.command,args:[...e.args],python:[...e.python],pythonExecutable:e.pythonExecutable};return t&&n.args.push(...t),void 0===n.pythonExecutable&&(n.pythonExecutable=n.python[n.python.length-1]),n}},29817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.activate=t.initialize=void 0;const r=n(66828),i=n(66828),o=n(96486),s=n(73766),a=n(87450),c=n(30752),l=n(27736),u=n(44644),p=n(3143),d=n(37769),h=n(14424),f=n(82399),g=n(74437),m=n(93235),v=n(43160),y=n(41770),b=n(5613),S=n(39046),E=n(67931),_=n(22544),w=n(68624),T=n(11069),C=n(97954),P=n(17021),I=n(19735),x=n(96255);function O(e){const{initRoot:t,addRoot:n,removeRoot:i}=e,o=r.workspace.workspaceFolders;return o&&o.map((e=>e.uri)).forEach(t),r.workspace.onDidChangeWorkspaceFolders((e=>{for(const t of e.removed)i(t.uri);for(const t of e.added)n(t.uri)}))}t.initialize=async function(e){(0,d.initializeExternalDependencies)(e.legacyIOC.serviceContainer);const t=await(0,T.createPythonEnvironments)((()=>async function(e){const t=new h.ExtensionLocators(function(e){const t=[];t.push(new y.PyenvLocator,new g.CondaEnvironmentLocator,new x.ActiveStateLocator,new m.GlobalVirtualEnvironmentLocator,new f.CustomVirtualEnvironmentLocator),(0,a.getOSType)()===a.OSType.Windows?t.push(new b.WindowsRegistryLocator,new S.MicrosoftStoreLocator,new u.WindowsPathEnvVarLocator):t.push(new v.PosixKnownPathsLocator);const n=t.filter((e=>void 0!==e.dispose));return e.disposables.push(...n),t}(e),function(e){const t=new h.WorkspaceLocators(O,[e=>[new p.WorkspaceVirtualEnvironmentLocator(e.fsPath),new w.PoetryLocator(e.fsPath)]]);return e.disposables.push(t),t}(e)),n=(0,E.getEnvironmentInfoService)(e.disposables),r=new c.PythonEnvsReducer(t),d=new l.PythonEnvsResolver(r,n);return new P.EnvsCollectionService(await async function(e){const t=(0,s.getGlobalStorage)(e.context,"PYTHON_ENV_INFO_CACHE",[]);return await(0,C.createCollectionCache)({get:()=>function(e){return e.get().map((e=>(e.searchLocation&&("string"==typeof e.searchLocation?e.searchLocation=i.Uri.parse(e.searchLocation):"scheme"in e.searchLocation&&"path"in e.searchLocation?e.searchLocation=i.Uri.parse(`${e.searchLocation.scheme}://${e.searchLocation.path}`):(0,I.traceError)("Unexpected search location",JSON.stringify(e.searchLocation))),e)))}(t),store:async e=>function(e,t){return e.set((0,o.cloneDeep)(t).map((e=>(e.searchLocation&&(e.searchLocation=e.searchLocation.toString()),e)))),Promise.resolve()}(t,e)})}(e),d)}(e)));return(0,_.registerNewDiscoveryForIOC)(e.legacyIOC.serviceManager,t),t},t.activate=async function(e,t){const n=r.workspace.workspaceFolders;return(0,s.getGlobalStorage)(t.context,"PYTHON_ENV_INFO_CACHE",[]).get().length>0?null==n||n.forEach((async n=>{const r=(0,s.getGlobalStorage)(t.context,`PYTHON_WAS_DISCOVERY_TRIGGERED_${(0,d.normCasePath)(n.uri.fsPath)}`,!1);r.get()||(e.triggerRefresh({searchLocations:{roots:[n.uri],doNotIncludeNonRooted:!0}}).ignoreErrors(),await r.set(!0))})):(e.triggerRefresh().ignoreErrors(),null==n||n.forEach((async e=>{const n=(0,s.getGlobalStorage)(t.context,`PYTHON_WAS_DISCOVERY_TRIGGERED_${(0,d.normCasePath)(e.uri.fsPath)}`,!1);await n.set(!0)}))),{fullyReady:Promise.resolve()}}},93400:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExecutablePath=void 0;const r=n(31776),i=n(19735),o=n(24708);t.getExecutablePath=async function(e,t){try{const[n,i]=(0,r.getExecutable)(),s=(0,o.copyPythonExecInfo)(e,n),a=[s.command,...s.args].reduce(((e,t)=>e?`${e} ${t.toCommandArgumentForPythonExt()}`:`${t.toCommandArgumentForPythonExt()}`),""),c=i((await t(a,{timeout:15e3})).stdout.trim());if(""===c)throw new Error(`${a} resulted in empty stdout`);return c}catch(e){return void(0,i.traceError)(e)}}},81387:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvironmentTypeName=t.ModuleInstallerType=t.virtualEnvTypes=t.EnvironmentType=void 0,function(e){e.Unknown="Unknown",e.Conda="Conda",e.VirtualEnv="VirtualEnv",e.Pipenv="PipEnv",e.Pyenv="Pyenv",e.Venv="Venv",e.MicrosoftStore="MicrosoftStore",e.Poetry="Poetry",e.VirtualEnvWrapper="VirtualEnvWrapper",e.ActiveState="ActiveState",e.Global="Global",e.System="System"}(n=t.EnvironmentType||(t.EnvironmentType={})),t.virtualEnvTypes=[n.Poetry,n.Pipenv,n.Venv,n.VirtualEnvWrapper,n.Conda,n.VirtualEnv],(r=t.ModuleInstallerType||(t.ModuleInstallerType={})).Unknown="Unknown",r.Conda="Conda",r.Pip="Pip",r.Poetry="Poetry",r.Pipenv="Pipenv",t.getEnvironmentTypeName=function(e){switch(e){case n.Conda:return"conda";case n.Pipenv:return"pipenv";case n.Pyenv:return"pyenv";case n.Venv:return"venv";case n.VirtualEnv:return"virtualenv";case n.MicrosoftStore:return"microsoft store";case n.Poetry:return"poetry";case n.VirtualEnvWrapper:return"virtualenvwrapper";case n.ActiveState:return"activestate";default:return""}}},69554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInterpreterInfo=void 0;const r=n(81249),i=n(4057),o=n(94146),s=n(87450),a=n(24708);t.getInterpreterInfo=async function(e,t,n){const[c,l]=(0,i.interpreterInfo)(),u=(0,a.copyPythonExecInfo)(e,c),p=[u.command,...u.args],d=p.reduce(((e,t)=>e?`${e} "${t}"`:`"${(0,o.replaceAll)(t,"\\","\\\\")}"`),""),h=await t(d,{timeout:15e3});h.stderr&&n&&n.error(`Failed to parse interpreter information for ${p} stderr: ${h.stderr}`);const f=l(h.stdout);if(n&&n.verbose(`Found interpreter for ${p}`),f)return function(e,t){let n=`${t.versionInfo.slice(0,3).join(".")}`;if(void 0!==t.versionInfo[3]&&["alpha","beta","candidate"].includes(t.versionInfo[3])&&(n=`${n}-${t.versionInfo[3]}`,void 0!==t.versionInfo[4])){let e=-1;try{e=parseInt(`${t.versionInfo[4]}`,10)}catch(t){e=-1}n=e>=0?`${n}${e}`:n}return{architecture:t.is64Bit?s.Architecture.x64:s.Architecture.x86,path:e,version:new r.SemVer(n),sysVersion:t.sysVersion,sysPrefix:t.sysPrefix}}(e.pythonExecutable,f)}},22544:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.registerNewDiscoveryForIOC=void 0;const i=n(86700),o=n(96486),s=n(66828),a=n(88409),c=n(18639),l=n(45878),u=n(35271),p=n(37769),d=n(81387),h=n(95084),f=n(59314),g=n(99910),m=n(75470),v=n(10423),y=n(1132),b=n(19735),S=new Map(Object.entries({[l.PythonEnvKind.OtherGlobal]:d.EnvironmentType.Global,[l.PythonEnvKind.System]:d.EnvironmentType.System,[l.PythonEnvKind.MicrosoftStore]:d.EnvironmentType.MicrosoftStore,[l.PythonEnvKind.Pyenv]:d.EnvironmentType.Pyenv,[l.PythonEnvKind.Conda]:d.EnvironmentType.Conda,[l.PythonEnvKind.VirtualEnv]:d.EnvironmentType.VirtualEnv,[l.PythonEnvKind.Pipenv]:d.EnvironmentType.Pipenv,[l.PythonEnvKind.Poetry]:d.EnvironmentType.Poetry,[l.PythonEnvKind.Venv]:d.EnvironmentType.Venv,[l.PythonEnvKind.VirtualEnvWrapper]:d.EnvironmentType.VirtualEnvWrapper,[l.PythonEnvKind.ActiveState]:d.EnvironmentType.ActiveState}));function E(e){const{name:t,location:n,executable:r,arch:i,kind:o,version:s,distro:a,id:c}=e,{filename:l,sysPrefix:u}=r,p={id:c,sysPrefix:u,envType:d.EnvironmentType.Unknown,envName:t,envPath:n,path:l,architecture:i},f=S.get(o);if(void 0!==f&&(p.envType=f),void 0!==s){const{release:e,sysVersion:t}=s;p.sysVersion=void 0===e?"":t;const n=(0,h.toSemverLikeVersion)(s);p.version=n}return void 0!==a&&""!==a.org&&(p.companyDisplayName=a.org),p.displayName=e.display,p.detailedDisplayName=e.detailedDisplayName,p.type=e.type,p}let _=class{constructor(e){this.api=e,this.changed=new s.EventEmitter,this.api.onChanged((e=>{this.changed.fire({type:e.type,new:e.new?E(e.new):void 0,old:e.old?E(e.old):void 0,resource:e.searchLocation})}))}triggerRefresh(e,t){return this.api.triggerRefresh(e,t)}getRefreshPromise(){return this.api.getRefreshPromise()}get onProgress(){return this.api.onProgress}get onChanged(){return this.changed.event}onDidCreate(e,t){const n=e?s.workspace.getWorkspaceFolder(e):void 0;return this.api.onChanged((e=>{n&&e.searchLocation&&((0,b.traceVerbose)(`Received event ${JSON.stringify(e)} file change event`),e.type===a.FileChangeType.Created&&(0,p.isParentPath)(e.searchLocation.fsPath,n.uri.fsPath)&&t())}))}async getInterpreterInformation(e){const t=await this.api.resolveEnv(e);return t?E(t):void 0}async isMacDefaultPythonPath(e){return(0,u.isMacDefaultPythonPath)(e)}async getInterpreterDetails(e){const t=await this.api.resolveEnv(e);if(t)return E(t)}async isCondaEnvironment(e){return(0,m.isCondaEnvironment)(e)}async getCondaEnvironment(e){if(!await(0,m.isCondaEnvironment)(e))return;const t=await this.api.resolveEnv(e);return t?{name:t.name,path:t.location}:void 0}async isMicrosoftStoreInterpreter(e){return(0,v.isMicrosoftStoreEnvironment)(e)}async hasInterpreters(e=(async()=>!0)){const t=(0,f.createDeferred)();return this.api.onChanged((async n=>{n.new&&await e(E(n.new))&&t.resolve()})),(await(0,g.asyncFilter)(this.api.getEnvs(),(t=>e(E(t))))).length>0||(await Promise.race([t.promise,this.api.getRefreshPromise()]),(await(0,g.asyncFilter)(this.api.getEnvs(),(t=>e(E(t))))).length>0)}getInterpreters(e,t){const n={};let r,i=[];void 0!==e&&(r=s.workspace.getWorkspaceFolder(e),r&&(i=[r.uri])),!r&&s.workspace.workspaceFolders&&s.workspace.workspaceFolders.length>0&&(!e||"untitled"===e.scheme)&&(i=s.workspace.workspaceFolders.map((e=>e.uri))),n.searchLocations={roots:i};let a=this.api.getEnvs(n);return t&&(a=a.filter((e=>(0,o.intersection)(t,e.source).length>0))),a.map(E)}async getWorkspaceVirtualEnvInterpreters(e,t){const n=s.workspace.getWorkspaceFolder(e);if(!n)return[];const r={searchLocations:{roots:[n.uri],doNotIncludeNonRooted:!0}};return(null==t?void 0:t.ignoreCache)&&await this.api.triggerRefresh(r),await this.api.getRefreshPromise(),this.api.getEnvs(r).map(E)}};_=r([(0,i.injectable)()],_),t.registerNewDiscoveryForIOC=function(e,t){e.addSingleton(c.ICondaService,y.CondaService),e.addSingletonInstance(c.IComponentAdapter,new _(t))}},69284:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.SourceMapSupport=void 0;const r=n(71017);n(32727);const i=n(90209),o=n(63281),s=n(19735),a="sourceMapsEnabled";class c{constructor(e){this.vscode=e,this.config=this.vscode.workspace.getConfiguration("python.diagnostics",null)}async initialize(){if(!this.enabled)return;await this.enableSourceMaps(!0),n(75913).install();const e=n(67098),t=e.Diagnostics.disableSourceMaps;this.vscode.window.showWarningMessage(e.Diagnostics.warnSourceMaps,t).then((e=>{e===t&&this.disable().ignoreErrors()}))}get enabled(){return this.config.get(a,!1)}async disable(){this.enabled&&await this.config.update(a,!1,this.vscode.ConfigurationTarget.Global),await this.enableSourceMaps(!1)}async enableSourceMaps(e){const t=r.join(o.EXTENSION_ROOT_DIR,"out","client","extension.js"),n=r.join(o.EXTENSION_ROOT_DIR,"out","client","debugger","debugAdapter","main.js");await Promise.all([this.enableSourceMap(e,t),this.enableSourceMap(e,n)])}async enableSourceMap(e,t){const n=`${t}.map`,r=`${t}.map.disabled`;e?await this.rename(r,n):await this.rename(n,r)}async rename(e,t){const n=new i.FileSystem;await n.fileExists(t)||await n.move(e,t)}}t.SourceMapSupport=c,t.initialize=function(e=n(66828)){e.workspace.getConfiguration("python.diagnostics",null).get("sourceMapsEnabled",!1)?new c(e).initialize().catch((e=>{(0,s.traceError)("Failed to initialize source map support in extension")})):new c(e).disable().ignoreErrors()}},13825:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasUserDefinedPythonPath=t.sendErrorTelemetry=t.sendStartupTelemetry=void 0;const r=n(66828),i=n(17585),o=n(77570),s=n(58400),a=n(61684),c=n(87282),l=n(18639),u=n(19735),p=n(81387),d=n(54813),h=n(61522);function f(e,t){let n=t.get(a.IInterpreterPathService).inspect(e);return!!(n.workspaceFolderValue&&"python"!==n.workspaceFolderValue||n.workspaceValue&&"python"!==n.workspaceValue||n.globalValue&&"python"!==n.globalValue)}async function g(e){var t,n;const o=r.env.appName,a=e.get(i.IWorkspaceService),d=(null===(t=a.workspaceFolders)||void 0===t?void 0:t.length)||0,h=e.get(s.ITerminalHelper).identifyTerminalShell();if(!a.isTrusted)return{workspaceFolderCount:d,terminal:h};const g=e.get(l.IInterpreterService),m=(null===(n=a.workspaceFolders)||void 0===n?void 0:n.length)?a.workspaceFolders[0].uri:void 0,v=await g.hasInterpreters((async e=>{var t;return 3===(null===(t=e.version)||void 0===t?void 0:t.major)}));await g.refreshPromise;const y=await g.getActiveInterpreter().catch((()=>{})),b=y&&y.version?y.version.raw:void 0,S=y?y.envType:void 0;let E;if(S===p.EnvironmentType.Unknown&&(0,u.traceError)("Active interpreter type is detected as Unknown",JSON.stringify(y)),S===p.EnvironmentType.Conda){const t=e.get(l.ICondaService);E=await t.getCondaVersion().then((e=>e?e.raw:"")).catch((()=>""))}const _=f(m,e),w=!!y&&function(e,t){const n=t.get(c.IInterpreterAutoSelectionService).getAutoSelectedInterpreter(void 0);return!!n&&e===n.path}(y.path,e);return{condaVersion:E,terminal:h,pythonVersion:b,interpreterType:S,workspaceFolderCount:d,hasPythonThree:v,usingUserDefinedInterpreter:_,usingGlobalInterpreter:w,appName:o}}t.sendStartupTelemetry=async function(e,t,n,r){if(!(0,o.isTestExecution)())try{await e,t.totalNonBlockingActivateTime=n.elapsedTime-t.startActivateTime;const i=await g(r);(0,d.sendTelemetryEvent)(h.EventName.EDITOR_LOAD,t,i)}catch(e){(0,u.traceError)("sendStartupTelemetry() failed.",e)}},t.sendErrorTelemetry=async function(e,t,n){try{let r={};if(n)try{r=await g(n)}catch(e){(0,u.traceError)("getActivationTelemetryProps() failed.",e)}(0,d.sendTelemetryEvent)(h.EventName.EDITOR_LOAD,t,r,e)}catch(e){(0,u.traceError)("sendErrorTelemetry() failed.",e)}},t.hasUserDefinedPythonPath=f},61522:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformErrors=t.EventName=void 0,(r=t.EventName||(t.EventName={})).FORMAT_SORT_IMPORTS="FORMAT.SORT_IMPORTS",r.FORMAT="FORMAT.FORMAT",r.FORMAT_ON_TYPE="FORMAT.FORMAT_ON_TYPE",r.EDITOR_LOAD="EDITOR.LOAD",r.LINTING="LINTING",r.REPL="REPL",r.CREATE_NEW_FILE_COMMAND="CREATE_NEW_FILE_COMMAND",r.SELECT_INTERPRETER="SELECT_INTERPRETER",r.SELECT_INTERPRETER_ENTER_BUTTON="SELECT_INTERPRETER_ENTER_BUTTON",r.SELECT_INTERPRETER_ENTER_CHOICE="SELECT_INTERPRETER_ENTER_CHOICE",r.SELECT_INTERPRETER_SELECTED="SELECT_INTERPRETER_SELECTED",r.SELECT_INTERPRETER_ENTER_OR_FIND="SELECT_INTERPRETER_ENTER_OR_FIND",r.SELECT_INTERPRETER_ENTERED_EXISTS="SELECT_INTERPRETER_ENTERED_EXISTS",r.PYTHON_INTERPRETER="PYTHON_INTERPRETER",r.PYTHON_INSTALL_PACKAGE="PYTHON_INSTALL_PACKAGE",r.ENVIRONMENT_WITHOUT_PYTHON_SELECTED="ENVIRONMENT_WITHOUT_PYTHON_SELECTED",r.PYTHON_ENVIRONMENTS_API="PYTHON_ENVIRONMENTS_API",r.PYTHON_INTERPRETER_DISCOVERY="PYTHON_INTERPRETER_DISCOVERY",r.PYTHON_INTERPRETER_AUTO_SELECTION="PYTHON_INTERPRETER_AUTO_SELECTION",r.PYTHON_INTERPRETER_ACTIVATION_ENVIRONMENT_VARIABLES="PYTHON_INTERPRETER.ACTIVATION_ENVIRONMENT_VARIABLES",r.PYTHON_INTERPRETER_ACTIVATION_FOR_RUNNING_CODE="PYTHON_INTERPRETER_ACTIVATION_FOR_RUNNING_CODE",r.PYTHON_INTERPRETER_ACTIVATION_FOR_TERMINAL="PYTHON_INTERPRETER_ACTIVATION_FOR_TERMINAL",r.TERMINAL_SHELL_IDENTIFICATION="TERMINAL_SHELL_IDENTIFICATION",r.PYTHON_INTERPRETER_ACTIVATE_ENVIRONMENT_PROMPT="PYTHON_INTERPRETER_ACTIVATE_ENVIRONMENT_PROMPT",r.PYTHON_NOT_INSTALLED_PROMPT="PYTHON_NOT_INSTALLED_PROMPT",r.CONDA_INHERIT_ENV_PROMPT="CONDA_INHERIT_ENV_PROMPT",r.REQUIRE_JUPYTER_PROMPT="REQUIRE_JUPYTER_PROMPT",r.ACTIVATED_CONDA_ENV_LAUNCH="ACTIVATED_CONDA_ENV_LAUNCH",r.ENVFILE_VARIABLE_SUBSTITUTION="ENVFILE_VARIABLE_SUBSTITUTION",r.ENVFILE_WORKSPACE="ENVFILE_WORKSPACE",r.EXECUTION_CODE="EXECUTION_CODE",r.EXECUTION_DJANGO="EXECUTION_DJANGO",r.DEBUG_IN_TERMINAL_BUTTON="DEBUG.IN_TERMINAL",r.DEBUG_ADAPTER_USING_WHEELS_PATH="DEBUG_ADAPTER.USING_WHEELS_PATH",r.DEBUG_SESSION_ERROR="DEBUG_SESSION.ERROR",r.DEBUG_SESSION_START="DEBUG_SESSION.START",r.DEBUG_SESSION_STOP="DEBUG_SESSION.STOP",r.DEBUG_SESSION_USER_CODE_RUNNING="DEBUG_SESSION.USER_CODE_RUNNING",r.DEBUGGER="DEBUGGER",r.DEBUGGER_ATTACH_TO_CHILD_PROCESS="DEBUGGER.ATTACH_TO_CHILD_PROCESS",r.DEBUGGER_ATTACH_TO_LOCAL_PROCESS="DEBUGGER.ATTACH_TO_LOCAL_PROCESS",r.DEBUGGER_CONFIGURATION_PROMPTS="DEBUGGER.CONFIGURATION.PROMPTS",r.DEBUGGER_CONFIGURATION_PROMPTS_IN_LAUNCH_JSON="DEBUGGER.CONFIGURATION.PROMPTS.IN.LAUNCH.JSON",r.UNITTEST_CONFIGURING="UNITTEST.CONFIGURING",r.UNITTEST_CONFIGURE="UNITTEST.CONFIGURE",r.UNITTEST_DISCOVERY_TRIGGER="UNITTEST.DISCOVERY.TRIGGER",r.UNITTEST_DISCOVERING="UNITTEST.DISCOVERING",r.UNITTEST_DISCOVERING_STOP="UNITTEST.DISCOVERY.STOP",r.UNITTEST_DISCOVERY_DONE="UNITTEST.DISCOVERY.DONE",r.UNITTEST_RUN_STOP="UNITTEST.RUN.STOP",r.UNITTEST_RUN="UNITTEST.RUN",r.UNITTEST_RUN_ALL_FAILED="UNITTEST.RUN_ALL_FAILED",r.UNITTEST_DISABLED="UNITTEST.DISABLED",r.PYTHON_EXPERIMENTS_INIT_PERFORMANCE="PYTHON_EXPERIMENTS_INIT_PERFORMANCE",r.PYTHON_EXPERIMENTS_LSP_NOTEBOOKS="PYTHON_EXPERIMENTS_LSP_NOTEBOOKS",r.PYTHON_EXPERIMENTS_OPT_IN_OPT_OUT_SETTINGS="PYTHON_EXPERIMENTS_OPT_IN_OPT_OUT_SETTINGS",r.EXTENSION_SURVEY_PROMPT="EXTENSION_SURVEY_PROMPT",r.LANGUAGE_SERVER_ENABLED="LANGUAGE_SERVER.ENABLED",r.LANGUAGE_SERVER_STARTUP="LANGUAGE_SERVER.STARTUP",r.LANGUAGE_SERVER_READY="LANGUAGE_SERVER.READY",r.LANGUAGE_SERVER_TELEMETRY="LANGUAGE_SERVER.EVENT",r.LANGUAGE_SERVER_REQUEST="LANGUAGE_SERVER.REQUEST",r.LANGUAGE_SERVER_RESTART="LANGUAGE_SERVER.RESTART",r.TERMINAL_CREATE="TERMINAL.CREATE",r.ACTIVATE_ENV_IN_CURRENT_TERMINAL="ACTIVATE_ENV_IN_CURRENT_TERMINAL",r.ACTIVATE_ENV_TO_GET_ENV_VARS_FAILED="ACTIVATE_ENV_TO_GET_ENV_VARS_FAILED",r.DIAGNOSTICS_ACTION="DIAGNOSTICS.ACTION",r.DIAGNOSTICS_MESSAGE="DIAGNOSTICS.MESSAGE",r.SELECT_LINTER="LINTING.SELECT",r.USE_REPORT_ISSUE_COMMAND="USE_REPORT_ISSUE_COMMAND",r.LINTER_NOT_INSTALLED_PROMPT="LINTER_NOT_INSTALLED_PROMPT",r.HASHED_PACKAGE_NAME="HASHED_PACKAGE_NAME",r.JEDI_LANGUAGE_SERVER_ENABLED="JEDI_LANGUAGE_SERVER.ENABLED",r.JEDI_LANGUAGE_SERVER_STARTUP="JEDI_LANGUAGE_SERVER.STARTUP",r.JEDI_LANGUAGE_SERVER_READY="JEDI_LANGUAGE_SERVER.READY",r.JEDI_LANGUAGE_SERVER_REQUEST="JEDI_LANGUAGE_SERVER.REQUEST",r.TENSORBOARD_SESSION_LAUNCH="TENSORBOARD.SESSION_LAUNCH",r.TENSORBOARD_SESSION_DURATION="TENSORBOARD.SESSION_DURATION",r.TENSORBOARD_SESSION_DAEMON_STARTUP_DURATION="TENSORBOARD.SESSION_DAEMON_STARTUP_DURATION",r.TENSORBOARD_LAUNCH_PROMPT_SELECTION="TENSORBOARD.LAUNCH_PROMPT_SELECTION",r.TENSORBOARD_SESSION_E2E_STARTUP_DURATION="TENSORBOARD.SESSION_E2E_STARTUP_DURATION",r.TENSORBOARD_ENTRYPOINT_SHOWN="TENSORBOARD.ENTRYPOINT_SHOWN",r.TENSORBOARD_INSTALL_PROMPT_SHOWN="TENSORBOARD.INSTALL_PROMPT_SHOWN",r.TENSORBOARD_INSTALL_PROMPT_SELECTION="TENSORBOARD.INSTALL_PROMPT_SELECTION",r.TENSORBOARD_DETECTED_IN_INTEGRATED_TERMINAL="TENSORBOARD_DETECTED_IN_INTEGRATED_TERMINAL",r.TENSORBOARD_PACKAGE_INSTALL_RESULT="TENSORBOARD.PACKAGE_INSTALL_RESULT",r.TENSORBOARD_TORCH_PROFILER_IMPORT="TENSORBOARD.TORCH_PROFILER_IMPORT",r.TENSORBOARD_JUMP_TO_SOURCE_REQUEST="TENSORBOARD_JUMP_TO_SOURCE_REQUEST",r.TENSORBOARD_JUMP_TO_SOURCE_FILE_NOT_FOUND="TENSORBOARD_JUMP_TO_SOURCE_FILE_NOT_FOUND",r.ENVIRONMENT_CREATING="ENVIRONMENT.CREATING",r.ENVIRONMENT_CREATED="ENVIRONMENT.CREATED",r.ENVIRONMENT_FAILED="ENVIRONMENT.FAILED",r.ENVIRONMENT_INSTALLING_PACKAGES="ENVIRONMENT.INSTALLING_PACKAGES",r.ENVIRONMENT_INSTALLED_PACKAGES="ENVIRONMENT.INSTALLED_PACKAGES",r.ENVIRONMENT_INSTALLING_PACKAGES_FAILED="ENVIRONMENT.INSTALLING_PACKAGES_FAILED",r.ENVIRONMENT_BUTTON="ENVIRONMENT.BUTTON",r.ENVIRONMENT_DELETE="ENVIRONMENT.DELETE",r.ENVIRONMENT_REUSE="ENVIRONMENT.REUSE",r.TOOLS_EXTENSIONS_ALREADY_INSTALLED="TOOLS_EXTENSIONS.ALREADY_INSTALLED",r.TOOLS_EXTENSIONS_PROMPT_SHOWN="TOOLS_EXTENSIONS.PROMPT_SHOWN",r.TOOLS_EXTENSIONS_INSTALL_SELECTED="TOOLS_EXTENSIONS.INSTALL_SELECTED",r.TOOLS_EXTENSIONS_PROMPT_DISMISSED="TOOLS_EXTENSIONS.PROMPT_DISMISSED",(n=t.PlatformErrors||(t.PlatformErrors={})).FailedToParseVersion="FailedToParseVersion",n.FailedToDetermineOS="FailedToDetermineOS"},98634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnvFileTelemetryTests=t.sendActivationTelemetry=t.sendFileCreationTelemetry=t.sendSettingTelemetry=void 0;const r=n(48683),i=n(54813),o=n(61522);let s,a=!1;function c(e=!1){(0,i.sendTelemetryEvent)(o.EventName.ENVFILE_WORKSPACE,void 0,{hasCustomEnvPath:e}),a=!0}function l(){return!a}function u(e){var t;if(!s){const n=e.getConfiguration("python");s=(null===(t=n.inspect("envFile"))||void 0===t?void 0:t.defaultValue)||""}return s}t.sendSettingTelemetry=function(e,t){l()&&t!==u(e)&&c(!0)},t.sendFileCreationTelemetry=function(){l()&&c()},t.sendActivationTelemetry=async function(e,t,n){if(l()){const i=new r.SystemVariables(n,void 0,t).resolveAny(u(t));await e.fileExists(i)&&c()}},t.EnvFileTelemetryTests={setState:({telemetrySent:e,defaultSetting:t})=>{void 0!==e&&(a=e),void 0!==u&&(s=t)},resetState:()=>{s=void 0,a=!1}}},72392:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setExtensionInstallTelemetryProperties=void 0;const r=n(71017),i=n(54813),o=n(63281);t.setExtensionInstallTelemetryProperties=async function(e){const t=r.join(r.dirname(o.EXTENSION_ROOT_DIR),"PythonCodingPack");await e.fileExists(t)?(0,i.setSharedProperty)("installSource","pythonCodingPack"):(0,i.setSharedProperty)("installSource","marketPlace")}},15036:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentLines=t.ImportTracker=void 0;const s=n(86700),a=n(71017),c=n(39512),l=n(54813),u=n(17585),p=n(77570);n(32727);const d=n(61684),h=n(3481),f=n(2810),g=n(61522),m=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,v=(0,p.isTestExecution)();let y=r=class{constructor(e,t){this.documentManager=e,this.disposables=t,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!0},this.pendingChecks=new Map,this.hashFn=n(33715).sha256,this.documentManager.onDidOpenTextDocument((e=>this.onOpenedOrSavedDocument(e)),this,this.disposables),this.documentManager.onDidSaveTextDocument((e=>this.onOpenedOrSavedDocument(e)),this,this.disposables)}dispose(){this.pendingChecks.clear()}async activate(){this.documentManager.textDocuments.forEach((e=>this.onOpenedOrSavedDocument(e)))}static hasModuleImport(e){return this.sentMatches.has(e)}onOpenedOrSavedDocument(e){".py"===a.extname(e.fileName).toLowerCase()&&this.scheduleDocument(e)}scheduleDocument(e){this.scheduleCheck(e.fileName,this.checkDocument.bind(this,e))}scheduleCheck(e,t){const n=this.pendingChecks.get(e);n&&((0,c.clearTimeout)(n),this.pendingChecks.delete(e)),v?t():this.pendingChecks.set(e,(0,c.setTimeout)(t,5e3))}checkDocument(e){this.pendingChecks.delete(e.fileName);const t=b(e);this.lookForImports(t)}sendTelemetry(e){if(r.sentMatches.has(e))return;r.sentMatches.add(e);const t=this.hashFn().update(e).digest("hex");(0,l.sendTelemetryEvent)(g.EventName.HASHED_PACKAGE_NAME,void 0,{hashedName:t})}lookForImports(e){try{for(const t of e){const e=t?m.exec(t):null;null!==e&&void 0!==e.groups&&(void 0!==e.groups.fromImport?this.sendTelemetry(e.groups.fromImport):void 0!==e.groups.importImport&&e.groups.importImport.split(",").map((e=>e.trim())).forEach((e=>this.sendTelemetry(e)))),t&&f.TorchProfilerImportRegEx.test(t)&&(0,l.sendTelemetryEvent)(g.EventName.TENSORBOARD_TORCH_PROFILER_IMPORT)}}catch(e){(0,h.noop)()}}};function b(e){return Array(Math.min(e.lineCount,1e3)).fill("").map(((t,n)=>{const r=e.lineAt(n);if(r&&!r.isEmptyOrWhitespace)return r.text})).filter((e=>e))}y.sentMatches=new Set,y=r=i([(0,s.injectable)(),o(0,(0,s.inject)(u.IDocumentManager)),o(1,(0,s.inject)(d.IDisposableRegistry))],y),t.ImportTracker=y,t.getDocumentLines=b},54813:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendTelemetryWhenDone=t.captureTelemetry=t.sendTelemetryEvent=t.clearTelemetryReporter=t.getTelemetryReporter=t._resetSharedProperties=t.setSharedProperty=t.isTelemetryDisabled=void 0;const r=n(71017),i=n(55674),o=n(77570),s=n(70057),a=n(59314);function c(){const e=r.join(o.EXTENSION_ROOT_DIR,"package.json");return!i.readJSONSync(e).enableTelemetry}n(61522),t.isTelemetryDisabled=c;const l={};let u;function p(){if(!(0,o.isTestExecution)()&&u)return u;const e=n(92291).default;return u=new e(o.AppinsightsKey,[{lookup:/(errorName|errorMessage|errorStack)/g}]),u}function d(e,t,r,i){var s;if((0,o.isTestExecution)()||!function(){try{const e=n(66828),t=n(92291);return void 0!==e&&void 0!==t}catch(e){return!1}}()||c())return;const a=p(),u="number"==typeof t?{duration:t}:t||void 0,d={},h=e;if(r){const t=r;Object.getOwnPropertyNames(t).forEach((n=>{if(void 0!==t[n]&&null!==t[n])try{switch(typeof t[n]){case"string":d[n]=t[n];break;case"object":d[n]="object";break;default:d[n]=t[n].toString()}}catch(t){console.error(`Failed to serialize ${n} for ${String(e)}`,t)}}))}if(Object.assign(d,l),i){const e={errorName:i.name,errorStack:null!==(s=i.stack)&&void 0!==s?s:""};Object.assign(d,e),a.sendTelemetryErrorEvent(h,d,u)}else a.sendTelemetryEvent(h,d,u);process.env&&process.env.VSC_PYTHON_LOG_TELEMETRY&&console.info(`Telemetry Event : ${h} Measures: ${JSON.stringify(u)} Props: ${JSON.stringify(d)} `)}t.setSharedProperty=function(e,t){const n=e;(0,o.isUnitTestExecution)()&&n.startsWith("ds_")||(void 0===t?delete l[n]:l[n]=t)},t._resetSharedProperties=function(){for(const e of Object.keys(l))delete l[e]},t.getTelemetryReporter=p,t.clearTelemetryReporter=function(){u=void 0},t.sendTelemetryEvent=d,t.captureTelemetry=function(e,t,n=!0,r,i,o){return function(c,l,u){const p=u.value;return u.value=function(...c){if(!n&&!i&&!o)return d(e,void 0,t),p.apply(this,c);const l=e=>i?{...t,...i(this,e)}:t,u=n?new s.StopWatch:void 0,h=e=>{const t=u?{duration:u.elapsedTime}:void 0;return o?{...t,...o(this,e)}:t},f=p.apply(this,c);return f&&(0,a.isPromise)(f)?f.then((t=>(d(e,h(t),l(t)),t))).catch((t=>{const n={...l(),failed:!0};d(r||e,h(),n,t)})):d(e,h(f),l(f)),f},u}},t.sendTelemetryWhenDone=function(e,t,n,r){if(n=n||new s.StopWatch,"function"!=typeof t.then)throw new Error("Method is neither a Promise nor a Theneable");t.then((t=>(d(e,n.elapsedTime,r),t)),(t=>(d(e,n.elapsedTime,r,t),Promise.reject(t))))}},78838:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IImportTracker=void 0,t.IImportTracker=Symbol("IImportTracker")},68329:(e,t)=>{"use strict";var n,r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardEntrypoint=t.TensorBoardSessionStartResult=t.TensorBoardEntrypointTrigger=t.TensorBoardPromptSelection=void 0,(o=t.TensorBoardPromptSelection||(t.TensorBoardPromptSelection={})).Yes="yes",o.No="no",o.DoNotAskAgain="doNotAskAgain",o.None="none",(i=t.TensorBoardEntrypointTrigger||(t.TensorBoardEntrypointTrigger={})).tfeventfiles="tfeventfiles",i.fileimport="fileimport",i.nbextension="nbextension",i.palette="palette",(r=t.TensorBoardSessionStartResult||(t.TensorBoardSessionStartResult={})).cancel="canceled",r.success="success",r.error="error",(n=t.TensorBoardEntrypoint||(t.TensorBoardEntrypoint={})).prompt="prompt",n.codelens="codelens",n.palette="palette"},2810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.containsNotebookExtension=t.containsTensorBoardImport=t.TorchProfilerImportRegEx=void 0;const r=n(3481);t.TorchProfilerImportRegEx=/^\s*(?:import (?:(\w+, )*torch\.profiler(, \w+)*))|(?:from torch import (?:(\w+, )*profiler(, \w+)*))/;const i=/^\s*(?:from torch\.utils\.tensorboard import \w+)|(?:from torch\.utils import (?:(\w+, )*tensorboard(, \w+)*))|(?:from tensorboardX import \w+)|(?:import (\w+, )*((torch\.utils\.tensorboard)|(tensorboardX)|(tensorboard))(, \w+)*)/;t.containsTensorBoardImport=function(e){try{for(const n of e)if(n&&(i.test(n)||t.TorchProfilerImportRegEx.test(n)))return!0}catch(e){(0,r.noop)()}return!1},t.containsNotebookExtension=function(e){for(const t of e)if((null==t?void 0:t.startsWith("%tensorboard"))||(null==t?void 0:t.startsWith("%load_ext tensorboard")))return!0;return!1}},87401:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardNbextensionCodeLensProvider=void 0;const o=n(86700),s=n(96486),a=n(66828),c=n(77570),l=n(61684),u=n(67098),p=n(54813),d=n(61522),h=n(68329),f=n(2810);let g=class{constructor(e){this.disposables=e,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.sendTelemetryOnce=(0,s.once)(p.sendTelemetryEvent.bind(this,d.EventName.TENSORBOARD_ENTRYPOINT_SHOWN,void 0,{trigger:h.TensorBoardEntrypointTrigger.nbextension,entrypoint:h.TensorBoardEntrypoint.codelens}))}async activate(){this.activateInternal().ignoreErrors()}async activateInternal(){this.disposables.push(a.languages.registerCodeLensProvider([{scheme:c.NotebookCellScheme,language:c.PYTHON_LANGUAGE},{scheme:"vscode-notebook",language:c.PYTHON_LANGUAGE}],this))}provideCodeLenses(e,t){const n={title:u.TensorBoard.launchNativeTensorBoardSessionCodeLens,command:c.Commands.LaunchTensorBoard,arguments:[{trigger:h.TensorBoardEntrypointTrigger.nbextension,entrypoint:h.TensorBoardEntrypoint.codelens}]},r=[];for(let i=0;i<e.lineCount;i+=1){if(t.isCancellationRequested)return r;const o=e.lineAt(i);if((0,f.containsNotebookExtension)([o.text])){const e=new a.Range(new a.Position(o.lineNumber,0),new a.Position(o.lineNumber,1));r.push(new a.CodeLens(e,n)),this.sendTelemetryOnce()}}return r}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IDisposableRegistry))],g),t.TensorBoardNbextensionCodeLensProvider=g},94611:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(42540),o=n(18675),s=n(17950),a=n(68291),c=n(23968),l=n(87401),u=n(12074);t.registerTypes=function(e){e.addSingleton(c.TensorBoardSessionProvider,c.TensorBoardSessionProvider),e.addBinding(c.TensorBoardSessionProvider,r.IExtensionSingleActivationService),e.addSingleton(o.TensorBoardFileWatcher,o.TensorBoardFileWatcher),e.addBinding(o.TensorBoardFileWatcher,r.IExtensionSingleActivationService),e.addSingleton(a.TensorBoardPrompt,a.TensorBoardPrompt),e.addSingleton(r.IExtensionSingleActivationService,s.TensorBoardUsageTracker),e.addSingleton(i.TensorBoardImportCodeLensProvider,i.TensorBoardImportCodeLensProvider),e.addBinding(i.TensorBoardImportCodeLensProvider,r.IExtensionSingleActivationService),e.addSingleton(l.TensorBoardNbextensionCodeLensProvider,l.TensorBoardNbextensionCodeLensProvider),e.addBinding(l.TensorBoardNbextensionCodeLensProvider,r.IExtensionSingleActivationService),e.addSingleton(r.IExtensionSingleActivationService,u.TerminalWatcher)}},18675:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardFileWatcher=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(61684),l=n(68329),u=n(68291);let p=class{constructor(e,t,n){this.workspaceService=e,this.tensorBoardPrompt=t,this.disposables=n,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.fileSystemWatchers=new Map,this.globPatterns=["*tfevents*","*/*tfevents*","*/*/*tfevents*"]}async activate(){this.activateInternal().ignoreErrors()}async activateInternal(){const e=this.workspaceService.workspaceFolders;if(e){for(const t of e)this.createFileSystemWatcher(t);this.disposables.push(this.workspaceService.onDidChangeWorkspaceFolders((e=>this.updateFileSystemWatchers(e))))}}async updateFileSystemWatchers(e){for(const t of e.added)this.createFileSystemWatcher(t);for(const t of e.removed){const e=this.fileSystemWatchers.get(t);e&&(e.forEach((e=>e.dispose())),this.fileSystemWatchers.delete(t))}}createFileSystemWatcher(e){const t=[];for(const n of this.globPatterns){const r=new s.RelativePattern(e,n),i=this.workspaceService.createFileSystemWatcher(r);this.disposables.push(i.onDidCreate((()=>this.tensorBoardPrompt.showNativeTensorBoardPrompt(l.TensorBoardEntrypointTrigger.tfeventfiles)))),this.disposables.push(i.onDidChange((()=>this.tensorBoardPrompt.showNativeTensorBoardPrompt(l.TensorBoardEntrypointTrigger.tfeventfiles)))),this.disposables.push(i),t.push(i)}this.fileSystemWatchers.set(e,t)}};p=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IWorkspaceService)),i(1,(0,o.inject)(u.TensorBoardPrompt)),i(2,(0,o.inject)(c.IDisposableRegistry))],p),t.TensorBoardFileWatcher=p},42540:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardImportCodeLensProvider=void 0;const o=n(86700),s=n(96486),a=n(66828),c=n(77570),l=n(61684),u=n(67098),p=n(54813),d=n(61522),h=n(68329),f=n(2810);let g=class{constructor(e){this.disposables=e,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.sendTelemetryOnce=(0,s.once)(p.sendTelemetryEvent.bind(this,d.EventName.TENSORBOARD_ENTRYPOINT_SHOWN,void 0,{trigger:h.TensorBoardEntrypointTrigger.fileimport,entrypoint:h.TensorBoardEntrypoint.codelens}))}async activate(){this.activateInternal().ignoreErrors()}provideCodeLenses(e,t){const n={title:u.TensorBoard.launchNativeTensorBoardSessionCodeLens,command:c.Commands.LaunchTensorBoard,arguments:[{trigger:h.TensorBoardEntrypointTrigger.fileimport,entrypoint:h.TensorBoardEntrypoint.codelens}]},r=[];for(let i=0;i<e.lineCount;i+=1){if(t.isCancellationRequested)return r;const o=e.lineAt(i);if((0,f.containsTensorBoardImport)([o.text])){const e=new a.Range(new a.Position(o.lineNumber,0),new a.Position(o.lineNumber,1));r.push(new a.CodeLens(e,n)),this.sendTelemetryOnce()}}return r}async activateInternal(){this.disposables.push(a.languages.registerCodeLensProvider(c.PYTHON,this))}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IDisposableRegistry))],g),t.TensorBoardImportCodeLensProvider=g},68291:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardPrompt=void 0;const o=n(86700),s=n(96486),a=n(17585),c=n(77570),l=n(61684),u=n(67098),p=n(54813),d=n(61522),h=n(68329);var f;!function(e){e.ShowNativeTensorBoardPrompt="showNativeTensorBoardPrompt"}(f||(f={}));let g=class{constructor(e,t,n){this.applicationShell=e,this.commandManager=t,this.persistentStateFactory=n,this.enabledInCurrentSession=!0,this.waitingForUserSelection=!1,this.sendTelemetryOnce=(0,s.once)((e=>{(0,p.sendTelemetryEvent)(d.EventName.TENSORBOARD_ENTRYPOINT_SHOWN,void 0,{entrypoint:h.TensorBoardEntrypoint.prompt,trigger:e})})),this.state=this.persistentStateFactory.createWorkspacePersistentState(f.ShowNativeTensorBoardPrompt,!0),this.enabled=this.isPromptEnabled()}async showNativeTensorBoardPrompt(e){if(this.enabled&&this.enabledInCurrentSession&&!this.waitingForUserSelection){const t=u.Common.bannerLabelYes,n=u.Common.bannerLabelNo,r=u.Common.doNotShowAgain,i=[t,n,r];this.waitingForUserSelection=!0,this.sendTelemetryOnce(e);const o=await this.applicationShell.showInformationMessage(u.TensorBoard.nativeTensorBoardPrompt,...i);this.waitingForUserSelection=!1,this.enabledInCurrentSession=!1;let s=h.TensorBoardPromptSelection.None;switch(o){case t:s=h.TensorBoardPromptSelection.Yes,await this.commandManager.executeCommand(c.Commands.LaunchTensorBoard,h.TensorBoardEntrypoint.prompt,e);break;case r:s=h.TensorBoardPromptSelection.DoNotAskAgain,await this.disablePrompt();break;case n:s=h.TensorBoardPromptSelection.No}(0,p.sendTelemetryEvent)(d.EventName.TENSORBOARD_LAUNCH_PROMPT_SELECTION,void 0,{selection:s})}}isPromptEnabled(){return this.state.value}async disablePrompt(){await this.state.updateValue(!1)}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IApplicationShell)),i(1,(0,o.inject)(a.ICommandManager)),i(2,(0,o.inject)(l.IPersistentStateFactory))],g),t.TensorBoardPrompt=g},30094:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardSession=void 0;const r=n(55674),i=n(71017),o=n(66828),s=n(29979),a=n(4057),c=n(61684),l=n(59314),u=n(67098),p=n(70057),d=n(54813),h=n(61522),f=n(15036),g=n(68329),m=n(59747),v=n(19735);var y;!function(e){e.JumpToSource="jump_to_source"}(y||(y={}));const b=">= 2.4.1",S=">= 0.2.0";t.TensorBoardSession=class{constructor(e,t,n,r,i,s,a,c,l,u){this.installer=e,this.interpreterService=t,this.workspaceService=n,this.pythonExecFactory=r,this.commandManager=i,this.disposables=s,this.applicationShell=a,this.globalMemento=c,this.multiStepFactory=l,this.configurationService=u,this._active=!1,this.onDidChangeViewStateEventEmitter=new o.EventEmitter,this.onDidDisposeEventEmitter=new o.EventEmitter}get panel(){return this.webviewPanel}get daemon(){return this.process}get onDidDispose(){return this.onDidDisposeEventEmitter.event}get onDidChangeViewState(){return this.onDidChangeViewStateEventEmitter.event}get active(){return this._active}async refresh(){this.webviewPanel&&(this.webviewPanel.webview.html="",this.webviewPanel.webview.html=await this.getHtml())}async initialize(){const e=new p.StopWatch;if(!await this.ensurePrerequisitesAreInstalled())return;const t=await this.getLogDirectory();t&&(await this.startTensorboardSession(t)&&(await this.showPanel(),(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_SESSION_E2E_STARTUP_DURATION,e.elapsedTime)),this.sessionDurationStopwatch=new p.StopWatch)}async promptToInstall(e,t){(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_INSTALL_PROMPT_SHOWN);const n=u.Common.bannerLabelYes,r=u.Common.bannerLabelNo,i=e===c.ProductInstallStatus.NeedsUpgrade;let o;o=e===c.ProductInstallStatus.Installed&&t!==c.ProductInstallStatus.Installed?u.TensorBoard.installProfilerPluginPrompt:t!==c.ProductInstallStatus.Installed?u.TensorBoard.installTensorBoardAndProfilerPluginPrompt:i?u.TensorBoard.upgradePrompt:u.TensorBoard.installPrompt;const s=await this.applicationShell.showErrorMessage(o,n,r);let a=g.TensorBoardPromptSelection.None;return s===n?a=g.TensorBoardPromptSelection.Yes:s===r&&(a=g.TensorBoardPromptSelection.No),(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_INSTALL_PROMPT_SELECTION,void 0,{selection:a,operationType:i?"upgrade":"install"}),s}async ensurePrerequisitesAreInstalled(){(0,v.traceVerbose)("Ensuring TensorBoard package is installed into active interpreter");const e=await this.interpreterService.getActiveInterpreter()||await this.commandManager.executeCommand("python.setInterpreter");if(!e)return!1;let[t,n]=await Promise.all([this.installer.isProductVersionCompatible(c.Product.tensorboard,b,e),this.installer.isProductVersionCompatible(c.Product.torchProfilerImportName,S,e)]);const r=f.ImportTracker.hasModuleImport("torch"),i=t!==c.ProductInstallStatus.Installed,a=n!==c.ProductInstallStatus.Installed;if(r&&!i&&!a||!r&&t===c.ProductInstallStatus.Installed)return!0;const l=await this.promptToInstall(t,r?n:c.ProductInstallStatus.Installed);if(l!==u.Common.bannerLabelYes&&!i)return!0;if(l!==u.Common.bannerLabelYes)return!1;const p=(new o.CancellationTokenSource).token,g=(0,s.createPromiseFromCancellation)({cancelAction:"resolve",defaultValue:c.InstallerResponse.Ignore,token:p}),y=[];return i&&y.push(this.installer.install(c.Product.tensorboard,e,p,t===c.ProductInstallStatus.NeedsUpgrade?m.ModuleInstallFlags.upgrade:void 0)),r&&a&&y.push(this.installer.install(c.Product.torchProfilerInstallName,e,p,n===c.ProductInstallStatus.NeedsUpgrade?m.ModuleInstallFlags.upgrade:void 0)),await Promise.race([...y,g]),[t,n]=await Promise.all([this.installer.isProductVersionCompatible(c.Product.tensorboard,b,e),this.installer.isProductVersionCompatible(c.Product.torchProfilerImportName,S,e)]),(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_PACKAGE_INSTALL_RESULT,void 0,{wasTensorBoardAttempted:i,wasProfilerPluginAttempted:a,wasTensorBoardInstalled:t===c.ProductInstallStatus.Installed,wasProfilerPluginInstalled:n===c.ProductInstallStatus.Installed}),r&&n!==c.ProductInstallStatus.Installed&&(0,v.traceError)("Failed to install torch-tb-plugin. Profiler plugin will not appear in TensorBoard session."),t===c.ProductInstallStatus.Installed}async showFilePicker(){const e=await this.applicationShell.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1});if(e)return e[0].fsPath}getQuickPickItems(e){const t=[];if(e){const e={label:u.TensorBoard.useCurrentWorkingDirectory,detail:u.TensorBoard.useCurrentWorkingDirectoryDetail},n={label:u.TensorBoard.selectAnotherFolder,detail:u.TensorBoard.selectAnotherFolderDetail};t.push(e,n)}else{const e={label:u.TensorBoard.selectAFolder,detail:u.TensorBoard.selectAFolderDetail};t.push(e)}return t.push({label:u.TensorBoard.enterRemoteUrl,detail:u.TensorBoard.enterRemoteUrlDetail}),t}async getLogDirectory(){var e;const t=null===(e=this.configurationService.getSettings().tensorBoard)||void 0===e?void 0:e.logDirectory;if(t)return(0,v.traceVerbose)(`Using log directory resolved by python.tensorBoard.logDirectory setting: ${t}`),t;const n=this.autopopulateLogDirectoryPath(),{useCurrentWorkingDirectory:r}=u.TensorBoard,{selectAFolder:i}=u.TensorBoard,{selectAnotherFolder:s}=u.TensorBoard,{enterRemoteUrl:a}=u.TensorBoard,c=this.getQuickPickItems(n),l=await this.applicationShell.showQuickPick(c,{canPickMany:!1,ignoreFocusOut:!1,placeHolder:n?o.l10n.t("Current: {0}",n):void 0});switch(null==l?void 0:l.label){case r:return n;case i:case s:return this.showFilePicker();case a:return this.applicationShell.showInputBox({prompt:u.TensorBoard.enterRemoteUrlDetail});default:return}}async startTensorboardSession(e){const t=await this.interpreterService.getActiveInterpreter();if(!t)return!1;const n={title:u.TensorBoard.progressMessage,location:o.ProgressLocation.Notification,cancellable:!0},r=await this.pythonExecFactory.createActivatedEnvironment({allowEnvironmentFetchExceptions:!0,interpreter:t}),i=(0,a.tensorboardLauncher)([e]),c=new p.StopWatch,f=r.execObservable(i,{}),m=await this.applicationShell.withProgress(n,((t,n)=>{(0,v.traceVerbose)(`Starting TensorBoard with log directory ${e}...`);const r=this.waitForTensorBoardStart(f),i=(0,s.createPromiseFromCancellation)({token:n,cancelAction:"resolve",defaultValue:"canceled"});return Promise.race([(0,l.sleep)(6e4),r,i])}));switch(m){case"canceled":return(0,v.traceVerbose)("Canceled starting TensorBoard session."),(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_SESSION_DAEMON_STARTUP_DURATION,c.elapsedTime,{result:g.TensorBoardSessionStartResult.cancel}),f.dispose(),!1;case"success":return this.process=f.proc,(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_SESSION_DAEMON_STARTUP_DURATION,c.elapsedTime,{result:g.TensorBoardSessionStartResult.success}),!0;case 6e4:throw(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_SESSION_DAEMON_STARTUP_DURATION,c.elapsedTime,{result:g.TensorBoardSessionStartResult.error}),new Error("Timed out after 60 seconds waiting for TensorBoard to launch.");default:throw new Error(`Failed to start TensorBoard, received unknown promise result: ${m}`)}}async waitForTensorBoardStart(e){const t=(0,l.createDeferred)();return e.out.subscribe({next:e=>{if("stdout"===e.source){const n=e.out.match(/TensorBoard started at (.*)/);n&&n[1]&&(this.url=n[1],t.resolve("success")),(0,v.traceVerbose)(e.out)}else"stderr"===e.source&&(0,v.traceError)(e.out)},error:e=>{(0,v.traceError)(e)}}),t.promise}async showPanel(){(0,v.traceVerbose)("Showing TensorBoard panel"),(this.webviewPanel||await this.createPanel()).reveal(),this._active=!0,this.onDidChangeViewStateEventEmitter.fire()}async createPanel(){const e=o.window.createWebviewPanel("tensorBoardSession","TensorBoard",this.globalMemento.value,{enableScripts:!0,retainContextWhenHidden:!0});return e.webview.html=await this.getHtml(),this.webviewPanel=e,this.disposables.push(e.onDidDispose((()=>{var e,t;this.webviewPanel=void 0,null===(e=this.process)||void 0===e||e.kill(),(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_SESSION_DURATION,null===(t=this.sessionDurationStopwatch)||void 0===t?void 0:t.elapsedTime),this.process=void 0,this._active=!1,this.onDidDisposeEventEmitter.fire(this)}))),this.disposables.push(e.onDidChangeViewState((async t=>{var n;this.active&&t.webviewPanel.active&&await this.globalMemento.updateValue(null!==(n=e.viewColumn)&&void 0!==n?n:o.ViewColumn.Active),this._active=t.webviewPanel.active,this.onDidChangeViewStateEventEmitter.fire()}))),this.disposables.push(e.webview.onDidReceiveMessage((e=>{e.command===y.JumpToSource&&this.jumpToSource(e.args.filename,e.args.line)}))),e}autopopulateLogDirectoryPath(){if(this.workspaceService.rootPath)return this.workspaceService.rootPath;const{activeTextEditor:e}=o.window;return e?i.dirname(e.document.uri.fsPath):void 0}async jumpToSource(e,t){let n;if((0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_JUMP_TO_SOURCE_REQUEST),r.existsSync(e))n=o.Uri.file(e);else{(0,d.sendTelemetryEvent)(h.EventName.TENSORBOARD_JUMP_TO_SOURCE_FILE_NOT_FOUND),(0,v.traceError)(`Requested jump to source filepath ${e} does not exist. Prompting user to select source file...`);const t=[{label:u.TensorBoard.selectMissingSourceFile,description:u.TensorBoard.selectMissingSourceFileDescription}],r=this.multiStepFactory.create();await r.run((async r=>{const i=await r.showQuickPick({items:t,title:u.TensorBoard.missingSourceFile,placeholder:e});switch(null==i?void 0:i.label){case u.TensorBoard.selectMissingSourceFile:{const e=await this.applicationShell.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1});void 0!==e&&([n]=e);break}}}),{})}if(void 0===n)return;const i=await o.workspace.openTextDocument(n),s=await o.window.showTextDocument(i,o.ViewColumn.Beside);if(t<s.document.lineCount){const e=new o.Position(t,0),n=new o.Selection(e,s.document.lineAt(t).range.end);s.selection=n,s.revealRange(n,o.TextEditorRevealType.InCenterIfOutsideViewport)}}async getHtml(){const e=await o.env.asExternalUri(o.Uri.parse(this.url));return`<!DOCTYPE html>\n        <html lang="en">\n            <head>\n                <meta charset="UTF-8">\n                <meta http-equiv="Content-Security-Policy" content="default-src 'unsafe-inline'; frame-src ${e} http: https:;">\n                <meta name="viewport" content="width=device-width, initial-scale=1.0">\n                <title>TensorBoard</title>\n            </head>\n            <body>\n                <script type="text/javascript">\n                    (function() {\n                        const vscode = acquireVsCodeApi();\n                        function resizeFrame() {\n                            var f = window.document.getElementById('vscode-tensorboard-iframe');\n                            if (f) {\n                                f.style.height = window.innerHeight / 0.8 + "px";\n                                f.style.width = window.innerWidth / 0.8 + "px";\n                            }\n                        }\n                        window.onload = function() {\n                            resizeFrame();\n                        }\n                        window.addEventListener('resize', resizeFrame);\n                        window.addEventListener('message', (event) => {\n                            if (!"${e}".startsWith(event.origin) || !event.data || !event.data.filename || !event.data.line) {\n                                return;\n                            }\n                            const args = { filename: event.data.filename, line: event.data.line };\n                            vscode.postMessage({ command: '${y.JumpToSource}', args: args });\n                        });\n                    }())\n                <\/script>\n                <iframe\n                    id="vscode-tensorboard-iframe"\n                    class="responsive-iframe"\n                    sandbox="allow-scripts allow-forms allow-same-origin allow-pointer-lock"\n                    src="${e}"\n                    frameborder="0"\n                    border="0"\n                    allowfullscreen\n                ></iframe>\n                <style>\n                    .responsive-iframe {\n                        transform: scale(0.8);\n                        transform-origin: 0 0;\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        overflow: hidden;\n                        display: block;\n                        width: 100%;\n                        height: 100%;\n                    }\n                </style>\n            </body>\n        </html>`}}},23968:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardSessionProvider=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570),l=n(94316),u=n(29983),p=n(61684),d=n(22207),h=n(18639),f=n(19735),g=n(54813),m=n(61522),v=n(68329),y=n(30094);let b=class{constructor(e,t,n,r,i,o,a,c,u,p){this.installer=e,this.interpreterService=t,this.applicationShell=n,this.workspaceService=r,this.commandManager=i,this.disposables=o,this.pythonExecFactory=a,this.stateFactory=c,this.multiStepFactory=u,this.configurationService=p,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.knownSessions=[],this.preferredViewGroupMemento=this.stateFactory.createGlobalPersistentState("PythonTensorBoardWebviewPreferredViewGroup",s.ViewColumn.Active),this.hasActiveTensorBoardSessionContext=new l.ContextKey("python.hasActiveTensorBoardSession",this.commandManager)}async activate(){this.disposables.push(this.commandManager.registerCommand(c.Commands.LaunchTensorBoard,((e=v.TensorBoardEntrypoint.palette,t=v.TensorBoardEntrypointTrigger.palette)=>((0,g.sendTelemetryEvent)(m.EventName.TENSORBOARD_SESSION_LAUNCH,void 0,{trigger:t,entrypoint:e}),this.createNewSession()))),this.commandManager.registerCommand(c.Commands.RefreshTensorBoard,(()=>this.knownSessions.map((e=>e.refresh())))))}async updateTensorBoardSessionContext(){let e=!1;this.knownSessions.forEach((t=>{t.active&&(e=!0)})),await this.hasActiveTensorBoardSessionContext.set(e)}async didDisposeSession(e){this.knownSessions=this.knownSessions.filter((t=>t!==e)),this.updateTensorBoardSessionContext()}async createNewSession(){(0,f.traceVerbose)("Starting new TensorBoard session...");try{const e=new y.TensorBoardSession(this.installer,this.interpreterService,this.workspaceService,this.pythonExecFactory,this.commandManager,this.disposables,this.applicationShell,this.preferredViewGroupMemento,this.multiStepFactory,this.configurationService);return e.onDidChangeViewState((()=>this.updateTensorBoardSessionContext()),this,this.disposables),e.onDidDispose((e=>this.didDisposeSession(e)),this,this.disposables),this.knownSessions.push(e),await e.initialize(),e}catch(e){(0,f.traceError)(`Encountered error while starting new TensorBoard session: ${e}`),await this.applicationShell.showErrorMessage(s.l10n.t("We failed to start a TensorBoard session due to the following error: {0}",e.message))}}};b=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IInstaller)),i(1,(0,o.inject)(h.IInterpreterService)),i(2,(0,o.inject)(a.IApplicationShell)),i(3,(0,o.inject)(a.IWorkspaceService)),i(4,(0,o.inject)(a.ICommandManager)),i(5,(0,o.inject)(p.IDisposableRegistry)),i(6,(0,o.inject)(u.IPythonExecutionFactory)),i(7,(0,o.inject)(p.IPersistentStateFactory)),i(8,(0,o.inject)(d.IMultiStepInputFactory)),i(9,(0,o.inject)(p.IConfigurationService))],b),t.TensorBoardSessionProvider=b},17950:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TensorBoardUsageTracker=void 0;const o=n(86700),s=n(71017),a=n(17585),c=n(77570),l=n(61684),u=n(15036),p=n(68329),d=n(2810),h=n(68291),f=(0,c.isTestExecution)();let g=class{constructor(e,t,n){this.documentManager=e,this.disposables=t,this.prompt=n,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){f?await this.activateInternal():this.activateInternal().ignoreErrors()}async activateInternal(){this.onChangedActiveTextEditor(this.documentManager.activeTextEditor),this.documentManager.onDidChangeActiveTextEditor((e=>this.onChangedActiveTextEditor(e)),this,this.disposables)}onChangedActiveTextEditor(e){if(!e||!e.document)return;const{document:t}=e,n=s.extname(t.fileName).toLowerCase();if(".py"===n||".ipynb"===n&&"python"===t.languageId){const e=(0,u.getDocumentLines)(t);(0,d.containsTensorBoardImport)(e)&&this.prompt.showNativeTensorBoardPrompt(p.TensorBoardEntrypointTrigger.fileimport).ignoreErrors()}}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IDocumentManager)),i(1,(0,o.inject)(l.IDisposableRegistry)),i(2,(0,o.inject)(h.TensorBoardPrompt))],g),t.TensorBoardUsageTracker=g},12074:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalWatcher=void 0;const o=n(86700),s=n(66828),a=n(61684),c=n(54813),l=n(61522);let u=class{constructor(e){this.disposables=e,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1}}async activate(){const e=setInterval((()=>{s.window.terminals.filter((e=>"tensorboard"===e.name)).length>0&&((0,c.sendTelemetryEvent)(l.EventName.TENSORBOARD_DETECTED_IN_INTEGRATED_TERMINAL),clearInterval(e))}),3e5);this.handle=e,this.disposables.push(this)}dispose(){this.handle&&clearInterval(this.handle)}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IDisposableRegistry))],u),t.TerminalWatcher=u},98383:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalAutoActivation=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(58400),l=n(61684);let u=class{constructor(e,t,n,r){this.terminalManager=e,this.activator=n,this.activeResourceService=r,this.terminalsNotToAutoActivate=new WeakSet,t.push(this)}dispose(){this.handler&&(this.handler.dispose(),this.handler=void 0)}register(){this.handler||(this.handler=this.terminalManager.onDidOpenTerminal(this.activateTerminal,this))}disableAutoActivation(e){this.terminalsNotToAutoActivate.add(e)}async activateTerminal(e){if(this.terminalsNotToAutoActivate.has(e))return;if("hideFromUser"in e.creationOptions&&e.creationOptions.hideFromUser)return;const t="cwd"in e.creationOptions?e.creationOptions.cwd:this.activeResourceService.getActiveResource(),n="string"==typeof t?s.Uri.file(t):t;await this.activator.activateEnvironmentInTerminal(e,{resource:n})}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ITerminalManager)),i(1,(0,o.inject)(l.IDisposableRegistry)),i(2,(0,o.inject)(c.ITerminalActivator)),i(3,(0,o.inject)(a.IActiveResourceService))],u),t.TerminalAutoActivation=u},19645:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeExecutionManager=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570);n(32727);const l=n(84974),u=n(61684),p=n(3481),d=n(18639),h=n(77498),f=n(19735),g=n(54813),m=n(61522),v=n(43200);let y=class{constructor(e,t,n,r,i,o){this.commandManager=e,this.documentManager=t,this.disposableRegistry=n,this.fileSystem=r,this.configSettings=i,this.serviceContainer=o,this.eventEmitter=new s.EventEmitter}get onExecutedCode(){return this.eventEmitter.event}registerCommands(){[c.Commands.Exec_In_Terminal,c.Commands.Exec_In_Terminal_Icon,c.Commands.Exec_In_Separate_Terminal].forEach((e=>{this.disposableRegistry.push(this.commandManager.registerCommand(e,(async t=>{const n=this.serviceContainer.get(d.IInterpreterService);if(!await n.getActiveInterpreter(t))return void this.commandManager.executeCommand(c.Commands.TriggerEnvironmentSelection,t).then(p.noop,p.noop);const r=e===c.Commands.Exec_In_Terminal?"command":"icon";await this.executeFileInTerminal(t,r,{newTerminalPerFile:e===c.Commands.Exec_In_Separate_Terminal}).then((()=>{this.shouldTerminalFocusOnStart(t)&&this.commandManager.executeCommand("workbench.action.terminal.focus")})).catch((e=>(0,f.traceError)("Failed to execute file in terminal",e)))})))})),this.disposableRegistry.push(this.commandManager.registerCommand(c.Commands.Exec_Selection_In_Terminal,(async e=>{const t=this.serviceContainer.get(d.IInterpreterService);await t.getActiveInterpreter(e)?await this.executeSelectionInTerminal().then((()=>{this.shouldTerminalFocusOnStart(e)&&this.commandManager.executeCommand("workbench.action.terminal.focus")})):this.commandManager.executeCommand(c.Commands.TriggerEnvironmentSelection,e).then(p.noop,p.noop)}))),this.disposableRegistry.push(this.commandManager.registerCommand(c.Commands.Exec_Selection_In_Django_Shell,(async e=>{const t=this.serviceContainer.get(d.IInterpreterService);await t.getActiveInterpreter(e)?await this.executeSelectionInDjangoShell().then((()=>{this.shouldTerminalFocusOnStart(e)&&this.commandManager.executeCommand("workbench.action.terminal.focus")})):this.commandManager.executeCommand(c.Commands.TriggerEnvironmentSelection,e).then(p.noop,p.noop)})))}async executeFileInTerminal(e,t,n){(0,g.sendTelemetryEvent)(m.EventName.EXECUTION_CODE,void 0,{scope:"file",trigger:t,newTerminalPerFile:null==n?void 0:n.newTerminalPerFile});const r=this.serviceContainer.get(v.ICodeExecutionHelper);let i=(e=e instanceof s.Uri?e:void 0)||await r.getFileToExecute();if(!i)return;const o=await r.saveFileIfDirty(i);o&&(i=o);try{const e=await this.fileSystem.readFile(i.fsPath);this.eventEmitter.fire(e)}catch(e){(0,p.noop)()}const a=this.serviceContainer.get(v.ICodeExecutionService,"standard");await a.executeFile(i,n)}async executeSelectionInTerminal(){const e=this.serviceContainer.get(v.ICodeExecutionService,"standard");await this.executeSelection(e)}async executeSelectionInDjangoShell(){const e=this.serviceContainer.get(v.ICodeExecutionService,"djangoShell");await this.executeSelection(e)}async executeSelection(e){const t=this.documentManager.activeTextEditor;if(!t)return;const n=this.serviceContainer.get(v.ICodeExecutionHelper),r=await n.getSelectedTextToExecute(t),i=await n.normalizeLines(r);if(i&&0!==i.trim().length){try{this.eventEmitter.fire(i)}catch(e){(0,p.noop)()}await e.execute(i,t.document.uri)}}shouldTerminalFocusOnStart(e){var t;return null===(t=this.configSettings.getSettings(e))||void 0===t?void 0:t.terminal.focusAfterLaunch}};r([(0,g.captureTelemetry)(m.EventName.EXECUTION_CODE,{scope:"selection"},!1)],y.prototype,"executeSelectionInTerminal",null),r([(0,g.captureTelemetry)(m.EventName.EXECUTION_DJANGO,{scope:"selection"},!1)],y.prototype,"executeSelectionInDjangoShell",null),y=r([(0,o.injectable)(),i(0,(0,o.inject)(a.ICommandManager)),i(1,(0,o.inject)(a.IDocumentManager)),i(2,(0,o.inject)(u.IDisposableRegistry)),i(3,(0,o.inject)(l.IFileSystem)),i(4,(0,o.inject)(u.IConfigurationService)),i(5,(0,o.inject)(h.IServiceContainer))],y),t.CodeExecutionManager=y},20130:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DjangoContextInitializer=void 0;const i=n(86700),o=n(71017),s=n(94316),a=n(19735);let c=class{constructor(e,t,n,r){this.documentManager=e,this.workpaceService=t,this.fileSystem=n,this.monitoringActiveTextEditor=!1,this.workspaceContextKeyValues=new Map,this.lastCheckedWorkspace="",this.disposables=[],this.isDjangoProject=new s.ContextKey("python.isDjangoProject",r),this.ensureContextStateIsSet().catch((e=>(0,a.traceError)("Python Extension: ensureState",e))),this.disposables.push(this.workpaceService.onDidChangeWorkspaceFolders((()=>this.updateContextKeyBasedOnActiveWorkspace())))}dispose(){this.disposables.forEach((e=>e.dispose()))}updateContextKeyBasedOnActiveWorkspace(){this.monitoringActiveTextEditor||(this.monitoringActiveTextEditor=!0,this.disposables.push(this.documentManager.onDidChangeActiveTextEditor((()=>this.ensureContextStateIsSet()))))}getActiveWorkspace(){if(!Array.isArray(this.workpaceService.workspaceFolders)||0===this.workpaceService.workspaceFolders.length)return;if(1===this.workpaceService.workspaceFolders.length)return this.workpaceService.workspaceFolders[0].uri.fsPath;const e=this.documentManager.activeTextEditor;if(!e)return;const t=this.workpaceService.getWorkspaceFolder(e.document.uri);return t?t.uri.fsPath:void 0}async ensureContextStateIsSet(){const e=this.getActiveWorkspace();if(!e)return this.isDjangoProject.set(!1);if(this.lastCheckedWorkspace!==e)if(this.workspaceContextKeyValues.has(e))await this.isDjangoProject.set(this.workspaceContextKeyValues.get(e));else{const t=await this.fileSystem.fileExists(o.join(e,"manage.py"));await this.isDjangoProject.set(t),this.workspaceContextKeyValues.set(e,t),this.lastCheckedWorkspace=e}}};c=r([(0,i.injectable)()],c),t.DjangoContextInitializer=c},80710:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DjangoShellCodeExecutionProvider=void 0;const o=n(86700),s=n(71017),a=n(17585);n(32727);const c=n(84974),l=n(58400),u=n(61684),p=n(18639),d=n(24708),h=n(20130),f=n(96524);let g=class extends f.TerminalCodeExecutionProvider{constructor(e,t,n,r,i,o,s,a,c){super(e,t,n,a,i,c),this.terminalTitle="Django Shell",a.push(new h.DjangoContextInitializer(r,n,s,o))}async getExecutableInfo(e,t=[]){const n=await super.getExecutableInfo(e,t),r=e?this.workspace.getWorkspaceFolder(e):void 0,i=Array.isArray(this.workspace.workspaceFolders)&&this.workspace.workspaceFolders.length>0?this.workspace.workspaceFolders[0].uri.fsPath:"",o=r?r.uri.fsPath:i,a=0===o.length?"manage.py":s.join(o,"manage.py");return(0,d.copyPythonExecInfo)(n,[a.fileToCommandArgumentForPythonExt(),"shell"])}async getExecuteFileArgs(e,t=[]){const n=await super.getExecutableInfo(e);return(0,d.copyPythonExecInfo)(n,t)}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(l.ITerminalServiceFactory)),i(1,(0,o.inject)(u.IConfigurationService)),i(2,(0,o.inject)(a.IWorkspaceService)),i(3,(0,o.inject)(a.IDocumentManager)),i(4,(0,o.inject)(c.IPlatformService)),i(5,(0,o.inject)(a.ICommandManager)),i(6,(0,o.inject)(c.IFileSystem)),i(7,(0,o.inject)(u.IDisposableRegistry)),i(8,(0,o.inject)(p.IInterpreterService))],g),t.DjangoShellCodeExecutionProvider=g},50773:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeExecutionHelper=void 0,n(32727);const o=n(86700),s=n(66828),a=n(17585),c=n(77570),l=n(4057),u=n(29983),p=n(59314),d=n(18639),h=n(77498),f=n(19735);let g=class{constructor(e){this.serviceContainer=e,this.documentManager=e.get(a.IDocumentManager),this.applicationShell=e.get(a.IApplicationShell),this.processServiceFactory=e.get(u.IProcessServiceFactory),this.interpreterService=e.get(d.IInterpreterService)}async normalizeLines(e,t){var n,r,i,o;try{if(0===e.trim().length)return"";e=e.replace(new RegExp("\\r","g"),"");const s=await this.interpreterService.getActiveInterpreter(t),a=await this.processServiceFactory.create(t),[c,u]=l.normalizeSelection(),d=a.execObservable((null==s?void 0:s.path)||"python",c,{throwOnStdErr:!0}),h=(0,p.createDeferred)();let f="";d.out.subscribe({next:e=>{"stdout"===e.source&&(f+=e.out)},complete:()=>{h.resolve(f)}});const g=JSON.stringify({code:e});null===(r=null===(n=d.proc)||void 0===n?void 0:n.stdin)||void 0===r||r.write(g),null===(o=null===(i=d.proc)||void 0===i?void 0:i.stdin)||void 0===o||o.end();const m=await h.promise;return u(JSON.parse(m).normalized)}catch(t){return(0,f.traceError)(t,"Python: Failed to normalize code for execution in terminal"),e}}async getFileToExecute(){const e=this.documentManager.activeTextEditor;if(e)if(e.document.isUntitled)this.applicationShell.showErrorMessage(s.l10n.t("The active file needs to be saved before it can be run"));else{if(e.document.languageId===c.PYTHON_LANGUAGE)return e.document.isDirty&&await e.document.save(),e.document.uri;this.applicationShell.showErrorMessage(s.l10n.t("The active file is not a Python source file)"))}else this.applicationShell.showErrorMessage(s.l10n.t("No open file to run in terminal"))}async getSelectedTextToExecute(e){if(!e)return;const{selection:t}=e;let n;return n=t.isEmpty?e.document.lineAt(t.start.line).text:t.isSingleLine?function(e){const{selection:t}=e,n=new s.Range(t.start,t.end),r=e.document.getText(n),i=e.document.lineAt(t.start.line).text;return r.trim()===i.trim()?i:r}(e):function(e){const{selection:t}=e,n=new s.Range(t.start,t.end),r=e.document.getText(n),i=new s.Range(new s.Position(t.start.line,0),new s.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),o=e.document.getText(i);if(r.trim()===o.trim())return o;const a=e.document.lineAt(t.start.line).text,c=new s.Range(t.start,new s.Position(t.start.line,a.length)),l=e.document.getText(c);return l.trimLeft()===a.trimLeft()?a+r.substr(l.length):r}(e),n}async saveFileIfDirty(e){const t=this.documentManager.textDocuments.filter((t=>t.uri.path===e.path));if(1===t.length&&(t[0].isDirty||t[0].isUntitled))return this.serviceContainer.get(a.IWorkspaceService).save(t[0].uri)}};g=r([(0,o.injectable)(),i(0,(0,o.inject)(h.IServiceContainer))],g),t.CodeExecutionHelper=g},80055:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReplProvider=void 0;const o=n(86700),s=n(17585),a=n(84974),c=n(58400),l=n(61684),u=n(18639),p=n(96524);let d=class extends p.TerminalCodeExecutionProvider{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this.terminalTitle="REPL"}};d=r([(0,o.injectable)(),i(0,(0,o.inject)(c.ITerminalServiceFactory)),i(1,(0,o.inject)(l.IConfigurationService)),i(2,(0,o.inject)(s.IWorkspaceService)),i(3,(0,o.inject)(l.IDisposableRegistry)),i(4,(0,o.inject)(a.IPlatformService)),i(5,(0,o.inject)(u.IInterpreterService))],d),t.ReplProvider=d},96524:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalCodeExecutionProvider=void 0;const o=n(86700),s=n(71017),a=n(17585);n(32727);const c=n(84974),l=n(58400),u=n(61684),p=n(18639),d=n(24708);let h=class{constructor(e,t,n,r,i,o){this.terminalServiceFactory=e,this.configurationService=t,this.workspace=n,this.disposables=r,this.platformService=i,this.interpreterService=o,this.hasRanOutsideCurrentDrive=!1}async executeFile(e,t){await this.setCwdForFileExecution(e,t);const{command:n,args:r}=await this.getExecuteFileArgs(e,[e.fsPath.fileToCommandArgumentForPythonExt()]);await this.getTerminalService(e,t).sendCommand(n,r)}async execute(e,t){e&&0!==e.trim().length&&(await this.initializeRepl(t),await this.getTerminalService(t).sendText(e))}async initializeRepl(e){const t=this.getTerminalService(e);this.replActive&&await this.replActive?await t.show():(this.replActive=new Promise((async n=>{const r=await this.getExecutableInfo(e);t.sendCommand(r.command,r.args),setTimeout((()=>n(!0)),1e3)})),this.disposables.push(t.onDidCloseTerminal((()=>{this.replActive=void 0}))),await this.replActive)}async getExecutableInfo(e,t=[]){var n;const r=this.configurationService.getSettings(e),i=await this.interpreterService.getActiveInterpreter(e),o=null!==(n=null==i?void 0:i.path)&&void 0!==n?n:r.pythonPath,s=this.platformService.isWindows?o.replace(/\\/g,"/"):o,a=r.terminal.launchArgs;return(0,d.buildPythonExecInfo)(s,[...a,...t])}async getExecuteFileArgs(e,t=[]){return this.getExecutableInfo(e,t)}getTerminalService(e,t){return this.terminalServiceFactory.getTerminalService({resource:e,title:this.terminalTitle,newTerminalPerFile:null==t?void 0:t.newTerminalPerFile})}async setCwdForFileExecution(e,t){if(!this.configurationService.getSettings(e).terminal.executeInFileDir)return;const n=s.dirname(e.fsPath);if(n.length>0){if(this.platformService.isWindows&&/[a-z]\:/i.test(n)){const t="string"==typeof this.workspace.rootPath?this.workspace.rootPath.replace(/\:.*/g,""):void 0,r=n.replace(/\:.*/g,"");(r!==t||this.hasRanOutsideCurrentDrive)&&(this.hasRanOutsideCurrentDrive=!0,await this.getTerminalService(e).sendText(`${r}:`))}await this.getTerminalService(e,t).sendText(`cd ${n.fileToCommandArgumentForPythonExt()}`)}}};h=r([(0,o.injectable)(),i(0,(0,o.inject)(l.ITerminalServiceFactory)),i(1,(0,o.inject)(u.IConfigurationService)),i(2,(0,o.inject)(a.IWorkspaceService)),i(3,(0,o.inject)(u.IDisposableRegistry)),i(4,(0,o.inject)(c.IPlatformService)),i(5,(0,o.inject)(p.IInterpreterService))],h),t.TerminalCodeExecutionProvider=h},73607:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(98383),i=n(19645),o=n(80710),s=n(50773),a=n(80055),c=n(96524),l=n(43200);t.registerTypes=function(e){e.addSingleton(l.ICodeExecutionHelper,s.CodeExecutionHelper),e.addSingleton(l.ICodeExecutionManager,i.CodeExecutionManager),e.addSingleton(l.ICodeExecutionService,o.DjangoShellCodeExecutionProvider,"djangoShell"),e.addSingleton(l.ICodeExecutionService,c.TerminalCodeExecutionProvider,"standard"),e.addSingleton(l.ICodeExecutionService,a.ReplProvider,"repl"),e.addSingleton(l.ITerminalAutoActivation,r.TerminalAutoActivation)}},43200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITerminalAutoActivation=t.ICodeExecutionManager=t.ICodeExecutionHelper=t.ICodeExecutionService=void 0,t.ICodeExecutionService=Symbol("ICodeExecutionService"),t.ICodeExecutionHelper=Symbol("ICodeExecutionHelper"),t.ICodeExecutionManager=Symbol("ICodeExecutionManager"),t.ITerminalAutoActivation=Symbol("ITerminalAutoActivation")},81345:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferedTestConfigSettingsService=void 0,t.BufferedTestConfigSettingsService=class{constructor(){this.ops=[]}async updateTestArgs(e,t,n){return this.ops.push(["updateTestArgs",e,t,n]),Promise.resolve()}async enable(e,t){return this.ops.push(["enable",e,t,[]]),Promise.resolve()}async disable(e,t){return this.ops.push(["disable",e,t,[]]),Promise.resolve()}async apply(e){const{ops:t}=this;this.ops=[];for(const[n,r,i,o]of t)switch(n){case"updateTestArgs":await e.updateTestArgs(r,i,o);break;case"enable":await e.enable(r,i);break;case"disable":await e.disable(r,i)}return Promise.resolve()}getTestEnablingSetting(e){throw new Error("Method not implemented.")}}},96472:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TestConfigSettingsService=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(61684),l=n(77498);let u=class{constructor(e){this.workspaceService=e.get(a.IWorkspaceService)}async updateTestArgs(e,t,n){const r=this.getTestArgSetting(t);return this.updateSetting(e,r,n)}async enable(e,t){const n=this.getTestEnablingSetting(t);return this.updateSetting(e,n,!0)}async disable(e,t){const n=this.getTestEnablingSetting(t);return this.updateSetting(e,n,!1)}getTestEnablingSetting(e){switch(e){case c.Product.unittest:return"testing.unittestEnabled";case c.Product.pytest:return"testing.pytestEnabled";default:throw new Error("Invalid Test Product")}}getTestArgSetting(e){switch(e){case c.Product.unittest:return"testing.unittestArgs";case c.Product.pytest:return"testing.pytestArgs";default:throw new Error("Invalid Test Product")}}async updateSetting(e,t,n){var r;let i;const o="string"==typeof e?s.Uri.file(e):e;if(((null===(r=this.workspaceService.workspaceFolders)||void 0===r?void 0:r.length)||0)>0)if(1===this.workspaceService.workspaceFolders.length)i=this.workspaceService.getConfiguration("python",this.workspaceService.workspaceFolders[0].uri);else{const t=this.workspaceService.getWorkspaceFolder(o);if(!t)throw new Error(`Test directory does not belong to any workspace (${e})`);i=this.workspaceService.getConfiguration("python",t.uri)}else i=this.workspaceService.getConfiguration("python");return i.update(t,n)}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(l.IServiceContainer))],u),t.TestConfigSettingsService=u},83194:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNITTEST_PROVIDER=t.PYTEST_PROVIDER=t.UNIT_TEST_PRODUCTS=void 0;const r=n(61684);t.UNIT_TEST_PRODUCTS=[r.Product.pytest,r.Product.unittest],t.PYTEST_PROVIDER="pytest",t.UNITTEST_PROVIDER="unittest"},57488:function(e,t,n){"use strict";var r,i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugLauncher=void 0;const s=n(86700),a=n(71017),c=n(66828),l=n(17585),u=n(77570),p=n(4057),d=n(61684),h=n(51097),f=n(45093),g=n(7317),m=n(77498),v=n(19735),y=n(40169),b=n(85261),S=n(56693),E=n(59314),_=n(76646),w=n(38610);let T=r=class{constructor(e,t){this.serviceContainer=e,this.launchResolver=t,this.configService=this.serviceContainer.get(d.IConfigurationService)}async launchDebugger(e,t){if(e.token&&e.token.isCancellationRequested)return;const n=r.resolveWorkspaceFolder(e.cwd),i=await this.getLaunchArgs(e,n,this.configService.getSettings(n.uri)),o=this.serviceContainer.get(l.IDebugService),s=(0,E.createDeferred)();return o.onDidTerminateDebugSession((()=>{s.resolve(),null==t||t()})),o.startDebugging(n,i),s.promise}static resolveWorkspaceFolder(e){var t;if(!(((null===(t=(0,b.getWorkspaceFolders)())||void 0===t?void 0:t.length)||0)>0))throw new Error("Please open a workspace");const n=e?c.Uri.file(e):void 0;let r=(0,b.getWorkspaceFolder)(n);if(!r){const[e]=(0,b.getWorkspaceFolders)();r=e}return r}async getLaunchArgs(e,t,n){let i=await r.readDebugConfig(t);return i||(i={name:"Debug Unit Test",type:"python",request:"test",subProcess:!0}),i.rules||(i.rules=[]),i.rules.push({path:a.join(u.EXTENSION_ROOT_DIR,"pythonFiles"),include:!1}),r.applyDefaults(i,t,n),this.convertConfigToArgs(i,t,e)}async readAllDebugConfigs(e){try{return await(0,y.getConfigurationsForWorkspace)(e)}catch(e){(0,v.traceError)("could not get debug config",e);const t=this.serviceContainer.get(l.IApplicationShell);return await t.showErrorMessage(c.l10n.t("Could not load unit test config from launch.json as it is missing a field")),[]}}static async readDebugConfig(e){var t;try{const n=await(0,y.getConfigurationsForWorkspace)(e);for(const e of n)if(e.name&&e.type===h.DebuggerTypeName&&("test"===e.request||(null===(t=e.purpose)||void 0===t?void 0:t.includes(g.DebugPurpose.DebugTest))))return e;return}catch(e){return(0,v.traceError)("could not get debug config",e),void await(0,S.showErrorMessage)(c.l10n.t("Could not load unit test config from launch.json as it is missing a field"))}}static applyDefaults(e,t,n){e.console||(e.console="internalConsole"),e.cwd||(e.cwd=n.testing.cwd||t.uri.fsPath),e.env||(e.env={}),e.envFile||(e.envFile=n.envFile),void 0===e.stopOnEntry&&(e.stopOnEntry=!1),e.showReturnValue=!1!==e.showReturnValue,void 0===e.redirectOutput&&(e.redirectOutput=!0),void 0===e.debugStdLib&&(e.debugStdLib=!1),void 0===e.subProcess&&(e.subProcess=!0)}async convertConfigToArgs(e,t,n){const i=(0,_.pythonTestAdapterRewriteEnabled)(this.serviceContainer),o=e,s="unittest"===n.testProvider?n.args.filter((e=>"--debug"!==e)):n.args,c=r.getTestLauncherScript(n.testProvider,i)(s),[l]=c;o.program=l,o.args=c.slice(1);let p=await this.launchResolver.resolveDebugConfiguration(t,o,n.token);if(!p)throw Error(`Invalid debug config "${e.name}"`);if(p=await this.launchResolver.resolveDebugConfigurationWithSubstitutedVariables(t,p,n.token),!p)throw Error(`Invalid debug config "${e.name}"`);if(p.request="launch",n.runTestIdsPort&&(p.env={...p.env,RUN_TEST_IDS_PORT:n.runTestIdsPort}),"pytest"===n.testProvider&&i){if(!n.pytestPort||!n.pytestUUID)throw Error(`Missing value for debug setup, both port and uuid need to be defined. port: "${n.pytestPort}" uuid: "${n.pytestUUID}"`);p.env={...p.env,TEST_PORT:n.pytestPort,TEST_UUID:n.pytestUUID}}const d=a.join(u.EXTENSION_ROOT_DIR,"pythonFiles");if(p.env){const e=[d];p.cwd?e.push(p.cwd):n.cwd&&e.push(n.cwd),(0,w.addPathToPythonpath)(e,p.env.PYTHONPATH)}return p.purpose=[],p}static getTestLauncherScript(e,t){switch(e){case"unittest":return t?p.execution_py_testlauncher:p.visualstudio_py_testlauncher;case"pytest":return t?p.pytestlauncher:p.testlauncher;default:throw new Error(`Unknown test provider '${e}'`)}}};T=r=i([(0,s.injectable)(),o(0,(0,s.inject)(m.IServiceContainer)),o(1,(0,s.inject)(f.IDebugConfigurationResolver)),o(1,(0,s.named)("launch"))],T),t.DebugLauncher=T},38610:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPathToPythonpath=void 0;const r=n(71017);t.addPathToPythonpath=function(e,t){let n;return n=t?t.split(r.delimiter):[],n=n.map((e=>r.normalize(e))),e.forEach((e=>{const t=r.normalize(e);n.includes(t)||n.push(t)})),n.join(r.delimiter)}},57475:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TestRunner=void 0;const o=n(86700),s=n(71017),a=n(26804),c=n(97300),l=n(29983),u=n(61684),p=n(77498),d=n(83194),h=n(78308);let f=class{constructor(e){this.serviceContainer=e}run(e,t){return async function(e,t,n){const r=function(e,t){let n;if(e===d.PYTEST_PROVIDER)return n=t.testing.pytestPath,s.basename(n)===n?void 0:n}(t,e.get(u.IConfigurationService).getSettings(n.workspaceFolder)),i=function(e){switch(e){case d.PYTEST_PROVIDER:return"pytest";case d.UNITTEST_PROVIDER:return"unittest";default:throw new Error(`Test provider '${e}' not supported`)}}(t),o=n;let p,f;o.mergeStdOutErr="boolean"!=typeof o.mergeStdOutErr||o.mergeStdOutErr;const g=e.get(h.ITestsHelper),m={execPath:r,args:n.args,moduleName:r&&r.length>0?void 0:i,product:g.parseProduct(t)};return t===d.UNITTEST_PROVIDER?f=e.get(l.IPythonExecutionFactory).createActivatedEnvironment({resource:n.workspaceFolder}).then((e=>e.execObservable(n.args,{...o}))):"string"==typeof m.moduleName&&m.moduleName.length>0?(p=e.get(l.IPythonExecutionFactory).createActivatedEnvironment({resource:n.workspaceFolder}),f=p.then((e=>e.execModuleObservable(m.moduleName,m.args,n)))):f=e.get(l.IPythonToolExecutionService).execObservable(m,o,n.workspaceFolder),f.then((e=>new Promise(((t,r)=>{let o="",s="";e.out.subscribe((e=>{o+=e.out,"stderr"===e.source&&(s+=e.out),n.outChannel&&n.outChannel.append(e.out)}),r,(async()=>{if(i&&p&&a.ErrorUtils.outputHasModuleNotInstalledError(i,s)){const e=await p;if(!await e.isModuleInstalled(i))return r(new c.ModuleNotInstalledError(i))}t(o)}))}))))}(this.serviceContainer,e,t)}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer))],f),t.TestRunner=f},42035:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.UnitTestSocketServer=void 0;const i=n(82361),o=n(86700),s=n(41808),a=n(59314);let c=class extends i.EventEmitter{constructor(){super(),this.sockets=[],this.ipcBuffer=""}get clientsConnected(){return this.sockets.length>0}dispose(){this.stop()}stop(){this.server&&(this.server.close(),this.server=void 0)}start({port:e,host:t}={port:0,host:"localhost"}){var n;return this.ipcBuffer="",this.startedDef=(0,a.createDeferred)(),this.server=s.createServer(this.connectionListener.bind(this)),this.server.maxConnections=100,this.server.on("error",(e=>{this.startedDef&&(this.startedDef.reject(e),this.startedDef=void 0),this.emit("error",e)})),this.log("starting server as","TCP"),0===t.trim().length&&(t="localhost"),this.server.on("connection",(e=>{this.emit("start",e)})),this.server.listen(e,t,(()=>{var e,t;null===(e=this.startedDef)||void 0===e||e.resolve((null===(t=this.server)||void 0===t?void 0:t.address()).port),this.startedDef=void 0})),null===(n=this.startedDef)||void 0===n?void 0:n.promise}connectionListener(e){this.sockets.push(e),e.setEncoding("utf8"),this.log("## socket connection to server detected ##"),e.on("close",(()=>{this.ipcBuffer="",this.onCloseSocket()})),e.on("error",(e=>{this.log("server socket error",e),this.emit("error",e)})),e.on("data",(t=>{const n=e;let r=this.ipcBuffer+=t;for(;;){const e=r.indexOf("{");if(-1===e)return;const t=parseInt(r.slice(r.indexOf(":")+1,r.indexOf("{")).trim(),10);if(r.length<e+t)return;let i;try{i=JSON.parse(r.substring(e,t+e))}catch(e){return void this.emit("error",e)}r=this.ipcBuffer=r.substring(e+t),this.emit(i.event,i.body,n)}})),this.emit("connect",e)}log(e,...t){this.emit("log",e,...t)}onCloseSocket(){for(let e=0,t=this.sockets.length;e<t;e+=1){const t=this.sockets[e];if(t&&t.readable)continue;let n;return t.id&&(n=t.id),this.log("socket disconnected",null==n?void 0:n.toString()),t&&t.destroy&&t.destroy(),this.sockets.splice(e,1),void this.emit("socket.disconnected",t,n)}}};c=r([(0,o.injectable)()],c),t.UnitTestSocketServer=c},85494:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestConfigurationManager=void 0;const r=n(71017),i=n(17585),o=n(84974),s=n(61684),a=n(59314),c=n(19735),l=n(83194),u=n(78308);function p(){throw(0,c.traceVerbose)("testing configuration (in UI) cancelled"),Error("cancelled")}t.TestConfigurationManager=class{constructor(e,t,n,r){this.workspace=e,this.product=t,this.serviceContainer=n,this.handleCancelled=p,this.installer=n.get(s.IInstaller),this.testConfigSettingsService=r||n.get(u.ITestConfigSettingsService)}async enable(){await Promise.all(l.UNIT_TEST_PRODUCTS.filter((e=>e!==this.product)).map((e=>this.testConfigSettingsService.disable(this.workspace,e)))),await this.testConfigSettingsService.enable(this.workspace,this.product)}async disable(){return this.testConfigSettingsService.enable(this.workspace,this.product)}selectTestDir(e,t,n=[]){let i=t.map((t=>{const n=r.relative(e,t);if(0!==n.indexOf("."))return{label:n,description:""}})).filter((e=>void 0!==e)).map((e=>e));return i=[{label:".",description:"Root directory"},...i],i=n.concat(i),this.showQuickPick(i,{ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0,placeHolder:"Select the directory containing the tests"})}selectTestFilePattern(){return this.showQuickPick([{label:"*test.py",description:"Python files ending with 'test'"},{label:"*_test.py",description:"Python files ending with '_test'"},{label:"test*.py",description:"Python files beginning with 'test'"},{label:"test_*.py",description:"Python files beginning with 'test_'"},{label:"*test*.py",description:"Python files containing the word 'test'"}],{ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0,placeHolder:"Select the pattern to identify test files"})}getTestDirs(e){return this.serviceContainer.get(o.IFileSystem).getSubDirectories(e).then((e=>{e.sort();const t=e.filter((e=>e.match(/test/i))),n=e.filter((e=>-1===t.indexOf(e)));return t.push(...n),t}))}showQuickPick(e,t){const n=(0,a.createDeferred)();return this.serviceContainer.get(i.IApplicationShell).showQuickPick(e,t).then((e=>{e?n.resolve(e.label):this.handleCancelled()})),n.promise}}},97395:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TestsHelper=t.selectTestWorkspace=void 0;const i=n(86700),o=n(66828),s=n(61684);t.selectTestWorkspace=async function(e){if(Array.isArray(o.workspace.workspaceFolders)&&0!==o.workspace.workspaceFolders.length){if(1===o.workspace.workspaceFolders.length)return o.workspace.workspaceFolders[0].uri;{const t=await e.showWorkspaceFolderPick({placeHolder:"Select a workspace"});return t?t.uri:void 0}}};let a=class{parseProviderName(e){switch(e){case s.Product.pytest:return"pytest";case s.Product.unittest:return"unittest";default:throw new Error(`Unknown Test Product ${e}`)}}parseProduct(e){switch(e){case"pytest":return s.Product.pytest;case"unittest":return s.Product.unittest;default:throw new Error(`Unknown Test Provider ${e}`)}}getSettingsPropertyNames(e){switch(this.parseProviderName(e)){case"pytest":return{argsName:"pytestArgs",pathName:"pytestPath",enabledName:"pytestEnabled"};case"unittest":return{argsName:"unittestArgs",enabledName:"unittestEnabled"};default:throw new Error(`Unknown Test Provider '${e}'`)}}};a=r([(0,i.injectable)()],a),t.TestsHelper=a},78308:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ITestRunner=t.IUnitTestSocketServer=t.ITestDebugLauncher=t.ITestConfigurationManagerFactory=t.ITestConfigSettingsService=t.ITestConfigurationService=t.ITestsHelper=t.TestFilter=void 0,(n=t.TestFilter||(t.TestFilter={})).removeTests="removeTests",n.discovery="discovery",n.runAll="runAll",n.runSpecific="runSpecific",n.debugAll="debugAll",n.debugSpecific="debugSpecific",t.ITestsHelper=Symbol("ITestsHelper"),t.ITestConfigurationService=Symbol("ITestConfigurationService"),t.ITestConfigSettingsService=Symbol("ITestConfigSettingsService"),t.ITestConfigurationManagerFactory=Symbol("ITestConfigurationManagerFactory"),t.ITestDebugLauncher=Symbol("ITestDebugLauncher"),t.IUnitTestSocketServer=Symbol("IUnitTestSocketServer"),t.ITestRunner=Symbol("ITestRunner")},8051:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UnitTestConfigurationService=t.NONE_SELECTED=void 0;const o=n(86700),s=n(17585),a=n(61684),c=n(77498),l=n(19735),u=n(54813),p=n(61522),d=n(81345),h=n(78308);t.NONE_SELECTED=Error("none selected");let f=class{constructor(e){this.serviceContainer=e,this.configurationService=e.get(a.IConfigurationService),this.appShell=e.get(s.IApplicationShell),this.workspaceService=e.get(s.IWorkspaceService)}async displayTestFrameworkError(e){const n=this.configurationService.getSettings(e);let r=n.testing.pytestEnabled?1:0;if(r+=n.testing.unittestEnabled?1:0,r>1)return this._promptToEnableAndConfigureTestFramework(e,"Enable only one of the test frameworks (unittest or pytest).",!0);const i="Enable and configure a Test Framework";if(await this.appShell.showInformationMessage("No test framework configured (unittest, or pytest)",i)!==i)throw t.NONE_SELECTED;return this._promptToEnableAndConfigureTestFramework(e)}async selectTestRunner(e){const t=[{label:"unittest",product:a.Product.unittest,description:"Standard Python test framework",detail:"https://docs.python.org/3/library/unittest.html"},{label:"pytest",product:a.Product.pytest,description:"pytest framework",detail:"http://docs.pytest.org/"}],n={ignoreFocusOut:!0,matchOnDescription:!0,matchOnDetail:!0,placeHolder:e},r=await this.appShell.showQuickPick(t,n);return r?r.product:void 0}async enableTest(e,t){const n=this.serviceContainer.get(h.ITestConfigurationManagerFactory).create(e,t);return this._enableTest(e,n)}async promptToEnableAndConfigureTestFramework(e){await this._promptToEnableAndConfigureTestFramework(e,void 0,!1,"commandpalette")}_enableTest(e,t){const n=this.workspaceService.getConfiguration("python",e);return n.get("testing.promptToConfigure")?t.enable():n.update("testing.promptToConfigure",void 0).then((()=>t.enable()),(e=>t.enable().then((()=>Promise.reject(e)))))}async _promptToEnableAndConfigureTestFramework(e,n="Select a test framework/tool to enable",r=!1,i="ui"){const o={trigger:i,failed:!1};try{const i=await this.selectTestRunner(n);if("number"!=typeof i)throw t.NONE_SELECTED;const s=this.serviceContainer.get(h.ITestsHelper);o.tool=s.parseProviderName(i);const a=new d.BufferedTestConfigSettingsService,c=this.serviceContainer.get(h.ITestConfigurationManagerFactory).create(e,i,a);r?await c.enable():await c.configure(e).then((()=>this._enableTest(e,c))).catch((t=>this._enableTest(e,c).then((()=>Promise.reject(t)))));const f=this.serviceContainer.get(h.ITestConfigSettingsService);try{await a.apply(f)}catch(e){(0,l.traceError)("Python Extension: applying unit test config updates",e),o.failed=!0}}finally{(0,u.sendTelemetryEvent)(p.EventName.UNITTEST_CONFIGURING,void 0,o)}}};f=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IServiceContainer))],f),t.UnitTestConfigurationService=f},50946:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationManager=void 0;const r=n(71017),i=n(84974),o=n(61684),s=n(85494);class a extends s.TestConfigurationManager{constructor(e,t,n){super(e,o.Product.pytest,t,n)}async requiresUserToConfigure(e){const t=await this.getConfigFiles(e.fsPath);return!(t.length>0&&1!==t.length&&"setup.cfg"!==t[0])}async configure(e){const t=[],n="Use existing config file",r=[],i=await this.getConfigFiles(e.fsPath);if(i.length>0&&1!==i.length&&"setup.cfg"!==i[0])return;1===i.length&&"setup.cfg"===i[0]&&r.push({label:n,description:"setup.cfg"});const s=await this.getTestDirs(e.fsPath),a=await this.selectTestDir(e.fsPath,s,r);"string"==typeof a&&a!==n&&t.push(a),await this.installer.isInstalled(o.Product.pytest)||await this.installer.install(o.Product.pytest),await this.testConfigSettingsService.updateTestArgs(e.fsPath,o.Product.pytest,t)}async getConfigFiles(e){const t=this.serviceContainer.get(i.IFileSystem),n=["pytest.ini","tox.ini","setup.cfg"].map((async n=>await t.fileExists(r.join(e,n))?n:""));return(await Promise.all(n)).filter((e=>e.length>0))}}t.ConfigurationManager=a},55058:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationManager=void 0;const r=n(61684),i=n(85494);class o extends i.TestConfigurationManager{constructor(e,t,n){super(e,r.Product.unittest,t,n)}async requiresUserToConfigure(e){return!0}async configure(e){const t=["-v"],n=await this.getTestDirs(e.fsPath),i=await this.selectTestDir(e.fsPath,n);t.push("-s"),"string"==typeof i&&"."!==i?t.push(`./${i}`):t.push(".");const o=await this.selectTestFilePattern();t.push("-p"),"string"==typeof o?t.push(o):t.push("test*.py"),await this.testConfigSettingsService.updateTestArgs(e.fsPath,r.Product.unittest,t)}}t.ConfigurationManager=o},10919:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TestConfigurationManagerFactory=void 0;const o=n(86700),s=n(61684),a=n(77498),c=n(50946),l=n(55058);let u=class{constructor(e){this.serviceContainer=e}create(e,t,n){switch(t){case s.Product.unittest:return new l.ConfigurationManager(e,this.serviceContainer,n);case s.Product.pytest:return new c.ConfigurationManager(e,this.serviceContainer,n);default:throw new Error("Invalid test configuration")}}};u=r([(0,o.injectable)(),i(0,(0,o.inject)(a.IServiceContainer))],u),t.TestConfigurationManagerFactory=u},3876:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UnitTestManagementService=t.TestingService=void 0;const o=n(86700),s=n(66828),a=n(17585),c=n(77570);n(32727);const l=n(61684),u=n(18639),p=n(77498),d=n(61522),h=n(54813),f=n(97395),g=n(78308),m=n(77540),v=n(4100),y=n(56994),b=n(62020),S=n(67098),E=n(19735);let _=class{constructor(e){this.serviceContainer=e}getSettingsPropertyNames(e){return this.serviceContainer.get(g.ITestsHelper).getSettingsPropertyNames(e)}};_=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer))],_),t.TestingService=_;let w=class{constructor(e){this.serviceContainer=e,this.activatedOnce=!1,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.testStateMap=new Map,this.disposableRegistry=e.get(l.IDisposableRegistry),this.workspaceService=e.get(a.IWorkspaceService),this.context=this.serviceContainer.get(a.IContextKeyManager),s.tests&&s.tests.createTestController&&(this.testController=e.get(m.ITestController));const t=new v.DelayedTrigger(this.configurationChangeHandler.bind(this),500,"Test Configuration Change");this.configChangeTrigger=t,this.disposableRegistry.push(t)}async activate(){this.activatedOnce||(this.activatedOnce=!0,this.registerHandlers(),this.registerCommands(),s.tests.testResults&&(await this.updateTestUIButtons(),this.disposableRegistry.push(s.tests.onDidChangeTestResults((()=>{this.updateTestUIButtons()})))),this.testController&&(this.testController.onRefreshingStarted((async()=>{await this.context.setContext(y.ExtensionContextKey.RefreshingTests,!0)})),this.testController.onRefreshingCompleted((async()=>{await this.context.setContext(y.ExtensionContextKey.RefreshingTests,!1)})),this.testController.onRunWithoutConfiguration((async e=>{var t;const n=null!==(t=this.workspaceService.workspaceFolders)&&void 0!==t?t:[];if(e.length===n.length){const t=this.serviceContainer.get(a.ICommandManager);await t.executeCommand("workbench.view.testing.focus");const n=this.serviceContainer.get(a.IApplicationShell);await n.showInformationMessage(S.Testing.testNotConfigured,S.Testing.configureTests)===S.Testing.configureTests&&await t.executeCommand(c.Commands.Tests_Configure,void 0,c.CommandSource.ui,e[0].uri)}}))))}async updateTestUIButtons(){(0,b.updateTestResultMap)(this.testStateMap,s.tests.testResults);const e=(0,b.checkForFailedTests)(this.testStateMap);await this.context.setContext(y.ExtensionContextKey.HasFailedTests,e)}async configurationChangeHandler(e){var t;const n=(null!==(t=this.workspaceService.workspaceFolders)&&void 0!==t?t:[]).filter((t=>e.affectsConfiguration("python.testing",t.uri))).map((e=>e.uri));await Promise.all(n.map((e=>{var t;return null===(t=this.testController)||void 0===t?void 0:t.refreshTestData(e)})))}async configureTests(e){let t;if(e){const n=this.workspaceService.getWorkspaceFolder(e);t=n?n.uri:void 0}else{const e=this.serviceContainer.get(a.IApplicationShell);t=await(0,f.selectTestWorkspace)(e)}if(!t)return;const n=this.serviceContainer.get(u.IInterpreterService),r=this.serviceContainer.get(a.ICommandManager);if(!await n.getActiveInterpreter(t))return void r.executeCommand(c.Commands.TriggerEnvironmentSelection,t);const i=this.serviceContainer.get(g.ITestConfigurationService);await i.promptToEnableAndConfigureTestFramework(t)}registerCommands(){const e=this.serviceContainer.get(a.ICommandManager);this.disposableRegistry.push(e.registerCommand(c.Commands.Tests_Configure,((e,t=c.CommandSource.commandPalette,n)=>{var r;this.configureTests(n).ignoreErrors(),(0,E.traceVerbose)("Testing: Trigger refresh after config change"),null===(r=this.testController)||void 0===r||r.refreshTestData(n,{forceRefresh:!0})})))}registerHandlers(){const e=this.serviceContainer.get(u.IInterpreterService);this.disposableRegistry.push(this.workspaceService.onDidChangeConfiguration((e=>{this.configChangeTrigger.trigger(e)})),e.onDidChangeInterpreter((async()=>{var e;(0,E.traceVerbose)("Testing: Triggered refresh due to interpreter change."),(0,h.sendTelemetryEvent)(d.EventName.UNITTEST_DISCOVERY_TRIGGER,void 0,{trigger:"interpreter"}),await(null===(e=this.testController)||void 0===e?void 0:e.refreshTestData(void 0,{forceRefresh:!0}))})))}};r([(0,h.captureTelemetry)(d.EventName.UNITTEST_CONFIGURE,void 0,!1)],w.prototype,"configureTests",null),w=r([(0,o.injectable)(),i(0,(0,o.inject)(p.IServiceContainer))],w),t.UnitTestManagementService=w},59857:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTypes=void 0;const r=n(90819),i=n(57488),o=n(57475),s=n(96472),a=n(97395),c=n(78308),l=n(8051),u=n(10919),p=n(3876),d=n(40704),h=n(42035),f=n(20582);t.registerTypes=function(e){e.addSingleton(c.ITestDebugLauncher,i.DebugLauncher),e.add(c.ITestsHelper,a.TestsHelper),e.add(c.IUnitTestSocketServer,h.UnitTestSocketServer),e.add(c.ITestRunner,o.TestRunner),e.addSingleton(c.ITestConfigurationService,l.UnitTestConfigurationService),e.addSingleton(d.ITestingService,p.TestingService),e.addSingleton(c.ITestConfigSettingsService,s.TestConfigSettingsService),e.addSingleton(c.ITestConfigurationManagerFactory,u.TestConfigurationManagerFactory),e.addSingleton(r.IExtensionActivationService,p.UnitTestManagementService),(0,f.registerTestControllerTypes)(e)}},55149:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterArguments=t.getPositionalArguments=t.getOptionValues=void 0;const r=n(19735);t.getOptionValues=function(e,t){const n=[];let r=!1;for(const i of e)r?(n.push(i),r=!1):i.startsWith(`${t}=`)?n.push(i.substring(`${t}=`.length)):i===t&&(r=!0);return n},t.getPositionalArguments=function(e,t=[],n=[]){const i=[];return e.forEach(((e,o)=>{-1!==n.indexOf(e)?i.push(o):-1!==t.indexOf(e)?(i.push(o),i.push(o+1)):-1!==t.findIndex((t=>e.startsWith(`${t}=`)))?i.push(o):(e.startsWith("-")||e.indexOf("=")>0)&&((0,r.traceWarn)(`Unknown command line option passed into args parser for tests '${e}'. Please report on https://github.com/Microsoft/vscode-python/issues/new`),i.push(o))})),e.filter(((e,t)=>-1===i.indexOf(t)))},t.filterArguments=function(e,t=[],n=[]){let r=-1;return e.filter(((e,i)=>!(r===i||n.indexOf(e)>=0||n.filter((t=>t.endsWith("*")&&e.startsWith(t.slice(0,-1)))).length>0||(t.indexOf(e)>=0?(r=i+1,1):t.filter((t=>e.startsWith(`${t}=`))).length>0||(-1===e.indexOf("=")&&n.filter((t=>t.endsWith("*")&&e.startsWith(t.slice(0,-1)))).length>0?(r=i+1,1):e.indexOf("=")>=0&&n.filter((t=>t.endsWith("*")&&e.startsWith(t.slice(0,-1)))).length>0)))))}},31997:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TestDiscoveryHelper=void 0;const o=n(86700),s=n(29983);let a=class{constructor(e){this.pythonExecFactory=e}async runTestDiscovery(e){const t={allowEnvironmentFetchExceptions:!1,resource:e.workspaceFolder},n=await this.pythonExecFactory.createActivatedEnvironment(t),r={token:e.token,cwd:e.cwd,throwOnStdErr:!0};e.outChannel&&e.outChannel.appendLine(`python ${e.args.join(" ")}`);const i=await n.exec(e.args,r);try{return JSON.parse(i.stdout)}catch(e){throw e.message=i.stdout,e}}};a=r([(0,o.injectable)(),i(0,(0,o.inject)(s.IPythonExecutionFactory))],a),t.TestDiscoveryHelper=a},94977:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTemporaryFile=void 0;const r=n(36276);t.createTemporaryFile=function(e=".tmp"){return new Promise(((t,n)=>{r.file({postfix:e},((e,r,i,o)=>{e?n(e):t({filePath:r,dispose:o})}))}))}},68597:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonResultResolver=void 0;const r=n(66828),i=n(73837),o=n(19735),s=n(67098),a=n(62020),c=n(54813),l=n(61522),u=n(94146),p=n(76646);t.PythonResultResolver=class{constructor(e,t,n){this.workspaceUri=n,this.subTestStats=new Map,this.testController=e,this.testProvider=t,this.runIdToTestItem=new Map,this.runIdToVSid=new Map,this.vsIdToRunId=new Map}resolveDiscovery(e,t){var n,r;const u=this.workspaceUri.fsPath;(0,o.traceLog)("Using result resolver for discovery");const d=e;if(!d)return Promise.resolve();if("error"===d.status){const e="pytest"===this.testProvider?s.Testing.errorPytestDiscovery:s.Testing.errorUnittestDiscovery,{error:t}=d;(0,o.traceError)(e,"\r\n",null!==(n=null==t?void 0:t.join("\r\n\r\n"))&&void 0!==n?n:"");let c=this.testController.items.get(`DiscoveryError:${u}`);const l=i.format(`${e} ${s.Testing.seePythonOutput}\r\n`,null!==(r=null==t?void 0:t.join("\r\n\r\n"))&&void 0!==r?r:"");if(void 0===c){const e=(0,p.buildErrorNodeOptions)(this.workspaceUri,l,this.testProvider);c=(0,a.createErrorTestItem)(this.testController,e),this.testController.items.add(c)}c.error=l}else this.testController.items.delete(`DiscoveryError:${u}`);return d.tests||null===d.tests?(0,p.populateTestTree)(this.testController,d.tests,void 0,this,t):this.testController.items.replace([]),(0,c.sendTelemetryEvent)(l.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:this.testProvider,failed:!1}),Promise.resolve()}resolveExecution(e,t){var n,i,o,s,c,l,d,h,f;const g=e;if(void 0!==g&&void 0!==g.result)for(const e of Object.keys(g.result)){const m=[];if(this.testController.items.forEach((e=>{const t=(0,a.getTestCaseNodes)(e);m.push(...t)})),"error"===g.result[e].outcome){const o=null!==(n=g.result[e].traceback)&&void 0!==n?n:"",s=(0,u.splitLines)(o,{trim:!1,removeEmptyEntries:!0}).join("\r\n"),a=`${g.result[e].test} failed with error: ${null!==(i=g.result[e].message)&&void 0!==i?i:g.result[e].outcome}\r\n${s}\r\n`,c=new r.TestMessage(a),l=this.runIdToVSid.get(e);m.forEach((e=>{e.id===l&&e.uri&&e.range&&(c.location=new r.Location(e.uri,e.range),t.errored(e,c),t.appendOutput((0,p.fixLogLines)(a)))}))}else if("failure"===g.result[e].outcome||"passed-unexpected"===g.result[e].outcome){const n=null!==(o=g.result[e].traceback)&&void 0!==o?o:"",i=(0,u.splitLines)(n,{trim:!1,removeEmptyEntries:!0}).join("\r\n"),a=`${g.result[e].test} failed: ${null!==(s=g.result[e].message)&&void 0!==s?s:g.result[e].outcome}\r\n${i}\r\n`,c=new r.TestMessage(a),l=this.runIdToVSid.get(e);m.forEach((e=>{e.id===l&&e.uri&&e.range&&(c.location=new r.Location(e.uri,e.range),t.failed(e,c),t.appendOutput((0,p.fixLogLines)(a)))}))}else if("success"===g.result[e].outcome||"expected-failure"===g.result[e].outcome){const n=this.runIdToTestItem.get(e),r=this.runIdToVSid.get(e);void 0!==n&&m.forEach((e=>{e.id===r&&e.uri&&e.range&&t.passed(n)}))}else if("skipped"===g.result[e].outcome){const n=this.runIdToTestItem.get(e),r=this.runIdToVSid.get(e);void 0!==n&&m.forEach((e=>{e.id===r&&e.uri&&e.range&&t.skipped(n)}))}else if("subtest-failure"===g.result[e].outcome){const n=e.split(" ")[0],i=e.split(" ")[1],o=this.runIdToTestItem.get(n),s=g.result[e];if(!o)throw new Error("Parent test item not found");{const u=this.subTestStats.get(n);u?u.failed+=1:(this.subTestStats.set(n,{failed:1,passed:0}),t.appendOutput((0,p.fixLogLines)(`${n} [subtests]:\r\n`)),(0,a.clearAllChildren)(o));const f=null===(c=this.testController)||void 0===c?void 0:c.createTestItem(i,i);if(t.appendOutput((0,p.fixLogLines)(`${i} Failed\r\n`)),!f)throw new Error("Unable to create new child node for subtest");{const n=null!==(l=s.traceback)&&void 0!==l?l:"",i=`${s.subtest} Failed: ${null!==(d=s.message)&&void 0!==d?d:s.outcome}\r\n${n}\r\n`;t.appendOutput((0,p.fixLogLines)(i)),o.children.add(f),t.started(f);const a=new r.TestMessage(null!==(h=null==g?void 0:g.result[e].message)&&void 0!==h?h:"");o.uri&&o.range&&(a.location=new r.Location(o.uri,o.range)),t.failed(f,a)}}}else if("subtest-success"===g.result[e].outcome){const n=e.split(" ")[0],r=e.split(" ")[1],i=this.runIdToTestItem.get(n);if(!i)throw new Error("Parent test item not found");{const e=this.subTestStats.get(n);e?e.passed+=1:(this.subTestStats.set(n,{failed:0,passed:1}),t.appendOutput((0,p.fixLogLines)(`${n} [subtests]:\r\n`)),(0,a.clearAllChildren)(i));const o=null===(f=this.testController)||void 0===f?void 0:f.createTestItem(r,r);if(!o)throw new Error("Unable to create new child node for subtest");i.children.add(o),t.started(o),t.passed(o),t.appendOutput((0,p.fixLogLines)(`${r} Passed\r\n`))}}}return Promise.resolve()}}},64388:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateResultFromJunitXml=void 0;const r=n(55674),i=n(66828),o=n(62020),s=n(76646);t.updateResultFromJunitXml=async function(e,t,a,c){const l=await r.readFile(e),u=function(e){const t=e;if(!t.testsuites)return e.testsuite;const n=t.testsuites.testsuite;if(!Array.isArray(n))throw Error("bad JUnit XML data");if(0!==n.length){if(n.length>1)throw Error("got multiple XML results");return n[0]}}(await async function(e){const t=await Promise.resolve().then((()=>n(74232)));return new Promise(((n,r)=>{t.parseString(e,((e,t)=>e?r(e):n(t)))}))}(l.toString("utf8"))),p=(0,o.getTestCaseNodes)(t);if(u&&u.testcase.length>0&&p.length>0){let e=0,t=0,n=0,r=0;p.forEach((l=>{const p=c.get(l.id);if(!p)return;const d=u.testcase.find((e=>{const t=(0,o.getRunIdFromRawData)(`${e.$.classname}::${e.$.name}`),n=p.runId;return t===n||n.endsWith(t)}));if(d)if(d.error){n+=1;const e=d.error[0],t=`${p.rawId} Failed with Error: [${e.$.type}]${e.$.message}\r\n${e._}\r\n\r\n`,r=new i.TestMessage(t);l.uri&&l.range&&(r.location=new i.Location(l.uri,l.range)),a.errored(l,r),a.appendOutput((0,s.fixLogLines)(t))}else if(d.failure){e+=1;const t=d.failure[0],n=`${p.rawId} Failed: [${t.$.type}]${t.$.message}\r\n${t._}\r\n`,r=new i.TestMessage(n);l.uri&&l.range&&(r.location=new i.Location(l.uri,l.range)),a.failed(l,r),a.appendOutput((0,s.fixLogLines)(n))}else if(d.skipped){const e=d.skipped[0];let n="";"pytest.xfail"===e.$.type?(r+=1,n=`${p.rawId} Passed: [${e.$.type}]${e.$.message}\r\n`,a.passed(l)):(t+=1,n=`${p.rawId} Skipped: [${e.$.type}]${e.$.message}\r\n`,a.skipped(l)),a.appendOutput((0,s.fixLogLines)(n))}else{r+=1;const e=`${p.rawId} Passed\r\n`;a.passed(l),a.appendOutput((0,s.fixLogLines)(e))}else{const e=`Test result not found for: ${p.rawId}\r\n`;a.appendOutput((0,s.fixLogLines)(e));const t=new i.TestMessage(e);l.uri&&l.range&&(t.location=new i.Location(l.uri,l.range)),a.errored(l,t)}})),a.appendOutput(`Total number of tests expected to run: ${p.length}\r\n`),a.appendOutput(`Total number of tests run: ${r+e+n+t}\r\n`),a.appendOutput(`Total number of tests passed: ${r}\r\n`),a.appendOutput(`Total number of tests failed: ${e}\r\n`),a.appendOutput(`Total number of tests failed with errors: ${n}\r\n`),a.appendOutput(`Total number of tests skipped: ${t}\r\n`),a.appendOutput(`Total number of tests with no result data: ${p.length-r-e-n-t}\r\n`)}}},9981:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PythonTestServer=void 0;const r=n(41808),i=n(6113),o=n(66828),s=n(71017),a=n(19735),c=n(83194),l=n(76646),u=n(59314);t.PythonTestServer=class{constructor(e,t){this.executionFactory=e,this.debugLauncher=t,this._onDataReceived=new o.EventEmitter,this.uuids=[],this._onRunDataReceived=new o.EventEmitter,this._onDiscoveryDataReceived=new o.EventEmitter,this.server=r.createServer((e=>{let t=Buffer.alloc(0);e.on("data",(e=>{try{let n=e.toString();for(t=Buffer.concat([t,e]);t.length>0;){const e=(0,l.jsonRPCHeaders)(t.toString()),r=e.headers.get(l.JSONRPC_UUID_HEADER),i=e.headers.get("Content-Length");if(!r)return(0,a.traceError)("On data received: Error occurred because payload UUID is undefined"),void this._onDataReceived.fire({uuid:"",data:""});if(!this.uuids.includes(r))return(0,a.traceError)("On data received: Error occurred because the payload UUID is not recognized"),void this._onDataReceived.fire({uuid:"",data:""});n=e.remainingRawData;const o=(0,l.jsonRPCContent)(e.headers,n);if(o.extractedJSON.length!==Number(i))break;if(n.includes('"tests":'))this._onDiscoveryDataReceived.fire({uuid:r,data:o.extractedJSON});else{if(!n.includes('"result":'))return(0,a.traceLog)("Error processing test server request: request is not recognized as discovery or run."),void this._onDataReceived.fire({uuid:"",data:""});this._onRunDataReceived.fire({uuid:r,data:o.extractedJSON})}t=Buffer.alloc(0)}}catch(e){(0,a.traceError)(`Error processing test server request: ${e} observe`),this._onDataReceived.fire({uuid:"",data:""})}}))})),this.ready=new Promise(((e,t)=>{this.server.listen(void 0,"localhost",(()=>{e()}))})),this.server.on("error",(e=>{(0,a.traceLog)(`Error starting test server: ${e}`)})),this.server.on("close",(()=>{(0,a.traceLog)("Test server closed.")})),this.server.on("listening",(()=>{(0,a.traceLog)("Test server listening.")})),this.server.on("connection",(()=>{(0,a.traceLog)("Test server connected to a client.")}))}serverReady(){return this.ready}getPort(){return this.server.address().port}createUUID(){const e=i.randomUUID();return this.uuids.push(e),e}deleteUUID(e){this.uuids=this.uuids.filter((t=>t!==e))}get onRunDataReceived(){return this._onRunDataReceived.event}get onDiscoveryDataReceived(){return this._onDiscoveryDataReceived.event}dispose(){this.server.close(),this._onDataReceived.dispose()}get onDataReceived(){return this._onDataReceived.event}async sendCommand(e,t,n,r){var i,o,l,p,d,h,f;const{uuid:g}=e,m=null!==(o=null===(i=process.env.PYTHONPATH)||void 0===i?void 0:i.split(s.delimiter))&&void 0!==o?o:[],v=[e.cwd,...m].join(s.delimiter),y={token:e.token,cwd:e.cwd,throwOnStdErr:!0,outputChannel:e.outChannel,extraVariables:{PYTHONPATH:v}};y.extraVariables&&(y.extraVariables.RUN_TEST_IDS_PORT=t);const b=void 0!==t,S={allowEnvironmentFetchExceptions:!1,resource:e.workspaceFolder},E=await this.executionFactory.createActivatedEnvironment(S),_=[e.command.script,"--port",this.getPort().toString(),"--uuid",g].concat(e.command.args);e.outChannel&&e.outChannel.appendLine(`python ${_.join(" ")}`);try{if(e.debugBool){const n={cwd:e.cwd,args:_,token:e.token,testProvider:c.UNITTEST_PROVIDER,runTestIdsPort:t};(0,a.traceInfo)(`Running DEBUG unittest with arguments: ${_}\r\n`),await this.debugLauncher.launchDebugger(n,(()=>{null==r||r()}))}else{b?(0,a.traceInfo)(`Running unittests with arguments: ${_}\r\n`):(0,a.traceLog)(`Discovering unittest tests with arguments: ${_}\r\n`);const e=(0,u.createDeferred)(),t=E.execObservable(_,y);null==n||n.token.onCancellationRequested((()=>{var e;null===(e=null==t?void 0:t.proc)||void 0===e||e.kill()})),null===(p=null===(l=null==t?void 0:t.proc)||void 0===l?void 0:l.stdout)||void 0===p||p.on("data",(e=>{var t;null===(t=null==y?void 0:y.outputChannel)||void 0===t||t.append(e.toString())})),null===(h=null===(d=null==t?void 0:t.proc)||void 0===d?void 0:d.stderr)||void 0===h||h.on("data",(e=>{var t;null===(t=null==y?void 0:y.outputChannel)||void 0===t||t.append(e.toString())})),null===(f=null==t?void 0:t.proc)||void 0===f||f.on("exit",(()=>{(0,a.traceLog)("Exec server closed.",g),e.resolve({stdout:"",stderr:""}),null==r||r()})),await e.promise}}catch(e){this.uuids=this.uuids.filter((e=>e!==g)),this._onDataReceived.fire({uuid:g,data:JSON.stringify({status:"error",errors:[e.message]})})}}}},62020:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllChildren=t.checkForFailedTests=t.updateTestResultMap=t.getNodeByUri=t.getWorkspaceNode=t.getTestCaseNodes=t.getUri=t.updateTestItemFromRawData=t.getRunIdFromRawData=t.createWorkspaceRootTestItem=t.createErrorTestItem=t.removeItemByIdFromChildren=t.DebugTestTag=t.RunTestTag=void 0;const r=n(71017),i=n(66828),o=n(99910),s=n(19735),a=n(77540);function c(e){const t=[];return e.forEach((e=>{t.push(e)})),t}function l(e,t,n){n.forEach((n=>{t.children.delete(n),e.delete(n)}))}function u(e,t,n){const i=e.get(r.join(t,n.parentid));let o;return i&&(o="."===i.id?t:i.id),o}function p(e){try{const t=e.source.substr(e.source.indexOf(":")+1),n=Number.parseInt(t,10);return new i.Range(new i.Position(n-1,0),new i.Position(n,0))}catch(e){}}function d(e){const t=e.replace(/\.py[^\w\-]/g,"").replace(/[\\\:\/]/g,".").replace(/\:\:/g,".").replace(/\.\./g,".");return t.startsWith(".")?t.substr(1):t}function h(e,n,o,s){const c=r.join(o,s.relpath),l=i.Uri.file(c),p=u(n,o,s),d=r.basename(c),h=e.createTestItem(c,d,l);return h.canResolveChildren=!0,n.set(h.id,{id:h.id,rawId:s.id,runId:s.relpath,uri:l,kind:a.TestDataKinds.FolderOrFile,parentId:p}),h.tags=[t.RunTestTag,t.DebugTestTag],h}async function f(e,n,f,m,v,y){var b;if(null==y?void 0:y.isCancellationRequested)return;const S=null===(b=f.get(e.id))||void 0===b?void 0:b.rawId;if(!S)return void(0,s.traceError)(`Unknown node id: ${e.id}`);const E=v.filter((e=>e.root===S||e.rootid===S||e.parents.find((e=>e.id===S))||e.tests.find((e=>e.id===S))));if(0===E.length&&e.parent)return l(f,e.parent,[e.id]),void(0,s.traceVerbose)(`Following test item was removed Reason: No-Raw-Data ${e.id}`);if(E.length>1)return void(0,s.traceError)(`Multiple (${E.length}) raw data nodes had the same id: ${S}`);if(S===E[0].root||S===E[0].rootid){await(0,o.asyncForEach)(c(e.children),(async e=>{await g(e,n,f,m,E,y)}));const t=E[0].parents.filter((e=>"."===e.parentid||e.parentid===S)),r=[];return e.children.forEach((e=>{var t,n;return r.push(null!==(n=null===(t=f.get(e.id))||void 0===t?void 0:t.rawId)&&void 0!==n?n:"")})),void await(0,o.asyncForEach)(t.filter((e=>!r.includes(e.id))),(async t=>{const r=(t.kind,h(n,f,m,t));e.children.add(r),await g(r,n,f,m,E,y)}))}const _=E[0].parents.filter((e=>e.id===S));if(1===_.length){switch(_[0].kind){case"file":case"folder":!function(e,n,o,s){const c=r.join(o,s.relpath),l=i.Uri.file(c),p=u(n,o,s);e.label=r.basename(c),e.canResolveChildren=!0,n.set(e.id,{id:e.id,rawId:s.id,runId:s.relpath,uri:l,kind:a.TestDataKinds.FolderOrFile,parentId:p}),e.tags=[t.RunTestTag,t.DebugTestTag]}(e,f,m,_[0]);break;case"suite":case"function":!function(e,n,o,s){const c=r.join(o,s.id.substr(0,s.id.indexOf(":"))),l=i.Uri.file(c);e.label=s.name;const p=u(n,o,s),h=d(s.id);e.canResolveChildren=!0,n.set(e.id,{id:e.id,rawId:s.id,runId:h,uri:l,kind:a.TestDataKinds.Collection,parentId:p}),e.tags=[t.RunTestTag,t.DebugTestTag]}(e,f,m,_[0])}await(0,o.asyncForEach)(c(e.children),(async e=>{await g(e,n,f,m,E,y)}));const s=[];e.children.forEach((e=>{var t,n;return s.push(null!==(n=null===(t=f.get(e.id))||void 0===t?void 0:t.rawId)&&void 0!==n?n:"")}));const l=E[0].parents.filter((e=>e.parentid===S));return await(0,o.asyncForEach)(l.filter((e=>!s.includes(e.id))),(async o=>{let s;switch(o.kind){case"file":case"folder":s=h(n,f,m,o);break;case"suite":case"function":s=function(e,n,o,s){const c=r.join(o,s.id),l=r.join(o,s.id.substr(0,s.id.indexOf(":"))),p=i.Uri.file(l),h=s.name,f=u(n,o,s),g=d(s.id),m=e.createTestItem(c,h,p);return m.canResolveChildren=!0,n.set(m.id,{id:m.id,rawId:s.id,runId:g,uri:p,kind:a.TestDataKinds.Collection,parentId:f}),m.tags=[t.RunTestTag,t.DebugTestTag],m}(n,f,m,o)}s&&(e.children.add(s),await g(s,n,f,m,E,y))})),void E[0].tests.filter((e=>e.parentid===S)).filter((e=>!s.includes(e.id))).forEach((o=>{const s=function(e,n,o,s){const c=r.join(o,s.id),l=r.join(o,s.source.substr(0,s.source.indexOf(":"))),h=i.Uri.file(l),f=s.name,g=u(n,o,s),m=d(s.id),v=e.createTestItem(c,f,h);return v.canResolveChildren=!1,v.range=p(s),n.set(v.id,{id:v.id,rawId:s.id,runId:m,uri:h,kind:a.TestDataKinds.Case,parentId:g}),v.tags=[t.RunTestTag,t.DebugTestTag],v}(n,f,m,o);e.children.add(s)}))}if(_.length>1)return void(0,s.traceError)(`Multiple (${_.length}) raw data nodes had the same id: ${S}`);const w=E[0].tests.filter((e=>e.id===S));1!==w.length?w.length>1&&(0,s.traceError)(`Multiple (${w.length}) raw data nodes had the same id: ${S}`):function(e,n,o,s){const c=r.join(o,s.source.substr(0,s.source.indexOf(":"))),l=i.Uri.file(c);e.label=s.name;const h=u(n,o,s),f=d(s.id);e.canResolveChildren=!1,e.range=p(s),n.set(e.id,{id:e.id,rawId:s.id,runId:f,uri:l,kind:a.TestDataKinds.Case,parentId:h}),e.tags=[t.RunTestTag,t.DebugTestTag]}(e,f,m,w[0])}async function g(e,t,n,r,i,o){e.busy=!0,await f(e,t,n,r,i,o),e.busy=!1}function m(e,t){for(const n of t.taskStates)e.set(t.id,n.state);t.children.forEach((t=>m(e,t)))}t.RunTestTag={id:"python-run"},t.DebugTestTag={id:"python-debug"},t.removeItemByIdFromChildren=l,t.createErrorTestItem=function(e,n){const r=e.createTestItem(n.id,n.label);return r.canResolveChildren=!1,r.error=n.error,r.tags=[t.RunTestTag,t.DebugTestTag],r},t.createWorkspaceRootTestItem=function(e,n,r){var i;const o=e.createTestItem(r.id,r.label,r.uri);return o.canResolveChildren=!0,n.set(r.id,{...r,rawId:null!==(i=r.rawId)&&void 0!==i?i:r.id,kind:a.TestDataKinds.Workspace}),o.tags=[t.RunTestTag,t.DebugTestTag],o},t.getRunIdFromRawData=d,t.updateTestItemFromRawData=g,t.getUri=function e(t){return!t.uri&&t.parent?e(t.parent):t.uri},t.getTestCaseNodes=function e(t,n=[]){return!t.canResolveChildren&&t.tags.length>0&&n.push(t),t.children.forEach((r=>{t.canResolveChildren?e(r,n):n.push(t)})),n},t.getWorkspaceNode=function e(t,n){const r=n.get(t.id);if(r){if(r.kind===a.TestDataKinds.Workspace)return t;if(t.parent)return e(t.parent,n)}},t.getNodeByUri=function e(t,n){var r,i;if((null===(r=t.uri)||void 0===r?void 0:r.fsPath)===n.fsPath)return t;const o=[];t.children.forEach((e=>o.push(e)));for(const e of o)if((null===(i=e.uri)||void 0===i?void 0:i.fsPath)===n.fsPath)return e;for(const t of o){const r=e(t,n);if(r)return r}},t.updateTestResultMap=function(e,t){new Array(...t).sort(((e,t)=>e.completedAt-t.completedAt)).forEach((t=>{t.results.forEach((t=>m(e,t)))}))},t.checkForFailedTests=function(e){return void 0!==Array.from(e.values()).find((e=>e===i.TestResultState.Failed||e===i.TestResultState.Errored))},t.clearAllChildren=function(e){const t=[];e.children.forEach((e=>t.push(e.id))),t.forEach(e.children.delete)}},77540:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ITestsRunner=t.ITestFrameworkController=t.ITestController=t.ITestDiscoveryHelper=t.TestDataKinds=void 0,(n=t.TestDataKinds||(t.TestDataKinds={}))[n.Workspace=0]="Workspace",n[n.FolderOrFile=1]="FolderOrFile",n[n.Collection=2]="Collection",n[n.Case=3]="Case",t.ITestDiscoveryHelper=Symbol("ITestDiscoveryHelper"),t.ITestController=Symbol("ITestController"),t.ITestFrameworkController=Symbol("ITestFrameworkController"),t.ITestsRunner=Symbol("ITestsRunner")},76646:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.populateTestTree=t.buildErrorNodeOptions=t.startTestIdServer=t.pythonTestAdapterRewriteEnabled=t.jsonRPCContent=t.jsonRPCHeaders=t.JSONRPC_CONTENT_TYPE_HEADER=t.JSONRPC_CONTENT_LENGTH_HEADER=t.JSONRPC_UUID_HEADER=t.fixLogLines=void 0;const r=n(41808),i=n(71017),o=n(66828),s=n(19735),a=n(60717),c=n(61684),l=n(62020);t.fixLogLines=function(e){return`${e.split(/\r?\n/g).join("\r\n")}\r\n`},t.JSONRPC_UUID_HEADER="Request-uuid",t.JSONRPC_CONTENT_LENGTH_HEADER="Content-Length",t.JSONRPC_CONTENT_TYPE_HEADER="Content-Type",t.jsonRPCHeaders=function(e){const n=e.split("\n");let r="";const i=new Map;for(let e=0;e<n.length;e+=1){const o=n[e];if(""===o){r=n.slice(e+1).join("\n");break}const[s,a]=o.split(":");[t.JSONRPC_UUID_HEADER,t.JSONRPC_CONTENT_LENGTH_HEADER,t.JSONRPC_CONTENT_TYPE_HEADER].includes(s)&&i.set(s.trim(),a.trim())}return{headers:i,remainingRawData:r}},t.jsonRPCContent=function(e,t){var n;const r=parseInt(null!==(n=e.get("Content-Length"))&&void 0!==n?n:"0",10);return{extractedJSON:t.slice(0,r),remainingRawData:t.slice(r)}},t.pythonTestAdapterRewriteEnabled=function(e){return e.get(c.IExperimentService).inExperimentSync(a.EnableTestAdapterRewrite.experiment)},t.startTestIdServer=async function(e){let t=0;try{return await new Promise(((t,n)=>{const i=r.createServer((t=>{const n=JSON.stringify(e),r=`${[`Content-Length: ${Buffer.byteLength(n)}`,"Content-Type: application/json"].join("\r\n")}\r\n\r\n${n}`;t.write(r),t.on("data",(e=>{(0,s.traceLog)("Received data:",e.toString())})),t.on("end",(()=>{(0,s.traceLog)("Client disconnected")}))}));i.listen(0,(()=>{const{port:e}=i.address();(0,s.traceLog)(`Server listening on port ${e}`),t(e)})),i.on("error",(e=>{n(e)}))})).then((e=>{(0,s.traceVerbose)(`Server started for pytest test ids server and listening on port ${e}`),t=e})).catch((e=>((0,s.traceError)("Error starting server for pytest test ids server:",e),0))).finally((()=>t)),t}catch(e){return(0,s.traceError)("Error starting server for pytest test ids server, cannot get port."),t}},t.buildErrorNodeOptions=function(e,t,n){const r="pytest"===n?"Pytest Discovery Error":"Unittest Discovery Error";return{id:`DiscoveryError:${e.fsPath}`,label:`${r} [${i.basename(e.fsPath)}]`,error:t}},t.populateTestTree=function e(t,n,r,i,s){r||((r=t.createTestItem(n.path,n.name,o.Uri.file(n.path))).canResolveChildren=!0,r.tags=[l.RunTestTag,l.DebugTestTag],t.items.add(r)),n.children.forEach((n=>{if(!(null==s?void 0:s.isCancellationRequested))if("test"===n.type_){const e=t.createTestItem(n.id_,n.name,o.Uri.file(n.path));e.tags=[l.RunTestTag,l.DebugTestTag];const s=new o.Range(new o.Position(Number(n.lineno)-1,0),new o.Position(Number(n.lineno),0));e.canResolveChildren=!1,e.range=s,e.tags=[l.RunTestTag,l.DebugTestTag],r.children.add(e),i.runIdToTestItem.set(n.runID,e),i.runIdToVSid.set(n.runID,n.id_),i.vsIdToRunId.set(n.id_,n.runID)}else{let a=t.items.get(n.path);a||(a=t.createTestItem(n.id_,n.name,o.Uri.file(n.path)),a.canResolveChildren=!0,a.tags=[l.RunTestTag,l.DebugTestTag],r.children.add(a)),e(t,n,a,i,s)}}))}},40063:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PythonTestController=void 0;const o=n(86700),s=n(96486),a=n(66828),c=n(17585),l=n(77570),u=n(29983),p=n(61684),d=n(4100),h=n(3481),f=n(18639),g=n(19735),m=n(54813),v=n(61522),y=n(83194),b=n(9981),S=n(62020),E=n(76646),_=n(77540),w=n(16903),T=n(928),C=n(57495),P=n(15536),I=n(80454),x=n(78308),O=n(77498),R=n(68597),D=n(85261);let A=class{constructor(e,t,n,r,i,o,s,c,u,p,h){this.workspaceService=e,this.configSettings=t,this.pytest=n,this.unittest=r,this.disposables=i,this.interpreterService=o,this.commandManager=s,this.pythonExecFactory=c,this.debugLauncher=u,this.testOutputChannel=p,this.serviceContainer=h,this.supportedWorkspaceTypes={untrustedWorkspace:!1,virtualWorkspace:!1},this.testAdapters=new Map,this.triggerTypes=[],this.refreshingCompletedEvent=new a.EventEmitter,this.refreshingStartedEvent=new a.EventEmitter,this.runWithoutConfigurationEvent=new a.EventEmitter,this.onRefreshingCompleted=this.refreshingCompletedEvent.event,this.onRefreshingStarted=this.refreshingStartedEvent.event,this.onRunWithoutConfiguration=this.runWithoutConfigurationEvent.event,this.sendTestDisabledTelemetry=!0,this.refreshCancellation=new a.CancellationTokenSource,this.testController=a.tests.createTestController("python-tests","Python Tests"),this.disposables.push(this.testController);const f=new d.DelayedTrigger(((e,t)=>{this.refreshTestDataInternal(e),t&&this.invalidateTests(e)}),250,"Refresh Test Data");this.disposables.push(f),this.refreshData=f,this.disposables.push(this.testController.createRunProfile("Run Tests",a.TestRunProfileKind.Run,this.runTests.bind(this),!0,S.RunTestTag),this.testController.createRunProfile("Debug Tests",a.TestRunProfileKind.Debug,this.runTests.bind(this),!0,S.DebugTestTag)),this.testController.resolveHandler=this.resolveChildren.bind(this),this.testController.refreshHandler=e=>(this.disposables.push(e.onCancellationRequested((()=>{(0,g.traceVerbose)("Testing: Stop refreshing triggered"),(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERING_STOP),this.stopRefreshing()}))),(0,g.traceVerbose)("Testing: Manually triggered test refresh"),(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERY_TRIGGER,void 0,{trigger:l.CommandSource.commandPalette}),this.refreshTestData(void 0,{forceRefresh:!0})),this.pythonTestServer=new b.PythonTestServer(this.pythonExecFactory,this.debugLauncher)}async activate(){(0,g.traceVerbose)("Waiting for test server to start..."),await this.pythonTestServer.serverReady(),(0,g.traceVerbose)("Test server started."),(this.workspaceService.workspaceFolders||[]).forEach((e=>{const t=this.configSettings.getSettings(e.uri);let n,r,i,o;t.testing.unittestEnabled?(i=y.UNITTEST_PROVIDER,o=new R.PythonResultResolver(this.testController,i,e.uri),n=new w.UnittestTestDiscoveryAdapter(this.pythonTestServer,this.configSettings,this.testOutputChannel,o),r=new T.UnittestTestExecutionAdapter(this.pythonTestServer,this.configSettings,this.testOutputChannel,o)):(i=y.PYTEST_PROVIDER,o=new R.PythonResultResolver(this.testController,i,e.uri),n=new C.PytestTestDiscoveryAdapter(this.pythonTestServer,this.configSettings,this.testOutputChannel,o),r=new P.PytestTestExecutionAdapter(this.pythonTestServer,this.configSettings,this.testOutputChannel,o));const s=new I.WorkspaceTestAdapter(i,n,r,e.uri,o);this.testAdapters.set(e.uri,s),t.testing.autoTestDiscoverOnSaveEnabled&&((0,g.traceVerbose)(`Testing: Setting up watcher for ${e.uri.fsPath}`),this.watchForSettingsChanges(e),this.watchForTestContentChangeOnSave())}))}refreshTestData(e,t){return(null==t?void 0:t.forceRefresh)?void 0===e?((0,g.traceVerbose)("Testing: Clearing all discovered tests"),this.testController.items.forEach((e=>{const t=[];e.children.forEach((e=>t.push(e.id))),t.forEach((t=>e.children.delete(t)))})),(0,g.traceVerbose)("Testing: Forcing test data refresh"),this.refreshTestDataInternal(void 0)):((0,g.traceVerbose)("Testing: Forcing test data refresh"),this.refreshTestDataInternal(e)):(this.refreshData.trigger(e,!1),Promise.resolve())}stopRefreshing(){this.refreshCancellation.cancel(),this.refreshCancellation.dispose(),this.refreshCancellation=new a.CancellationTokenSource}clearTestController(){const e=[];this.testController.items.forEach((t=>e.push(t.id))),e.forEach((e=>this.testController.items.delete(e)))}async refreshTestDataInternal(e){if(this.refreshingStartedEvent.fire(),e){const t=this.configSettings.getSettings(e),n=this.workspaceService.getWorkspaceFolder(e);if((0,g.traceInfo)(`Discover tests for workspace name: ${null==n?void 0:n.name} - uri: ${e.fsPath}`),this.sendTestDisabledTelemetry=!0,t.testing.pytestEnabled)(0,E.pythonTestAdapterRewriteEnabled)(this.serviceContainer)?((0,g.traceInfo)("Running discovery for pytest using the new test adapter."),(this.testAdapters.get(e)||this.testAdapters.values().next().value).discoverTests(this.testController,this.refreshCancellation.token,this.pythonExecFactory)):await this.pytest.refreshTestData(this.testController,e,this.refreshCancellation.token);else if(t.testing.unittestEnabled)(0,E.pythonTestAdapterRewriteEnabled)(this.serviceContainer)?((0,g.traceInfo)("Running discovery for unittest using the new test adapter."),(this.testAdapters.get(e)||this.testAdapters.values().next().value).discoverTests(this.testController,this.refreshCancellation.token,this.pythonExecFactory)):await this.unittest.refreshTestData(this.testController,e,this.refreshCancellation.token);else if(this.sendTestDisabledTelemetry&&(this.sendTestDisabledTelemetry=!1,(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISABLED)),n){const e=[];this.testController.items.forEach((t=>{const r=this.workspaceService.getWorkspaceFolder(t.uri);(null==r?void 0:r.uri.fsPath)===n.uri.fsPath&&e.push(t.id)})),e.forEach((e=>this.testController.items.delete(e)))}}else{(0,g.traceVerbose)("Testing: Refreshing all test data");const e=this.workspaceService.workspaceFolders||[];await Promise.all(e.map((async e=>{await this.interpreterService.getActiveInterpreter(e.uri)?await this.refreshTestDataInternal(e.uri):this.commandManager.executeCommand(l.Commands.TriggerEnvironmentSelection,e.uri).then(h.noop,h.noop)})))}return this.refreshingCompletedEvent.fire(),Promise.resolve()}async resolveChildren(e){if(e){(0,g.traceVerbose)(`Testing: Resolving item ${e.id}`);const t=this.configSettings.getSettings(e.uri);if(t.testing.pytestEnabled)return this.pytest.resolveChildren(this.testController,e,this.refreshCancellation.token);if(t.testing.unittestEnabled)return this.unittest.resolveChildren(this.testController,e,this.refreshCancellation.token)}else{(0,g.traceVerbose)("Testing: Refreshing all test data"),this.sendTriggerTelemetry("auto");const e=this.workspaceService.workspaceFolders||[];await Promise.all(e.map((async e=>{await this.interpreterService.getActiveInterpreter(e.uri)?await this.refreshTestDataInternal(e.uri):(0,g.traceError)("Cannot trigger test discovery as a valid interpreter is not selected")})))}return Promise.resolve()}async runTests(e,t){const n=[];e.include?(0,s.uniq)(e.include.map((e=>this.workspaceService.getWorkspaceFolder(e.uri)))).forEach((e=>{e&&n.push(e)})):(this.workspaceService.workspaceFolders||[]).forEach((e=>n.push(e)));const r=this.testController.createTestRun(e,`Running Tests for Workspace(s): ${n.map((e=>e.uri.fsPath)).join(";")}`,!0),i=t.onCancellationRequested((()=>{r.end()})),o=[];try{await Promise.all(n.map((async n=>{var i,s,c,u,p,d,f,g,y,b,S;if(!await this.interpreterService.getActiveInterpreter(n.uri))return void this.commandManager.executeCommand(l.Commands.TriggerEnvironmentSelection,n.uri).then(h.noop,h.noop);const _=[];(null!==(i=e.include)&&void 0!==i?i:this.testController.items).forEach((e=>{const t=this.workspaceService.getWorkspaceFolder(e.uri);(null==t?void 0:t.uri.fsPath)===n.uri.fsPath&&_.push(e)}));const w=this.configSettings.getSettings(n.uri);if(_.length>0){if(w.testing.pytestEnabled)return(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_RUN,void 0,{tool:"pytest",debugging:(null===(s=e.profile)||void 0===s?void 0:s.kind)===a.TestRunProfileKind.Debug}),(0,E.pythonTestAdapterRewriteEnabled)(this.serviceContainer)?(this.testAdapters.get(n.uri)||this.testAdapters.values().next().value).executeTests(this.testController,r,_,t,(null===(c=e.profile)||void 0===c?void 0:c.kind)===a.TestRunProfileKind.Debug,this.pythonExecFactory,this.debugLauncher):this.pytest.runTests({includes:_,excludes:null!==(u=e.exclude)&&void 0!==u?u:[],runKind:null!==(d=null===(p=e.profile)||void 0===p?void 0:p.kind)&&void 0!==d?d:a.TestRunProfileKind.Run,runInstance:r},n,t);if(w.testing.unittestEnabled)return(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_RUN,void 0,{tool:"unittest",debugging:(null===(f=e.profile)||void 0===f?void 0:f.kind)===a.TestRunProfileKind.Debug}),(0,E.pythonTestAdapterRewriteEnabled)(this.serviceContainer)?(this.testAdapters.get(n.uri)||this.testAdapters.values().next().value).executeTests(this.testController,r,_,t,(null===(g=e.profile)||void 0===g?void 0:g.kind)===a.TestRunProfileKind.Debug,this.pythonExecFactory):this.unittest.runTests({includes:_,excludes:null!==(y=e.exclude)&&void 0!==y?y:[],runKind:null!==(S=null===(b=e.profile)||void 0===b?void 0:b.kind)&&void 0!==S?S:a.TestRunProfileKind.Run,runInstance:r},n,t,this.testController)}return w.testing.pytestEnabled||w.testing.unittestEnabled||o.push(n),Promise.resolve()})))}finally{r.appendOutput("Finished running tests!\r\n"),r.end(),i.dispose(),o.length>0&&this.runWithoutConfigurationEvent.fire(o)}}invalidateTests(e){this.testController.items.forEach((t=>{const n=(0,S.getNodeByUri)(t,e);n&&n.invalidateResults&&n.invalidateResults()}))}watchForSettingsChanges(e){const t=new a.RelativePattern(e,"**/{settings.json,pytest.ini,pyproject.toml,setup.cfg}"),n=this.workspaceService.createFileSystemWatcher(t);this.disposables.push(n),this.disposables.push((0,D.onDidSaveTextDocument)((async e=>{const t=e.fileName;(t.includes("settings.json")||t.includes("pytest.ini")||t.includes("setup.cfg")||t.includes("pyproject.toml"))&&((0,g.traceVerbose)(`Testing: Trigger refresh after saving ${e.uri.fsPath}`),this.sendTriggerTelemetry("watching"),this.refreshData.trigger(e.uri,!1))}))),this.disposables.push(n.onDidCreate((e=>{(0,g.traceVerbose)(`Testing: Trigger refresh after creating ${e.fsPath}`),this.sendTriggerTelemetry("watching"),this.refreshData.trigger(e,!1)}))),this.disposables.push(n.onDidDelete((e=>{(0,g.traceVerbose)(`Testing: Trigger refresh after deleting in ${e.fsPath}`),this.sendTriggerTelemetry("watching"),this.refreshData.trigger(e,!1)})))}watchForTestContentChangeOnSave(){this.disposables.push((0,D.onDidSaveTextDocument)((async e=>{e.fileName.endsWith(".py")&&((0,g.traceVerbose)(`Testing: Trigger refresh after saving ${e.uri.fsPath}`),this.sendTriggerTelemetry("watching"),this.refreshData.trigger(e.uri,!1))})))}sendTriggerTelemetry(e){this.triggerTypes.includes(e)||((0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERY_TRIGGER,void 0,{trigger:e}),this.triggerTypes.push(e))}};A=r([(0,o.injectable)(),i(0,(0,o.inject)(c.IWorkspaceService)),i(1,(0,o.inject)(p.IConfigurationService)),i(2,(0,o.inject)(_.ITestFrameworkController)),i(2,(0,o.named)(y.PYTEST_PROVIDER)),i(3,(0,o.inject)(_.ITestFrameworkController)),i(3,(0,o.named)(y.UNITTEST_PROVIDER)),i(4,(0,o.inject)(p.IDisposableRegistry)),i(5,(0,o.inject)(f.IInterpreterService)),i(6,(0,o.inject)(c.ICommandManager)),i(7,(0,o.inject)(u.IPythonExecutionFactory)),i(8,(0,o.inject)(x.ITestDebugLauncher)),i(9,(0,o.inject)(p.ITestOutputChannel)),i(10,(0,o.inject)(O.IServiceContainer))],A),t.PythonTestController=A},85269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.preparePytestArgumentsForDiscovery=t.removePositionalFoldersAndFiles=t.pytestGetTestFilesAndFolders=void 0;const r=n(78308),i=n(55149),o=["-c","-k","-m","-o","-p","-r","-W","-n","--assert","--basetemp","--cache-show","--capture","--code-highlight","--color","--confcutdir","--cov","--cov-config","--cov-fail-under","--cov-report","--deselect","--dist","--doctest-glob","--doctest-report","--durations","--durations-min","--ignore","--ignore-glob","--import-mode","--junit-prefix","--junit-xml","--last-failed-no-failures","--lfnf","--log-auto-indent","--log-cli-date-format","--log-cli-format","--log-cli-level","--log-date-format","--log-file","--log-file-date-format","--log-file-format","--log-file-level","--log-format","--log-level","--maxfail","--override-ini","--pastebin","--pdbcls","--pythonwarnings","--result-log","--rootdir","--show-capture","--tb","--verbosity","--max-slave-restart","--numprocesses","--rsyncdir","--rsyncignore","--tx"],s=["--cache-clear","--collect-in-virtualenv","--collect-only","--co","--continue-on-collection-errors","--cov-append","--cov-branch","--debug","--disable-pytest-warnings","--disable-warnings","--doctest-continue-on-failure","--doctest-ignore-import-errors","--doctest-modules","--exitfirst","--failed-first","--ff","--fixtures","--fixtures-per-test","--force-sugar","--full-trace","--funcargs","--help","--keep-duplicates","--last-failed","--lf","--markers","--new-first","--nf","--no-cov","--no-cov-on-fail","--no-header","--no-print-logs","--no-summary","--noconftest","--old-summary","--pdb","--pyargs","-PyTest, Unittest-pyargs","--quiet","--runxfail","--setup-only","--setup-plan","--setup-show","--showlocals","--stepwise","--sw","--stepwise-skip","--strict","--strict-config","--strict-markers","--trace-config","--verbose","--version","-V","-h","-l","-q","-s","-v","-x","--boxed","--forked","--looponfail","--trace","--tx","-d"];function a(e,t){const n=[],a=[];let c=!1;if(Array.isArray(t))t.forEach((e=>{o.indexOf(e)>=0&&a.push(e),s.indexOf(e)>=0&&n.push(e)}));else switch(t){case r.TestFilter.removeTests:n.push("--lf","--last-failed","--ff","--failed-first","--nf","--new-first"),a.push("-k","-m","--lfnf","--last-failed-no-failures"),c=!0;break;case r.TestFilter.discovery:n.push("-x","--exitfirst","--fixtures","--funcargs","--fixtures-per-test","--pdb","--lf","--last-failed","--ff","--failed-first","--nf","--new-first","--cache-show","-v","--verbose","-q","-quiet","-l","--showlocals","--no-print-logs","--debug","--setup-only","--setup-show","--setup-plan","--trace"),a.push("-m","--maxfail","--pdbcls","--capture","--lfnf","--last-failed-no-failures","--verbosity","-r","--tb","--show-capture","--durations","--junit-xml","--junit-prefix","--result-log","-W","--pythonwarnings","--log-*"),c=!0;break;case r.TestFilter.debugAll:case r.TestFilter.runAll:n.push("--collect-only","--trace");break;case r.TestFilter.debugSpecific:case r.TestFilter.runSpecific:n.push("--collect-only","--lf","--last-failed","--ff","--failed-first","--nf","--new-first","--trace"),a.push("-k","-m","--lfnf","--last-failed-no-failures"),c=!0;break;default:throw new Error(`Unsupported Filter '${t}'`)}let l=e.slice();if(c){const e=(0,i.getPositionalArguments)(l,o,s);l=l.filter((t=>-1===e.indexOf(t)))}return(0,i.filterArguments)(l,a,n)}t.pytestGetTestFilesAndFolders=function(e){return(0,i.getPositionalArguments)(e,o,s)},t.removePositionalFoldersAndFiles=function(e){return a(e,r.TestFilter.removeTests)},t.preparePytestArgumentsForDiscovery=function(e){const t=a(e.args,r.TestFilter.discovery);return e.ignoreCache&&-1===t.indexOf("--cache-clear")&&t.splice(0,0,"--cache-clear"),-1===t.indexOf("-s")&&t.splice(0,0,"-s"),0===t.filter((e=>e.startsWith("--rootdir"))).length&&t.splice(0,0,"--rootdir",e.cwd),t}},48372:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PytestController=void 0;const o=n(86700),s=n(96486),a=n(71017),c=n(73837),l=n(66828),u=n(17585),p=n(81036),d=n(61684),h=n(99910),f=n(59314),g=n(19735),m=n(54813),v=n(61522),y=n(83194),b=n(62020),S=n(77540),E=n(85269);let _=class{constructor(e,t,n,r){this.discoveryHelper=e,this.runner=t,this.configService=n,this.workspaceService=r,this.testData=new Map,this.discovering=new Map,this.idToRawData=new Map}async resolveChildren(e,t,n){const r=this.workspaceService.getWorkspaceFolder(t.uri);if(r){const i=this.discovering.get(r.uri.fsPath);i&&await i.promise;const o=this.testData.get(r.uri.fsPath);if(o){if(0===o.length){const t=[];return e.items.forEach((e=>t.push(e))),t.forEach((t=>e.items.delete(t.id))),Promise.resolve()}const i=1===o.length?o[0].root:r.uri.fsPath;if(i===t.id)if(1===o.length){if(!(o[0].tests.length>0))return this.idToRawData.delete(t.id),e.items.delete(t.id),Promise.resolve();await(0,b.updateTestItemFromRawData)(t,e,this.idToRawData,t.id,o,n)}else{let r=[];t.children.forEach((e=>r.push(e.id))),await(0,h.asyncForEach)(o,(async o=>{let s,c=o.root;if(o.root===i){const e=o.parents.filter((e=>"."===e.parentid||e.parentid===i));c=a.join(o.root,e.length>0?e[0].id:""),s=e.length>0?e[0].id:void 0}if(o.tests.length>0){let u=t.children.get(c);u||(u=(0,b.createWorkspaceRootTestItem)(e,this.idToRawData,{id:c,label:a.basename(c),uri:l.Uri.file(c),runId:c,parentId:t.id,rawId:s}),t.children.add(u)),r=r.filter((e=>e!==c)),await(0,b.updateTestItemFromRawData)(u,e,this.idToRawData,i,[o],n)}else(0,b.removeItemByIdFromChildren)(this.idToRawData,t,[c])})),(0,b.removeItemByIdFromChildren)(this.idToRawData,t,r)}else{const r=(0,b.getWorkspaceNode)(t,this.idToRawData);r&&await(0,b.updateTestItemFromRawData)(t,e,this.idToRawData,r.id,o,n)}}else{const n=(0,b.getWorkspaceNode)(t,this.idToRawData);n&&e.items.delete(n.id)}}return Promise.resolve()}async refreshTestData(e,t,n){var r;(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERING,void 0,{tool:"pytest"});const i=this.workspaceService.getWorkspaceFolder(t);if(i){const o=this.discovering.get(i.uri.fsPath);if(o)return o.promise;const u=this.configService.getSettings(i.uri),d={workspaceFolder:i.uri,cwd:u.testing.cwd&&u.testing.cwd.length>0?u.testing.cwd:i.uri.fsPath,args:u.testing.pytestArgs,ignoreCache:!0,token:n},h=(0,E.pytestGetTestFilesAndFolders)(d.args),y=(0,p.runAdapter)(["discover","pytest","--",...(0,E.preparePytestArgumentsForDiscovery)(d)]);let S;S=0===h.length?[{...d,args:y}]:h.map((e=>({...d,args:[...y,e]})));const _=(0,f.createDeferred)();this.discovering.set(i.uri.fsPath,_);let w=[];try{w=(0,s.flatten)(await Promise.all(S.map((e=>this.discoveryHelper.runTestDiscovery(e))))),this.testData.set(i.uri.fsPath,w),e.items.delete(`DiscoveryError:${i.uri.fsPath}`),_.resolve()}catch(t){(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:"pytest",failed:!0});const n=(null===(r=d.token)||void 0===r?void 0:r.isCancellationRequested)?"Cancelled":"Error";(0,g.traceError)(`${n} discovering pytest tests:\r\n`,t);const o=function(e){const t=e.split(/\r?\n/g);let n=!1,r="";for(const e of t)n?r+=`${e}\r\n`:e.includes(" ERRORS ")&&(n=!0);return r}(t.message);e.items.add((0,b.createErrorTestItem)(e,{id:`DiscoveryError:${i.uri.fsPath}`,label:`Pytest Discovery Error [${a.basename(i.uri.fsPath)}]`,error:c.format(`${n} discovering pytest tests (see Output > Python):\r\n`,o.length>0?o:t)})),_.reject(t)}finally{this.discovering.delete(i.uri.fsPath)}const T=1===w.length?w[0].root:i.uri.fsPath,C=e.items.get(T);if(C)if(t.fsPath===i.uri.fsPath)await this.resolveChildren(e,C,n);else{const r=(0,b.getNodeByUri)(C,t);r?await this.resolveChildren(e,r,n):await this.resolveChildren(e,C,n)}else if(w.length>0){const t=(0,b.createWorkspaceRootTestItem)(e,this.idToRawData,{id:T,label:a.basename(T),uri:l.Uri.file(T),runId:T});e.items.add(t),await this.resolveChildren(e,t,n)}}return(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:"pytest",failed:!1}),Promise.resolve()}runTests(e,t,n){const r=this.configService.getSettings(t.uri);try{return this.runner.runTests(e,{workspaceFolder:t.uri,cwd:r.testing.cwd&&r.testing.cwd.length>0?r.testing.cwd:t.uri.fsPath,token:n,args:r.testing.pytestArgs},this.idToRawData)}catch(e){throw(0,m.sendTelemetryEvent)(v.EventName.UNITTEST_RUN_ALL_FAILED,void 0),new Error(`Failed to run tests: ${e}`)}}};_=r([(0,o.injectable)(),i(0,(0,o.inject)(S.ITestDiscoveryHelper)),i(1,(0,o.inject)(S.ITestsRunner)),i(1,(0,o.named)(y.PYTEST_PROVIDER)),i(2,(0,o.inject)(d.IConfigurationService)),i(3,(0,o.inject)(u.IWorkspaceService))],_),t.PytestController=_},57495:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PytestTestDiscoveryAdapter=void 0;const r=n(71017),i=n(59314),o=n(63281),s=n(19735);t.PytestTestDiscoveryAdapter=class{constructor(e,t,n,r){this.testServer=e,this.configSettings=t,this.outputChannel=n,this.resultResolver=r}async discoverTests(e,t){const n=this.configSettings.getSettings(e),r=this.testServer.createUUID(e.fsPath),{pytestArgs:i}=n.testing;(0,s.traceVerbose)(i);const o=this.testServer.onDiscoveryDataReceived((e=>{var t;null===(t=this.resultResolver)||void 0===t||t.resolveDiscovery(JSON.parse(e.data))}));try{await this.runPytestDiscovery(e,r,t)}finally{this.testServer.deleteUUID(r),o.dispose()}return{cwd:e.fsPath,status:"success"}}async runPytestDiscovery(e,t,n){var s,a,c,l,u,p,d;const h=(0,i.createDeferred)(),f=r.join(o.EXTENSION_ROOT_DIR,"pythonFiles"),g=this.configSettings.getSettings(e),{pytestArgs:m}=g.testing,v={cwd:g.testing.cwd&&g.testing.cwd.length>0?g.testing.cwd:e.fsPath,throwOnStdErr:!0,extraVariables:{PYTHONPATH:[f,...null!==(a=null===(s=process.env.PYTHONPATH)||void 0===s?void 0:s.split(r.delimiter))&&void 0!==a?a:[]].join(r.delimiter),TEST_UUID:t.toString(),TEST_PORT:this.testServer.getPort().toString()},outputChannel:this.outputChannel},y={allowEnvironmentFetchExceptions:!1,resource:e},b=await(null==n?void 0:n.createActivatedEnvironment(y)),S=(0,i.createDeferred)(),E=["-m","pytest","-p","vscode_pytest","--collect-only"].concat(m),_=null==b?void 0:b.execObservable(E,v);null===(l=null===(c=null==_?void 0:_.proc)||void 0===c?void 0:c.stdout)||void 0===l||l.on("data",(e=>{var t;null===(t=v.outputChannel)||void 0===t||t.append(e.toString())})),null===(p=null===(u=null==_?void 0:_.proc)||void 0===u?void 0:u.stderr)||void 0===p||p.on("data",(e=>{var t;null===(t=v.outputChannel)||void 0===t||t.append(e.toString())})),null===(d=null==_?void 0:_.proc)||void 0===d||d.on("exit",(()=>{S.resolve({stdout:"",stderr:""}),h.resolve()})),await S.promise}}},15536:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PytestTestExecutionAdapter=void 0;const r=n(71017),i=n(59314),o=n(19735),s=n(85269),a=n(83194),c=n(77570),l=n(76646);t.PytestTestExecutionAdapter=class{constructor(e,t,n,r){this.testServer=e,this.configSettings=t,this.outputChannel=n,this.resultResolver=r}async runTests(e,t,n,r,i,s){const a=this.testServer.createUUID(e.fsPath);(0,o.traceVerbose)(e,t,n);const c=this.testServer.onRunDataReceived((e=>{var t;r&&(null===(t=this.resultResolver)||void 0===t||t.resolveExecution(JSON.parse(e.data),r))})),l=function(e){e.deleteUUID(a),c.dispose()};return null==r||r.token.onCancellationRequested((()=>{l(this.testServer)})),await this.runTestsNew(e,t,a,r,n,i,s,l),{cwd:e.fsPath,status:"success",error:""}}async runTestsNew(e,t,n,u,p,d,h,f){var g,m,v,y,b,S,E;const _=(0,i.createDeferred)(),w=r.join(c.EXTENSION_ROOT_DIR,"pythonFiles");this.configSettings.isTestExecution();const T=this.configSettings.getSettings(e),{pytestArgs:C}=T.testing,P=T.testing.cwd&&T.testing.cwd.length>0?T.testing.cwd:e.fsPath,I={cwd:P,throwOnStdErr:!0,extraVariables:{PYTHONPATH:[w,...null!==(m=null===(g=process.env.PYTHONPATH)||void 0===g?void 0:g.split(r.delimiter))&&void 0!==m?m:[]].join(r.delimiter),TEST_UUID:n.toString(),TEST_PORT:this.testServer.getPort().toString()},outputChannel:this.outputChannel,stdinStr:t.toString()},x={allowEnvironmentFetchExceptions:!1,resource:e},O=await(null==d?void 0:d.createActivatedEnvironment(x));try{const c=(0,s.removePositionalFoldersAndFiles)(C);0===c.filter((e=>e.startsWith("--rootdir"))).length&&c.splice(0,0,"--rootdir",e.fsPath),p&&!c.some((e=>e.startsWith("--capture")||"-s"===e))&&c.push("--capture","no"),(0,o.traceLog)(`Running PYTEST execution for the following test ids: ${t}`);const d=await l.startTestIdServer(t);if(I.extraVariables&&(I.extraVariables.RUN_TEST_IDS_PORT=d.toString()),p){const e=this.testServer.getPort().toString(),t=n.toString(),r={cwd:P,args:c,token:I.token,testProvider:a.PYTEST_PROVIDER,pytestPort:e,pytestUUID:t,runTestIdsPort:d.toString()};(0,o.traceInfo)(`Running DEBUG pytest with arguments: ${c.join(" ")}\r\n`),await h.launchDebugger(r,(()=>{_.resolve(),this.testServer.deleteUUID(n)}))}else{const e=[r.join(w,"vscode_pytest","run_pytest_script.py"),...c];(0,o.traceInfo)(`Running pytests with arguments: ${e.join(" ")}\r\n`);const t=(0,i.createDeferred)(),n=null==O?void 0:O.execObservable(e,I);null==u||u.token.onCancellationRequested((()=>{var e;null===(e=null==n?void 0:n.proc)||void 0===e||e.kill()})),null===(y=null===(v=null==n?void 0:n.proc)||void 0===v?void 0:v.stdout)||void 0===y||y.on("data",(e=>{var t;null===(t=this.outputChannel)||void 0===t||t.append(e.toString())})),null===(S=null===(b=null==n?void 0:n.proc)||void 0===b?void 0:b.stderr)||void 0===S||S.on("data",(e=>{var t;null===(t=this.outputChannel)||void 0===t||t.append(e.toString())})),null===(E=null==n?void 0:n.proc)||void 0===E||E.on("exit",(()=>{t.resolve({stdout:"",stderr:""}),_.resolve(),null==f||f(this.testServer)})),await t.promise}}catch(e){return(0,o.traceError)(`Error while running tests: ${t}\r\n${e}\r\n\r\n`),Promise.reject(e)}return{cwd:P,status:"success",error:""}}}},30523:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PytestRunner=void 0;const o=n(86700),s=n(66828),a=n(61684),c=n(83194),l=n(78308),u=n(55149),p=n(94977),d=n(64388),h=n(62020),f=n(85269),g="--junit-xml";let m=class{constructor(e,t,n){this.runner=e,this.debugLauncher=t,this.outputChannel=n}async runTests(e,t,n){const r={...t,exclude:e.excludes,debug:e.runKind===s.TestRunProfileKind.Debug};try{await Promise.all(e.includes.map((t=>this.runTest(t,e.runInstance,r,n))))}catch(t){e.runInstance.appendOutput(`Error while running tests:\r\n${t}\r\n\r\n`)}}async runTest(e,t,n,r){t.appendOutput(`Running tests (pytest): ${e.id}\r\n`),(0,h.getTestCaseNodes)(e).forEach((e=>t.started(e)));const i=[],o=await async function(e,t){const n=(0,u.getOptionValues)(e,g);if(1===n.length)return n[0];const r=await(0,p.createTemporaryFile)(".xml");return t.push(r),r.filePath}(n.args,i);try{let s=(0,f.removePositionalFoldersAndFiles)(n.args);s=(0,u.filterArguments)(s,[g,"--junitxml"]),s.splice(0,0,`--junit-xml=${o}`),s.splice(0,0,"--override-ini","junit_family=xunit1"),0===s.filter((e=>e.startsWith("--rootdir"))).length&&s.splice(0,0,"--rootdir",n.cwd),n.debug&&!s.some((e=>e.startsWith("--capture")||"-s"===e))&&s.push("--capture","no");const a=r.get(e.id);if(!a)throw new Error(`Trying to run unknown node: ${e.id}`);if(e.id!==n.cwd&&s.push(a.rawId),t.appendOutput(`Running test with arguments: ${s.join(" ")}\r\n`),t.appendOutput(`Current working directory: ${n.cwd}\r\n`),t.appendOutput(`Workspace directory: ${n.workspaceFolder.fsPath}\r\n`),n.debug){const e=[n.cwd,"pytest"].concat(s),t={cwd:n.cwd,args:e,token:n.token,outChannel:this.outputChannel,testProvider:c.PYTEST_PROVIDER};await this.debugLauncher.launchDebugger(t)}else{const e={args:s,cwd:n.cwd,outChannel:this.outputChannel,token:n.token,workspaceFolder:n.workspaceFolder};await this.runner.run(c.PYTEST_PROVIDER,e)}t.appendOutput("Run completed, parsing output\r\n"),await(0,d.updateResultFromJunitXml)(o,e,t,r)}catch(n){return t.appendOutput(`Error while running tests: ${e.label}\r\n${n}\r\n\r\n`),Promise.reject(n)}finally{i.forEach((e=>e.dispose()))}return Promise.resolve()}};m=r([(0,o.injectable)(),i(0,(0,o.inject)(l.ITestRunner)),i(1,(0,o.inject)(l.ITestDebugLauncher)),i(2,(0,o.inject)(a.ITestOutputChannel))],m),t.PytestRunner=m},20582:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTestControllerTypes=void 0;const r=n(90819),i=n(83194),o=n(31997),s=n(77540),a=n(40063),c=n(48372),l=n(30523),u=n(19661),p=n(7975);t.registerTestControllerTypes=function(e){e.addSingleton(s.ITestDiscoveryHelper,o.TestDiscoveryHelper),e.addSingleton(s.ITestFrameworkController,c.PytestController,i.PYTEST_PROVIDER),e.addSingleton(s.ITestsRunner,l.PytestRunner,i.PYTEST_PROVIDER),e.addSingleton(s.ITestFrameworkController,p.UnittestController,i.UNITTEST_PROVIDER),e.addSingleton(s.ITestsRunner,u.UnittestRunner,i.UNITTEST_PROVIDER),e.addSingleton(s.ITestController,a.PythonTestController),e.addBinding(s.ITestController,r.IExtensionSingleActivationService)}},33108:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTestRunArgs=t.unittestGetTopLevelDirectory=t.unittestGetTestPattern=t.unittestGetTestFolders=t.unittestFilterArguments=void 0;const r=n(55149),i=["-k","-p","-s","-t","--pattern","--start-directory","--top-level-directory"],o=["-b","-c","-f","-h","-q","-v","--buffer","--catch","--failfast","--help","--locals","--quiet","--verbose"];function s(e){const t=(0,r.getOptionValues)(e,"-s");if(1===t.length)return t;const n=(0,r.getOptionValues)(e,"--start-directory");return 1===n.length?n:["."]}function a(e){const t=(0,r.getOptionValues)(e,"-p");if(1===t.length)return t[0];const n=(0,r.getOptionValues)(e,"--pattern");return 1===n.length?n[0]:"test*.py"}function c(e){const t=(0,r.getOptionValues)(e,"-t");if(1===t.length)return t[0];const n=(0,r.getOptionValues)(e,"--top-level-directory");return 1===n.length?n[0]:null}t.unittestFilterArguments=function(e,t){const n=[],s=[];let a=!1;Array.isArray(t)?t.forEach((e=>{i.indexOf(e)>=0&&s.push(e),o.indexOf(e)>=0&&n.push(e)})):a=!0;let c=e.slice();if(a){const e=(0,r.getPositionalArguments)(c,i,o);c=c.filter((t=>-1===e.indexOf(t)))}return(0,r.filterArguments)(c,s,n)},t.unittestGetTestFolders=s,t.unittestGetTestPattern=a,t.unittestGetTopLevelDirectory=c,t.getTestRunArgs=function(e){const t=s(e)[0],n=a(e),r=c(e),i=e.some((e=>"-f"===e.trim()||"--failfast"===e.trim())),o=[`--us=${t}`,`--up=${n}`,"--uvInt="+(e.some((e=>0===e.trim().indexOf("-v")))?2:1)];return r&&o.push(`--ut=${r}`),i&&o.push("--uf"),o}},19661:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UnittestRunner=void 0;const o=n(86700),s=n(66828),a=n(4057),c=n(94146),l=n(61684),u=n(3481),p=n(19735),d=n(83194),h=n(78308),f=n(62020),g=n(76646),m=n(33108);function v(e){return(0,c.splitLines)(e,{trim:!1,removeEmptyEntries:!0}).join("\r\n")}let y=class{constructor(e,t,n,r){this.runner=e,this.debugLauncher=t,this.outputChannel=n,this.server=r}async runTests(e,t,n,r){const i={...t,exclude:e.excludes,debug:e.runKind===s.TestRunProfileKind.Debug};try{await this.runTest(e.includes,e.runInstance,i,n,r)}catch(t){e.runInstance.appendOutput(`Error while running tests:\r\n${t}\r\n\r\n`)}}async runTest(e,t,n,r,i){t.appendOutput(`Running tests (unittest): ${e.map((e=>e.id)).join(" ; ")}\r\n`);const o=[],c=new Map;e.forEach((e=>{const t=(0,f.getTestCaseNodes)(e);t.forEach((e=>{if(e.uri){const t=c.get(e.uri.fsPath);t?t.push(e):c.set(e.uri.fsPath,[e])}})),o.push(...t)}));const l=[],h={total:0,passed:0,skipped:0,errored:0,failed:0},y=new Map;let b=!1,S=!1;this.server.on("error",((e,...t)=>{(0,p.traceError)(`${e} ${t.join(" ")}`)})),this.server.on("log",((e,...t)=>{(0,p.traceVerbose)(`${e} ${t.join(" ")}`)})),this.server.on("connect",u.noop),this.server.on("start",u.noop),this.server.on("result",(e=>{var n,a,c;const u=o.find((t=>{var n;return(null===(n=r.get(t.id))||void 0===n?void 0:n.runId)===e.test})),p=r.get(null!==(n=null==u?void 0:u.id)&&void 0!==n?n:"");if(u&&p)if(h.total+=1,l.push(p.runId),"passed"===e.outcome||"failed-expected"===e.outcome){const e=`${p.rawId} Passed\r\n`;t.passed(u),t.appendOutput((0,g.fixLogLines)(e)),h.passed+=1}else if("failed"===e.outcome||"passed-unexpected"===e.outcome){const n=e.traceback?v(e.traceback):"",r=`${p.rawId} Failed: ${null!==(a=e.message)&&void 0!==a?a:e.outcome}\r\n${n}\r\n`,i=new s.TestMessage(r);u.uri&&u.range&&(i.location=new s.Location(u.uri,u.range)),t.failed(u,i),t.appendOutput((0,g.fixLogLines)(r)),h.failed+=1,b&&(S=!0)}else if("error"===e.outcome){const n=e.traceback?v(e.traceback):"",r=`${p.rawId} Failed with Error: ${e.message}\r\n${n}\r\n`,i=new s.TestMessage(r);u.uri&&u.range&&(i.location=new s.Location(u.uri,u.range)),t.errored(u,i),t.appendOutput((0,g.fixLogLines)(r)),h.errored+=1,b&&(S=!0)}else if("skipped"===e.outcome){const n=e.traceback?v(e.traceback):"",r=`${p.rawId} Skipped: ${e.message}\r\n${n}\r\n`;t.skipped(u),t.appendOutput((0,g.fixLogLines)(r)),h.skipped+=1}else if("subtest-passed"===e.outcome){const n=y.get(e.test);if(n?n.passed+=1:(h.passed+=1,y.set(e.test,{passed:1,failed:0}),t.appendOutput((0,g.fixLogLines)(`${p.rawId} [subtests]:\r\n`)),(0,f.clearAllChildren)(u)),e.subtest){t.appendOutput((0,g.fixLogLines)(`${e.subtest} Passed\r\n`));const n=null==i?void 0:i.createTestItem(e.subtest,e.subtest);n&&(u.children.add(n),t.started(n),t.passed(n))}}else if("subtest-failed"===e.outcome){const n=y.get(e.test);if(n?n.failed+=1:(h.failed+=1,y.set(e.test,{passed:0,failed:1}),t.appendOutput((0,g.fixLogLines)(`${p.rawId} [subtests]:\r\n`)),(0,f.clearAllChildren)(u)),e.subtest){t.appendOutput((0,g.fixLogLines)(`${e.subtest} Failed\r\n`));const n=e.traceback?v(e.traceback):"",r=`${e.subtest} Failed: ${null!==(c=e.message)&&void 0!==c?c:e.outcome}\r\n${n}\r\n`;t.appendOutput((0,g.fixLogLines)(r));const o=null==i?void 0:i.createTestItem(e.subtest,e.subtest);if(o){u.children.add(o),t.started(o);const e=new s.TestMessage(r);u.uri&&u.range&&(e.location=new s.Location(u.uri,u.range)),t.failed(o,e)}}}else{const n=`Unknown outcome type for test ${p.rawId}: ${e.outcome}`;t.appendOutput((0,g.fixLogLines)(n));const r=new s.TestMessage(n);u.uri&&u.range&&(r.location=new s.Location(u.uri,u.range)),t.errored(u,r)}else if("error"===e.outcome){const n=e.traceback?v(e.traceback):"",r=`${e.test} Failed with Error: ${e.message}\r\n${n}\r\n`;t.appendOutput((0,g.fixLogLines)(r))}}));const E=await this.server.start(),_=async(e,t)=>{let r=(0,m.getTestRunArgs)(n.args);if(b=r.indexOf("--uf")>=0,r=r.filter((e=>"--uf"!==e)),r.push(`--result-port=${E}`),t.forEach((e=>r.push(`-t${e}`))),r.push(`--testFile=${e}`),!0===n.debug){r.push("--debug");const e={cwd:n.cwd,args:r,token:n.token,outChannel:this.outputChannel,testProvider:d.UNITTEST_PROVIDER};return this.debugLauncher.launchDebugger(e)}const i={args:a.visualstudio_py_testlauncher(r),cwd:n.cwd,outChannel:this.outputChannel,token:n.token,workspaceFolder:n.workspaceFolder};return await this.runner.run(d.UNITTEST_PROVIDER,i),Promise.resolve()};try{for(const e of c.keys()){if(S||n.token.isCancellationRequested)break;const i=c.get(e);if(i){t.appendOutput(`Running tests: ${i.map((e=>e.id)).join("\r\n")}\r\n`);const n=[];i.forEach((e=>{const i=r.get(e.id);i&&(t.started(e),n.push(i.runId))})),await _(e,n)}}}catch(e){(0,p.traceError)(e)}finally{this.server.removeAllListeners(),this.server.stop()}t.appendOutput(`Total number of tests expected to run: ${o.length}\r\n`),t.appendOutput(`Total number of tests run: ${h.total}\r\n`),t.appendOutput(`Total number of tests passed: ${h.passed}\r\n`),t.appendOutput(`Total number of tests failed: ${h.failed}\r\n`),t.appendOutput(`Total number of tests failed with errors: ${h.errored}\r\n`),t.appendOutput(`Total number of tests skipped: ${h.skipped}\r\n\r\n`),y.size>0&&t.appendOutput("Sub-test stats: \r\n"),y.forEach(((e,n)=>{t.appendOutput(`Sub-tests for [${n}]: Total=${e.passed+e.failed} Passed=${e.passed} Failed=${e.failed}\r\n\r\n`)})),b&&t.appendOutput(`Total number of tests skipped due to fail fast: ${h.total-l.length}\r\n`)}};y=r([(0,o.injectable)(),i(0,(0,o.inject)(h.ITestRunner)),i(1,(0,o.inject)(h.ITestDebugLauncher)),i(2,(0,o.inject)(l.ITestOutputChannel)),i(3,(0,o.inject)(h.IUnitTestSocketServer))],y),t.UnittestRunner=y},16903:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnittestTestDiscoveryAdapter=void 0;const r=n(71017),i=n(63281);t.UnittestTestDiscoveryAdapter=class{constructor(e,t,n,r){this.testServer=e,this.configSettings=t,this.outputChannel=n,this.resultResolver=r}async discoverTests(e){const t=this.configSettings.getSettings(e),{unittestArgs:n}=t.testing,o=t.testing.cwd&&t.testing.cwd.length>0?t.testing.cwd:e.fsPath,s=(a=n,{script:r.join(i.EXTENSION_ROOT_DIR,"pythonFiles","unittestadapter","discovery.py"),args:["--udiscovery",...a]});var a;const c=this.testServer.createUUID(e.fsPath),l={workspaceFolder:e,command:s,cwd:o,uuid:c,outChannel:this.outputChannel},u=this.testServer.onDiscoveryDataReceived((e=>{var t;null===(t=this.resultResolver)||void 0===t||t.resolveDiscovery(JSON.parse(e.data))}));return await this.callSendCommand(l,(()=>{this.testServer.deleteUUID(c),u.dispose()})),{cwd:o,status:"success"}}async callSendCommand(e,t){return await this.testServer.sendCommand(e,void 0,void 0,t),{cwd:"",status:"success"}}}},928:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnittestTestExecutionAdapter=void 0;const r=n(71017),i=n(59314),o=n(63281),s=n(19735),a=n(76646);t.UnittestTestExecutionAdapter=class{constructor(e,t,n,r){this.testServer=e,this.configSettings=t,this.outputChannel=n,this.resultResolver=r}async runTests(e,t,n,r){const i=this.testServer.createUUID(e.fsPath),o=this.testServer.onRunDataReceived((e=>{var t;r&&(null===(t=this.resultResolver)||void 0===t||t.resolveExecution(JSON.parse(e.data),r))})),s=function(e){e.deleteUUID(i),o.dispose()};return null==r||r.token.onCancellationRequested((()=>{s(this.testServer)})),await this.runTestsNew(e,t,i,r,n,s),{cwd:e.fsPath,status:"success",error:""}}async runTestsNew(e,t,n,c,l,u){const p=this.configSettings.getSettings(e),{unittestArgs:d}=p.testing,h=p.testing.cwd&&p.testing.cwd.length>0?p.testing.cwd:e.fsPath;var f;const g={workspaceFolder:e,command:(f=d,{script:r.join(o.EXTENSION_ROOT_DIR,"pythonFiles","unittestadapter","execution.py"),args:["--udiscovery",...f]}),cwd:h,uuid:n,debugBool:l,testIds:t,outChannel:this.outputChannel},m=(0,i.createDeferred)();(0,s.traceLog)(`Running UNITTEST execution for the following test ids: ${t}`);const v=await(0,a.startTestIdServer)(t);return await this.testServer.sendCommand(g,v.toString(),c,(()=>{m.resolve(),null==u||u(this.testServer)})),{cwd:h,status:"success",error:""}}}},7975:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UnittestController=void 0;const o=n(71017),s=n(73837),a=n(86700),c=n(66828),l=n(17585),u=n(61684),p=n(59314),d=n(83194),h=n(78308),f=n(77540),g=n(33108),m=n(62020),v=n(54813),y=n(61522),b=n(81036),S=n(19735);let E=class{constructor(e,t,n,r){this.discoveryRunner=e,this.runner=t,this.configService=n,this.workspaceService=r,this.testData=new Map,this.discovering=new Map,this.idToRawData=new Map}async resolveChildren(e,t,n){const r=this.workspaceService.getWorkspaceFolder(t.uri);if(r){const i=this.discovering.get(r.uri.fsPath);i&&await i.promise;const o=this.testData.get(r.uri.fsPath);if(o)if(o.root===t.id){if(0===o.tests.length)return e.items.delete(t.id),Promise.resolve();o.tests.length>0?await(0,m.updateTestItemFromRawData)(t,e,this.idToRawData,t.id,[o],n):(this.idToRawData.delete(t.id),e.items.delete(t.id))}else{const r=(0,m.getWorkspaceNode)(t,this.idToRawData);r&&await(0,m.updateTestItemFromRawData)(t,e,this.idToRawData,r.id,[o],n)}else{const n=(0,m.getWorkspaceNode)(t,this.idToRawData);n&&e.items.delete(n.id)}}return Promise.resolve()}async refreshTestData(e,t,n){var r;(0,v.sendTelemetryEvent)(y.EventName.UNITTEST_DISCOVERING,void 0,{tool:"unittest"});const i=this.workspaceService.getWorkspaceFolder(t);if(i){const a=this.discovering.get(i.uri.fsPath);if(a)return a.promise;const l=this.configService.getSettings(i.uri),u={workspaceFolder:i.uri,cwd:l.testing.cwd&&l.testing.cwd.length>0?l.testing.cwd:i.uri.fsPath,args:l.testing.unittestArgs,ignoreCache:!0,token:n},h=(0,g.unittestGetTestFolders)(u.args)[0],f=(0,g.unittestGetTestPattern)(u.args),E=(0,g.unittestGetTopLevelDirectory)(u.args);let _=h;if(o.isAbsolute(h)){const e=o.relative(u.cwd,h);_=e.length>0?e:"."}const w=null==E?[h,f]:[h,f,E],T={args:(0,b.unittestDiscovery)(w),cwd:u.cwd,workspaceFolder:u.workspaceFolder,token:u.token,outChannel:u.outChannel},C=(0,p.createDeferred)();let P;this.discovering.set(i.uri.fsPath,C);try{const t=await this.discoveryRunner.run(d.UNITTEST_PROVIDER,T);P=await function(e,t,n,r){const i=[],s=[];for(const e of n){if(null==r?void 0:r.isCancellationRequested)break;const t=e.split(":");if(t.length>3){const e=t.pop(),n=t.pop(),r=t.pop(),o=t.pop(),a=t,c=`${o}.py`,l=`./${[...a,c].join("/")}`;if(n&&r&&o&&e){const t=`${l}::${r}`,o=l;s.push({id:`${l}::${r}::${n}`,name:n,parentid:t,source:`${l}:${e}`}),i.find((e=>e.id===t))||i.push({id:t,name:r,parentid:o,kind:"suite"}),i.find((e=>e.id===o))||i.push({id:o,name:c,parentid:0===a.length?".":`./${a.join("/")}`,kind:"file",relpath:l});const u=[];for(const e of a){const t=0===u.length?".":`./${u.join("/")}`;u.push(e);const n=`./${u.join("/")}`;i.find((e=>e.id===n))||i.push({id:n,name:e,parentid:t,kind:"folder",relpath:n})}}}}return Promise.resolve({rootid:".",root:o.isAbsolute(t)?t:o.resolve(e,t),parents:i,tests:s})}(u.cwd,_,function(e){let t=!1;const n=e.split(/\r?\n/g),r=[];for(const e of n){if(!t&&("start"===e&&(t=!0),e.startsWith("===")))break;r.push(e.trim())}return r.filter((e=>e.length>0))}(t),u.token),this.testData.set(i.uri.fsPath,P);const n=function(e){const t=e.split(/\r?\n/g);let n=!1,r="";const i=[];for(const e of t)n?e.startsWith("=== exception end ===")?(i.push(r),n=!1):r+=`${e}\r\n`:e.startsWith("=== exception start ===")&&(n=!0,r="");return i}(t);if(0===n.length)e.items.delete(`DiscoveryError:${i.uri.fsPath}`);else{(0,S.traceError)("Error discovering unittest tests:\r\n",n.join("\r\n\r\n"));let t=e.items.get(`DiscoveryError:${i.uri.fsPath}`);const r=s.format("Error discovering unittest tests (see Output > Python):\r\n",n.join("\r\n\r\n"));void 0===t&&(t=(0,m.createErrorTestItem)(e,{id:`DiscoveryError:${i.uri.fsPath}`,label:`Unittest Discovery Error [${o.basename(i.uri.fsPath)}]`,error:r}),t.canResolveChildren=!1,e.items.add(t)),t.error=r}C.resolve()}catch(t){(0,v.sendTelemetryEvent)(y.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:"unittest",failed:!0});const n=(null===(r=u.token)||void 0===r?void 0:r.isCancellationRequested)?"Cancelled":"Error";(0,S.traceError)(`${n} discovering unittest tests:\r\n`,t),e.items.add((0,m.createErrorTestItem)(e,{id:`DiscoveryError:${i.uri.fsPath}`,label:`Unittest Discovery Error [${o.basename(i.uri.fsPath)}]`,error:s.format(`${n} discovering unittest tests (see Output > Python):\r\n`,t)})),C.reject(t)}finally{this.discovering.delete(i.uri.fsPath)}if(!P)return Promise.resolve();const I=e.items.get(P.root);if(I)if(t.fsPath===i.uri.fsPath)await this.resolveChildren(e,I,n);else{const r=(0,m.getNodeByUri)(I,t);r?await this.resolveChildren(e,r,n):await this.resolveChildren(e,I,n)}else if(P.tests.length>0){const t=(0,m.createWorkspaceRootTestItem)(e,this.idToRawData,{id:P.root,label:o.basename(P.root),uri:c.Uri.file(P.root),runId:"."===P.root?i.uri.fsPath:P.root,rawId:P.rootid});e.items.add(t),await this.resolveChildren(e,t,n)}}return(0,v.sendTelemetryEvent)(y.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:"unittest",failed:!1}),Promise.resolve()}runTests(e,t,n,r){const i=this.configService.getSettings(t.uri);try{return this.runner.runTests(e,{workspaceFolder:t.uri,cwd:i.testing.cwd&&i.testing.cwd.length>0?i.testing.cwd:t.uri.fsPath,token:n,args:i.testing.unittestArgs},this.idToRawData,r)}catch(e){throw(0,v.sendTelemetryEvent)(y.EventName.UNITTEST_RUN_ALL_FAILED,void 0),new Error(`Failed to run tests: ${e}`)}}};E=r([(0,a.injectable)(),i(0,(0,a.inject)(h.ITestRunner)),i(1,(0,a.inject)(f.ITestsRunner)),i(1,(0,a.named)(d.UNITTEST_PROVIDER)),i(2,(0,a.inject)(u.IConfigurationService)),i(3,(0,a.inject)(l.IWorkspaceService))],E),t.UnittestController=E},80454:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceTestAdapter=void 0;const r=n(73837),i=n(59314),o=n(67098),s=n(19735),a=n(54813),c=n(61522),l=n(62020),u=n(76646);t.WorkspaceTestAdapter=class{constructor(e,t,n,r,i){this.testProvider=e,this.discoveryAdapter=t,this.executionAdapter=n,this.workspaceUri=r,this.resultResolver=i}async executeTests(e,t,n,p,d,h,f){if(this.executing)return this.executing.promise;const g=(0,i.createDeferred)();this.executing=g;const m=[],v=new Set;try{n.forEach((e=>{const t=(0,l.getTestCaseNodes)(e);m.push(...t)})),m.forEach((e=>{t.started(e);const n=this.resultResolver.vsIdToRunId.get(e.id);n&&v.add(n)}));const e=Array.from(v);void 0!==h?await this.executionAdapter.runTests(this.workspaceUri,e,d,t,h,f):await this.executionAdapter.runTests(this.workspaceUri,e,d),g.resolve()}catch(t){(0,a.sendTelemetryEvent)(c.EventName.UNITTEST_RUN_ALL_FAILED,void 0);let n=(null==p?void 0:p.isCancellationRequested)?o.Testing.cancelUnittestExecution:o.Testing.errorUnittestExecution;"pytest"===this.testProvider&&(n=(null==p?void 0:p.isCancellationRequested)?o.Testing.cancelPytestExecution:o.Testing.errorPytestExecution),(0,s.traceError)(`${n}\r\n`,t);const i=r.format(`${n} ${o.Testing.seePythonOutput}\r\n`,t),d=(0,u.buildErrorNodeOptions)(this.workspaceUri,i,this.testProvider),h=(0,l.createErrorTestItem)(e,d);e.items.add(h),g.reject(t)}finally{this.executing=void 0}return Promise.resolve()}async discoverTests(e,t,n){if((0,a.sendTelemetryEvent)(c.EventName.UNITTEST_DISCOVERING,void 0,{tool:this.testProvider}),this.discovering)return this.discovering.promise;const p=(0,i.createDeferred)();this.discovering=p;try{void 0!==n?await this.discoveryAdapter.discoverTests(this.workspaceUri,n):await this.discoveryAdapter.discoverTests(this.workspaceUri),p.resolve()}catch(n){(0,a.sendTelemetryEvent)(c.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:this.testProvider,failed:!0});let i=(null==t?void 0:t.isCancellationRequested)?o.Testing.cancelUnittestDiscovery:o.Testing.errorUnittestDiscovery;"pytest"===this.testProvider&&(i=(null==t?void 0:t.isCancellationRequested)?o.Testing.cancelPytestDiscovery:o.Testing.errorPytestDiscovery),(0,s.traceError)(`${i}\r\n`,n);const d=r.format(`${i} ${o.Testing.seePythonOutput}\r\n`,n),h=(0,u.buildErrorNodeOptions)(this.workspaceUri,d,this.testProvider),f=(0,l.createErrorTestItem)(e,h);return e.items.add(f),p.reject(n)}finally{this.discovering=void 0}return(0,a.sendTelemetryEvent)(c.EventName.UNITTEST_DISCOVERY_DONE,void 0,{tool:this.testProvider,failed:!1}),Promise.resolve()}}},40704:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITestingService=void 0,t.ITestingService=Symbol("ITestingService")},94380:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RestError:()=>Be,bearerTokenAuthenticationPolicy:()=>Et,bearerTokenAuthenticationPolicyName:()=>bt,createDefaultHttpClient:()=>st,createEmptyPipeline:()=>o,createHttpHeaders:()=>Ze,createPipelineFromOptions:()=>Ge,createPipelineRequest:()=>pt,decompressResponsePolicy:()=>J,decompressResponsePolicyName:()=>Y,defaultRetryPolicy:()=>de,exponentialRetryPolicy:()=>ht,exponentialRetryPolicyName:()=>dt,formDataPolicy:()=>me,formDataPolicyName:()=>ge,getDefaultProxySettings:()=>Pe,isRestError:()=>We,logPolicy:()=>U,logPolicyName:()=>F,ndJsonPolicy:()=>wt,ndJsonPolicyName:()=>_t,proxyPolicy:()=>xe,proxyPolicyName:()=>Ee,redirectPolicy:()=>B,redirectPolicyName:()=>V,retryPolicy:()=>pe,setClientRequestIdPolicy:()=>Re,setClientRequestIdPolicyName:()=>Oe,systemErrorRetryPolicy:()=>gt,systemErrorRetryPolicyName:()=>ft,throttlingRetryPolicy:()=>vt,throttlingRetryPolicyName:()=>mt,tlsPolicy:()=>Ae,tlsPolicyName:()=>De,tracingPolicy:()=>$e,tracingPolicyName:()=>qe,userAgentPolicy:()=>z,userAgentPolicyName:()=>K});const r=new Set(["Deserialize","Serialize","Retry","Sign"]);class i{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!r.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!r.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new i(this._policies)}static create(){return new i}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const r=n("Serialize"),i=n("None"),o=n("Deserialize"),s=n("Retry"),a=n("Sign"),c=[r,i,o,s,a];function l(e){return"Retry"===e?s:"Serialize"===e?r:"Deserialize"===e?o:"Sign"===e?a:i}for(const e of this._policies){const n=e.policy,r=e.options,i=n.name;if(t.has(i))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};r.afterPhase&&(o.afterPhase=l(r.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(i,o),l(r.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:r}=e,i=n.name,o=t.get(i);if(!o)throw new Error(`Missing node for policy ${i}`);if(r.afterPolicies)for(const e of r.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(r.beforePolicies)for(const e of r.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function u(n){n.hasRun=!0;for(const r of n.policies)if((!r.afterPhase||r.afterPhase.hasRun&&!r.afterPhase.policies.size)&&0===r.dependsOn.size){e.push(r.policy);for(const e of r.dependants)e.dependsOn.delete(r);t.delete(r.policy.name),n.policies.delete(r)}}function p(){for(const e of c){if(u(e),e.policies.size>0&&e!==i)return void(i.hasRun||u(i));e.hasAfterPolicies&&u(i)}}let d=0;for(;t.size>0;){d++;const t=e.length;if(p(),e.length<=t&&d>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function o(){return i.create()}var s=n(22037),a=n(73837),c=n.n(a);const l="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let u,p=[],d=[];const h=[];l&&g(l);const f=Object.assign((e=>v(e)),{enable:g,enabled:m,disable:function(){const e=u||"";return g(""),e},log:function(e,...t){process.stderr.write(`${c().format(e,...t)}${s.EOL}`)}});function g(e){u=e,p=[],d=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?d.push(new RegExp(`^${e.substr(1)}$`)):p.push(new RegExp(`^${e}$`));for(const e of h)e.enabled=m(e.namespace)}function m(e){if(e.endsWith("*"))return!0;for(const t of d)if(t.test(e))return!1;for(const t of p)if(t.test(e))return!0;return!1}function v(e){const t=Object.assign((function(...n){t.enabled&&(n.length>0&&(n[0]=`${e} ${n[0]}`),t.log(...n))}),{enabled:m(e),destroy:y,log:f.log,namespace:e,extend:b});return h.push(t),t}function y(){const e=h.indexOf(this);return e>=0&&(h.splice(e,1),!0)}function b(e){const t=v(`${this.namespace}:${e}`);return t.log=this.log,t}const S=f,E=new Set,_="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let w;const T=S("azure");T.log=(...e)=>{S.log(...e)};const C=["verbose","info","warning","error"];_&&(D(_)?function(e){if(e&&!D(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${C.join(",")}`);w=e;const t=[];for(const e of E)R(e)&&t.push(e.namespace);S.enable(t.join(","))}(_):console.error(`AZURE_LOG_LEVEL set to unknown log level '${_}'; logging is not enabled. Acceptable values: ${C.join(", ")}.`));const P={verbose:400,info:300,warning:200,error:100};function I(e){const t=T.extend(e);return x(T,t),{error:O(t,"error"),warning:O(t,"warning"),info:O(t,"info"),verbose:O(t,"verbose")}}function x(e,t){t.log=(...t)=>{e.log(...t)}}function O(e,t){const n=Object.assign(e.extend(t),{level:t});if(x(e,n),R(n)){const e=S.disable();S.enable(e+","+n.namespace)}return E.add(n),n}function R(e){return Boolean(w&&P[e.level]<=P[w])}function D(e){return C.includes(e)}const A=I("core-rest-pipeline");function k(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}const N="REDACTED",M=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],L=["api-version"];class j{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=M.concat(e),t=L.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||k(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=N;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=N;return t}sanitizeUrl(e){if("string"!=typeof e||null===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,N);return t.toString()}}const F="logPolicy";function U(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:A.info,r=new j({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:F,async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${r.sanitize(e)}`);const i=await t(e);return n(`Response status code: ${i.status}`),n(`Headers: ${r.sanitize(i.headers)}`),i}}}const V="redirectPolicy",H=["GET","HEAD"];function B(e={}){const{maxRetries:t=20}=e;return{name:V,async sendRequest(e,n){const r=await n(e);return W(n,r,t)}}}async function W(e,t,n,r=0){const{request:i,status:o,headers:s}=t,a=s.get("location");if(a&&(300===o||301===o&&H.includes(i.method)||302===o&&H.includes(i.method)||303===o&&"POST"===i.method||307===o)&&r<n){const t=new URL(a,i.url);i.url=t.toString(),303===o&&(i.method="GET",i.headers.delete("Content-Length"),delete i.body),i.headers.delete("Authorization");const s=await e(i);return W(e,s,n,r+1)}return t}const q="1.10.3";function $(e){const t=new Map;var n;t.set("core-rest-pipeline",q),(n=t).set("Node",process.version),n.set("OS",`(${s.arch()}-${s.type()}-${s.release()})`);const r=function(e){const t=[];for(const[n,r]of e){const e=r?`${n}/${r}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${r}`:r}const G="User-Agent",K="userAgentPolicy";function z(e={}){const t=$(e.userAgentPrefix);return{name:K,sendRequest:async(e,n)=>(e.headers.has(G)||e.headers.set(G,t),n(e))}}const Y="decompressResponsePolicy";function J(){return{name:Y,sendRequest:async(e,t)=>("HEAD"!==e.method&&e.headers.set("Accept-Encoding","gzip,deflate"),t(e))}}const X=new WeakMap,Q=new WeakMap;class Z{constructor(){this.onabort=null,X.set(this,[]),Q.set(this,!1)}get aborted(){if(!Q.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return Q.get(this)}static get none(){return new Z}addEventListener(e,t){if(!X.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");X.get(this).push(t)}removeEventListener(e,t){if(!X.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");const n=X.get(this),r=n.indexOf(t);r>-1&&n.splice(r,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}function ee(e){if(e.aborted)return;e.onabort&&e.onabort.call(e);const t=X.get(e);t&&t.slice().forEach((t=>{t.call(e,{type:"abort"})})),Q.set(e,!0)}class te extends Error{constructor(e){super(e),this.name="AbortError"}}class ne{constructor(e){if(this._signal=new Z,e){Array.isArray(e)||(e=arguments);for(const t of e)t.aborted?this.abort():t.addEventListener("abort",(()=>{this.abort()}))}}get signal(){return this._signal}abort(){ee(this._signal)}static timeout(e){const t=new Z,n=setTimeout(ee,e,t);return"function"==typeof n.unref&&n.unref(),t}}function re(e,t,n){return new Promise(((r,i)=>{let o,s;const a=()=>i(new te((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:"The operation was aborted.")),c=()=>{(null==n?void 0:n.abortSignal)&&s&&n.abortSignal.removeEventListener("abort",s)};if(s=()=>(o&&clearTimeout(o),c(),a()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return a();o=setTimeout((()=>{c(),r(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",s)}))}function ie(e,t){const n=e.headers.get(t);if(!n)return;const r=Number(n);return Number.isNaN(r)?void 0:r}const oe="Retry-After",se=["retry-after-ms","x-ms-retry-after-ms",oe];function ae(e){if(e&&[429,503].includes(e.status))try{for(const t of se){const n=ie(e,t);if(0===n||n)return n*(t===oe?1e3:1)}const t=e.headers.get(oe);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}function ce(){return{name:"throttlingRetryStrategy",retry({response:e}){const t=ae(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}}}function le(e={}){var t,n;const r=null!==(t=e.retryDelayInMs)&&void 0!==t?t:1e3,i=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:64e3;let o=r;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:r}){const s=!!(p=r)&&("ETIMEDOUT"===p.code||"ESOCKETTIMEDOUT"===p.code||"ECONNREFUSED"===p.code||"ECONNRESET"===p.code||"ENOENT"===p.code),a=s&&e.ignoreSystemErrors,c=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),l=c&&e.ignoreHttpStatusCodes,u=n&&(function(e){return Number.isFinite(ae(e))}(n)||!c);var p;if(u||l||a)return{skipStrategy:!0};if(r&&!s&&!c)return{errorToThrow:r};const d=o*Math.pow(2,t),h=Math.min(i,d);var f,g;return o=h/2+(f=0,g=h/2,f=Math.ceil(f),g=Math.floor(g),Math.floor(Math.random()*(g-f+1))+f),{retryAfterInMs:o}}}}const ue=I("core-rest-pipeline retryPolicy");function pe(e,t={maxRetries:3}){const n=t.logger||ue;return{name:"retryPolicy",async sendRequest(r,i){var o,s;let a,c,l=-1;e:for(;;){l+=1,a=void 0,c=void 0;try{n.info(`Retry ${l}: Attempting to send request`,r.requestId),a=await i(r),n.info(`Retry ${l}: Received a response from request`,r.requestId)}catch(e){if(n.error(`Retry ${l}: Received an error from request`,r.requestId),c=e,!e||"RestError"!==c.name)throw e;a=c.response}if(null===(o=r.abortSignal)||void 0===o?void 0:o.aborted)throw n.error(`Retry ${l}: Request aborted.`),new te;if(l>=(null!==(s=t.maxRetries)&&void 0!==s?s:3)){if(n.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(a)return a;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${l}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||ue;e.info(`Retry ${l}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:l,response:a,responseError:c});if(n.skipStrategy){e.info(`Retry ${l}: Skipped.`);continue t}const{errorToThrow:i,retryAfterInMs:o,redirectTo:s}=n;if(i)throw e.error(`Retry ${l}: Retry strategy ${t.name} throws error:`,i),i;if(o||0===o){e.info(`Retry ${l}: Retry strategy ${t.name} retries after ${o}`),await re(o,void 0,{abortSignal:r.abortSignal});continue e}if(s){e.info(`Retry ${l}: Retry strategy ${t.name} redirects to ${s}`),r.url=s;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(a)return n.info("None of the retry strategies could work with the received response. Returning it."),a}}}}function de(e={}){var t;return{name:"defaultRetryPolicy",sendRequest:pe([ce(),le(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3}).sendRequest}}var he=n(46882),fe=n.n(he);const ge="formDataPolicy";function me(){return{name:ge,async sendRequest(e,t){if(e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?(e.body=function(e){const t=new URLSearchParams;for(const[n,r]of Object.entries(e))if(Array.isArray(r))for(const e of r)t.append(n,e.toString());else t.append(n,r.toString());return t.toString()}(e.formData),e.formData=void 0):await async function(e,t){const n=new(fe());for(const t of Object.keys(e)){const r=e[t];if(Array.isArray(r))for(const e of r)n.append(t,e);else n.append(t,r)}t.body=n,t.formData=void 0;const r=t.headers.get("Content-Type");r&&-1!==r.indexOf("multipart/form-data")&&t.headers.set("Content-Type",`multipart/form-data; boundary=${n.getBoundary()}`);try{const e=await new Promise(((e,t)=>{n.getLength(((n,r)=>{n?t(n):e(r)}))}));t.headers.set("Content-Length",e)}catch(e){}}(e.formData,e)}return t(e)}}}var ve;const ye="undefined"!=typeof process&&Boolean(process.version)&&Boolean(null===(ve=process.versions)||void 0===ve?void 0:ve.node);var be=n(26018),Se=n(74476);const Ee="proxyPolicy",_e=[];let we=!1;const Te=new Map;function Ce(e){return process.env[e]?process.env[e]:process.env[e.toLowerCase()]?process.env[e.toLowerCase()]:void 0}function Pe(e){if(!e&&!(e=function(){if(!process)return;const e=Ce("HTTPS_PROXY"),t=Ce("ALL_PROXY"),n=Ce("HTTP_PROXY");return e||t||n}()))return;const t=new URL(e);return{host:(t.protocol?t.protocol+"//":"")+t.hostname,port:Number.parseInt(t.port||"80"),username:t.username,password:t.password}}function Ie(e,{headers:t,tlsSettings:n}){let r;try{r=new URL(e.host)}catch(t){throw new Error(`Expecting a valid host string in proxy settings, but found "${e.host}".`)}n&&A.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");const i={hostname:r.hostname,port:e.port,protocol:r.protocol,headers:t.toJSON()};return e.username&&e.password?i.auth=`${e.username}:${e.password}`:e.username&&(i.auth=`${e.username}`),i}function xe(e=Pe(),t){we||_e.push(...function(){const e=Ce("NO_PROXY");return we=!0,e?e.split(",").map((e=>e.trim())).filter((e=>e.length)):[]}());const n={};return{name:Ee,async sendRequest(r,i){var o;return r.proxySettings||function(e,t,n){if(0===t.length)return!1;const r=new URL(e).hostname;if(null==n?void 0:n.has(r))return n.get(r);let i=!1;for(const e of t)"."===e[0]?(r.endsWith(e)||r.length===e.length-1&&r===e.slice(1))&&(i=!0):r===e&&(i=!0);return null==n||n.set(r,i),i}(r.url,null!==(o=null==t?void 0:t.customNoProxyList)&&void 0!==o?o:_e,(null==t?void 0:t.customNoProxyList)?void 0:Te)||(r.proxySettings=e),r.proxySettings&&function(e,t){if(e.agent)return;const n="https:"!==new URL(e.url).protocol,r=e.proxySettings;if(r)if(n){if(!t.httpProxyAgent){const n=Ie(r,e);t.httpProxyAgent=new Se.HttpProxyAgent(n)}e.agent=t.httpProxyAgent}else{if(!t.httpsProxyAgent){const n=Ie(r,e);t.httpsProxyAgent=new be.HttpsProxyAgent(n)}e.agent=t.httpsProxyAgent}}(r,n),i(r)}}}const Oe="setClientRequestIdPolicy";function Re(e="x-ms-client-request-id"){return{name:Oe,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}const De="tlsPolicy";function Ae(e){return{name:De,sendRequest:async(t,n)=>(t.tlsSettings||(t.tlsSettings=e),n(t))}}const ke={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Ne(e={}){let t=new Me(e.parentContext);return e.span&&(t=t.setValue(ke.span,e.span)),e.namespace&&(t=t.setValue(ke.namespace,e.namespace)),t}class Me{constructor(e){this._contextMap=e instanceof Me?new Map(e._contextMap):new Map}setValue(e,t){const n=new Me(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new Me(this);return t._contextMap.delete(e),t}}let Le;function je(){return Le||(Le={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Ne({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),Le}function Fe(e){if(k(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function Ue(e){if(Fe(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}const Ve=a.inspect.custom,He=new j;class Be extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,Be.prototype)}[Ve](){return`RestError: ${this.message} \n ${He.sanitize(this)}`}}function We(e){return e instanceof Be||Fe(e)&&"RestError"===e.name}Be.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",Be.PARSE_ERROR="PARSE_ERROR";const qe="tracingPolicy";function $e(e={}){const t=$(e.userAgentPrefix),n=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:r}=e;function i(e,i,o){var s;const a=je().startSpan(e,Object.assign(Object.assign({},o),{packageName:n,packageVersion:r,tracingContext:null===(s=null==i?void 0:i.tracingOptions)||void 0===s?void 0:s.tracingContext}));let c=a.tracingContext;const l=a.span;return c.getValue(ke.namespace)||(c=c.setValue(ke.namespace,t)),l.setAttribute("az.namespace",c.getValue(ke.namespace)),{span:l,updatedOptions:Object.assign({},i,{tracingOptions:Object.assign(Object.assign({},null==i?void 0:i.tracingOptions),{tracingContext:c})})}}function o(e,t,...n){return je().withContext(e,t,...n)}return{startSpan:i,withSpan:async function(e,t,n,r){const{span:s,updatedOptions:a}=i(e,t,r);try{const e=await o(a.tracingOptions.tracingContext,(()=>Promise.resolve(n(a,s))));return s.setStatus({status:"success"}),e}catch(e){throw s.setStatus({status:"error",error:e}),e}finally{s.end()}},withContext:o,parseTraceparentHeader:function(e){return je().parseTraceparentHeader(e)},createRequestHeaders:function(e){return je().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:q})}catch(e){return void A.warning(`Error when creating the TracingClient: ${Ue(e)}`)}}();return{name:qe,async sendRequest(e,r){var i,o;if(!n||!(null===(i=e.tracingOptions)||void 0===i?void 0:i.tracingContext))return r(e);const{span:s,tracingContext:a}=null!==(o=function(e,t,n){try{const{span:r,updatedOptions:i}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":t.method,"http.url":t.url,requestId:t.requestId}});if(!r.isRecording())return void r.end();n&&r.setAttribute("http.user_agent",n);const o=e.createRequestHeaders(i.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(e){return void A.warning(`Skipping creating a tracing span due to an error: ${Ue(e)}`)}}(n,e,t))&&void 0!==o?o:{};if(!s||!a)return r(e);try{const t=await n.withContext(a,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){A.warning(`Skipping tracing span processing due to an error: ${Ue(e)}`)}}(s,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:Fe(t)?t:void 0}),We(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(e){A.warning(`Skipping tracing span processing due to an error: ${Ue(e)}`)}}(s,e),e}}}}function Ge(e){const t=o();return ye&&(e.tlsOptions&&t.addPolicy(Ae(e.tlsOptions)),t.addPolicy(xe(e.proxyOptions)),t.addPolicy(J())),t.addPolicy(me()),t.addPolicy(z(e.userAgentOptions)),t.addPolicy(Re()),t.addPolicy(de(e.retryOptions),{phase:"Retry"}),t.addPolicy($e(e.userAgentOptions),{afterPhase:"Retry"}),ye&&t.addPolicy(B(e.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(U(e.loggingOptions),{afterPhase:"Sign"}),t}var Ke=n(13685),ze=n(95687),Ye=n(59796),Je=n(12781);function Xe(e){return e.toLowerCase()}class Qe{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Xe(e),{name:e,value:String(t)})}get(e){var t;return null===(t=this._headersMap.get(Xe(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(Xe(e))}delete(e){this._headersMap.delete(Xe(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function Ze(e){return new Qe(e)}const et={};function tt(e){return e&&"function"==typeof e.pipe}function nt(e){return new Promise((t=>{e.on("close",t),e.on("end",t),e.on("error",t)}))}function rt(e){return e&&"number"==typeof e.byteLength}class it extends Je.Transform{constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}_transform(e,t,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(e){n(e)}}}class ot{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,n,r;const i=new ne;let o;if(e.abortSignal){if(e.abortSignal.aborted)throw new te("The operation was aborted.");o=e=>{"abort"===e.type&&i.abort()},e.abortSignal.addEventListener("abort",o)}e.timeout>0&&setTimeout((()=>{i.abort()}),e.timeout);const s=e.headers.get("Accept-Encoding"),a=(null==s?void 0:s.includes("gzip"))||(null==s?void 0:s.includes("deflate"));let c,l="function"==typeof e.body?e.body():e.body;if(l&&!e.headers.has("Content-Length")){const t=function(e){return e?Buffer.isBuffer(e)?e.length:tt(e)?null:rt(e)?e.byteLength:"string"==typeof e?Buffer.from(e).length:null:0}(l);null!==t&&e.headers.set("Content-Length",t)}try{if(l&&e.onUploadProgress){const t=e.onUploadProgress,n=new it(t);n.on("error",(e=>{A.error("Error in upload progress",e)})),tt(l)?l.pipe(n):n.end(l),l=n}const s=await this.makeRequest(e,i,l),p=function(e){const t=Ze();for(const n of Object.keys(e.headers)){const r=e.headers[n];Array.isArray(r)?r.length>0&&t.set(n,r[0]):r&&t.set(n,r)}return t}(s),d={status:null!==(t=s.statusCode)&&void 0!==t?t:0,headers:p,request:e};if("HEAD"===e.method)return s.resume(),d;c=a?function(e,t){const n=t.get("Content-Encoding");if("gzip"===n){const t=Ye.createGunzip();return e.pipe(t),t}if("deflate"===n){const t=Ye.createInflate();return e.pipe(t),t}return e}(s,p):s;const h=e.onDownloadProgress;if(h){const e=new it(h);e.on("error",(e=>{A.error("Error in download progress",e)})),c.pipe(e),c=e}return(null===(n=e.streamResponseStatusCodes)||void 0===n?void 0:n.has(Number.POSITIVE_INFINITY))||(null===(r=e.streamResponseStatusCodes)||void 0===r?void 0:r.has(d.status))?d.readableStreamBody=c:d.bodyAsText=await(u=c,new Promise(((e,t)=>{const n=[];u.on("data",(e=>{Buffer.isBuffer(e)?n.push(e):n.push(Buffer.from(e))})),u.on("end",(()=>{e(Buffer.concat(n).toString("utf8"))})),u.on("error",(e=>{e&&"AbortError"===(null==e?void 0:e.name)?t(e):t(new Be(`Error reading response as text: ${e.message}`,{code:Be.PARSE_ERROR}))}))}))),d}finally{if(e.abortSignal&&o){let t=Promise.resolve();tt(l)&&(t=nt(l));let n=Promise.resolve();tt(c)&&(n=nt(c)),Promise.all([t,n]).then((()=>{var t;o&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",o))})).catch((e=>{A.warning("Error when cleaning up abortListener on httpRequest",e)}))}}var u}makeRequest(e,t,n){var r;const i=new URL(e.url),o="https:"!==i.protocol;if(o&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);const s={agent:null!==(r=e.agent)&&void 0!==r?r:this.getOrCreateAgent(e,o),hostname:i.hostname,path:`${i.pathname}${i.search}`,port:i.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise(((r,i)=>{const a=o?Ke.request(s,r):ze.request(s,r);a.once("error",(t=>{var n;i(new Be(t.message,{code:null!==(n=t.code)&&void 0!==n?n:Be.REQUEST_SEND_ERROR,request:e}))})),t.signal.addEventListener("abort",(()=>{const e=new te("The operation was aborted.");a.destroy(e),i(e)})),n&&tt(n)?n.pipe(a):n?"string"==typeof n||Buffer.isBuffer(n)?a.end(n):rt(n)?a.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(A.error("Unrecognized body type",n),i(new Be("Unrecognized body type"))):a.end()}))}getOrCreateAgent(e,t){var n;const r=e.disableKeepAlive;if(t)return r?Ke.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new Ke.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(r&&!e.tlsSettings)return ze.globalAgent;const t=null!==(n=e.tlsSettings)&&void 0!==n?n:et;let i=this.cachedHttpsAgents.get(t);return i&&i.options.keepAlive===!r||(A.info("No cached TLS Agent exist, creating a new Agent"),i=new ze.Agent(Object.assign({keepAlive:!r},t)),this.cachedHttpsAgents.set(t,i)),i}}}function st(){return new ot}var at,ct=n(6113);const lt="function"==typeof(null===(at=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===at?void 0:at.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):ct.randomUUID;class ut{constructor(e){var t,n,r,i,o,s,a;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:Ze(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(r=e.timeout)&&void 0!==r?r:0,this.formData=e.formData,this.disableKeepAlive=null!==(i=e.disableKeepAlive)&&void 0!==i&&i,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||lt(),this.allowInsecureConnection=null!==(s=e.allowInsecureConnection)&&void 0!==s&&s,this.enableBrowserStreams=null!==(a=e.enableBrowserStreams)&&void 0!==a&&a}}function pt(e){return new ut(e)}const dt="exponentialRetryPolicy";function ht(e={}){var t;return pe([le(Object.assign(Object.assign({},e),{ignoreSystemErrors:!0}))],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3})}const ft="systemErrorRetryPolicy";function gt(e={}){var t;return{name:ft,sendRequest:pe([le(Object.assign(Object.assign({},e),{ignoreHttpStatusCodes:!0}))],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3}).sendRequest}}const mt="throttlingRetryPolicy";function vt(e={}){var t;return{name:mt,sendRequest:pe([ce()],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:3}).sendRequest}}const yt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};const bt="bearerTokenAuthenticationPolicy";async function St(e){const{scopes:t,getAccessToken:n,request:r}=e,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},o=await n(t,i);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function Et(e){var t;const{credential:n,scopes:r,challengeCallbacks:i}=e,o=e.logger||A,s=Object.assign({authorizeRequest:null!==(t=null==i?void 0:i.authorizeRequest)&&void 0!==t?t:St,authorizeRequestOnChallenge:null==i?void 0:i.authorizeRequestOnChallenge},i),a=n?function(e,t){let n,r=null,i=null;const o=Object.assign(Object.assign({},yt),t),s={get isRefreshing(){return null!==r},get shouldRefresh(){var e;return!s.isRefreshing&&(null!==(e=null==i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function a(t,a){var c;return s.isRefreshing||(r=async function(e,t,n){async function r(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let i=await r();for(;null===i;)await re(t),i=await r();return i}((()=>e.getToken(t,a)),o.retryIntervalInMs,null!==(c=null==i?void 0:i.expiresOnTimestamp)&&void 0!==c?c:Date.now()).then((e=>(r=null,i=e,n=a.tenantId,i))).catch((e=>{throw r=null,i=null,n=void 0,e}))),r}return async(e,t)=>n!==t.tenantId||Boolean(t.claims)||s.mustRefresh?a(e,t):(s.shouldRefresh&&a(e,t),i)}(n):()=>Promise.resolve(null);return{name:bt,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,i;await s.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:a,logger:o});try{n=await t(e)}catch(e){i=e,n=e.response}if(s.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)&&await s.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:a,logger:o}))return t(e);if(i)throw i;return n}}}const _t="ndJsonPolicy";function wt(){return{name:_t,async sendRequest(e,t){if("string"==typeof e.body&&e.body.startsWith("[")){const t=JSON.parse(e.body);Array.isArray(t)&&(e.body=t.map((e=>JSON.stringify(e)+"\n")).join(""))}return t(e)}}}},65521:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,{signal:n}={}){return new Promise(((r,i)=>{function o(){null==n||n.removeEventListener("abort",o),e.removeListener(t,s),e.removeListener("error",a)}function s(...e){o(),r(e)}function a(e){o(),i(e)}null==n||n.addEventListener("abort",o),e.on(t,s),e.on("error",a)}))}},21961:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(77166)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},77166:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,s=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];n=o.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(57824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},73086:(e,t,n)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(21961):e.exports=n(86538)},86538:(e,t,n)=>{const r=n(76224),i=n(73837);t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(i.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${r} [0m`;n[0]=o+n[0].split("\n").join("\n"+o),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=n(92130);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=n(77166)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},88192:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(41808)),s=i(n(24404)),a=i(n(57310)),c=i(n(73086)),l=i(n(65521)),u=n(88054),p=(0,c.default)("http-proxy-agent");class d extends u.Agent{constructor(e){let t;if(t="string"==typeof e?a.default.parse(e):e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");p("Creating new HttpProxyAgent instance: %o",t),super(t);const n=Object.assign({},t);var r;this.secureProxy=t.secureProxy||"string"==typeof(r=n.protocol)&&/^https:?$/i.test(r),n.host=n.hostname||n.host,"string"==typeof n.port&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,t){return r(this,void 0,void 0,(function*(){const{proxy:n,secureProxy:r}=this,i=a.default.parse(e.path);let c;if(i.protocol||(i.protocol="http:"),i.hostname||(i.hostname=t.hostname||t.host||null),null==i.port&&(t.port,1)&&(i.port=String(t.port)),"80"===i.port&&(i.port=""),e.path=a.default.format(i),n.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(n.auth).toString("base64")}`),r?(p("Creating `tls.Socket`: %o",n),c=s.default.connect(n)):(p("Creating `net.Socket`: %o",n),c=o.default.connect(n)),e._header){let t,n;p("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?(p("Patching connection write() output buffer with updated header"),t=e.output[0],n=t.indexOf("\r\n\r\n")+4,e.output[0]=e._header+t.substring(n),p("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&(p("Patching connection write() output buffer with updated header"),t=e.outputData[0].data,n=t.indexOf("\r\n\r\n")+4,e.outputData[0].data=e._header+t.substring(n),p("Output buffer: %o",e.outputData[0].data))}return yield(0,l.default)(c,"connect"),c}))}}t.default=d},74476:function(e,t,n){"use strict";const r=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(n(88192));function i(e){return new r.default(e)}!function(e){e.HttpProxyAgent=r.default,e.prototype=r.default.prototype}(i||(i={})),e.exports=i},98925:(e,t,n)=>{"use strict";const r=n(98633),i=global.Date;class o extends i{constructor(e){super(e),this.isDate=!0}toISOString(){return`${this.getUTCFullYear()}-${r(2,this.getUTCMonth()+1)}-${r(2,this.getUTCDate())}`}}e.exports=e=>{const t=new o(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},86595:(e,t,n)=>{"use strict";const r=n(98633);class i extends Date{constructor(e){super(e+"Z"),this.isFloating=!0}toISOString(){return`${this.getUTCFullYear()}-${r(2,this.getUTCMonth()+1)}-${r(2,this.getUTCDate())}T${r(2,this.getUTCHours())}:${r(2,this.getUTCMinutes())}:${r(2,this.getUTCSeconds())}.${r(3,this.getUTCMilliseconds())}`}}e.exports=e=>{const t=new i(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},76114:e=>{"use strict";e.exports=e=>{const t=new Date(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},99439:(e,t,n)=>{"use strict";const r=n(98633);class i extends Date{constructor(e){super(`0000-01-01T${e}Z`),this.isTime=!0}toISOString(){return`${r(2,this.getUTCHours())}:${r(2,this.getUTCMinutes())}:${r(2,this.getUTCSeconds())}.${r(3,this.getUTCMilliseconds())}`}}e.exports=e=>{const t=new i(e);if(isNaN(t))throw new TypeError("Invalid Datetime");return t}},98633:e=>{"use strict";e.exports=(e,t)=>{for(t=String(t);t.length<e;)t="0"+t;return t}},98818:e=>{"use strict";const t=1114112;class n extends Error{constructor(e,t,r){super("[ParserError] "+e,t,r),this.name="ParserError",this.code="ParserError",Error.captureStackTrace&&Error.captureStackTrace(this,n)}}class r{constructor(e){this.parser=e,this.buf="",this.returned=null,this.result=null,this.resultTable=null,this.resultArr=null}}class i{constructor(){this.pos=0,this.col=0,this.line=0,this.obj={},this.ctx=this.obj,this.stack=[],this._buf="",this.char=null,this.ii=0,this.state=new r(this.parseStart)}parse(e){if(0===e.length||null==e.length)return;let t;for(this._buf=String(e),this.ii=-1,this.char=-1;!1===t||this.nextChar();)t=this.runOne();this._buf=null}nextChar(){return 10===this.char&&(++this.line,this.col=-1),++this.ii,this.char=this._buf.codePointAt(this.ii),++this.pos,++this.col,this.haveBuffer()}haveBuffer(){return this.ii<this._buf.length}runOne(){return this.state.parser.call(this,this.state.returned)}finish(){let e;this.char=t;do{e=this.state.parser,this.runOne()}while(this.state.parser!==e);return this.ctx=null,this.state=null,this._buf=null,this.obj}next(e){if("function"!=typeof e)throw new n("Tried to set state to non-existent state: "+JSON.stringify(e));this.state.parser=e}goto(e){return this.next(e),this.runOne()}call(e,t){t&&this.next(t),this.stack.push(this.state),this.state=new r(e)}callNow(e,t){return this.call(e,t),this.runOne()}return(e){if(0===this.stack.length)throw this.error(new n("Stack underflow"));void 0===e&&(e=this.state.buf),this.state=this.stack.pop(),this.state.returned=e}returnNow(e){return this.return(e),this.runOne()}consume(){if(this.char===t)throw this.error(new n("Unexpected end-of-buffer"));this.state.buf+=this._buf[this.ii]}error(e){return e.line=this.line,e.col=this.col,e.pos=this.pos,e}parseStart(){throw new n("Must declare a parseStart method")}}i.END=t,i.Error=n,e.exports=i},8676:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=makeParserClass(__webpack_require__(98818)),module.exports.makeParserClass=makeParserClass;class TomlError extends Error{constructor(e){super(e),this.name="TomlError",Error.captureStackTrace&&Error.captureStackTrace(this,TomlError),this.fromTOML=!0,this.wrapped=null}}TomlError.wrap=e=>{const t=new TomlError(e.message);return t.code=e.code,t.wrapped=e,t},module.exports.TomlError=TomlError;const createDateTime=__webpack_require__(76114),createDateTimeFloat=__webpack_require__(86595),createDate=__webpack_require__(98925),createTime=__webpack_require__(99439),CTRL_I=9,CTRL_J=10,CTRL_M=13,CTRL_CHAR_BOUNDARY=31,CHAR_SP=32,CHAR_QUOT=34,CHAR_NUM=35,CHAR_APOS=39,CHAR_PLUS=43,CHAR_COMMA=44,CHAR_HYPHEN=45,CHAR_PERIOD=46,CHAR_0=48,CHAR_1=49,CHAR_7=55,CHAR_9=57,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_A=65,CHAR_E=69,CHAR_F=70,CHAR_T=84,CHAR_U=85,CHAR_Z=90,CHAR_LOWBAR=95,CHAR_a=97,CHAR_b=98,CHAR_e=101,CHAR_f=102,CHAR_i=105,CHAR_l=108,CHAR_n=110,CHAR_o=111,CHAR_r=114,CHAR_s=115,CHAR_t=116,CHAR_u=117,CHAR_x=120,CHAR_z=122,CHAR_LCUB=123,CHAR_RCUB=125,CHAR_LSQB=91,CHAR_BSOL=92,CHAR_RSQB=93,CHAR_DEL=127,SURROGATE_FIRST=55296,SURROGATE_LAST=57343,escapes={[CHAR_b]:"\b",[CHAR_t]:"\t",[CHAR_n]:"\n",[CHAR_f]:"\f",[CHAR_r]:"\r",[CHAR_QUOT]:'"',[CHAR_BSOL]:"\\"};function isDigit(e){return e>=CHAR_0&&e<=CHAR_9}function isHexit(e){return e>=CHAR_A&&e<=CHAR_F||e>=CHAR_a&&e<=CHAR_f||e>=CHAR_0&&e<=CHAR_9}function isBit(e){return e===CHAR_1||e===CHAR_0}function isOctit(e){return e>=CHAR_0&&e<=CHAR_7}function isAlphaNumQuoteHyphen(e){return e>=CHAR_A&&e<=CHAR_Z||e>=CHAR_a&&e<=CHAR_z||e>=CHAR_0&&e<=CHAR_9||e===CHAR_APOS||e===CHAR_QUOT||e===CHAR_LOWBAR||e===CHAR_HYPHEN}function isAlphaNumHyphen(e){return e>=CHAR_A&&e<=CHAR_Z||e>=CHAR_a&&e<=CHAR_z||e>=CHAR_0&&e<=CHAR_9||e===CHAR_LOWBAR||e===CHAR_HYPHEN}const _type=Symbol("type"),_declared=Symbol("declared"),hasOwnProperty=Object.prototype.hasOwnProperty,defineProperty=Object.defineProperty,descriptor={configurable:!0,enumerable:!0,writable:!0,value:void 0};function hasKey(e,t){return!!hasOwnProperty.call(e,t)||("__proto__"===t&&defineProperty(e,"__proto__",descriptor),!1)}const INLINE_TABLE=Symbol("inline-table");function InlineTable(){return Object.defineProperties({},{[_type]:{value:INLINE_TABLE}})}function isInlineTable(e){return null!==e&&"object"==typeof e&&e[_type]===INLINE_TABLE}const TABLE=Symbol("table");function Table(){return Object.defineProperties({},{[_type]:{value:TABLE},[_declared]:{value:!1,writable:!0}})}function isTable(e){return null!==e&&"object"==typeof e&&e[_type]===TABLE}const _contentType=Symbol("content-type"),INLINE_LIST=Symbol("inline-list");function InlineList(e){return Object.defineProperties([],{[_type]:{value:INLINE_LIST},[_contentType]:{value:e}})}function isInlineList(e){return null!==e&&"object"==typeof e&&e[_type]===INLINE_LIST}const LIST=Symbol("list");function List(){return Object.defineProperties([],{[_type]:{value:LIST}})}function isList(e){return null!==e&&"object"==typeof e&&e[_type]===LIST}let _custom;try{const utilInspect=eval("require('util').inspect");_custom=utilInspect.custom}catch(e){}const _inspect=_custom||"inspect";class BoxedBigInt{constructor(e){try{this.value=global.BigInt.asIntN(64,e)}catch(e){this.value=null}Object.defineProperty(this,_type,{value:INTEGER})}isNaN(){return null===this.value}toString(){return String(this.value)}[_inspect](){return`[BigInt: ${this.toString()}]}`}valueOf(){return this.value}}const INTEGER=Symbol("integer");function Integer(e){let t=Number(e);return Object.is(t,-0)&&(t=0),global.BigInt&&!Number.isSafeInteger(t)?new BoxedBigInt(e):Object.defineProperties(new Number(t),{isNaN:{value:function(){return isNaN(this)}},[_type]:{value:INTEGER},[_inspect]:{value:()=>`[Integer: ${e}]`}})}function isInteger(e){return null!==e&&"object"==typeof e&&e[_type]===INTEGER}const FLOAT=Symbol("float");function Float(e){return Object.defineProperties(new Number(e),{[_type]:{value:FLOAT},[_inspect]:{value:()=>`[Float: ${e}]`}})}function isFloat(e){return null!==e&&"object"==typeof e&&e[_type]===FLOAT}function tomlType(e){const t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Date)return"datetime";if(_type in e)switch(e[_type]){case INLINE_TABLE:return"inline-table";case INLINE_LIST:return"inline-list";case TABLE:return"table";case LIST:return"list";case FLOAT:return"float";case INTEGER:return"integer"}}return t}function makeParserClass(e){return class extends e{constructor(){super(),this.ctx=this.obj=Table()}atEndOfWord(){return this.char===CHAR_NUM||this.char===CTRL_I||this.char===CHAR_SP||this.atEndOfLine()}atEndOfLine(){return this.char===e.END||this.char===CTRL_J||this.char===CTRL_M}parseStart(){if(this.char===e.END)return null;if(this.char===CHAR_LSQB)return this.call(this.parseTableOrList);if(this.char===CHAR_NUM)return this.call(this.parseComment);if(this.char===CTRL_J||this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M)return null;if(isAlphaNumQuoteHyphen(this.char))return this.callNow(this.parseAssignStatement);throw this.error(new TomlError(`Unknown character "${this.char}"`))}parseWhitespaceToEOL(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M)return null;if(this.char===CHAR_NUM)return this.goto(this.parseComment);if(this.char===e.END||this.char===CTRL_J)return this.return();throw this.error(new TomlError("Unexpected character, expected only whitespace or comments till end of line"))}parseAssignStatement(){return this.callNow(this.parseAssign,this.recordAssignStatement)}recordAssignStatement(e){let t=this.ctx,n=e.key.pop();for(let n of e.key){if(hasKey(t,n)&&(!isTable(t[n])||t[n][_declared]))throw this.error(new TomlError("Can't redefine existing key"));t=t[n]=t[n]||Table()}if(hasKey(t,n))throw this.error(new TomlError("Can't redefine existing key"));return isInteger(e.value)||isFloat(e.value)?t[n]=e.value.valueOf():t[n]=e.value,this.goto(this.parseWhitespaceToEOL)}parseAssign(){return this.callNow(this.parseKeyword,this.recordAssignKeyword)}recordAssignKeyword(e){return this.state.resultTable?this.state.resultTable.push(e):this.state.resultTable=[e],this.goto(this.parseAssignKeywordPreDot)}parseAssignKeywordPreDot(){return this.char===CHAR_PERIOD?this.next(this.parseAssignKeywordPostDot):this.char!==CHAR_SP&&this.char!==CTRL_I?this.goto(this.parseAssignEqual):void 0}parseAssignKeywordPostDot(){if(this.char!==CHAR_SP&&this.char!==CTRL_I)return this.callNow(this.parseKeyword,this.recordAssignKeyword)}parseAssignEqual(){if(this.char===CHAR_EQUALS)return this.next(this.parseAssignPreValue);throw this.error(new TomlError('Invalid character, expected "="'))}parseAssignPreValue(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseValue,this.recordAssignValue)}recordAssignValue(e){return this.returnNow({key:this.state.resultTable,value:e})}parseComment(){do{if(this.char===e.END||this.char===CTRL_J)return this.return()}while(this.nextChar())}parseTableOrList(){if(this.char!==CHAR_LSQB)return this.goto(this.parseTable);this.next(this.parseList)}parseTable(){return this.ctx=this.obj,this.goto(this.parseTableNext)}parseTableNext(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseKeyword,this.parseTableMore)}parseTableMore(e){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CHAR_RSQB){if(hasKey(this.ctx,e)&&(!isTable(this.ctx[e])||this.ctx[e][_declared]))throw this.error(new TomlError("Can't redefine existing key"));return this.ctx=this.ctx[e]=this.ctx[e]||Table(),this.ctx[_declared]=!0,this.next(this.parseWhitespaceToEOL)}if(this.char===CHAR_PERIOD){if(hasKey(this.ctx,e))if(isTable(this.ctx[e]))this.ctx=this.ctx[e];else{if(!isList(this.ctx[e]))throw this.error(new TomlError("Can't redefine existing key"));this.ctx=this.ctx[e][this.ctx[e].length-1]}else this.ctx=this.ctx[e]=Table();return this.next(this.parseTableNext)}throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseList(){return this.ctx=this.obj,this.goto(this.parseListNext)}parseListNext(){return this.char===CHAR_SP||this.char===CTRL_I?null:this.callNow(this.parseKeyword,this.parseListMore)}parseListMore(e){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CHAR_RSQB){if(hasKey(this.ctx,e)||(this.ctx[e]=List()),isInlineList(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline array"));if(!isList(this.ctx[e]))throw this.error(new TomlError("Can't redefine an existing key"));{const t=Table();this.ctx[e].push(t),this.ctx=t}return this.next(this.parseListEnd)}if(this.char===CHAR_PERIOD){if(hasKey(this.ctx,e)){if(isInlineList(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline array"));if(isInlineTable(this.ctx[e]))throw this.error(new TomlError("Can't extend an inline table"));if(isList(this.ctx[e]))this.ctx=this.ctx[e][this.ctx[e].length-1];else{if(!isTable(this.ctx[e]))throw this.error(new TomlError("Can't redefine an existing key"));this.ctx=this.ctx[e]}}else this.ctx=this.ctx[e]=Table();return this.next(this.parseListNext)}throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseListEnd(e){if(this.char===CHAR_RSQB)return this.next(this.parseWhitespaceToEOL);throw this.error(new TomlError("Unexpected character, expected whitespace, . or ]"))}parseValue(){if(this.char===e.END)throw this.error(new TomlError("Key without value"));if(this.char===CHAR_QUOT)return this.next(this.parseDoubleString);if(this.char===CHAR_APOS)return this.next(this.parseSingleString);if(this.char===CHAR_HYPHEN||this.char===CHAR_PLUS)return this.goto(this.parseNumberSign);if(this.char===CHAR_i)return this.next(this.parseInf);if(this.char===CHAR_n)return this.next(this.parseNan);if(isDigit(this.char))return this.goto(this.parseNumberOrDateTime);if(this.char===CHAR_t||this.char===CHAR_f)return this.goto(this.parseBoolean);if(this.char===CHAR_LSQB)return this.call(this.parseInlineList,this.recordValue);if(this.char===CHAR_LCUB)return this.call(this.parseInlineTable,this.recordValue);throw this.error(new TomlError("Unexpected character, expecting string, number, datetime, boolean, inline array or inline table"))}recordValue(e){return this.returnNow(e)}parseInf(){if(this.char===CHAR_n)return this.next(this.parseInf2);throw this.error(new TomlError('Unexpected character, expected "inf", "+inf" or "-inf"'))}parseInf2(){if(this.char===CHAR_f)return"-"===this.state.buf?this.return(-1/0):this.return(1/0);throw this.error(new TomlError('Unexpected character, expected "inf", "+inf" or "-inf"'))}parseNan(){if(this.char===CHAR_a)return this.next(this.parseNan2);throw this.error(new TomlError('Unexpected character, expected "nan"'))}parseNan2(){if(this.char===CHAR_n)return this.return(NaN);throw this.error(new TomlError('Unexpected character, expected "nan"'))}parseKeyword(){return this.char===CHAR_QUOT?this.next(this.parseBasicString):this.char===CHAR_APOS?this.next(this.parseLiteralString):this.goto(this.parseBareKey)}parseBareKey(){do{if(this.char===e.END)throw this.error(new TomlError("Key ended without value"));if(!isAlphaNumHyphen(this.char)){if(0===this.state.buf.length)throw this.error(new TomlError("Empty bare keys are not allowed"));return this.returnNow()}this.consume()}while(this.nextChar())}parseSingleString(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiStringMaybe):this.goto(this.parseLiteralString)}parseLiteralString(){do{if(this.char===CHAR_APOS)return this.return();if(this.atEndOfLine())throw this.error(new TomlError("Unterminated string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}parseLiteralMultiStringMaybe(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiString):this.returnNow()}parseLiteralMultiString(){return this.char===CTRL_M?null:this.char===CTRL_J?this.next(this.parseLiteralMultiStringContent):this.goto(this.parseLiteralMultiStringContent)}parseLiteralMultiStringContent(){do{if(this.char===CHAR_APOS)return this.next(this.parseLiteralMultiEnd);if(this.char===e.END)throw this.error(new TomlError("Unterminated multi-line string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I&&this.char!==CTRL_J&&this.char!==CTRL_M)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}parseLiteralMultiEnd(){return this.char===CHAR_APOS?this.next(this.parseLiteralMultiEnd2):(this.state.buf+="'",this.goto(this.parseLiteralMultiStringContent))}parseLiteralMultiEnd2(){return this.char===CHAR_APOS?this.return():(this.state.buf+="''",this.goto(this.parseLiteralMultiStringContent))}parseDoubleString(){return this.char===CHAR_QUOT?this.next(this.parseMultiStringMaybe):this.goto(this.parseBasicString)}parseBasicString(){do{if(this.char===CHAR_BSOL)return this.call(this.parseEscape,this.recordEscapeReplacement);if(this.char===CHAR_QUOT)return this.return();if(this.atEndOfLine())throw this.error(new TomlError("Unterminated string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}recordEscapeReplacement(e){return this.state.buf+=e,this.goto(this.parseBasicString)}parseMultiStringMaybe(){return this.char===CHAR_QUOT?this.next(this.parseMultiString):this.returnNow()}parseMultiString(){return this.char===CTRL_M?null:this.char===CTRL_J?this.next(this.parseMultiStringContent):this.goto(this.parseMultiStringContent)}parseMultiStringContent(){do{if(this.char===CHAR_BSOL)return this.call(this.parseMultiEscape,this.recordMultiEscapeReplacement);if(this.char===CHAR_QUOT)return this.next(this.parseMultiEnd);if(this.char===e.END)throw this.error(new TomlError("Unterminated multi-line string"));if(this.char===CHAR_DEL||this.char<=CTRL_CHAR_BOUNDARY&&this.char!==CTRL_I&&this.char!==CTRL_J&&this.char!==CTRL_M)throw this.errorControlCharInString();this.consume()}while(this.nextChar())}errorControlCharInString(){let e="\\u00";return this.char<16&&(e+="0"),e+=this.char.toString(16),this.error(new TomlError(`Control characters (codes < 0x1f and 0x7f) are not allowed in strings, use ${e} instead`))}recordMultiEscapeReplacement(e){return this.state.buf+=e,this.goto(this.parseMultiStringContent)}parseMultiEnd(){return this.char===CHAR_QUOT?this.next(this.parseMultiEnd2):(this.state.buf+='"',this.goto(this.parseMultiStringContent))}parseMultiEnd2(){return this.char===CHAR_QUOT?this.return():(this.state.buf+='""',this.goto(this.parseMultiStringContent))}parseMultiEscape(){return this.char===CTRL_M||this.char===CTRL_J?this.next(this.parseMultiTrim):this.char===CHAR_SP||this.char===CTRL_I?this.next(this.parsePreMultiTrim):this.goto(this.parseEscape)}parsePreMultiTrim(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===CTRL_M||this.char===CTRL_J)return this.next(this.parseMultiTrim);throw this.error(new TomlError("Can't escape whitespace"))}parseMultiTrim(){return this.char===CTRL_J||this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M?null:this.returnNow()}parseEscape(){if(this.char in escapes)return this.return(escapes[this.char]);if(this.char===CHAR_u)return this.call(this.parseSmallUnicode,this.parseUnicodeReturn);if(this.char===CHAR_U)return this.call(this.parseLargeUnicode,this.parseUnicodeReturn);throw this.error(new TomlError("Unknown escape character: "+this.char))}parseUnicodeReturn(e){try{const t=parseInt(e,16);if(t>=SURROGATE_FIRST&&t<=SURROGATE_LAST)throw this.error(new TomlError("Invalid unicode, character in range 0xD800 - 0xDFFF is reserved"));return this.returnNow(String.fromCodePoint(t))}catch(e){throw this.error(TomlError.wrap(e))}}parseSmallUnicode(){if(!isHexit(this.char))throw this.error(new TomlError("Invalid character in unicode sequence, expected hex"));if(this.consume(),this.state.buf.length>=4)return this.return()}parseLargeUnicode(){if(!isHexit(this.char))throw this.error(new TomlError("Invalid character in unicode sequence, expected hex"));if(this.consume(),this.state.buf.length>=8)return this.return()}parseNumberSign(){return this.consume(),this.next(this.parseMaybeSignedInfOrNan)}parseMaybeSignedInfOrNan(){return this.char===CHAR_i?this.next(this.parseInf):this.char===CHAR_n?this.next(this.parseNan):this.callNow(this.parseNoUnder,this.parseNumberIntegerStart)}parseNumberIntegerStart(){return this.char===CHAR_0?(this.consume(),this.next(this.parseNumberIntegerExponentOrDecimal)):this.goto(this.parseNumberInteger)}parseNumberIntegerExponentOrDecimal(){return this.char===CHAR_PERIOD?(this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat)):this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.returnNow(Integer(this.state.buf))}parseNumberInteger(){if(!isDigit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnder);if(this.char===CHAR_E||this.char===CHAR_e)return this.consume(),this.next(this.parseNumberExponentSign);if(this.char===CHAR_PERIOD)return this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseNoUnder(){if(this.char===CHAR_LOWBAR||this.char===CHAR_PERIOD||this.char===CHAR_E||this.char===CHAR_e)throw this.error(new TomlError("Unexpected character, expected digit"));if(this.atEndOfWord())throw this.error(new TomlError("Incomplete number"));return this.returnNow()}parseNoUnderHexOctBinLiteral(){if(this.char===CHAR_LOWBAR||this.char===CHAR_PERIOD)throw this.error(new TomlError("Unexpected character, expected digit"));if(this.atEndOfWord())throw this.error(new TomlError("Incomplete number"));return this.returnNow()}parseNumberFloat(){return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder,this.parseNumberFloat):isDigit(this.char)?void this.consume():this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.returnNow(Float(this.state.buf))}parseNumberExponentSign(){if(isDigit(this.char))return this.goto(this.parseNumberExponent);if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS)throw this.error(new TomlError("Unexpected character, expected -, + or digit"));this.consume(),this.call(this.parseNoUnder,this.parseNumberExponent)}parseNumberExponent(){if(!isDigit(this.char))return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder):this.returnNow(Float(this.state.buf));this.consume()}parseNumberOrDateTime(){return this.char===CHAR_0?(this.consume(),this.next(this.parseNumberBaseOrDateTime)):this.goto(this.parseNumberOrDateTimeOnly)}parseNumberOrDateTimeOnly(){return this.char===CHAR_LOWBAR?this.call(this.parseNoUnder,this.parseNumberInteger):isDigit(this.char)?(this.consume(),void(this.state.buf.length>4&&this.next(this.parseNumberInteger))):this.char===CHAR_E||this.char===CHAR_e?(this.consume(),this.next(this.parseNumberExponentSign)):this.char===CHAR_PERIOD?(this.consume(),this.call(this.parseNoUnder,this.parseNumberFloat)):this.char===CHAR_HYPHEN?this.goto(this.parseDateTime):this.char===CHAR_COLON?this.goto(this.parseOnlyTimeHour):this.returnNow(Integer(this.state.buf))}parseDateTimeOnly(){if(this.state.buf.length<4){if(isDigit(this.char))return this.consume();if(this.char===CHAR_COLON)return this.goto(this.parseOnlyTimeHour);throw this.error(new TomlError("Expected digit while parsing year part of a date"))}if(this.char===CHAR_HYPHEN)return this.goto(this.parseDateTime);throw this.error(new TomlError("Expected hyphen (-) while parsing year part of date"))}parseNumberBaseOrDateTime(){return this.char===CHAR_b?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerBin)):this.char===CHAR_o?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerOct)):this.char===CHAR_x?(this.consume(),this.call(this.parseNoUnderHexOctBinLiteral,this.parseIntegerHex)):this.char===CHAR_PERIOD?this.goto(this.parseNumberInteger):isDigit(this.char)?this.goto(this.parseDateTimeOnly):this.returnNow(Integer(this.state.buf))}parseIntegerHex(){if(!isHexit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseIntegerOct(){if(!isOctit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseIntegerBin(){if(!isBit(this.char)){if(this.char===CHAR_LOWBAR)return this.call(this.parseNoUnderHexOctBinLiteral);{const e=Integer(this.state.buf);if(e.isNaN())throw this.error(new TomlError("Invalid number"));return this.returnNow(e)}}this.consume()}parseDateTime(){if(this.state.buf.length<4)throw this.error(new TomlError("Years less than 1000 must be zero padded to four characters"));return this.state.result=this.state.buf,this.state.buf="",this.next(this.parseDateMonth)}parseDateMonth(){if(this.char===CHAR_HYPHEN){if(this.state.buf.length<2)throw this.error(new TomlError("Months less than 10 must be zero padded to two characters"));return this.state.result+="-"+this.state.buf,this.state.buf="",this.next(this.parseDateDay)}if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseDateDay(){if(this.char===CHAR_T||this.char===CHAR_SP){if(this.state.buf.length<2)throw this.error(new TomlError("Days less than 10 must be zero padded to two characters"));return this.state.result+="-"+this.state.buf,this.state.buf="",this.next(this.parseStartTimeHour)}if(this.atEndOfWord())return this.returnNow(createDate(this.state.result+"-"+this.state.buf));if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseStartTimeHour(){return this.atEndOfWord()?this.returnNow(createDate(this.state.result)):this.goto(this.parseTimeHour)}parseTimeHour(){if(this.char===CHAR_COLON){if(this.state.buf.length<2)throw this.error(new TomlError("Hours less than 10 must be zero padded to two characters"));return this.state.result+="T"+this.state.buf,this.state.buf="",this.next(this.parseTimeMin)}if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));this.consume()}parseTimeMin(){if(!(this.state.buf.length<2&&isDigit(this.char))){if(2===this.state.buf.length&&this.char===CHAR_COLON)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseTimeSec);throw this.error(new TomlError("Incomplete datetime"))}this.consume()}parseTimeSec(){if(!isDigit(this.char))throw this.error(new TomlError("Incomplete datetime"));if(this.consume(),2===this.state.buf.length)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseTimeZoneOrFraction)}parseOnlyTimeHour(){if(this.char===CHAR_COLON){if(this.state.buf.length<2)throw this.error(new TomlError("Hours less than 10 must be zero padded to two characters"));return this.state.result=this.state.buf,this.state.buf="",this.next(this.parseOnlyTimeMin)}throw this.error(new TomlError("Incomplete time"))}parseOnlyTimeMin(){if(!(this.state.buf.length<2&&isDigit(this.char))){if(2===this.state.buf.length&&this.char===CHAR_COLON)return this.state.result+=":"+this.state.buf,this.state.buf="",this.next(this.parseOnlyTimeSec);throw this.error(new TomlError("Incomplete time"))}this.consume()}parseOnlyTimeSec(){if(!isDigit(this.char))throw this.error(new TomlError("Incomplete time"));if(this.consume(),2===this.state.buf.length)return this.next(this.parseOnlyTimeFractionMaybe)}parseOnlyTimeFractionMaybe(){if(this.state.result+=":"+this.state.buf,this.char!==CHAR_PERIOD)return this.return(createTime(this.state.result));this.state.buf="",this.next(this.parseOnlyTimeFraction)}parseOnlyTimeFraction(){if(!isDigit(this.char)){if(this.atEndOfWord()){if(0===this.state.buf.length)throw this.error(new TomlError("Expected digit in milliseconds"));return this.returnNow(createTime(this.state.result+"."+this.state.buf))}throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume()}parseTimeZoneOrFraction(){if(this.char===CHAR_PERIOD)this.consume(),this.next(this.parseDateTimeFraction);else{if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS){if(this.char===CHAR_Z)return this.consume(),this.return(createDateTime(this.state.result+this.state.buf));if(this.atEndOfWord())return this.returnNow(createDateTimeFloat(this.state.result+this.state.buf));throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume(),this.next(this.parseTimeZoneHour)}}parseDateTimeFraction(){if(isDigit(this.char))this.consume();else{if(1===this.state.buf.length)throw this.error(new TomlError("Expected digit in milliseconds"));if(this.char!==CHAR_HYPHEN&&this.char!==CHAR_PLUS){if(this.char===CHAR_Z)return this.consume(),this.return(createDateTime(this.state.result+this.state.buf));if(this.atEndOfWord())return this.returnNow(createDateTimeFloat(this.state.result+this.state.buf));throw this.error(new TomlError("Unexpected character in datetime, expected period (.), minus (-), plus (+) or Z"))}this.consume(),this.next(this.parseTimeZoneHour)}}parseTimeZoneHour(){if(!isDigit(this.char))throw this.error(new TomlError("Unexpected character in datetime, expected digit"));if(this.consume(),/\d\d$/.test(this.state.buf))return this.next(this.parseTimeZoneSep)}parseTimeZoneSep(){if(this.char!==CHAR_COLON)throw this.error(new TomlError("Unexpected character in datetime, expected colon"));this.consume(),this.next(this.parseTimeZoneMin)}parseTimeZoneMin(){if(!isDigit(this.char))throw this.error(new TomlError("Unexpected character in datetime, expected digit"));if(this.consume(),/\d\d$/.test(this.state.buf))return this.return(createDateTime(this.state.result+this.state.buf))}parseBoolean(){return this.char===CHAR_t?(this.consume(),this.next(this.parseTrue_r)):this.char===CHAR_f?(this.consume(),this.next(this.parseFalse_a)):void 0}parseTrue_r(){if(this.char===CHAR_r)return this.consume(),this.next(this.parseTrue_u);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseTrue_u(){if(this.char===CHAR_u)return this.consume(),this.next(this.parseTrue_e);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseTrue_e(){if(this.char===CHAR_e)return this.return(!0);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_a(){if(this.char===CHAR_a)return this.consume(),this.next(this.parseFalse_l);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_l(){if(this.char===CHAR_l)return this.consume(),this.next(this.parseFalse_s);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_s(){if(this.char===CHAR_s)return this.consume(),this.next(this.parseFalse_e);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseFalse_e(){if(this.char===CHAR_e)return this.return(!1);throw this.error(new TomlError("Invalid boolean, expected true or false"))}parseInlineList(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M||this.char===CTRL_J)return null;if(this.char===e.END)throw this.error(new TomlError("Unterminated inline array"));return this.char===CHAR_NUM?this.call(this.parseComment):this.char===CHAR_RSQB?this.return(this.state.resultArr||InlineList()):this.callNow(this.parseValue,this.recordInlineListValue)}recordInlineListValue(e){if(this.state.resultArr){const t=this.state.resultArr[_contentType],n=tomlType(e);if(t!==n)throw this.error(new TomlError(`Inline lists must be a single type, not a mix of ${t} and ${n}`))}else this.state.resultArr=InlineList(tomlType(e));return isFloat(e)||isInteger(e)?this.state.resultArr.push(e.valueOf()):this.state.resultArr.push(e),this.goto(this.parseInlineListNext)}parseInlineListNext(){if(this.char===CHAR_SP||this.char===CTRL_I||this.char===CTRL_M||this.char===CTRL_J)return null;if(this.char===CHAR_NUM)return this.call(this.parseComment);if(this.char===CHAR_COMMA)return this.next(this.parseInlineList);if(this.char===CHAR_RSQB)return this.goto(this.parseInlineList);throw this.error(new TomlError("Invalid character, expected whitespace, comma (,) or close bracket (])"))}parseInlineTable(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===e.END||this.char===CHAR_NUM||this.char===CTRL_J||this.char===CTRL_M)throw this.error(new TomlError("Unterminated inline array"));return this.char===CHAR_RCUB?this.return(this.state.resultTable||InlineTable()):(this.state.resultTable||(this.state.resultTable=InlineTable()),this.callNow(this.parseAssign,this.recordInlineTableValue))}recordInlineTableValue(e){let t=this.state.resultTable,n=e.key.pop();for(let n of e.key){if(hasKey(t,n)&&(!isTable(t[n])||t[n][_declared]))throw this.error(new TomlError("Can't redefine existing key"));t=t[n]=t[n]||Table()}if(hasKey(t,n))throw this.error(new TomlError("Can't redefine existing key"));return isInteger(e.value)||isFloat(e.value)?t[n]=e.value.valueOf():t[n]=e.value,this.goto(this.parseInlineTableNext)}parseInlineTableNext(){if(this.char===CHAR_SP||this.char===CTRL_I)return null;if(this.char===e.END||this.char===CHAR_NUM||this.char===CTRL_J||this.char===CTRL_M)throw this.error(new TomlError("Unterminated inline array"));if(this.char===CHAR_COMMA)return this.next(this.parseInlineTable);if(this.char===CHAR_RCUB)return this.goto(this.parseInlineTable);throw this.error(new TomlError("Invalid character, expected whitespace, comma (,) or close bracket (])"))}}}},22950:(e,t,n)=>{"use strict";e.exports=function(e,t){t||(t={});const n=t.blocksize||40960,o=new r;return new Promise(((e,t)=>{setImmediate(s,0,n,e,t)}));function s(t,n,r,a){if(t>=e.length)try{return r(o.finish())}catch(t){return a(i(t,e))}try{o.parse(e.slice(t,t+n)),setImmediate(s,t+n,n,r,a)}catch(t){a(i(t,e))}}};const r=n(8676),i=n(22418)},22418:e=>{"use strict";e.exports=function(e,t){if(null==e.pos||null==e.line)return e;let n=e.message;if(n+=` at row ${e.line+1}, col ${e.col+1}, pos ${e.pos}:\n`,t&&t.split){const r=t.split(/\n/),i=String(Math.min(r.length,e.line+3)).length;let o=" ";for(;o.length<i;)o+=" ";for(let t=Math.max(0,e.line-1);t<Math.min(r.length,e.line+2);++t){let s=String(t+1);if(s.length<i&&(s=" "+s),e.line===t){n+=s+"> "+r[t]+"\n",n+=o+"  ";for(let t=0;t<e.col;++t)n+=" ";n+="^\n"}else n+=s+": "+r[t]+"\n"}}return e.message=n+"\n",e}},6435:(e,t,n)=>{"use strict";e.exports=function(e){return e?function(e){const t=new i;return e.setEncoding("utf8"),new Promise(((n,r)=>{let i,o=!1,s=!1;function a(){if(o=!0,!i)try{n(t.finish())}catch(e){r(e)}}function c(e){s=!0,r(e)}e.once("end",a),e.once("error",c),function n(){let r;for(i=!0;null!==(r=e.read());)try{t.parse(r)}catch(e){return c(e)}if(i=!1,o)return a();s||e.once("readable",n)}()}))}(e):function(){const e=new i;return new r.Transform({objectMode:!0,transform(t,n,r){try{e.parse(t.toString(n))}catch(e){this.emit("error",e)}r()},flush(t){try{this.push(e.finish())}catch(e){this.emit("error",e)}t()}})}()};const r=n(12781),i=n(8676)},56530:(e,t,n)=>{"use strict";e.exports=function(e){global.Buffer&&global.Buffer.isBuffer(e)&&(e=e.toString("utf8"));const t=new r;try{return t.parse(e),t.finish()}catch(t){throw i(t,e)}};const r=n(8676),i=n(22418)},83512:(e,t,n)=>{"use strict";e.exports=n(56530),e.exports.async=n(22950),e.exports.stream=n(6435),e.exports.prettyError=n(22418)},36921:e=>{"use strict";function t(e){return new Error("Can only stringify objects, not "+e)}function n(e){return Object.keys(e).filter((t=>o(e[t])))}function r(e){let t=Array.isArray(e)?[]:Object.prototype.hasOwnProperty.call(e,"__proto__")?{["__proto__"]:void 0}:{};for(let n of Object.keys(e))e[n]&&"function"==typeof e[n].toJSON&&!("toISOString"in e[n])?t[n]=e[n].toJSON():t[n]=e[n];return t}function i(e,c,l){var p,d;p=n(l=r(l)),d=function(e){return Object.keys(e).filter((t=>!o(e[t])))}(l);var f=[],g=c||"";p.forEach((e=>{var t=s(l[e]);"undefined"!==t&&"null"!==t&&f.push(g+a(e)+" = "+u(l[e],!0))})),f.length>0&&f.push("");var m=e&&p.length>0?c+"  ":"";return d.forEach((o=>{f.push(function(e,o,c,l){var u=s(l);if("array"===u)return function(e,n,o,c){h(c=r(c));var l=s(c[0]);if("table"!==l)throw t(l);var u=e+a(o),p="";return c.forEach((e=>{p.length>0&&(p+="\n"),p+=n+"[["+u+"]]\n",p+=i(u+".",n,e)})),p}(e,o,c,l);if("table"===u)return function(e,t,r,o){var s=e+a(r),c="";return n(o).length>0&&(c+=t+"["+s+"]\n"),c+i(s+".",t,o)}(e,o,c,l);throw t(u)}(e,m,o,l[o]))})),f.join("\n")}function o(e){switch(s(e)){case"undefined":case"null":case"integer":case"nan":case"float":case"boolean":case"string":case"datetime":return!0;case"array":return 0===e.length||"table"!==s(e[0]);case"table":return 0===Object.keys(e).length;default:return!1}}function s(e){return void 0===e?"undefined":null===e?"null":"bigint"==typeof e||Number.isInteger(e)&&!Object.is(e,-0)?"integer":"number"==typeof e?"float":"boolean"==typeof e?"boolean":"string"==typeof e?"string":"toISOString"in e?isNaN(e)?"undefined":"datetime":Array.isArray(e)?"array":"table"}function a(e){var t=String(e);return/^[-A-Za-z0-9_]+$/.test(t)?t:c(t)}function c(e){return'"'+l(e).replace(/"/g,'\\"')+'"'}function l(e){return e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/([\u0000-\u001f\u007f])/,(e=>"\\u"+function(e,t){for(;t.length<4;)t="0"+t;return t}(0,e.codePointAt(0).toString(16))))}function u(e,t){let n=s(e);return"string"===n&&(t&&/\n/.test(e)?n="string-multiline":!/[\b\t\n\f\r']/.test(e)&&/"/.test(e)&&(n="string-literal")),p(e,n)}function p(e,n){switch(n||(n=s(e)),n){case"string-multiline":return function(e){let t=e.split(/\n/).map((e=>l(e).replace(/"(?="")/g,'\\"'))).join("\n");return'"'===t.slice(-1)&&(t+="\\\n"),'"""\n'+t+'"""'}(e);case"string":return c(e);case"string-literal":return"'"+e+"'";case"integer":return d(e);case"float":return function(e){if(e===1/0)return"inf";if(e===-1/0)return"-inf";if(Object.is(e,NaN))return"nan";if(Object.is(e,-0))return"-0.0";var t=String(e).split("."),n=t[0],r=t[1]||0;return d(n)+"."+r}(e);case"boolean":return function(e){return String(e)}(e);case"datetime":return function(e){return e.toISOString()}(e);case"array":return function(e){const t=h(e=r(e));var n="[",i=e.map((e=>p(e,t)));return i.join(", ").length>60||/\n/.test(i)?n+="\n  "+i.join(",\n  ")+"\n":n+=" "+i.join(", ")+(i.length>0?" ":""),n+"]"}(e.filter((e=>"null"!==s(e)&&"undefined"!==s(e)&&"nan"!==s(e))));case"table":return function(e){e=r(e);var t=[];return Object.keys(e).forEach((n=>{t.push(a(n)+" = "+u(e[n],!1))})),"{ "+t.join(", ")+(t.length>0?" ":"")+"}"}(e);default:throw t(n)}}function d(e){return String(e).replace(/\B(?=(\d{3})+(?!\d))/g,"_")}function h(e){const t=function(e){var t=s(e[0]);return e.every((e=>s(e)===t))?t:e.every((e=>{return"float"===(t=s(e))||"integer"===t;var t}))?"float":"mixed"}(e);if("mixed"===t)throw new Error("Array values can't have mixed types");return t}e.exports=function(e){if(null===e)throw t("null");if(void 0===e)throw t("undefined");if("object"!=typeof e)throw t(typeof e);if("function"==typeof e.toJSON&&(e=e.toJSON()),null==e)return null;const n=s(e);if("table"!==n)throw t(n);return i("","",e)},e.exports.value=p},5022:(e,t,n)=>{"use strict";t.parse=n(83512),t.stringify=n(36921)},67164:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AppInsightsCore:()=>q,BaseCore:()=>G,BaseTelemetryPlugin:()=>O.i,CoreUtils:()=>B.Tr,DiagnosticLogger:()=>m.AQ,ESPromise:()=>Y,ESPromiseScheduler:()=>te,EventHelper:()=>oe.zB,EventLatency:()=>u,EventPersistence:()=>d,EventPropertyType:()=>p,EventsDiscardedReason:()=>ie.h,FullVersionString:()=>B.vs,InternalAppInsightsCore:()=>V,InternalBaseCore:()=>j,LoggingSeverity:()=>a,MinChannelPriorty:()=>re,NotificationManager:()=>U,PerfEvent:()=>v.zn,PerfManager:()=>v.Jk,ProcessTelemetryContext:()=>_.Vi,TraceLevel:()=>h,Undefined:()=>ce.jA,Utils:()=>B.cQ,ValueKind:()=>l,ValueSanitizer:()=>ne,Version:()=>B.Gf,_ExtendedInternalMessageId:()=>f,_InternalLogMessage:()=>m.lQ,_InternalMessageId:()=>c,__getRegisteredEvents:()=>se.um,_logInternalMessage:()=>m.L4,_throwInternal:()=>m.kP,_warnToConsole:()=>m.jV,addEventHandler:()=>se.Ib,addEventListeners:()=>se.yw,addPageHideEventListener:()=>se.TJ,addPageShowEventListener:()=>se.nD,addPageUnloadEventListener:()=>se.c9,areCookiesSupported:()=>P.p7,arrForEach:()=>s.tO,arrIndexOf:()=>s.UA,arrMap:()=>s.Mr,arrReduce:()=>s.Xz,attachEvent:()=>se.pZ,cookieAvailable:()=>P.p7,createCookieMgr:()=>P.Nz,createEnumStyle:()=>o.By,createGuid:()=>B.cm,createProcessTelemetryContext:()=>_.CD,createTraceParent:()=>le.SU,createUniqueNamespace:()=>I.J,createUnloadHandlerContainer:()=>D.Y,dateNow:()=>s.m6,deleteCookie:()=>B.kT,detachEvent:()=>se.pD,disableCookies:()=>B.oF,disallowsSameSiteNone:()=>P.UY,doPerf:()=>v.Lm,dumpObj:()=>y.eU,eventOff:()=>se.QY,eventOn:()=>se.XO,extend:()=>B.l7,findW3cTraceParent:()=>le.lq,formatTraceParent:()=>le.aR,generateW3CId:()=>oe.DO,getCommonSchemaMetaData:()=>B.Vv,getConsole:()=>y.dr,getCookie:()=>B.ej,getCookieValue:()=>B.Do,getCrypto:()=>y.MX,getDocument:()=>y.Me,getExceptionName:()=>s.jj,getFieldValueType:()=>B.Sy,getGlobal:()=>S.Rd,getGlobalInst:()=>y.a8,getHistory:()=>y.s1,getIEVersion:()=>y.sA,getISOString:()=>s.Y6,getJSON:()=>y.xA,getLocation:()=>y.k$,getMsCrypto:()=>y.gz,getNavigator:()=>y.jW,getPerformance:()=>y.r,getSetValue:()=>s.qK,getTenantId:()=>B.jM,getTime:()=>B.hK,getWindow:()=>y.Jj,hasDocument:()=>y.Nv,hasHistory:()=>y.fE,hasJSON:()=>y.nS,hasNavigator:()=>y.d6,hasOwnProperty:()=>s.nr,hasWindow:()=>y.Ym,isArray:()=>s.kJ,isArrayValid:()=>B.JT,isBeaconsSupported:()=>y.MF,isBoolean:()=>s.jn,isChromium:()=>B.mJ,isDate:()=>s.J_,isDocumentObjectAvailable:()=>B.x9,isError:()=>s.VZ,isFetchSupported:()=>y.JO,isFunction:()=>s.mf,isIE:()=>y.w1,isLatency:()=>B.r7,isNotTruthy:()=>s.F,isNullOrUndefined:()=>s.le,isNumber:()=>s.hj,isObject:()=>s.Kn,isReactNative:()=>y.b$,isSampledFlag:()=>le.Pn,isString:()=>s.HD,isTruthy:()=>s.fQ,isTypeof:()=>s.Ym,isUint8ArrayAvailable:()=>B.IZ,isUndefined:()=>s.o8,isValidSpanId:()=>le.Lc,isValidTraceId:()=>le.jN,isValidTraceParent:()=>le.J6,isValueAssigned:()=>B.Sn,isValueKind:()=>B.oS,isWindowObjectAvailable:()=>B.dH,isXhrSupported:()=>y.Z3,mergeEvtNamespace:()=>se.jU,newGuid:()=>oe.GW,newId:()=>ae.pZ,normalizeJsName:()=>s.Gf,objCreate:()=>S.pu,objDefineAccessors:()=>s.l_,objForEachKey:()=>s.rW,objFreeze:()=>s.FL,objKeys:()=>s.FY,objSeal:()=>s.Xi,openXhr:()=>B.ot,optimizeObject:()=>s.Ax,parseTraceParent:()=>le.j_,perfNow:()=>oe.Jj,proxyAssign:()=>s.cf,proxyFunctionAs:()=>s.Oi,proxyFunctions:()=>s.Vb,random32:()=>ae._l,randomValue:()=>ae.az,removeEventHandler:()=>se.C1,removeEventListeners:()=>se.nJ,removePageHideEventListener:()=>se.C9,removePageShowEventListener:()=>se.Yl,removePageUnloadEventListener:()=>se.JA,safeGetCookieMgr:()=>P.JP,safeGetLogger:()=>m.vH,sanitizeProperty:()=>B.yj,setCookie:()=>B.d8,setEnableEnvMocks:()=>y.dI,setProcessTelemetryTimings:()=>B.if,setValue:()=>s.sO,strContains:()=>s._Q,strEndsWith:()=>s.Id,strFunction:()=>ce.cb,strObject:()=>ce.fK,strPrototype:()=>ce.hB,strStartsWith:()=>s.xe,strTrim:()=>s.nd,strUndefined:()=>ce.jA,throwError:()=>s._y,toISOString:()=>s.Y6,useXDomainRequest:()=>y.cp});var r,i=n(27421),o=n(50951),s=n(24869),a=(0,o.By)({CRITICAL:1,WARNING:2}),c=(0,o.By)(((r={}).BrowserDoesNotSupportLocalStorage=0,r.BrowserCannotReadLocalStorage=1,r.BrowserCannotReadSessionStorage=2,r.BrowserCannotWriteLocalStorage=3,r.BrowserCannotWriteSessionStorage=4,r.BrowserFailedRemovalFromLocalStorage=5,r.BrowserFailedRemovalFromSessionStorage=6,r.CannotSendEmptyTelemetry=7,r.ClientPerformanceMathError=8,r.ErrorParsingAISessionCookie=9,r.ErrorPVCalc=10,r.ExceptionWhileLoggingError=11,r.FailedAddingTelemetryToBuffer=12,r.FailedMonitorAjaxAbort=13,r.FailedMonitorAjaxDur=14,r.FailedMonitorAjaxOpen=15,r.FailedMonitorAjaxRSC=16,r.FailedMonitorAjaxSend=17,r.FailedMonitorAjaxGetCorrelationHeader=18,r.FailedToAddHandlerForOnBeforeUnload=19,r.FailedToSendQueuedTelemetry=20,r.FailedToReportDataLoss=21,r.FlushFailed=22,r.MessageLimitPerPVExceeded=23,r.MissingRequiredFieldSpecification=24,r.NavigationTimingNotSupported=25,r.OnError=26,r.SessionRenewalDateIsZero=27,r.SenderNotInitialized=28,r.StartTrackEventFailed=29,r.StopTrackEventFailed=30,r.StartTrackFailed=31,r.StopTrackFailed=32,r.TelemetrySampledAndNotSent=33,r.TrackEventFailed=34,r.TrackExceptionFailed=35,r.TrackMetricFailed=36,r.TrackPVFailed=37,r.TrackPVFailedCalc=38,r.TrackTraceFailed=39,r.TransmissionFailed=40,r.FailedToSetStorageBuffer=41,r.FailedToRestoreStorageBuffer=42,r.InvalidBackendResponse=43,r.FailedToFixDepricatedValues=44,r.InvalidDurationValue=45,r.TelemetryEnvelopeInvalid=46,r.CreateEnvelopeError=47,r.CannotSerializeObject=48,r.CannotSerializeObjectNonSerializable=49,r.CircularReferenceDetected=50,r.ClearAuthContextFailed=51,r.ExceptionTruncated=52,r.IllegalCharsInName=53,r.ItemNotInArray=54,r.MaxAjaxPerPVExceeded=55,r.MessageTruncated=56,r.NameTooLong=57,r.SampleRateOutOfRange=58,r.SetAuthContextFailed=59,r.SetAuthContextFailedAccountName=60,r.StringValueTooLong=61,r.StartCalledMoreThanOnce=62,r.StopCalledWithoutStart=63,r.TelemetryInitializerFailed=64,r.TrackArgumentsNotSpecified=65,r.UrlTooLong=66,r.SessionStorageBufferFull=67,r.CannotAccessCookie=68,r.IdTooLong=69,r.InvalidEvent=70,r.FailedMonitorAjaxSetRequestHeader=71,r.SendBrowserInfoOnUserInit=72,r.PluginException=73,r.NotificationException=74,r.SnippetScriptLoadFailure=99,r.InvalidInstrumentationKey=100,r.CannotParseAiBlobValue=101,r.InvalidContentBlob=102,r.TrackPageActionEventFailed=103,r.FailedAddingCustomDefinedRequestContext=104,r.InMemoryStorageBufferFull=105,r.InstrumentationKeyDeprecation=106,r)),l=(0,o.By)({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),u=(0,o.By)({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),p=(0,o.By)({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),d=(0,o.By)({Normal:1,Critical:2}),h=(0,o.By)({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),f=(0,s.FL)((0,i.uc)((0,i.uc)({},c),(0,o.By)({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}))),g=n(29141),m=n(29339),v=n(81782),y=n(49251),b=n(98145),S=n(30175),E=n(96335),_=n(31030),w=n(69031),T=500;function C(e,t,n){t&&(0,s.kJ)(t)&&t[b.R5]>0&&(t=t.sort((function(e,t){return e[E.yi]-t[E.yi]})),(0,s.tO)(t,(function(e){e[E.yi]<T&&(0,s._y)("Channel has invalid priority - "+e[b.pZ])})),e[b.MW]({queue:(0,s.FL)(t),chain:(0,_.jV)(t,n[b.TC],n)}))}var P=n(88140),I=n(87624),x=n(28341),O=n(87951),R=function(e){function t(){var n,r,i=e.call(this)||this;function o(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),(0,g.Z)(t,i,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r[b.MW](t),{remove:function(){(0,s.tO)(r,(function(e,n){if(e.id===t.id)return r[b.cb](n,1),-1}))}}},e[E.hL]=function(t,n){for(var i=!1,o=r[b.R5],a=0;a<o;++a){var c=r[a];if(c)try{if(!1===c.fn[b.ZV](null,[t])){i=!0;break}}catch(e){(0,m.kP)(n[b.mc](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+(0,s.jj)(e),{exception:(0,y.eU)(e)},!0)}}i||e[b.uL](t,n)},e[b.F3]=function(){o()}})),i}return(0,i.ne)(t,e),t.__ieDyn=1,t}(O.i),D=n(38593),A="Plugins must provide initialize method",k="SDK is still unloading...",N={loggingLevelConsole:1};function M(e,t){return new v.Jk(t)}function L(e,t){var n=!1;return(0,s.tO)(t,(function(t){if(t===e)return n=!0,-1})),n}var j=function(){function e(){var t,n,r,o,a,c,l,u,p,d,h,f,y,O,j,F,U,V,H,B,W=0;(0,g.Z)(e,this,(function(e){function g(){n=!1,t=(0,s.mm)(!0,{},N),e[b.TC]=t,e[b.eZ]=new m.AQ(t),e[b.iC]=[],j=new R,r=[],o=null,a=null,c=null,l=null,u=null,d=null,p=[],h=null,f=null,y=null,O=!1,F=null,U=(0,I.J)("AIBaseCore",!0),V=(0,D.Y)(),B=null}function q(){return(0,_.CD)(K(),t,e)}function $(n){var r=function(e,t,n){var r,i=[],o={};return(0,s.tO)(n,(function(t){((0,s.le)(t)||(0,s.le)(t[b.VL]))&&(0,s._y)(A);var n=t[E.yi],r=t[b.pZ];t&&n&&((0,s.le)(o[n])?o[n]=r:(0,m.jV)(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+r)),(!n||n<500)&&i[b.MW](t)})),(r={all:n})[E.oV]=i,r}(e[b.eZ],0,p);d=r[E.oV],u=null;var i=r.all;if(y=(0,s.FL)(function(e,t,n){var r=[];if(e&&(0,s.tO)(e,(function(e){return C(r,e,n)})),t){var i=[];(0,s.tO)(t,(function(e){e[E.yi]>T&&i[b.MW](e)})),C(r,i,n)}return r}(f,i,e)),h){var o=(0,s.UA)(i,h);-1!==o&&i[b.cb](o,1),-1!==(o=(0,s.UA)(d,h))&&d[b.cb](o,1),h._setQueue(y)}else h=function(e,t){function n(){return(0,_.CD)(null,t[b.TC],t,null)}function r(e,t,n,r){var i=e?e[b.R5]+1:1;function o(){0==--i&&(r&&r(),r=null)}i>0&&(0,s.tO)(e,(function(e){if(e&&e.queue[b.R5]>0){var r=e.chain,s=t[b.zV](r);s[b.Fc](o),n(s)}else i--})),o()}var i=!1,o={identifier:"ChannelControllerPlugin",priority:T,initialize:function(t,n,r,o){i=!0,(0,s.tO)(e,(function(e){e&&e.queue[b.R5]>0&&(0,w.bP)((0,_.CD)(e.chain,t,n),r)}))},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),(function(e){e[b.uL](t)}),(function(){i[b.uL](t)}))},update:function(t,n){var i=n||{reason:0};return r(e,t,(function(e){e[b.uL](i)}),(function(){t[b.uL](i)})),!0},pause:function(){r(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){r(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return r(e,t,(function(e){e[b.uL](o)}),(function(){t[b.uL](o),i=!1})),!0},getChannel:function(t){var n=null;return e&&e[b.R5]>0&&(0,s.tO)(e,(function(e){if(e&&e.queue[b.R5]>0&&((0,s.tO)(e.queue,(function(e){if(e[b.pZ]===t)return n=e,-1})),n))return-1})),n},flush:function(t,i,o,s){var a=1,c=!1,l=null;function u(){a--,c&&0===a&&(l&&(clearTimeout(l),l=null),i&&i(c),i=null)}return s=s||5e3,r(e,n(),(function(e){e.iterate((function(e){if(e[b.kL]){a++;var n=!1;e[b.kL](t,(function(){n=!0,u()}),o)||n||(t&&null==l?l=setTimeout((function(){l=null,u()}),s):u())}}))}),(function(){c=!0,u()})),!0},_setQueue:function(t){e=t}};return o}(y,e);i[b.MW](h),d[b.MW](h),e[b.iC]=(0,w.AA)(i),h[b.VL](t,e,i),(0,w.bP)(q(),i),e[b.iC]=(0,s.FL)((0,w.AA)(d||[])).slice(),n&&function(t){var n=(0,_.xy)(K(),e);e._updateHook&&!0===e._updateHook(n,t)||n[b.uL](t)}(n)}function G(t){var n,r=null,i=null;return(0,s.tO)(e[b.iC],(function(e){if(e[b.pZ]===t&&e!==h&&e!==j)return i=e,-1})),!i&&h&&(i=h.getChannel(t)),i&&((n={plugin:i})[b.$h]=function(e){(0,w.OY)(i)[E.mE]=!e},n.isEnabled=function(){var e=(0,w.OY)(i);return!e[b.fi]&&!e[E.mE]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],o=((n={reason:1})[b.d]=e,n);z(r,o,(function(e){e&&$({reason:32,removed:r}),t&&t(e)}))},r=n),r}function K(){if(!u){var n=(d||[]).slice();-1===(0,s.UA)(n,j)&&n[b.MW](j),u=(0,_.jV)((0,w.AA)(n),t,e)}return u}function z(n,r,i){if(n&&n[b.R5]>0){var o=(0,_.jV)(n,t,e),a=(0,_.Bt)(o,e);a[b.Fc]((function(){var e=!1,t=[];(0,s.tO)(p,(function(r,i){L(r,n)?e=!0:t[b.MW](r)})),p=t;var r=[];f&&((0,s.tO)(f,(function(t,i){var o=[];(0,s.tO)(t,(function(t){L(t,n)?e=!0:o[b.MW](t)})),r[b.MW](o)})),f=r),i&&i(e)})),a[b.uL](r)}else i(!1)}function Y(){var n=e[b.eZ]?e[b.eZ].queue:[];n&&((0,s.tO)(n,(function(n){var r,i=((r={})[b.I]=F||"InternalMessageId: "+n[b.Gc],r.iKey=(0,s.v4)(t[b.p$]),r.time=(0,s.Y6)(new Date),r.baseType=m.lQ.dataType,r.baseData={message:n[b.gU]},r);e.track(i)})),n[b.R5]=0)}function J(e,t,n,r){return h?h[b.kL](e,t,n||6,r):(t&&t(!1),!0)}function X(t){var n=e[b.eZ];n?(0,m.kP)(n,2,73,t):(0,s._y)(t)}g(),e[b.yl]=function(){return n},e[b.VL]=function(r,a,l,u){var d,h;O&&(0,s._y)(k),e[b.yl]()&&(0,s._y)("Core should not be initialized more than once"),t=r||{},e[b.TC]=t,(0,s.le)(r[b.p$])&&(0,s._y)("Please provide instrumentation key"),o=u,e._notificationManager=u,!0===(h=(0,s.v4)(t.disableDbgExt))&&H&&(o[b.n7](H),H=null),o&&!H&&!0!==h&&(H=(0,x.p)(t),o[b.g](H)),!(d=(0,s.v4)(t.enablePerfMgr))&&c&&(c=null),d&&(0,s.qK)(t,E.DN,M),(0,s.qK)(t,E.Zh,{}).NotificationManager=o,l&&(e[b.eZ]=l);var g=(0,s.qK)(t,E.js,[]);(p=[])[b.MW].apply(p,(0,i.$h)((0,i.$h)([],a,!1),g,!1)),f=(0,s.qK)(t,E.Z,[]),$(null),y&&0!==y[b.R5]||(0,s._y)("No "+E.Z+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return y&&(0,s.tO)(y,(function(t){e[b.MW](t.queue)})),(0,s.FL)(e)},e.track=function(n){n.iKey=n.iKey||t[b.p$],n[b.Z_]=n[b.Z_]||(0,s.Y6)(new Date),n.ver=n.ver||"4.0",!O&&e[b.yl]()?q()[b.uL](n):r[b.MW](n)},e[b.SD]=q,e[b.tb]=function(){return o||(o=function(){var e;return(0,S.pu)(((e={})[b.g]=function(e){},e[b.n7]=function(e){},e[E.uC]=function(e){},e[E.$F]=function(e,t){},e[E.f_]=function(e,t){},e))}(),e._notificationManager=o),o},e[b.g]=function(e){o&&o[b.g](e)},e[b.n7]=function(e){o&&o[b.n7](e)},e.getCookieMgr=function(){return l||(l=(0,P.Nz)(t,e[b.eZ])),l},e.setCookieMgr=function(e){l=e},e[E.kl]=function(){if(!a&&!c&&(0,s.v4)(t.enablePerfMgr)){var n=(0,s.v4)(t[E.DN]);(0,s.mf)(n)&&(c=n(e,e[b.tb]()))}return a||c||(0,v.j5)()},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return r[b.R5]},e.releaseQueue=function(){if(n&&r[b.R5]>0){var e=r;r=[],(0,s.tO)(e,(function(e){q()[b.uL](e)}))}},e.pollInternalLogs=function(e){F=e||null;var n=(0,s.v4)(t.diagnosticLogInterval);return n&&n>0||(n=1e4),W&&clearInterval(W),W=setInterval((function(){Y()}),n)},e[b.LS]=function(){W&&(clearInterval(W),W=0,Y())},(0,s.Vb)(e,(function(){return j}),["addTelemetryInitializer"]),e.unload=function(t,r,i){var o;void 0===t&&(t=!0),n||(0,s._y)("SDK is not initialized"),O&&(0,s._y)(k);var a=((o={reason:50})[b.d]=t,o.flushComplete=!1,o),c=(0,_.Bt)(K(),e);function l(t){a.flushComplete=t,O=!0,V.run(c,a),e[b.LS](),c[b.uL](a)}c[b.Fc]((function(){g(),r&&r(a)}),e),J(t,l,6,i)||l(!1)},e[b.TO]=G,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void X(A);var i=G(e[b.pZ]);if(i&&!t)return r&&r(!1),void X("Plugin ["+e[b.pZ]+"] is already loaded!");var o={reason:16};function s(t){p[b.MW](e),o.added=[e],$(o),r&&r(!0)}if(i){var a=[i.plugin];z(a,{reason:2,isAsync:!!n},(function(e){e?(o.removed=a,o.reason|=32,s()):r&&r(!1)}))}else s()},e.evtNamespace=function(){return U},e[b.kL]=J,e.getTraceCtx=function(e){return B||(B=(0,w.Yn)()),B},e.setTraceCtx=function(e){B=e||null},(0,s.Oi)(e,"addUnloadCb",(function(){return V}),"add")}))}return e.__ieDyn=1,e}();function F(e,t,n,r){(0,s.tO)(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return r(e)}),0);else try{r(e)}catch(e){}}))}var U=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;(0,g.Z)(e,this,(function(e){e[b.g]=function(t){e.listeners[b.MW](t)},e[b.n7]=function(t){for(var n=(0,s.UA)(e[b.dE],t);n>-1;)e.listeners[b.cb](n,1),n=(0,s.UA)(e[b.dE],t)},e[E.uC]=function(t){F(e[b.dE],E.uC,!0,(function(e){e[E.uC](t)}))},e[E.$F]=function(t,n){F(e[b.dE],E.$F,!0,(function(e){e[E.$F](t,n)}))},e[E.f_]=function(t,n){F(e[b.dE],E.f_,n,(function(e){e[E.f_](t,n)}))},e[E.C$]=function(t){t&&(!n&&t[b.PL]()||F(e[b.dE],E.C$,!1,(function(e){t[b.d]?setTimeout((function(){return e[E.C$](t)}),0):e[E.C$](t)})))}}))}return e.__ieDyn=1,e}(),V=function(e){function t(){var n=e.call(this)||this;return(0,g.Z)(t,n,(function(e,t){function n(t){var n=e[b.tb]();n&&n[E.$F]([t],2)}e[b.VL]=function(e,n,r,i){t[b.VL](e,n,r||new m.AQ(e),i||new U(e))},e.track=function(r){(0,v.Lm)(e[E.kl](),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(n(r),(0,s._y)("Invalid telemetry item")),function(e){(0,s.le)(e[b.I])&&(n(e),(0,s._y)("telemetry name required"))}(r),t.track(r)}),(function(){return{item:r}}),!r.sync)}})),n}return(0,i.ne)(t,e),t.__ieDyn=1,t}(j),H=n(51539),B=n(65705),W=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],(0,g.Z)(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new m.AQ({loggingLevelConsole:1})),e.initialize=function(n,r,i,o){(0,v.Lm)(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl=H.YT);var c=n.propertyStorageOverride;!c||c.getProperty&&c.setProperty||(0,s._y)("Invalid property storage override passed."),n.channels&&(0,s.tO)(n.channels,(function(e){e&&(0,s.tO)(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},r&&(0,s.tO)(r,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,r,i,o),e.pollInternalLogs("InternalLog")}catch(t){var l=e.logger,u=(0,y.eU)(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),(0,m.kP)(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:r,logger:i,notificationManager:o}}))},e.track=function(n){(0,v.Lm)(e,(function(){return"AppInsightsCore.track"}),(function(){var r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=(0,B.hK)(),(0,B.r7)(r.latency)||(r.latency=1);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=B.vs;var o=r.baseData=r.baseData||{};o[H.o6]=o[H.o6]||{};var s=o[H.o6];s[H.p8]=s[H.p8]||e.pluginVersionString||H.qS}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return(0,i.ne)(t,e),t.__ieDyn=1,t}(V);const q=W;var $=function(e){function t(){var n=e.call(this)||this;return(0,g.Z)(t,n,(function(e,t){e.initialize=function(n,r,i,o){n&&!n.endpointUrl&&(n.endpointUrl=H.YT),e.getWParam=function(){return B.x9||n.enableWParam?0:-1};try{t.initialize(n,r,i,o)}catch(t){(0,m.kP)(e.logger,1,514,"Initialization Failed: "+(0,y.eU)(t)+"\n - Note: Channels must be provided through config.channels only")}},e.track=function(e){var n=e;if(n){var r=n.ext=n.ext||{};r.sdk=r.sdk||{},r.sdk.ver=B.vs}t.track(n)}})),n}return(0,i.ne)(t,e),t.__ieDyn=1,t}(j);const G=$;var K=s.mf;function z(e,t,n){return function(r){e[t]=r,n()}}const Y=function(){function e(t){var n=0,r=null,i=[];function o(){if(i.length>0){var e=i.slice();i=[],setTimeout((function(){for(var t=0,n=e.length;t<n;++t)try{e[t]()}catch(e){}}),0)}}function s(e){0===n&&(r=e,n=1,o())}function a(e){0===n&&(r=e,n=2,o())}(0,g.Z)(e,this,(function(t){t.then=function(t,s){return new e((function(a,c){!function(t,s,a,c){i.push((function(){var i;try{(i=1===n?K(t)?t(r):r:K(s)?s(r):r)instanceof e?i.then(a,c):2!==n||K(s)?a(i):c(i)}catch(e){return void c(e)}})),0!==n&&o()}(t,s,a,c)}))},t.catch=function(e){return t.then(null,e)}})),function(){if(!K(t))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{t(s,a)}catch(e){a(e)}}()}return e.resolve=function(t){return t instanceof e?t:t&&K(t.then)?new e((function(e,n){try{t.then(e,n)}catch(e){n(e)}})):new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.all=function(t){if(t&&t.length)return new e((function(e,n){try{for(var r=[],i=0,o=0;o<t.length;o++){var s=t[o];s&&K(s.then)?(i++,s.then(z(r,o,(function(){0==--i&&e(r)})),n)):r[o]=s}0===i&&setTimeout((function(){e(r)}),0)}catch(e){n(e)}}))},e.race=function(t){return new e((function(e,n){if(t&&t.length)try{for(var r=function(r){var i=t[r];i&&K(i.then)?i.then(e,n):setTimeout((function(){e(i)}),0)},i=0;i<t.length;i++)r(i)}catch(e){n(e)}}))},e}();var J=0,X=[],Q=[],Z=[];function ee(){return(new Date).getTime()}const te=function(){function e(t,n){var r=0,i=(t||"<unnamed>")+"."+J;function o(e){var t=(0,S.Rd)();t&&t.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+e)}function s(e){(0,m.jV)(n,"ESPromiseScheduler["+i+"] "+e)}J++,(0,g.Z)(e,this,(function(e){var t=null,n=0;function a(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e.splice(n,1)[0];return null}e.scheduleEvent=function(e,c,l){var u=i+"."+n;n++,c&&(u+="-("+c+")");var p=u+"{"+r+"}";r++;var d,h,f,g={evt:null,tm:ee(),id:p,isRunning:!1,isAborted:!1};return g.evt=t?(d=g,h=t,f=new Y((function(e,t){var n=ee()-h.tm,r=h.id;o("["+u+"] is waiting for ["+r+":"+n+" ms] to complete before starting -- ["+Q.length+"] waiting and ["+X.length+"] running"),d.abort=function(e){d.abort=null,a(Q,u),d.isAborted=!0,t(new Error(e))},h.evt.then((function(n){a(Q,u),E(d).then(e,t)}),(function(n){a(Q,u),E(d).then(e,t)}))})),Q.push(d),f):E(g),(t=g).evt._schId=p,g.evt;function m(e){for(var t=ee(),n=t-6e5,r=e.length,i=0;i<r;){var o=e[i];if(o&&o.tm<n){var a=null;o.abort?(a="Aborting ["+o.id+"] due to Excessive runtime ("+(t-o.tm)+" ms)",o.abort(a)):a="Removing ["+o.id+"] due to Excessive runtime ("+(t-o.tm)+" ms)",s(a),e.splice(i,1),r--}else i++}}function v(e,n){var r=!1,i=a(X,e);if(i||(i=a(Z,e),r=!0),i){i.to&&(clearTimeout(i.to),i.to=null);var c=ee()-i.tm;n?r?s("Timed out event ["+e+"] finally complete -- "+c+" ms"):o("Promise ["+e+"] Complete -- "+c+" ms"):(Z.push(i),s("Event ["+e+"] Timed out and removed -- "+c+" ms"))}else o("Failed to remove ["+e+"] from running queue");t&&t.id===e&&(t=null),m(X),m(Q),m(Z)}function y(e,t){return function(n){return v(e,!0),t&&t(n),n}}function b(e,t,n,r){t.then((function(t){return t instanceof Y?(o("Event ["+e+"] returned a promise -- waiting"),b(e,t,n,r),t):y(e,n)(t)}),y(e,r))}function S(e,t){var n=e.id;return new Y((function(r,i){o("Event ["+n+"] Starting -- waited for "+(e.wTm||"--")+" ms"),e.isRunning=!0,e.abort=function(t){e.abort=null,e.isAborted=!0,v(n,!1),i(new Error(t))};var s=t(n);s instanceof Y?(l&&(e.to=setTimeout((function(){v(n,!1),i(new Error("Timed out after ["+l+"] ms"))}),l)),b(n,s,(function(t){o("Event ["+n+"] Resolving after "+(ee()-e.tm)+" ms"),r(t)}),i)):(o("Promise ["+n+"] Auto completed as the start action did not return a promise"),r())}))}function E(t){var n=ee();return t.wTm=n-t.tm,t.tm=n,t.isAborted?Y.reject(new Error("["+u+"] was aborted")):(X.push(t),S(t,e))}}}))}return e.incomplete=function(){return X},e.waitingToStart=function(){return Q},e}();var ne=function(){function e(e){var t=this,n={},r=[],i=[];function o(e,t){var o,a=n[e];if(a&&(o=a[t]),!o&&null!==o){if((0,s.HD)(e)&&(0,s.HD)(t))if(i.length>0){for(var c=0;c<i.length;c++)if(i[c].handleField(e,t)){o={canHandle:!0,fieldHandler:i[c]};break}}else 0===r.length&&(o={canHandle:!0});if(!o&&null!==o)for(o=null,c=0;c<r.length;c++)if(r[c].handleField(e,t)){o={canHandle:!0,handler:r[c],fieldHandler:null};break}a||(a=n[e]={}),a[t]=o}return o}function a(e,t,n,r,i,o){if(e.handler)return e.handler.property(t,n,i,o);if(!(0,s.le)(i.kind)){if(4096==(4096&r)||!(0,B.oS)(i.kind))return null;i.value=i.value.toString()}return l(e.fieldHandler,t,n,r,i)}function c(e,t,n){return(0,B.Sn)(n)?{value:n}:null}function l(e,n,r,i,o){if(o&&e){var a=e.getSanitizer(n,r,i,o.kind,o.propertyType);if(a)if(4===i){var u={},p=o.value;(0,s.rW)(p,(function(t,i){var o=n+"."+r;if((0,B.Sn)(i)){var s=c(0,0,i);(s=l(e,o,t,(0,B.Sy)(i),s))&&(u[t]=s.value)}})),o.value=u}else{var d={path:n,name:r,type:i,prop:o,sanitizer:t};o=a.call(t,d)}}return o}e&&i.push(e),t.addSanitizer=function(e){e&&(r.push(e),n={})},t.addFieldSanitizer=function(e){e&&(i.push(e),n={})},t.handleField=function(e,t){var n=o(e,t);return!!n&&n.canHandle},t.value=function(e,t,n,r){var i=o(e,t);if(i&&i.canHandle){if(!i||!i.canHandle)return null;if(i.handler)return i.handler.value(e,t,n,r);if(!(0,s.HD)(t)||(0,s.le)(n)||n===H.qS)return null;var l=null,u=(0,B.Sy)(n);if(8192==(8192&u)){var p=-8193&u;if(l=n,!(0,B.Sn)(l.value)||1!==p&&2!==p&&3!==p&&4096!=(4096&p))return null}else 1===u||2===u||3===u||4096==(4096&u)?l=c(0,0,n):4===u&&(l=c(0,0,r?JSON.stringify(n):n));if(l)return a(i,e,t,u,l,r)}return null},t.property=function(e,t,n,r){var i=o(e,t);if(!i||!i.canHandle)return null;if(!(0,s.HD)(t)||(0,s.le)(n)||!(0,B.Sn)(n.value))return null;var c=(0,B.Sy)(n.value);return 0===c?null:a(i,e,t,c,n,r)}}return e.getFieldType=B.Sy,e}(),re=100,ie=n(28452),oe=n(28956),se=n(47954),ae=n(19406),ce=n(1550),le=n(56207)},51539:(e,t,n)=>{"use strict";n.d(t,{YT:()=>i,o6:()=>s,p8:()=>o,qS:()=>r});var r="",i="https://browser.events.data.microsoft.com/OneCollector/1.0/",o="version",s="properties"},65705:(e,t,n)=>{"use strict";n.d(t,{Do:()=>R,Gf:()=>h,IZ:()=>_,JT:()=>M,Sn:()=>S,Sy:()=>j,Tr:()=>U,Vv:()=>C,cQ:()=>F,cm:()=>D,d8:()=>I,dH:()=>b,ej:()=>O,hK:()=>k,if:()=>L,jM:()=>E,kT:()=>x,l7:()=>A,mJ:()=>V,oF:()=>P,oS:()=>N,ot:()=>H,r7:()=>w,vs:()=>f,x9:()=>y,yj:()=>T});var r,i=n(49251),o=n(24869),s=n(88140),a=n(28956),c=n(1550),l=n(47954),u=n(19406),p=n(30175),d=n(51539),h="3.2.9",f="1DS-Web-JS-"+h,g="withCredentials",m=((r={})[0]=0,r[2]=6,r[1]=1,r[3]=7,r[4098]=6,r[4097]=1,r[4099]=7,r),v=null,y=Boolean((0,i.Me)()),b=Boolean((0,i.Jj)());function S(e){return!(e===d.qS||(0,o.le)(e))}function E(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return d.qS}function _(){return null===v&&(v=!(0,o.o8)(Uint8Array)&&!function(){var e=(0,i.jW)();if(!(0,o.o8)(e)&&e.userAgent){var t=e.userAgent.toLowerCase();if((t.indexOf("safari")>=0||t.indexOf("firefox")>=0)&&t.indexOf("chrome")<0)return!0}return!1}()&&!(0,i.b$)()),v}function w(e){return!!(e&&(0,o.hj)(e)&&e>=1&&e<=4)}function T(e,t,n){if(!t&&!S(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||(0,o.kJ)(t))t={value:t};else if("object"!==r||c.CY.call(t,"value")){if((0,o.le)(t.value)||t.value===d.qS||!(0,o.HD)(t.value)&&!(0,o.hj)(t.value)&&!(0,o.jn)(t.value)&&!(0,o.kJ)(t.value))return null}else t={value:n?JSON.stringify(t):t};if((0,o.kJ)(t.value)&&!M(t.value))return null;if(!(0,o.le)(t.kind)){if((0,o.kJ)(t.value)||!N(t.kind))return null;t.value=t.value.toString()}return t}function C(e,t,n){var r=-1;if(!(0,o.o8)(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){return e>=0&&e<=9}(n))-1===r&&(r=0),r|=n;else{var i=m[j(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function P(){(0,s.JP)(null).setEnabled(!1)}function I(e,t,n){(0,s.p7)(null)&&(0,s.JP)(null).set(e,t,86400*n,null,"/")}function x(e){(0,s.p7)(null)&&(0,s.JP)(null).del(e)}function O(e){return(0,s.p7)(null)?R((0,s.JP)(null),e):d.qS}function R(e,t,n){var r;return void 0===n&&(n=!0),e&&(r=e.get(t),n&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||d.qS}function D(e){void 0===e&&(e="D");var t=(0,a.GW)();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,d.qS)),t}function A(e,t,n,r,i){var s={},a=!1,l=0,u=arguments.length,p=Object[c.hB],d=arguments;for("[object Boolean]"===p.toString.call(d[0])&&(a=d[0],l++);l<u;l++)e=d[l],(0,o.rW)(e,(function(e,t){a&&t&&(0,o.Kn)(t)?(0,o.kJ)(t)?(s[e]=s[e]||[],(0,o.tO)(t,(function(t,n){t&&(0,o.Kn)(t)?s[e][n]=A(!0,s[e][n],t):s[e][n]=t}))):s[e]=A(!0,s[e],t):s[e]=t}));return s}var k=a.Jj;function N(e){return 0===e||e>0&&e<=13||32===e}function M(e){return e.length>0}function L(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=k()}function j(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===c.fK&&(t=4,(0,o.kJ)(e)?(t=4096,e.length>0&&(t|=j(e[0]))):c.CY.call(e,"value")&&(t=8192|j(e.value)))}return t}var F={Version:h,FullVersionString:f,strUndefined:c.jA,strObject:c.fK,Undefined:c.jA,arrForEach:o.tO,arrIndexOf:o.UA,arrMap:o.Mr,arrReduce:o.Xz,objKeys:o.FY,toISOString:o.Y6,isReactNative:i.b$,isString:o.HD,isNumber:o.hj,isBoolean:o.jn,isFunction:o.mf,isArray:o.kJ,isObject:o.Kn,strTrim:o.nd,isDocumentObjectAvailable:y,isWindowObjectAvailable:b,isValueAssigned:S,getTenantId:E,isBeaconsSupported:i.MF,isUint8ArrayAvailable:_,isLatency:w,sanitizeProperty:T,getISOString:o.Y6,useXDomainRequest:i.cp,getCommonSchemaMetaData:C,cookieAvailable:s.p7,disallowsSameSiteNone:s.UY,setCookie:I,deleteCookie:x,getCookie:O,createGuid:D,extend:A,getTime:k,isValueKind:N,isArrayValid:M,objDefineAccessors:o.l_,addPageUnloadEventListener:l.c9,setProcessTelemetryTimings:L,addEventHandler:l.Ib,getFieldValueType:j,strEndsWith:o.Id,objForEachKey:o.rW},U={_canUseCookies:void 0,isTypeof:o.Ym,isUndefined:o.o8,isNullOrUndefined:o.le,hasOwnProperty:o.nr,isFunction:o.mf,isObject:o.Kn,isDate:o.J_,isArray:o.kJ,isError:o.VZ,isString:o.HD,isNumber:o.hj,isBoolean:o.jn,toISOString:o.Y6,arrForEach:o.tO,arrIndexOf:o.UA,arrMap:o.Mr,arrReduce:o.Xz,strTrim:o.nd,objCreate:p.pu,objKeys:o.FY,objDefineAccessors:o.l_,addEventHandler:l.Ib,dateNow:o.m6,isIE:i.w1,disableCookies:P,newGuid:a.GW,perfNow:a.Jj,newId:u.pZ,randomValue:u.az,random32:u._l,mwcRandomSeed:u.CN,mwcRandom32:u.F6,generateW3CId:a.DO};function V(){return!!(0,i.a8)("chrome")}function H(e,t,n,r,i,o){function s(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return r&&s(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&s(a,g,n),a.open(e,t,!i),n&&s(a,g,n),!i&&o&&s(a,"timeout",o),a}},71488:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BE_PROFILE:()=>m,NRT_PROFILE:()=>g,PostChannel:()=>re,RT_PROFILE:()=>f});var r=n(27421),i=n(29141),o=n(81782),s=n(47954),a=n(87624),c=n(65705),l=n(24869),u=n(49251),p=n(28452),d=n(29339),h=n(87951),f="REAL_TIME",g="NEAR_REAL_TIME",m="BEST_EFFORT",v="",y="POST",b="drop",S="requeue",E="application/x-json-stream",_="content-type",w="client-version",T="client-id",C="time-delta-to-apply-millis",P="upload-time",I="apikey",x="AuthMsaDeviceTicket",O="AuthXToken";function R(e){var t=(e.ext||{}).intweb;return t&&(0,c.Sn)(t.msfpc)?t.msfpc:null}function D(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=R(e[n]);return t}var A=function(){function e(t,n){var r=n?[].concat(n):[],i=this,o=D(r);i.iKey=function(){return t},i.Msfpc=function(){return o||v},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=R(e)),!0)},i.split=function(n,i){var s;if(n<r.length){var a=r.length-n;(0,l.le)(i)||(a=i<a?i:a),s=r.splice(n,a),o=D(r)}return new e(t,s)}}return e.create=function(t,n){return new e(t,n)},e}();const k=function(){function e(){var t=!0,n=!0,r=!0,o="use-collector-delta",s=!1;(0,i.Z)(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,s||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return o},e.setClockSkew=function(e){s||(e?(o=e,n=!0,s=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}(),N=function(){function e(){var t={};(0,i.Z)(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=(s=e.split(","),a=[],s&&(0,l.tO)(s,(function(e){a.push((0,l.nd)(e))})),a);if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=(0,l.m6)()+i}catch(e){return[]}var s,a;return[]},e.isTenantKilled=function(e){var n=t,r=(0,l.nd)(e);return void 0!==n[r]&&n[r]>(0,l.m6)()||(delete n[r],!1)}}))}return e.__ieDyn=1,e}();var M=n(1550);function L(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var j,F=2e6,U=Math.min(F,65e3),V=/\./,H=function(){function e(t,n,r,s){var a="baseData",u=!!s,p=n,d={};(0,i.Z)(e,this,(function(e){function n(e,t,i,o,s,a,h){(0,l.rW)(e,(function(e,f){var g=null;if(f||(0,c.Sn)(f)){var m=i,v=e,y=s,b=t;if(u&&!o&&V.test(e)){var S=e.split("."),E=S.length;if(E>1){y&&(y=y.slice());for(var _=0;_<E-1;_++){var w=S[_];b=b[w]=b[w]||{},m+="."+w,y&&y.push(w)}v=S[E-1]}}var T=o&&function(e,t){var n=d[e];return void 0===n&&(e.length>=7&&(n=(0,l.xe)(e,"ext.metadata")||(0,l.xe)(e,"ext.web")),d[e]=n),n}(m);if(g=!T&&p&&p.handleField(m,v)?p.value(m,v,f,r):(0,c.yj)(v,f,r)){var C=g.value;if(b[v]=C,a&&a(y,v,g),h&&"object"==typeof C&&!(0,l.kJ)(C)){var P=y;P&&(P=P.slice()).push(v),n(f,C,m+"."+v,o,P,a,h)}}}}))}e.createPayload=function(e,t,n,r,i,o){return{apiKeys:[],payloadBlob:v,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(n,r,i){var s=n&&r&&!n.overflow;return s&&(0,o.Lm)(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=r.events(),o=n.payloadBlob,s=n.numEvents,a=!1,c=[],u=[],p=n.isBeacon,d=p?65e3:3984588,h=p?U:F,f=0,g=0;f<t.length;){var m=t[f];if(m){if(s>=i){n.overflow=r.split(f);break}var v=e.getEventBlob(m);if(v&&v.length<=h){var y=v.length;if(o.length+y>d){n.overflow=r.split(f);break}o&&(o+="\n"),o+=v,++g>20&&(o.substr(0,1),g=0),a=!0,s++}else v?c.push(m):u.push(m),t.splice(f,1),f--}f++}if(c&&c.length>0&&n.sizeExceed.push(A.create(r.iKey(),c)),u&&u.length>0&&n.failedEvts.push(A.create(r.iKey(),u)),a){n.batches.push(r),n.payloadBlob=o,n.numEvents=s;var b=r.iKey();-1===(0,l.UA)(n.apiKeys,b)&&n.apiKeys.push(b)}}),(function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),s},e.getEventBlob=function(e){try{return(0,o.Lm)(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+(0,c.jM)(e.iKey);var r={},i=e.ext;i&&(t.ext=r,(0,l.rW)(i,(function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)})));var o=t.data={};o.baseType=e.baseType;var s=o.baseData={};return n(e.baseData,s,a,!1,[a],(function(e,t,n){B(r,e,t,n)}),!0),n(e.data,o,"data",!1,[],(function(e,t,n){B(r,e,t,n)}),!0),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function B(e,t,n,r){if(r&&e){var i=(0,c.Vv)(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var s=o.f;if(s||(s=o.f={}),t)for(var a=0;a<t.length;a++){var u=t[a];s[u]||(s[u]={f:{}});var p=s[u].f;p||(p=s[u].f={}),s=p}s=s[n]={},(0,l.kJ)(r.value)?s.a={t:i}:s.t=i}}}var W="&NoResponseBody=true",q=((j={})[1]=S,j[100]=S,j[200]="sent",j[8004]=b,j[8003]=b,j),$={},G={};function K(e,t,n){$[e]=t,!1!==n&&(G[t]=e)}function z(e){try{return e.responseText}catch(e){}return v}function Y(e,t){var n=!1;if(e&&t){var r=(0,l.FY)(e);if(r&&r.length>0)for(var i=t.toLowerCase(),o=0;o<r.length;o++){var s=r[o];if(s&&(0,l.nr)(t,s)&&s.toLowerCase()===i){n=!0;break}}}return n}function J(e,t,n,r){t&&n&&n.length>0&&(r&&$[t]?(e.hdrs[$[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function X(e,t){return t&&((0,l.hj)(t)?e=[t].concat(e):(0,l.kJ)(t)&&(e=t.concat(e))),e}K(x,x,!1),K(w,w),K(T,"Client-Id"),K(I,I),K(C,C),K(P,P),K(O,O);var Q=function(){function e(t,n,r,s,a){this._responseHandlers=[];var p,h,f,g,m,S,x,O,R,D,A="?cors=true&"+_.toLowerCase()+"="+E,j=new N,F=!1,U=new k,V=!1,B=0,$=!0,K=[],Q={},Z=[],ee=null,te=!1,ne=!1,re=!1;(0,i.Z)(e,this,(function(e){var i=!0;function k(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?(0,u.cp)()?r=N:(0,u.Z3)()&&(r=oe):2===n&&(0,u.JO)(t)&&(!t||t&&!O)?r=ie:V&&3===n&&(0,u.MF)()&&(r=ae),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function N(e,t,n){var r=new XDomainRequest;r.open(y,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=z(r);se(t,200,{},e),ye(e)},r.onerror=function(){se(t,400,{})},r.ontimeout=function(){se(t,500,{})},r.onprogress=function(){},n?r.send(e.data):a.set((function(){r.send(e.data)}),0)}function ie(e,t,n){var r,o=e.urlString,s=!1,c=!1,u=((r={body:e.data,method:y}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(u.keepalive=!0,2===e._sendReason&&(s=!0,D&&(o+=W))),i&&(u.credentials="include"),e.headers&&(0,l.FY)(e.headers).length>0&&(u.headers=e.headers),fetch(o,u).then((function(e){var n={},r=v,i=e.headers;i&&i.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){r=e})),c||(c=!0,se(t,e.status,n,r),ye(r))})).catch((function(e){c||(c=!0,se(t,0,{}))})),s&&!c&&(c=!0,se(t,200,{})),!c&&e.timeout>0&&a.set((function(){c||(c=!0,se(t,500,{}))}),e.timeout)}function oe(e,t,n){var r=e.urlString;function o(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=(0,l.nd)(r))}return e}function s(e,n){se(t,e.status,function(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if((0,l.HD)(e)){var n=(0,l.nd)(e).split(/[\r\n]+/);(0,l.tO)(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=(0,l.nd)(e.substring(0,n)).toLowerCase(),i=(0,l.nd)(e.substring(n+1));t[r]=i}else t[(0,l.nd)(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=o(t,e,"time-delta-millis"),t=o(t,e,"kill-duration"),t=o(t,e,"kill-duration-seconds")),t}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=(0,c.ot)(y,r,i,!0,n,e.timeout);(0,l.rW)(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=z(a);s(a,e),ye(e)},a.onerror=function(){s(a)},a.ontimeout=function(){s(a)},a.send(e.data)}function se(e,t,n,r){try{e(t,n,r)}catch(e){(0,d.kP)(h,2,518,(0,u.eU)(e))}}function ae(e,t,n){var r=200,i=e._thePayload,o=e.urlString+(D?W:v);try{var s=(0,u.jW)();if(!s.sendBeacon(o,e.data))if(i){var a=[];(0,l.tO)(i.batches,(function(e){if(a&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!s.sendBeacon(o,ee.getEventBlob(t[n]))){a.push(e.split(n));break}}else a.push(e.split(0))})),be(a,8003,i.sendType,!0)}else r=0}catch(e){(0,d.jV)(h,"Failed to send telemetry using sendBeacon API. Ex:"+(0,u.eU)(e)),r=0}finally{se(t,r,{},v)}}function ce(e){return 2===e||3===e}function le(e){return ne&&ce(e)&&(e=2),e}function ue(){return!F&&B<n}function pe(){var e=Z;return Z=[],e}function de(e,t,n){var r=!1;return e&&e.length>0&&!F&&f[t]&&ee&&(r=0!==t||ue()&&(n>0||U.allowRequestSending())),r}function he(e){var t={};return e&&(0,l.tO)(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function fe(e,n,r,i,s){if(e&&0!==e.length)if(F)be(e,1,i);else{i=le(i);try{var a=e,l=0!==i;(0,o.Lm)(g,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var a=[],u=null,p=(0,c.hK)(),d=f[i]||(l?f[1]:f[0]),h=d&&d._transport,g=R&&(ne||ce(i)||3===h||d._isSync&&2===h);de(e,i,n);){var m=e.shift();m&&m.count()>0&&(j.isTenantKilled(m.iKey())?a.push(m):(u=u||ee.createPayload(n,r,l,g,s,i),ee.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,me(u,p,(0,c.hK)(),s),p=(0,c.hK)(),u=null):(me(u,p,(0,c.hK)(),s),p=(0,c.hK)(),e=[m].concat(e),u=null)))}u&&me(u,p,(0,c.hK)(),s),e.length>0&&(Z=e.concat(Z)),be(a,8004,i)}),(function(){return{batches:he(a),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:s,useSendBeacon:ce(i),sendType:i}}),!l)}catch(e){(0,d.kP)(h,2,48,"Unexpected Exception sending batch: "+(0,u.eU)(e))}}}function ge(e,t,n){e[t]=e[t]||{},e[t][p.identifier]=n}function me(t,n,i,s){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var a=!!e.sendHook,m=f[t.sendType];!ce(t.sendType)&&t.isBeacon&&2===t.sendReason&&(m=f[2]||f[3]||m);var y=re;(t.isBeacon||3===m._transport)&&(y=!1);var b=function(e,t){var n={url:A,hdrs:{},useHdrs:!1};t?(n.hdrs=(0,c.l7)(n.hdrs,Q),n.useHdrs=(0,l.FY)(n.hdrs).length>0):(0,l.rW)(Q,(function(e,t){G[e]?J(n,G[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),J(n,T,"NO_AUTH",t),J(n,w,c.vs,t);var r=v;(0,l.tO)(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),J(n,I,r,t),J(n,P,(0,l.m6)().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return v}(e);if((0,c.Sn)(i)&&(n.url+="&ext.intweb.msfpc="+i),U.shouldAddClockSkewHeaders()&&J(n,C,U.getClockSkewHeaderValue(),t),g.getWParam){var o=g.getWParam();o>=0&&(n.url+="&w="+o)}for(var s=0;s<K.length;s++)n.url+="&"+K[s].name+"="+K[s].value;return n}(t,y);y=y||b.useHdrs;var R=(0,c.hK)();(0,o.Lm)(g,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var f=0;f<t.batches.length;f++)for(var v=t.batches[f].events(),w=0;w<v.length;w++){var T=v[w];if(te){var C=T.timings=T.timings||{};ge(C,"sendEventStart",R),ge(C,"serializationStart",n),ge(C,"serializationCompleted",i)}T.sendAttempt>0?T.sendAttempt++:T.sendAttempt=1}be(t.batches,1e3+(s||0),t.sendType,!0);var P={data:t.payloadBlob,urlString:b.url,headers:b.hdrs,_thePayload:t,_sendReason:s,timeout:S,disableXhrSync:x,disableFetchKeepAlive:O};y&&(Y(P.headers,"cache-control")||(P.headers["cache-control"]="no-cache, no-store"),Y(P.headers,_)||(P.headers["content-type"]=E));var I=null;m&&(I=function(n){U.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s,a=9e3,u=null,d=!1,h=!1;try{var f=!0;if(typeof t!==M.jA){if(n){U.setClockSkew(n["time-delta-millis"]);var g=n["kill-duration"]||n["kill-duration-seconds"];(0,l.tO)(j.setKillSwitchTenants(n["kill-tokens"],g),(function(e){(0,l.tO)(i.batches,(function(t){if(t.iKey()===e){u=u||[];var n=t.split(0);i.numEvents-=n.count(),u.push(n)}}))}))}if(200==t||204==t)return void(a=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(f=!1),a=9e3+t%1e3}if(f){a=100;var m=i.retryCnt;0===i.sendType&&(m<r?(d=!0,ve((function(){0===i.sendType&&B--,fe(i.batches,m+1,i.isTeardown,ne?2:i.sendType,5)}),ne,L(m))):(h=!0,ne&&(a=8001)))}}finally{d||(U.setClockSkew(),function(t,n,r,i){try{i&&p._backOffTransmission(),200===n&&(i||t.isSync||p._clearBackOff(),function(e){if(te){var t=(0,c.hK)();(0,l.tO)(e,(function(e){e&&e.count()>0&&function(e,t){te&&(0,l.tO)(e,(function(e){ge(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),be(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(B--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,a,o,h)),be(u,8004,i.sendType)}}(n,i,t,s)},o=t.isTeardown||t.isSync;try{m.sendPOST(n,i,o),e.sendListener&&e.sendListener(P,n,o,t.isBeacon)}catch(e){(0,d.jV)(h,"Unexpected exception sending payload. Ex:"+(0,u.eU)(e)),se(i,0,{})}}),(0,o.Lm)(g,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(I)if(0===t.sendType&&B++,a&&!t.isBeacon&&3!==m._transport){var n={data:P.data,urlString:P.urlString,headers:(0,c.l7)({},P.headers),timeout:P.timeout,disableXhrSync:P.disableXhrSync,disableFetchKeepAlive:P.disableFetchKeepAlive},r=!1;(0,o.Lm)(g,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){r=!0,$||e._thePayload||(e._thePayload=e._thePayload||P._thePayload,e._sendReason=e._sendReason||P._sendReason),I(e)}),t.isSync||t.isTeardown)}catch(e){r||I(P)}}))}else I(P)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:s}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&be(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&be(t.failedEvts,8002,t.sendType)}function ve(e,t,n){t?e():a.set(e,n)}function ye(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){(0,d.kP)(h,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);(0,c.Sn)(i.webResult)&&(0,c.Sn)(i.webResult.msfpc)&&m.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function be(e,t,n,r){if(e&&e.length>0&&s){var i=s[(l=t,u=q[l],(0,c.Sn)(u)||(u="oth",l>=9e3&&l<=9999?u="rspFail":l>=8e3&&l<=8999?u=b:l>=1e3&&l<=1999&&(u="send")),u)];if(i){var a=0!==n;(0,o.Lm)(g,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){ve((function(){try{i.call(s,e,t,a,n)}catch(e){(0,d.kP)(h,1,74,"send request notification failed: "+e)}}),r||a,0)}),(function(){return{batches:he(e),reason:t,isSync:a,sendSync:r,sendType:n}}),!a)}}var l,u}e.initialize=function(e,t,n,r,o){var s;o||(o={}),A=e+A,re=!!(0,l.o8)(o.avoidOptions)||!o.avoidOptions,g=t,m=t.getCookieMgr(),te=!g.config.disableEventTimings;var a=!!g.config.enableCompoundKey;h=(p=n).diagLog();var c=o.valueSanitizer,v=o.stringifyObjects;(0,l.o8)(o.enableCompoundKey)||(a=!!o.enableCompoundKey),S=o.xhrTimeout,x=!!o.disableXhrSync,O=!!o.disableFetchKeepAlive,D=!1!==o.addNoResponse,V=!(0,u.b$)(),ee=new H(g,c,v,a),(0,l.le)(o.useSendBeacon)||(V=!!o.useSendBeacon);var y=r,b=o.alwaysUseXhrOverride?r:null,E=o.alwaysUseXhrOverride?r:null,_=[3,2];if(!r){$=!1;var w=(0,u.k$)();w&&w.protocol&&"file:"===w.protocol.toLowerCase()&&(i=!1);var T=[];(0,u.b$)()?(T=[2,1],_=[2,1,3]):T=[1,2,3],(r=k(T=X(T,o.transports),!1))||(0,d.jV)(h,"No available transport to send events"),y=k(T,!0)}b||(b=k(_=X(_,o.unloadTransports),!0)),R=!$&&(V&&(0,u.MF)()||!O&&(0,u.JO)(!0)),(s={})[0]=r,s[1]=y||k([1,2,3],!0),s[2]=b||y||k([1],!0),s[3]=E||k([2,3],!0)||y||k([1],!0),f=s},e._getDbgPlgTargets=function(){return[f[0],j,ee,f]},e.addQueryStringParameter=function(e,t){for(var n=0;n<K.length;n++)if(K[n].name===e)return void(K[n].value=t);K.push({name:e,value:t})},e.addHeader=function(e,t){Q[e]=t},e.canSendRequest=function(){return ue()&&U.allowRequestSending()},e.sendQueuedRequests=function(e,t){(0,l.o8)(e)&&(e=0),ne&&(e=le(e),t=2),de(Z,e,0)&&fe(pe(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!F&&0===B&&0===Z.length},e.setUnloading=function(e){ne=e},e.addBatch=function(e){if(e&&e.count()>0){if(j.isTenantKilled(e.iKey()))return!1;Z.push(e)}return!0},e.teardown=function(){Z.length>0&&fe(pe(),0,!0,2,2)},e.pause=function(){F=!0},e.resume=function(){F=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&((0,l.le)(t)&&(t=1),ne&&(t=le(t),n=2),fe([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function Z(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function ee(e){clearTimeout(e)}function te(e,t){return{set:e||Z,clear:t||ee}}var ne="eventsDiscarded";const re=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.9";var h,v,y,b,S,E,_,w=!1,T=[],C=null,P=!1,I=0,O=500,R=0,D=1e4,k={},N=f,M=null,j=null,F=0,U=0,V={},H=-1,B=!0,W=!1,q=6,$=2;return(0,i.Z)(t,r,(function(e,t){function r(e){"beforeunload"!==(e||(0,u.Jj)().event).type&&(W=!0,v.setUnloading(W)),ee(2,2)}function i(e){W=!1,v.setUnloading(W)}function G(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,B&&(c.if,e.ext=(0,l.Ax)(e.ext),e.baseData&&(e.baseData=(0,l.Ax)(e.baseData)),e.data&&(e.data=(0,l.Ax)(e.data))),e.sync)if(F||P)e.latency=3,e.sync=!1;else if(v)return B&&(e=(0,l.Ax)(e)),void v.sendSynchronousBatch(A.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=R,i=D;4===n&&(r=I,i=O);var o=!1;if(r<i)o=!oe(e,t);else{var s=1,a=20;4===n&&(s=4,a=1),o=!0,function(e,t,n,r){for(;n<=t;){var i=re(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),s=o.count();if(s>0)return 4===n?I-=s:R-=s,fe(ne,[o],p.h.QueueFull),!0}n++}return se(),!1}(e.iKey,e.latency,s,a)&&(o=!oe(e,t))}o&&he(ne,[e],p.h.QueueFull)}function K(e,t,n){var r=ae(e,t,n);return v.sendQueuedRequests(t,n),r}function z(){return R>0}function Y(){if(H>=0&&ae(H,0,S)&&v.sendQueuedRequests(0,S),I>0&&!j&&!P){var e=k[N][2];e>=0&&(j=X((function(){j=null,K(4,0,1),Y()}),e))}var t=k[N][1];!M&&!C&&t>=0&&!P&&(z()?M=X((function(){M=null,K(0===U?3:1,0,1),U++,U%=2,Y()}),t):U=0)}function J(){n=null,w=!1,T=[],C=null,P=!1,I=0,O=500,R=0,D=1e4,k={},N=f,M=null,j=null,F=0,U=0,h=null,V={},y=void 0,b=0,H=-1,S=null,B=!0,W=!1,q=6,$=2,E=null,_=te(),v=new Q(500,2,1,{requeue:pe,send:ge,sent:me,drop:ve,rspFail:ye,oth:be},_),ue(),V[4]={batches:[],iKeyMap:{}},V[3]={batches:[],iKeyMap:{}},V[2]={batches:[],iKeyMap:{}},V[1]={batches:[],iKeyMap:{}},Se()}function X(e,t){0===t&&F&&(t=1);var n=1e3;return F&&(n=L(F-1)),_.set(e,t*n)}function Z(){return null!==M&&(_.clear(M),M=null,U=0,!0)}function ee(e,t){Z(),C&&(_.clear(C),C=null),P||K(1,e,t)}function re(e,t,n){var r=V[t];r||(r=V[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=A.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function ie(t,n){v.canSendRequest()&&!F&&(y>0&&R>y&&(n=!0),n&&null==C&&e.flush(t,null,20))}function oe(e,t){B&&(e=(0,l.Ax)(e));var n=e.latency,r=re(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(R++,t&&0===e.sendAttempt&&ie(!e.sync,b>0&&r.count()>=b)):I++,!0)}function se(){for(var e=0,t=0,n=function(n){var r=V[n];r&&r.batches&&(0,l.tO)(r.batches,(function(r){4===n?e+=r.count():t+=r.count()}))},r=1;r<=4;r++)n(r);R=t,I=e}function ae(t,n,r){var i=!1,s=0===n;return!s||v.canSendRequest()?(0,o.Lm)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var r=V[n];r&&r.batches&&r.batches.length>0&&((0,l.tO)(r.batches,(function(t){v.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?I-=t.count():R-=t.count()})),r.batches=[],r.iKeyMap={}),n--}e.length>0&&he(ne,e,p.h.KillSwitch),i&&H>=t&&(H=-1,S=0)}),(function(){return{latency:t,sendType:n,sendReason:r}}),!s):(H=H>=0?Math.min(H,t):t,S=Math.max(S,r)),i}function ce(e,t){K(1,0,t),se(),le((function(){e&&e(),T.length>0?C=X((function(){C=null,ce(T.shift(),t)}),0):(C=null,Y())}))}function le(e){v.isCompletelyIdle()?e():C=X((function(){C=null,le(e)}),.25)}function ue(){(k={})[f]=[2,1,0],k[g]=[6,3,0],k[m]=[18,9,0]}function pe(t,n){var r=[],i=q;W&&(i=$),(0,l.tO)(t,(function(t){t&&t.count()>0&&(0,l.tO)(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?((0,c.if)(t,e.identifier),G(t,!1)):r.push(t))}))})),r.length>0&&he(ne,r,p.h.NonRetryableStatus),W&&ee(2,2)}function de(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){(0,d.kP)(e.diagLog(),1,74,t+" notification failed: "+n)}}function he(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&de(e,[t].concat(n))}function fe(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&(0,l.tO)(t,(function(t){t&&t.count()>0&&de(e,[t.events()].concat(n))}))}function ge(e,t,n){e&&e.length>0&&de("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function me(e,t){fe("eventsSent",e,t),Y()}function ve(e,t){fe(ne,e,t>=8e3&&t<=8999?t-8e3:p.h.Unknown)}function ye(e){fe(ne,e,p.h.NonRetryableStatus),Y()}function be(e,t){fe(ne,e,p.h.Unknown),Y()}function Se(){b=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,D/6)}J(),e._getDbgPlgTargets=function(){return[v]},e.initialize=function(u,p,d){(0,o.Lm)(p,(function(){return"PostChannel:initialize"}),(function(){var o=p;t.initialize(u,p,d);try{p.addUnloadCb,E=(0,s.jU)((0,a.J)(e.identifier),p.evtNamespace&&p.evtNamespace());var f=e._getTelCtx();u.extensionConfig[e.identifier]=u.extensionConfig[e.identifier]||{},n=f.getExtCfg(e.identifier),_=te(n.setTimeoutOverride,n.clearTimeoutOverride),B=!n.disableOptimizeObj&&(0,c.mJ)(),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(o),n.eventsLimitInMem>0&&(D=n.eventsLimitInMem),n.immediateEventLimit>0&&(O=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(y=n.autoFlushEventsLimit),(0,l.hj)(n.maxEventRetryAttempts)&&(q=n.maxEventRetryAttempts),(0,l.hj)(n.maxUnloadEventRetryAttempts)&&($=n.maxUnloadEventRetryAttempts),Se(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(h=n.httpXHROverride),(0,c.Sn)(u.anonCookieName)&&v.addQueryStringParameter("anoncknm",u.anonCookieName),v.sendHook=n.payloadPreprocessor,v.sendListener=n.payloadListener;var g=n.overrideEndpointUrl?n.overrideEndpointUrl:u.endpointUrl;e._notificationManager=p.getNotifyMgr(),v.initialize(g,e.core,e,h,n);var m=u.disablePageUnloadEvents||[];(0,s.c9)(r,m,E),(0,s.TJ)(r,m,E),(0,s.nD)(i,u.disablePageShowEvents,E)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:u,core:p,extensions:d}}))},e.processTelemetry=function(t,r){(0,c.if)(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var s=t;o||w||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),i&&i.overrideInstrumentationKey&&(s.iKey=i.overrideInstrumentationKey),G(s,!0),W?ee(2,2):Y()),e.processNext(s,r)},e._doTeardown=function(e,t){ee(2,2),w=!0,v.teardown(),(0,s.JA)(null,E),(0,s.C9)(null,E),(0,s.Yl)(null,E),J()},e.setEventQueueLimits=function(e,t){D=e>0?e:1e4,y=t>0?t:0,Se();var n=R>e;if(!n&&b>0)for(var r=1;!n&&r<=3;r++){var i=V[r];i&&i.batches&&(0,l.tO)(i.batches,(function(e){e&&e.count()>=b&&(n=!0)}))}ie(!0,n)},e.pause=function(){Z(),P=!0,v.pause()},e.resume=function(){P=!1,v.resume(),Y()},e.addResponseHandler=function(e){v._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){Z(),ue(),N=f,Y(),(0,l.rW)(e,(function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),k[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!P)if(n=n||1,e)null==C?(Z(),ae(1,0,n),C=X((function(){C=null,ce(t,n)}),0)):T.push(t);else{var r=Z();K(1,1,n),null!=t&&t(),r&&Y()}},e.setMsaAuthTicket=function(e){v.addHeader(x,e)},e.hasEvents=z,e._setTransmitProfile=function(e){N!==e&&void 0!==k[e]&&(Z(),N=e,Y())},e._backOffTransmission=function(){F<4&&(F++,Z(),Y())},e._clearBackOff=function(){F&&(F=0,Z(),Y())},(0,l.l_)(e,"_setTimeoutOverride",(function(){return _.set}),(function(e){_=te(e,_.clear)})),(0,l.l_)(e,"_clearTimeoutOverride",(function(){return _.clear}),(function(e){_=te(_.set,e)}))})),r}return(0,r.ne)(t,e),t.__ieDyn=1,t}(h.i)},50951:(e,t,n)=>{"use strict";n.d(t,{By:()=>i});var r=n(24869);function i(e){var t={};return(0,r.rW)(e,(function(e,n){t[e]=n,t[n]=e})),(0,r._A)(t)}},28452:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var r=(0,n(50951).By)({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})},87951:(e,t,n)=>{"use strict";n.d(t,{i:()=>l});var r=n(29141),i=n(98145),o=n(24869),s=n(96335),a=n(31030),c=n(38593),l=function(){function e(){var t,n,l,u,p,d=this;function h(e){void 0===e&&(e=null);var t=e;if(!t){var r=n||(0,a.CD)(null,{},d[s.oV]);t=l&&l.getPlugin?r[i.zV](null,l.getPlugin):r[i.zV](null,l)}return t}function f(e,t,r){e&&(0,o.sO)(e,s.Zh,[],null,o.le),!r&&t&&(r=t[i.SD]()[i.W2]());var c=l;l&&l.getPlugin&&(c=l.getPlugin()),d[s.oV]=t,n=(0,a.CD)(r,e,t,c)}function g(){t=!1,d[s.oV]=null,n=null,l=null,p=[],u=(0,c.Y)()}g(),(0,r.Z)(e,d,(function(e){e[i.VL]=function(e,n,r,i){f(e,n,i),t=!0},e[i.fi]=function(t,n){var r,c=e[s.oV];if(c&&(!t||c===t[s.oV]())){var d,h=!1,f=t||(0,a.Bt)(null,c,l&&l.getPlugin?l.getPlugin():l),m=n||((r={reason:0})[i.d]=!1,r);return e[i.F3]&&!0===e[i.F3](f,m,v)?d=!0:v(),d}function v(){if(!h){h=!0,u.run(f,n);var e=p;p=[],(0,o.tO)(e,(function(e){e.rm()})),!0===d&&f[i.uL](m),g()}}},e[i.Tu]=function(t,n){var r=e[s.oV];if(r&&(!t||r===t[s.oV]())){var o,c=!1,u=t||(0,a.xy)(null,r,l&&l.getPlugin?l.getPlugin():l),p=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(u,p,d)?o=!0:d(),o}function d(){c||(c=!0,f(u.getCfg(),u.core(),u[i.W2]()))}},e._addHook=function(e){e&&((0,o.kJ)(e)?p=p.concat(e):p[i.MW](e))},(0,o.Oi)(e,"_addUnloadCb",(function(){return u}),"add")})),d[i.mc]=function(e){return h(e)[i.mc]()},d[i.yl]=function(){return t},d.setInitialized=function(e){t=e},d[i.Jd]=function(e){l=e},d[i.uL]=function(e,t){t?t[i.uL](e):l&&(0,o.mf)(l[s.hL])&&l[s.hL](e,null)},d._getTelCtx=h}return e.__ieDyn=1,e}()},88140:(e,t,n)=>{"use strict";n.d(t,{JP:()=>b,Nz:()=>S,UY:()=>I,kj:()=>m,p7:()=>E});var r=n(98145),i=n(29339),o=n(49251),s=n(24869),a=n(96335),c="toGMTString",l="toUTCString",u=null,p=null,d=null,h=(0,o.Me)(),f={},g={};function m(e,t){var n=S._ckMgr||g._ckMgr;return n||(n=S._ckMgr=S(e,t),g._ckMgr=n),n}function v(e){return!e||e.isEnabled()}function y(e,t){return!!(t&&e&&(0,s.kJ)(e.ignoreCookies))&&-1!==e.ignoreCookies[r.ou](t)}function b(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var i=t[r.Lk];n=i._ckMgr?i._ckMgr:S(t)}return n||(n=m(t,(e||{})[r.eZ])),n}function S(e,t){var n,i=function(e){var t=e[r.Lk]=e[r.Lk]||{};if((0,s.sO)(t,"domain",e.cookieDomain,s.BX,s.le),(0,s.sO)(t,"path",e.cookiePath||"/",null,s.le),(0,s.le)(t.enabled)){var n=void 0;(0,s.o8)(e.isCookieUseDisabled)||(n=!e.isCookieUseDisabled),(0,s.o8)(e.disableCookiesUsage)||(n=!e.disableCookiesUsage),t.enabled=n}return t}(e||g),u=i.path||"/",d=i.domain,h=!1!==i.enabled,f=((n={isEnabled:function(){var e=h&&E(t),n=g._ckMgr;return e&&n&&f!==n&&(e=v(n)),e}})[r.$h]=function(e){h=!1!==e},n.set=function(e,t,n,h,g){var m=!1;if(v(f)&&!function(e,t){return!!(t&&e&&(0,s.kJ)(e.blockedCookies)&&-1!==e.blockedCookies[r.ou](t))||y(e,t)}(i,e)){var b={},S=(0,s.nd)(t||a.qS),E=S[r.ou](";");if(-1!==E&&(S=(0,s.nd)(t[r.zc](0,E)),b=_(t[r.zc](E+1))),(0,s.sO)(b,"domain",h||d,s.fQ,s.o8),!(0,s.le)(n)){var C=(0,o.w1)();if((0,s.o8)(b.expires)){var x=(0,s.m6)()+1e3*n;if(x>0){var O=new Date;O.setTime(x),(0,s.sO)(b,"expires",w(O,C?c:l)||w(O,C?c:l)||a.qS,s.fQ)}}C||(0,s.sO)(b,"max-age",a.qS+n,null,s.o8)}var R=(0,o.k$)();R&&"https:"===R.protocol&&((0,s.sO)(b,"secure",null,null,s.o8),null===p&&(p=!I(((0,o.jW)()||{})[r.qV])),p&&(0,s.sO)(b,"SameSite","None",null,s.o8)),(0,s.sO)(b,"path",g||u,null,s.o8),(i.setCookie||P)(e,T(S,b)),m=!0}return m},n.get=function(e){var t=a.qS;return v(f)&&!y(i,e)&&(t=(i.getCookie||C)(e)),t},n.del=function(e,t){var n=!1;return v(f)&&(n=f.purge(e,t)),n},n.purge=function(e,n){var r,s=!1;if(E(t)){var c=((r={}).path=n||"/",r.expires="Thu, 01 Jan 1970 00:00:01 GMT",r);(0,o.w1)()||(c["max-age"]="0"),(i.delCookie||P)(e,T(a.qS,c)),s=!0}return s},n);return f._ckMgr=f,f}function E(e){if(null===u){u=!1;try{u=void 0!==(h||{}).cookie}catch(t){(0,i.kP)(e,2,68,"Cannot access document.cookie - "+(0,s.jj)(t),{exception:(0,o.eU)(t)})}}return u}function _(e){var t={};if(e&&e[r.R5]){var n=(0,s.nd)(e)[r.w6](";");(0,s.tO)(n,(function(e){if(e=(0,s.nd)(e||a.qS)){var n=e[r.ou]("=");-1===n?t[e]=null:t[(0,s.nd)(e[r.zc](0,n))]=(0,s.nd)(e[r.zc](n+1))}}))}return t}function w(e,t){return(0,s.mf)(e[t])?e[t]():null}function T(e,t){var n=e||a.qS;return(0,s.rW)(t,(function(e,t){n+="; "+e+((0,s.le)(t)?a.qS:"="+t)})),n}function C(e){var t=a.qS;if(h){var n=h.cookie||a.qS;d!==n&&(f=_(n),d=n),t=(0,s.nd)(f[e]||a.qS)}return t}function P(e,t){h&&(h.cookie=e+"="+t)}function I(e){return!(!(0,s.HD)(e)||!(0,s._Q)(e,"CPU iPhone OS 12")&&!(0,s._Q)(e,"iPad; CPU OS 12")&&!((0,s._Q)(e,"Macintosh; Intel Mac OS X 10_14")&&(0,s._Q)(e,"Version/")&&(0,s._Q)(e,"Safari"))&&(!(0,s._Q)(e,"Macintosh; Intel Mac OS X 10_14")||!(0,s.Id)(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!(0,s._Q)(e,"Chrome/5")&&!(0,s._Q)(e,"Chrome/6")&&(!(0,s._Q)(e,"UnrealEngine")||(0,s._Q)(e,"Chrome"))&&!(0,s._Q)(e,"UCBrowser/12")&&!(0,s._Q)(e,"UCBrowser/11"))}},28956:(e,t,n)=>{"use strict";n.d(t,{DO:()=>g,GW:()=>h,Jj:()=>f,zB:()=>v});var r,i=n(30175),o=n(98145),s=n(88140),a=n(49251),c=n(47954),l=n(24869),u=n(96335),p=n(19406),d=null;function h(){var e=g();return e[o.zc](0,8)+"-"+e[o.zc](8,12)+"-"+e[o.zc](12,16)+"-"+e[o.zc](16,20)+"-"+e[o.zc](20)}function f(){var e=(0,a.r)();return e&&e.now?e.now():(0,l.m6)()}function g(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=u.qS,r=0;r<4;r++)n+=t[15&(e=(0,p._l)())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&(0,p._l)())|0];return n[o.Jn](0,8)+n[o.Jn](9,4)+"4"+n[o.Jn](13,3)+i+n[o.Jn](16,3)+n[o.Jn](19,12)}var m={_canUseCookies:void 0,isTypeof:l.Ym,isUndefined:l.o8,isNullOrUndefined:l.le,hasOwnProperty:l.nr,isFunction:l.mf,isObject:l.Kn,isDate:l.J_,isArray:l.kJ,isError:l.VZ,isString:l.HD,isNumber:l.hj,isBoolean:l.jn,toISOString:l.Y6,arrForEach:l.tO,arrIndexOf:l.UA,arrMap:l.Mr,arrReduce:l.Xz,strTrim:l.nd,objCreate:i.pu,objKeys:l.FY,objDefineAccessors:l.l_,addEventHandler:c.Ib,dateNow:l.m6,isIE:a.w1,disableCookies:function(){var e,t,n,i;(n=(0,s.kj)(e,t),i=m._canUseCookies,null===d&&(d=[],r=i,(0,l.l_)(m,"_canUseCookies",(function(){return r}),(function(e){r=e,(0,l.tO)(d,(function(t){t[o.$h](e)}))}))),-1===(0,l.UA)(d,n)&&d[o.MW](n),(0,l.jn)(i)&&n[o.$h](i),(0,l.jn)(r)&&n[o.$h](r),n)[o.$h](!1)},newGuid:h,perfNow:f,newId:p.pZ,randomValue:p.az,random32:p._l,mwcRandomSeed:p.CN,mwcRandom32:p.F6,generateW3CId:g},v={Attach:c.pZ,AttachEvent:c.pZ,Detach:c.pD,DetachEvent:c.pD}},87624:(e,t,n)=>{"use strict";n.d(t,{J:()=>d,K:()=>h});var r=n(1550),i=n(98145),o=n(24869),s=n(96335),a=n(19406),c=r.RJ,l="."+(0,a.pZ)(6),u=0;function p(e){return 1===e[i.xv]||9===e[i.xv]||!+e[i.xv]}function d(e,t){return void 0===t&&(t=!1),(0,o.Gf)(e+u+++(t?".2.8.10":s.qS)+l)}function h(e){var t={id:d("_aiData-"+(e||s.qS)+".2.8.10"),accept:function(e){return p(e)},get:function(e,n,r,i){var s=e[t.id];return s?s[(0,o.Gf)(n)]:(i&&((s=function(e,t){var n=t[e.id];if(!n){n={};try{p(t)&&(function(e,t,n){if(c)try{return c(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[(0,o.Gf)(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}},28341:(e,t,n)=>{"use strict";n.d(t,{j:()=>l,p:()=>u});var r,i=n(98145),o=n(49251),s=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],a=null;function c(e,t){return function(){var n=arguments,r=l(t);if(r){var o=r.listener;o&&o[e]&&o[e][i.ZV](o,n)}}}function l(e){var t,n=a;return n||!0===e.disableDbgExt||(n=a||((t=(0,o.a8)("Microsoft"))&&(a=t.ApplicationInsights),a)),n?n.ChromeDbgExt:null}function u(e){if(!r){r={};for(var t=0;t<s[i.R5];t++)r[s[t]]=c(s[t],e)}return r}},29339:(e,t,n)=>{"use strict";n.d(t,{AQ:()=>h,L4:()=>v,jV:()=>m,kP:()=>g,lQ:()=>p,vH:()=>d});var r=n(29141),i=n(98145),o=n(28341),s=n(49251),a=n(24869),c=n(96335);function l(e){return e?'"'+e[i.i7](/\"/g,c.qS)+'"':c.qS}function u(e,t){var n=(0,s.dr)();if(n){var r="log";n[e]&&(r=e),(0,a.mf)(n[r])&&n[r](t)}}var p=function(){function e(e,t,n,r){void 0===n&&(n=!1);var o=this;o[i.Gc]=e,o[i.gU]=(n?"AI: ":"AI (Internal): ")+e;var a=c.qS;(0,s.nS)()&&(a=(0,s.xA)().stringify(r));var u=(t?" message:"+l(t):c.qS)+(r?" props:"+l(a):c.qS);o[i.gU]+=u}return e.dataType="MessageData",e}();function d(e,t){return(e||{})[i.eZ]||new h(t)}var h=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,l,d,h,f=0,g={};(0,r.Z)(e,this,(function(e){function r(t,n){if(!(f>=d)){var r=!0,o="AITR_"+n[i.Gc];if(g[o]?r=!1:g[o]=!0,r&&(t<=l&&(e.queue[i.MW](n),f++,m(1===t?"error":"warn",n)),f===d)){var s="Internal events throttle limit per PageView reached for this app.",a=new p(23,s,!1);e.queue[i.MW](a),1===t?e[c.ys](s):e[c.cL](s)}}}function m(e,n){var r=(0,o.j)(t||{});r&&r[i.mc]&&r[i.mc](e,n)}!function(e){n=(0,a.v4)(e.loggingLevelConsole,0),l=(0,a.v4)(e.loggingLevelTelemetry,1),d=(0,a.v4)(e.maxMessageLimit,25),h=(0,a.v4)(e[i.Fr],!1)}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return l},e.maxInternalMessageLimit=function(){return d},e[i.Fr]=function(){return h},e.throwInternal=function(t,o,l,u,d){void 0===d&&(d=!1);var f=new p(o,l,d,u);if(h)throw(0,s.eU)(f);var v=1===t?c.ys:c.cL;if((0,a.o8)(f[i.gU]))m("throw"+(1===t?"Critical":"Warning"),f);else{if(d){var y=+f[i.Gc];!g[y]&&n>=t&&(e[v](f[i.gU]),g[y]=!0)}else n>=t&&e[v](f[i.gU]);r(t,f)}},e[c.cL]=function(e){u("warn",e),m("warning",e)},e[c.ys]=function(e){u("error",e),m("error",e)},e.resetInternalMessageCount=function(){f=0,g={}},e[i.jk]=r}))}return e.__ieDyn=1,e}();function f(e){return e||new h}function g(e,t,n,r,i,o){void 0===o&&(o=!1),f(e).throwInternal(t,n,r,i,o)}function m(e,t){f(e)[c.cL](t)}function v(e,t,n){f(e)[i.jk](t,n)}},49251:(e,t,n)=>{"use strict";n.d(t,{JO:()=>H,Jj:()=>_,MF:()=>V,MX:()=>N,Me:()=>T,Nv:()=>w,Ym:()=>E,Z3:()=>W,a8:()=>S,b$:()=>L,cp:()=>B,d6:()=>C,dI:()=>b,dr:()=>R,eU:()=>U,ed:()=>$,fE:()=>I,gz:()=>M,jW:()=>P,k$:()=>O,nS:()=>A,pI:()=>G,r:()=>D,s1:()=>x,sA:()=>F,w1:()=>j,xA:()=>k});var r=n(1550),i=n(30175),o=n(98145),s=n(24869),a=n(96335),c="window",l="JSON",u="msie",p="trident/",d="XMLHttpRequest",h=null,f=null,g=!1,m=null,v=null;function y(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[r.hB];i&&(n=t in i)}}catch(e){}if(!n)try{var o=new e;n=!(0,s.o8)(o[t])}catch(e){}}return n}function b(e){g=e}function S(e){var t=(0,i.Rd)();return t&&t[e]?t[e]:e===c&&E()?window:null}function E(){return Boolean(typeof window===r.fK&&window)}function _(){return E()?window:S(c)}function w(){return Boolean(typeof document===r.fK&&document)}function T(){return w()?document:S("document")}function C(){return Boolean(typeof navigator===r.fK&&navigator)}function P(){return C()?navigator:S("navigator")}function I(){return Boolean(typeof history===r.fK&&history)}function x(){return I()?history:S("history")}function O(e){if(e&&g){var t=S("__mockLocation");if(t)return t}return typeof location===r.fK&&location?location:S("location")}function R(){return typeof console!==r.jA?console:S("console")}function D(){return S("performance")}function A(){return Boolean(typeof JSON===r.fK&&JSON||null!==S(l))}function k(){return A()?JSON||S(l):null}function N(){return S("crypto")}function M(){return S("msCrypto")}function L(){var e=P();return!(!e||!e.product)&&"ReactNative"===e.product}function j(){var e=P();if(e&&(e[o.qV]!==f||null===h)){var t=((f=e[o.qV])||a.qS)[o.T1]();h=(0,s._Q)(t,u)||(0,s._Q)(t,p)}return h}function F(e){if(void 0===e&&(e=null),!e){var t=P()||{};e=t?(t[o.qV]||a.qS)[o.T1]():a.qS}var n=(e||a.qS)[o.T1]();if((0,s._Q)(n,u)){var r=T()||{};return Math.max(parseInt(n[o.w6](u)[1]),r.documentMode||0)}if((0,s._Q)(n,p)){var i=parseInt(n[o.w6](p)[1]);if(i)return i+4}return null}function U(e){var t=Object[r.hB].toString[o._S](e),n=a.qS;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[o.I]+"'":A()&&(n=k().stringify(e)),t+n}function V(){return null===v&&(v=C()&&Boolean(P().sendBeacon)),v}function H(e){var t=!1;try{t=!!S("fetch");var n=S("Request");t&&e&&n&&(t=y(n,"keepalive"))}catch(e){}return t}function B(){return null===m&&(m=typeof XDomainRequest!==r.jA)&&W()&&(m=m&&!y(S(d),"withCredentials")),m}function W(){var e=!1;try{e=!!S(d)}catch(e){}return e}function q(e,t){if(e)for(var n=0;n<e[o.R5];n++){var r=e[n];if(r[o.I]&&r[o.I]===t)return r}return{}}function $(e){var t=T();return t&&e?q(t.querySelectorAll("meta"),e).content:null}function G(e){var t,n=D();if(n){var r=n.getEntriesByType("navigation")||[];t=q((r[o.R5]>0?r[0]:{}).serverTiming,e).description}return t}},47954:(e,t,n)=>{"use strict";n.d(t,{C1:()=>k,C9:()=>V,Ib:()=>A,JA:()=>F,QY:()=>O,TJ:()=>U,XO:()=>x,Yl:()=>B,c9:()=>j,jU:()=>I,nD:()=>H,nJ:()=>L,pD:()=>D,pZ:()=>R,um:()=>w,yw:()=>M});var r=n(98145),i=n(87624),o=n(49251),s=n(24869),a=n(96335),c="events",l="visibilitychange",u="pagehide",p="pageshow",d="unload",h="beforeunload",f=(0,i.J)("aiEvtPageHide"),g=(0,i.J)("aiEvtPageShow"),m=/\.[\.]+/g,v=/[\.]+$/,y=1,b=(0,i.K)("events"),S=/^([^.]*)(?:\.(.+)|)/;function E(e){return e&&e[r.i7]?e[r.i7](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,a.qS):e}function _(e,t){var n;if(t){var i=a.qS;(0,s.kJ)(t)?(i=a.qS,(0,s.tO)(t,(function(e){(e=E(e))&&("."!==e[0]&&(e="."+e),i+=e)}))):i=E(t),i&&("."!==i[0]&&(i="."+i),e=(e||a.qS)+i)}var o=S.exec(e||a.qS)||[];return(n={})[r.P6]=o[1],n.ns=(o[2]||a.qS).replace(m,".").replace(v,a.qS)[r.w6](".").sort().join("."),n}function w(e,t,n){var i=[],o=b.get(e,c,{},!1),l=_(t,n);return(0,s.rW)(o,(function(e,t){(0,s.tO)(t,(function(e){var t;l[r.P6]&&l[r.P6]!==e.evtName[r.P6]||l.ns&&l.ns!=l.ns||i[r.MW](((t={})[r.I]=e.evtName[r.P6]+(e.evtName.ns?"."+e.evtName.ns:a.qS),t.handler=e[r.Kn],t))}))})),i}function T(e,t,n){void 0===n&&(n=!0);var r=b.get(e,c,{},n),i=r[t];return i||(i=r[t]=[]),i}function C(e,t,n,i){e&&t&&t[r.P6]&&(e.removeEventListener?e.removeEventListener(t[r.P6],n,i):e.detachEvent&&e.detachEvent("on"+t[r.P6],n))}function P(e,t,n,i){for(var o=t[r.R5];o--;){var s=t[o];s&&(n.ns&&n.ns!==s.evtName.ns||i&&!i(s)||(C(e,s.evtName,s[r.Kn],s.capture),t[r.cb](o,1)))}}function I(e,t){return t?_("xx",(0,s.kJ)(t)?[e].concat(t):[e,t]).ns[r.w6]("."):e}function x(e,t,n,i,o){var s;void 0===o&&(o=!1);var a=!1;if(e)try{var c=_(t,i);if(a=function(e,t,n,i){var o=!1;return e&&t&&t[r.P6]&&n&&(e.addEventListener?(e.addEventListener(t[r.P6],n,i),o=!0):e.attachEvent&&(e.attachEvent("on"+t[r.P6],n),o=!0)),o}(e,c,n,o),a&&b.accept(e)){var l=((s={guid:y++,evtName:c})[r.Kn]=n,s.capture=o,s);T(e,c.type)[r.MW](l)}}catch(e){}return a}function O(e,t,n,i,o){if(void 0===o&&(o=!1),e)try{var a=_(t,i),l=!1;!function(e,t,n){if(t[r.P6])P(e,T(e,t[r.P6]),t,n);else{var i=b.get(e,c,{});(0,s.rW)(i,(function(r,i){P(e,i,t,n)})),0===(0,s.FY)(i)[r.R5]&&b.kill(e,c)}}(e,a,(function(e){return!((!a.ns||n)&&e[r.Kn]!==n||(l=!0,0))})),l||C(e,a,n,o)}catch(e){}}function R(e,t,n,r){return void 0===r&&(r=!1),x(e,t,n,null,r)}function D(e,t,n,r){void 0===r&&(r=!1),O(e,t,n,null,r)}function A(e,t,n){var r=!1,i=(0,o.Jj)();i&&(r=x(i,e,t,n),r=x(i.body,e,t,n)||r);var s=(0,o.Me)();return s&&(r=x(s,e,t,n)||r),r}function k(e,t,n){var r=(0,o.Jj)();r&&(O(r,e,t,n),O(r.body,e,t,n));var i=(0,o.Me)();i&&O(i,e,t,n)}function N(e,t,n,i){var o=!1;return t&&e&&e[r.R5]>0&&(0,s.tO)(e,(function(e){e&&(n&&-1!==(0,s.UA)(n,e)||(o=A(e,t,i)||o))})),o}function M(e,t,n,i){var o=!1;return t&&e&&(0,s.kJ)(e)&&!(o=N(e,t,n,i))&&n&&n[r.R5]>0&&(o=N(e,t,null,i)),o}function L(e,t,n){e&&(0,s.kJ)(e)&&(0,s.tO)(e,(function(e){e&&k(e,t,n)}))}function j(e,t,n){return M([h,d,u],e,t,n)}function F(e,t){L([h,d,u],e,t)}function U(e,t,n){var r=I(f,n),i=N([u],e,t,r);return t&&-1!==(0,s.UA)(t,l)||(i=N([l],(function(t){var n=(0,o.Me)();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,r)||i),!i&&t&&(i=U(e,null,n)),i}function V(e,t){var n=I(f,t);L([u],e,n),L([l],null,n)}function H(e,t,n){var r=I(g,n),i=N([p],e,t,r);return!(i=N([l],(function(t){var n=(0,o.Me)();e&&n&&"visible"===n.visibilityState&&e(t)}),t,r)||i)&&t&&(i=H(e,null,n)),i}function B(e,t){var n=I(g,t);L([p],e,n),L([l],null,n)}},24869:(e,t,n)=>{"use strict";n.d(t,{Ax:()=>ge,BX:()=>I,F:()=>ce,FL:()=>te,FY:()=>X,Gf:()=>D,HD:()=>U,Id:()=>k,J_:()=>L,Kn:()=>O,Mr:()=>G,Oi:()=>he,UA:()=>$,VZ:()=>F,Vb:()=>fe,Xi:()=>ne,Xz:()=>K,Y6:()=>W,Ym:()=>T,_A:()=>ee,_Q:()=>M,_y:()=>ue,cf:()=>de,fQ:()=>le,hj:()=>V,jj:()=>ie,jn:()=>H,kJ:()=>j,l_:()=>Q,le:()=>P,m6:()=>re,mf:()=>R,mm:()=>me,nd:()=>z,nr:()=>x,o8:()=>C,qK:()=>se,rW:()=>A,sO:()=>oe,tO:()=>q,v4:()=>ae,xe:()=>N});var r=n(1550),i=n(30175),o=n(98145),s=n(96335),a=r.RJ,c=r.Pw.freeze,l=r.Pw.seal,u=r.Pw.keys,p=String[r.hB],d=p.trim,h=p.endsWith,f=p.startsWith,g=Date[r.hB].toISOString,m=Array.isArray,v=r.V4.toString,y=r.CY.toString,b=y[o._S](r.Pw),S=/-([a-z])/g,E=/([^\w\d_$])/g,_=/^(\d+[\w\d_$])/,w=Object.getPrototypeOf;function T(e,t){return typeof e===t}function C(e){return void 0===e||typeof e===r.jA}function P(e){return null===e||C(e)}function I(e){return!P(e)}function x(e,t){return!(!e||!r.CY[o._S](e,t))}function O(e){return!(!e||typeof e!==r.fK)}function R(e){return!(!e||typeof e!==r.cb)}function D(e){var t=e;return t&&U(t)&&(t=(t=(t=t[o.i7](S,(function(e,t){return t.toUpperCase()})))[o.i7](E,"_"))[o.i7](_,(function(e,t){return"_"+t}))),t}function A(e,t){if(e)for(var n in e)r.CY[o._S](e,n)&&t[o._S](e,n,e[n])}function k(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=h?e.endsWith(t):function(e,t){var n=!1,r=t?t[o.R5]:0,i=e?e[o.R5]:0;if(r&&i&&i>=r&&!(n=e===t)){for(var s=i-1,a=r-1;a>=0;a--){if(e[s]!=t[a])return!1;s--}n=!0}return n}(e,t)),n}function N(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=f?e.startsWith(t):function(e,t){var n=!1,r=t?t[o.R5]:0;if(e&&r&&e[o.R5]>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function M(e,t){return!(!e||!t)&&-1!==e[o.ou](t)}function L(e){return!(!e||"[object Date]"!==v[o._S](e))}var j=m||function(e){return!(!e||"[object Array]"!==v[o._S](e))};function F(e){return!(!e||"[object Error]"!==v[o._S](e))}function U(e){return"string"==typeof e}function V(e){return"number"==typeof e}function H(e){return"boolean"==typeof e}function B(e){var t=!1;if(e&&"object"==typeof e){var n=w?w(e):function(e){if(e){if(w)return w(e);var t=e.__proto__||e[r.hB]||e.constructor;if(t)return t}return null}(e);n?(n.constructor&&r.CY[o._S](n,"constructor")&&(n=n.constructor),t=typeof n===r.cb&&y[o._S](n)===b):t=!0}return t}function W(e){if(e)return g?e.toISOString():function(e){if(e&&e